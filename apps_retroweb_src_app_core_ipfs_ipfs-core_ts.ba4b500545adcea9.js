(self.webpackChunkretroweb=self.webpackChunkretroweb||[]).push([["apps_retroweb_src_app_core_ipfs_ipfs-core_ts"],{76932:(re,J,p)=>{"use strict";p.r(J),p.d(J,{IPFSCore:()=>U3});var w={};p.r(w),p.d(w,{code:()=>gr,createLink:()=>EW,createNode:()=>wW,decode:()=>Vr,encode:()=>ir,name:()=>xW,prepare:()=>Ki,validate:()=>zT});var d={};p.r(d),p.d(d,{code:()=>l6,decode:()=>ip,encode:()=>u6,name:()=>RQ});var S={};p.r(S),p.d(S,{code:()=>EC,decode:()=>IJ,encode:()=>CJ,name:()=>TJ});var I={};p.r(I),p.d(I,{code:()=>AX,decode:()=>RX,encode:()=>IX,name:()=>SX,toGeneral:()=>BC});var m={};p.r(m),p.d(m,{identity:()=>A6});var l={};p.r(l),p.d(l,{identity:()=>uq});var h={};p.r(h),p.d(h,{base2:()=>dq});var y={};p.r(y),p.d(y,{base8:()=>fq});var _={};p.r(_),p.d(_,{base10:()=>hq});var A={};p.r(A),p.d(A,{base16:()=>pq,base16upper:()=>yq});var O={};p.r(O),p.d(O,{base32:()=>Fd,base32hex:()=>mq,base32hexpad:()=>wq,base32hexpadupper:()=>Eq,base32hexupper:()=>vq,base32pad:()=>bq,base32padupper:()=>_q,base32upper:()=>gq,base32z:()=>xq});var x={};p.r(x),p.d(x,{base36:()=>mp,base36upper:()=>Sq});var g={};p.r(g),p.d(g,{base58btc:()=>Hs,base58flickr:()=>Aq});var v={};p.r(v),p.d(v,{base64:()=>Tq,base64pad:()=>Cq,base64url:()=>Iq,base64urlpad:()=>Rq});var R={};p.r(R),p.d(R,{base256emoji:()=>Bq});var N={};p.r(N),p.d(N,{sha256:()=>ml,sha512:()=>kq});var D={};p.r(D),p.d(D,{code:()=>T6,decode:()=>Fq,encode:()=>Mq,name:()=>Uq});var k={};p.r(k),p.d(k,{code:()=>ZC,decode:()=>Kq,encode:()=>$q,name:()=>jq});var j={};p.r(j),p.d(j,{base58btc:()=>So,base58flickr:()=>yee});var Q={};p.r(Q),p.d(Q,{base32:()=>jd,base32hex:()=>mee,base32hexpad:()=>wee,base32hexpadupper:()=>Eee,base32hexupper:()=>vee,base32pad:()=>bee,base32padupper:()=>_ee,base32upper:()=>gee,base32z:()=>xee});var L={};p.r(L),p.d(L,{identity:()=>lte});var K={};p.r(K),p.d(K,{base2:()=>ute});var G={};p.r(G),p.d(G,{base8:()=>dte});var C={};p.r(C),p.d(C,{base10:()=>fte});var z={};p.r(z),p.d(z,{base16:()=>hte,base16upper:()=>pte});var te={};p.r(te),p.d(te,{base32:()=>wc,base32hex:()=>_te,base32hexpad:()=>vte,base32hexpadupper:()=>wte,base32hexupper:()=>mte,base32pad:()=>gte,base32padupper:()=>bte,base32upper:()=>yte,base32z:()=>Ete});var Z={};p.r(Z),p.d(Z,{base36:()=>xte,base36upper:()=>Ste});var se={};p.r(se),p.d(se,{base58btc:()=>mi,base58flickr:()=>Ate});var ue={};p.r(ue),p.d(ue,{base64:()=>Tte,base64pad:()=>Cte,base64url:()=>Ite,base64urlpad:()=>Rte});var oe={};p.r(oe),p.d(oe,{base256emoji:()=>Bte});var me={};p.r(me),p.d(me,{sha256:()=>tre,sha512:()=>rre});var fe={};p.r(fe),p.d(fe,{identity:()=>sre});var ae={};p.r(ae),p.d(ae,{code:()=>ore,decode:()=>cre,encode:()=>are,name:()=>ire});var pe={};p.r(pe),p.d(pe,{code:()=>fre,decode:()=>pre,encode:()=>hre,name:()=>dre});var ce={};p.r(ce),p.d(ce,{identity:()=>rne});var _e={};p.r(_e),p.d(_e,{base2:()=>nne});var de={};p.r(de),p.d(de,{base8:()=>sne});var ye={};p.r(ye),p.d(ye,{base10:()=>ine});var we={};p.r(we),p.d(we,{base16:()=>one,base16upper:()=>ane});var xe={};p.r(xe),p.d(xe,{base36:()=>cne,base36upper:()=>lne});var Ae={};p.r(Ae),p.d(Ae,{base64:()=>une,base64pad:()=>dne,base64url:()=>fne,base64urlpad:()=>hne});var Re={};p.r(Re),p.d(Re,{base256emoji:()=>_ne});var ve={};p.r(ve),p.d(ve,{sha256:()=>vne,sha512:()=>wne});var Oe={};p.r(Oe),p.d(Oe,{identity:()=>xne});var Ve={};p.r(Ve),p.d(Ve,{code:()=>Ane,decode:()=>Cne,encode:()=>Tne,name:()=>Sne});var Ue={};p.r(Ue),p.d(Ue,{code:()=>One,decode:()=>Nne,encode:()=>Pne,name:()=>Dne});var je={};p.r(je),p.d(je,{identity:()=>cse});var Ke={};p.r(Ke),p.d(Ke,{base2:()=>lse});var nt={};p.r(nt),p.d(nt,{base8:()=>use});var dt={};p.r(dt),p.d(dt,{base10:()=>dse});var pt={};p.r(pt),p.d(pt,{base16:()=>fse,base16upper:()=>hse});var Xt={};p.r(Xt),p.d(Xt,{base32:()=>pse,base32hex:()=>_se,base32hexpad:()=>vse,base32hexpadupper:()=>wse,base32hexupper:()=>mse,base32pad:()=>gse,base32padupper:()=>bse,base32upper:()=>yse,base32z:()=>Ese});var Ft={};p.r(Ft),p.d(Ft,{base36:()=>xse,base36upper:()=>Sse});var Ht={};p.r(Ht),p.d(Ht,{base58btc:()=>Ase,base58flickr:()=>Tse});var Kt={};p.r(Kt),p.d(Kt,{base64:()=>Cse,base64pad:()=>Ise,base64url:()=>Rse,base64urlpad:()=>Dse});var xr={};p.r(xr),p.d(xr,{base256emoji:()=>Lse});var Zt={};p.r(Zt),p.d(Zt,{sha256:()=>tie,sha512:()=>rie});var qt={};p.r(qt),p.d(qt,{identity:()=>sie});var lr={};p.r(lr),p.d(lr,{code:()=>oie,decode:()=>cie,encode:()=>aie,name:()=>iie});var hr={};p.r(hr),p.d(hr,{code:()=>fie,decode:()=>pie,encode:()=>hie,name:()=>die});var pr={};p.r(pr),p.d(pr,{base58btc:()=>To,base58flickr:()=>coe});var Dt={};p.r(Dt),p.d(Dt,{base32:()=>nf,base32hex:()=>foe,base32hexpad:()=>poe,base32hexpadupper:()=>yoe,base32hexupper:()=>hoe,base32pad:()=>uoe,base32padupper:()=>doe,base32upper:()=>loe,base32z:()=>goe});var Tt={};p.r(Tt),p.d(Tt,{base58btc:()=>Si,base58flickr:()=>Eae});var yr={};p.r(yr),p.d(yr,{base32:()=>yf,base32hex:()=>Tae,base32hexpad:()=>Iae,base32hexpadupper:()=>Rae,base32hexupper:()=>Cae,base32pad:()=>Sae,base32padupper:()=>Aae,base32upper:()=>xae,base32z:()=>Dae});var Ye={};p.r(Ye),p.d(Ye,{identity:()=>Uae});var tt={};p.r(tt),p.d(tt,{base2:()=>Mae});var st={};p.r(st),p.d(st,{base8:()=>Fae});var ot={};p.r(ot),p.d(ot,{base10:()=>zae});var ht={};p.r(ht),p.d(ht,{base16:()=>Vae,base16upper:()=>jae});var St={};p.r(St),p.d(St,{base36:()=>$ae,base36upper:()=>Kae});var zt={};p.r(zt),p.d(zt,{base64:()=>Zae,base64pad:()=>Hae,base64url:()=>Gae,base64urlpad:()=>Wae});var er={};p.r(er),p.d(er,{base256emoji:()=>qae});var bo={};p.r(bo),p.d(bo,{sha256:()=>i1,sha512:()=>tce});var ji={};p.r(ji),p.d(ji,{identity:()=>bf});var Vu={};p.r(Vu),p.d(Vu,{code:()=>sce,decode:()=>oce,encode:()=>ice,name:()=>nce});var ju={};p.r(ju),p.d(ju,{code:()=>uce,decode:()=>fce,encode:()=>dce,name:()=>lce});var $u={};p.r($u),p.d($u,{identity:()=>Zce});var Ku={};p.r(Ku),p.d(Ku,{base2:()=>Hce});var Zu={};p.r(Zu),p.d(Zu,{base8:()=>Gce});var Hu={};p.r(Hu),p.d(Hu,{base10:()=>Wce});var Gu={};p.r(Gu),p.d(Gu,{base16:()=>Yce,base16upper:()=>Qce});var Wu={};p.r(Wu),p.d(Wu,{base32:()=>Jce,base32hex:()=>tle,base32hexpad:()=>nle,base32hexpadupper:()=>sle,base32hexupper:()=>rle,base32pad:()=>qce,base32padupper:()=>ele,base32upper:()=>Xce,base32z:()=>ile});var Yu={};p.r(Yu),p.d(Yu,{base36:()=>ole,base36upper:()=>ale});var Qu={};p.r(Qu),p.d(Qu,{base58btc:()=>xD,base58flickr:()=>cle});var Ju={};p.r(Ju),p.d(Ju,{base64:()=>D5,base64pad:()=>lle,base64url:()=>ule,base64urlpad:()=>dle});var Xu={};p.r(Xu),p.d(Xu,{base256emoji:()=>gle});var qu={};p.r(qu),p.d(qu,{sha256:()=>Ro,sha512:()=>kle});var ed={};p.r(ed),p.d(ed,{identity:()=>kD});var td={};p.r(td),p.d(td,{code:()=>Fle,decode:()=>Vle,encode:()=>zle,name:()=>Mle});var rd={};p.r(rd),p.d(rd,{code:()=>Zle,decode:()=>Gle,encode:()=>Hle,name:()=>Kle});var nd={};p.r(nd),p.d(nd,{RsaPrivateKey:()=>y1,RsaPublicKey:()=>r8,fromJwk:()=>Fue,generateKeyPair:()=>zue,unmarshalRsaPrivateKey:()=>Uue,unmarshalRsaPublicKey:()=>Mue});var sd={};p.r(sd),p.d(sd,{Ed25519PrivateKey:()=>Lf,Ed25519PublicKey:()=>x8,generateKeyPair:()=>fde,generateKeyPairFromSeed:()=>BO,unmarshalEd25519PrivateKey:()=>ude,unmarshalEd25519PublicKey:()=>dde});var id={};p.r(id),p.d(id,{Secp256k1PrivateKey:()=>R8,Secp256k1PublicKey:()=>I8,generateKeyPair:()=>wde,unmarshalSecp256k1PrivateKey:()=>mde,unmarshalSecp256k1PublicKey:()=>vde});var od={};p.r(od),p.d(od,{base32:()=>kde,base32hex:()=>Fde,base32hexpad:()=>Vde,base32hexpadupper:()=>jde,base32hexupper:()=>zde,base32pad:()=>Ude,base32padupper:()=>Mde,base32upper:()=>UO,base32z:()=>$de});var ad={};p.r(ad),p.d(ad,{identity:()=>Kde});var _o={};p.r(_o),p.d(_o,{base2:()=>Zde});var ll={};p.r(ll),p.d(ll,{base8:()=>Hde});var cd={};p.r(cd),p.d(cd,{base10:()=>Gde});var ld={};p.r(ld),p.d(ld,{base16:()=>Wde,base16upper:()=>Yde});var ud={};p.r(ud),p.d(ud,{base36:()=>Qde,base36upper:()=>Jde});var dd={};p.r(dd),p.d(dd,{base58btc:()=>Xde,base58flickr:()=>qde});var fd={};p.r(fd),p.d(fd,{base64:()=>efe,base64pad:()=>tfe,base64url:()=>rfe,base64urlpad:()=>nfe});var $i={};p.r($i),p.d($i,{base256emoji:()=>cfe});var hd={};p.r(hd),p.d(hd,{sha256:()=>Rfe,sha512:()=>Dfe});var pd={};p.r(pd),p.d(pd,{identity:()=>QO});var yd={};p.r(yd),p.d(yd,{code:()=>Nfe,decode:()=>Lfe,encode:()=>Bfe,name:()=>Pfe});var gd={};p.r(gd),p.d(gd,{code:()=>Ffe,decode:()=>Vfe,encode:()=>zfe,name:()=>Mfe});var bd={};p.r(bd),p.d(bd,{identity:()=>Zhe});var _d={};p.r(_d),p.d(_d,{base2:()=>Hhe});var md={};p.r(md),p.d(md,{base8:()=>Ghe});var vd={};p.r(vd),p.d(vd,{base10:()=>Whe});var wd={};p.r(wd),p.d(wd,{base16:()=>Yhe,base16upper:()=>Qhe});var xs={};p.r(xs),p.d(xs,{base32:()=>Jhe,base32hex:()=>t0e,base32hexpad:()=>n0e,base32hexpadupper:()=>s0e,base32hexupper:()=>r0e,base32pad:()=>qhe,base32padupper:()=>e0e,base32upper:()=>Xhe,base32z:()=>i0e});var Ed={};p.r(Ed),p.d(Ed,{base36:()=>o0e,base36upper:()=>a0e});var xd={};p.r(xd),p.d(xd,{base58btc:()=>c0e,base58flickr:()=>l0e});var Sd={};p.r(Sd),p.d(Sd,{base64:()=>u0e,base64pad:()=>d0e,base64url:()=>f0e,base64urlpad:()=>h0e});var Ad={};p.r(Ad),p.d(Ad,{base256emoji:()=>_0e});var ie={};p.r(ie),p.d(ie,{sha256:()=>M0e,sha512:()=>F0e});var le={};p.r(le),p.d(le,{identity:()=>V0e});var he={};p.r(he),p.d(he,{code:()=>$0e,decode:()=>Z0e,encode:()=>K0e,name:()=>j0e});var Se={};p.r(Se),p.d(Se,{code:()=>Y0e,decode:()=>J0e,encode:()=>Q0e,name:()=>W0e});var Ne={};p.r(Ne),p.d(Ne,{identity:()=>Qpe});var Le={};p.r(Le),p.d(Le,{base2:()=>Jpe});var Ge={};p.r(Ge),p.d(Ge,{base8:()=>Xpe});var Ze={};p.r(Ze),p.d(Ze,{base10:()=>qpe});var Vt={};p.r(Vt),p.d(Vt,{base16:()=>e1e,base16upper:()=>t1e});var Nr={};p.r(Nr),p.d(Nr,{base36:()=>r1e,base36upper:()=>n1e});var Xn={};p.r(Xn),p.d(Xn,{base64:()=>s1e,base64pad:()=>i1e,base64url:()=>o1e,base64urlpad:()=>a1e});var pn={};p.r(pn),p.d(pn,{base256emoji:()=>f1e});var js={};p.r(js),p.d(js,{sha256:()=>p1e,sha512:()=>y1e});var ua={};p.r(ua),p.d(ua,{identity:()=>b1e});var Ss={};p.r(Ss),p.d(Ss,{code:()=>m1e,decode:()=>w1e,encode:()=>v1e,name:()=>_1e});var As={};p.r(As),p.d(As,{code:()=>A1e,decode:()=>C1e,encode:()=>T1e,name:()=>S1e});var da={};p.r(da),p.d(da,{sha256:()=>K1,sha512:()=>iye});var ri={};p.r(ri),p.d(ri,{base58btc:()=>No,base58flickr:()=>n2e});var pc={};p.r(pc),p.d(pc,{base32:()=>Xf,base32hex:()=>a2e,base32hexpad:()=>l2e,base32hexpadupper:()=>u2e,base32hexupper:()=>c2e,base32pad:()=>i2e,base32padupper:()=>o2e,base32upper:()=>s2e,base32z:()=>d2e});var j0={};p.r(j0),p.d(j0,{code:()=>j4,decode:()=>w2e,encode:()=>v2e,name:()=>m2e});var rb={};p.r(rb),p.d(rb,{identity:()=>$2e});var nb={};p.r(nb),p.d(nb,{base2:()=>K2e});var sb={};p.r(sb),p.d(sb,{base8:()=>Z2e});var ib={};p.r(ib),p.d(ib,{base10:()=>H2e});var ob={};p.r(ob),p.d(ob,{base16:()=>G2e,base16upper:()=>W2e});var ab={};p.r(ab),p.d(ab,{base36:()=>Y2e,base36upper:()=>Q2e});var cb={};p.r(cb),p.d(cb,{base64:()=>J2e,base64pad:()=>X2e,base64url:()=>q2e,base64urlpad:()=>ege});var lb={};p.r(lb),p.d(lb,{base256emoji:()=>ige});var ub={};p.r(ub),p.d(ub,{identity:()=>age});var db={};p.r(db),p.d(db,{code:()=>dge,decode:()=>hge,encode:()=>fge,name:()=>uge});var fb={};p.r(fb),p.d(fb,{identity:()=>zge});var hb={};p.r(hb),p.d(hb,{base2:()=>Vge});var pb={};p.r(pb),p.d(pb,{base8:()=>jge});var yb={};p.r(yb),p.d(yb,{base10:()=>$ge});var gb={};p.r(gb),p.d(gb,{base16:()=>Kge,base16upper:()=>Zge});var bb={};p.r(bb),p.d(bb,{base32:()=>Hge,base32hex:()=>Qge,base32hexpad:()=>Xge,base32hexpadupper:()=>qge,base32hexupper:()=>Jge,base32pad:()=>Wge,base32padupper:()=>Yge,base32upper:()=>Gge,base32z:()=>ebe});var _b={};p.r(_b),p.d(_b,{base36:()=>tbe,base36upper:()=>rbe});var mb={};p.r(mb),p.d(mb,{base58btc:()=>nbe,base58flickr:()=>sbe});var vb={};p.r(vb),p.d(vb,{base64:()=>ibe,base64pad:()=>obe,base64url:()=>abe,base64urlpad:()=>cbe});var wb={};p.r(wb),p.d(wb,{base256emoji:()=>hbe});var Eb={};p.r(Eb),p.d(Eb,{sha256:()=>Nbe,sha512:()=>Bbe});var xb={};p.r(xb),p.d(xb,{identity:()=>kbe});var Sb={};p.r(Sb),p.d(Sb,{code:()=>Mbe,decode:()=>zbe,encode:()=>Fbe,name:()=>Ube});var Ab={};p.r(Ab),p.d(Ab,{code:()=>Kbe,decode:()=>Hbe,encode:()=>Zbe,name:()=>$be});var Tb={};p.r(Tb),p.d(Tb,{identity:()=>Hme});var Cb={};p.r(Cb),p.d(Cb,{base2:()=>Gme});var Ib={};p.r(Ib),p.d(Ib,{base8:()=>Wme});var Rb={};p.r(Rb),p.d(Rb,{base10:()=>Yme});var Db={};p.r(Db),p.d(Db,{base16:()=>Qme,base16upper:()=>Jme});var Ob={};p.r(Ob),p.d(Ob,{base32:()=>Xme,base32hex:()=>rve,base32hexpad:()=>sve,base32hexpadupper:()=>ive,base32hexupper:()=>nve,base32pad:()=>eve,base32padupper:()=>tve,base32upper:()=>qme,base32z:()=>ove});var Pb={};p.r(Pb),p.d(Pb,{base36:()=>ave,base36upper:()=>cve});var Nb={};p.r(Nb),p.d(Nb,{base58btc:()=>lve,base58flickr:()=>uve});var Bb={};p.r(Bb),p.d(Bb,{base64:()=>dve,base64pad:()=>fve,base64url:()=>hve,base64urlpad:()=>pve});var Lb={};p.r(Lb),p.d(Lb,{base256emoji:()=>mve});var kb={};p.r(kb),p.d(kb,{sha256:()=>ZB,sha512:()=>Fve});var Ub={};p.r(Ub),p.d(Ub,{identity:()=>Vve});var Mb={};p.r(Mb),p.d(Mb,{code:()=>$ve,decode:()=>Zve,encode:()=>Kve,name:()=>jve});var Fb={};p.r(Fb),p.d(Fb,{code:()=>Yve,decode:()=>Jve,encode:()=>Qve,name:()=>Wve});var zb={};p.r(zb),p.d(zb,{base58btc:()=>zo,base58flickr:()=>L7e});var Vb={};p.r(Vb),p.d(Vb,{base32:()=>Bi,base32hex:()=>F7e,base32hexpad:()=>V7e,base32hexpadupper:()=>j7e,base32hexupper:()=>z7e,base32pad:()=>U7e,base32padupper:()=>M7e,base32upper:()=>k7e,base32z:()=>$7e});var jb={};p.r(jb),p.d(jb,{code:()=>zU,decode:()=>X7e,encode:()=>J7e,name:()=>Q7e});var $b={};p.r($b),p.d($b,{identity:()=>c9e});var Kb={};p.r(Kb),p.d(Kb,{base2:()=>l9e});var Zb={};p.r(Zb),p.d(Zb,{base8:()=>u9e});var Hb={};p.r(Hb),p.d(Hb,{base10:()=>d9e});var Gb={};p.r(Gb),p.d(Gb,{base16:()=>f9e,base16upper:()=>h9e});var Wb={};p.r(Wb),p.d(Wb,{base36:()=>p9e,base36upper:()=>y9e});var Yb={};p.r(Yb),p.d(Yb,{base64:()=>g9e,base64pad:()=>b9e,base64url:()=>_9e,base64urlpad:()=>m9e});var Qb={};p.r(Qb),p.d(Qb,{base256emoji:()=>S9e});var Jb={};p.r(Jb),p.d(Jb,{sha256:()=>Jy,sha512:()=>T9e});var Xb={};p.r(Xb),p.d(Xb,{identity:()=>I9e});var qb={};p.r(qb),p.d(qb,{code:()=>P9e,decode:()=>B9e,encode:()=>N9e,name:()=>O9e});var e_={};p.r(e_),p.d(e_,{InvalidValueError:()=>oxe,MissingRepoOptionsError:()=>V7,NonReversibleMigrationError:()=>sxe,NotInitializedRepoError:()=>yM,RequiredParameterError:()=>ixe});var t_={};p.r(t_),p.d(t_,{identity:()=>Txe});var r_={};p.r(r_),p.d(r_,{base2:()=>Cxe});var n_={};p.r(n_),p.d(n_,{base8:()=>Ixe});var s_={};p.r(s_),p.d(s_,{base10:()=>Rxe});var i_={};p.r(i_),p.d(i_,{base16:()=>Dxe,base16upper:()=>Oxe});var o_={};p.r(o_),p.d(o_,{base32:()=>Vo,base32hex:()=>Lxe,base32hexpad:()=>Uxe,base32hexpadupper:()=>Mxe,base32hexupper:()=>kxe,base32pad:()=>Nxe,base32padupper:()=>Bxe,base32upper:()=>Pxe,base32z:()=>Fxe});var a_={};p.r(a_),p.d(a_,{base36:()=>zxe,base36upper:()=>Vxe});var c_={};p.r(c_),p.d(c_,{base58btc:()=>jo,base58flickr:()=>jxe});var l_={};p.r(l_),p.d(l_,{base64:()=>$xe,base64pad:()=>Kxe,base64url:()=>Zxe,base64urlpad:()=>Hxe});var u_={};p.r(u_),p.d(u_,{base256emoji:()=>Jxe});var d_={};p.r(d_),p.d(d_,{sha256:()=>_Se,sha512:()=>mSe});var f_={};p.r(f_),p.d(f_,{identity:()=>CM});var h_={};p.r(h_),p.d(h_,{code:()=>ESe,decode:()=>SSe,encode:()=>xSe,name:()=>wSe});var p_={};p.r(p_),p.d(p_,{code:()=>ISe,decode:()=>DSe,encode:()=>RSe,name:()=>CSe});var y_={};p.r(y_),p.d(y_,{identity:()=>ITe});var g_={};p.r(g_),p.d(g_,{base2:()=>RTe});var b_={};p.r(b_),p.d(b_,{base8:()=>DTe});var __={};p.r(__),p.d(__,{base10:()=>OTe});var m_={};p.r(m_),p.d(m_,{base16:()=>PTe,base16upper:()=>NTe});var v_={};p.r(v_),p.d(v_,{base32:()=>BTe,base32hex:()=>MTe,base32hexpad:()=>zTe,base32hexpadupper:()=>VTe,base32hexupper:()=>FTe,base32pad:()=>kTe,base32padupper:()=>UTe,base32upper:()=>LTe,base32z:()=>jTe});var w_={};p.r(w_),p.d(w_,{base36:()=>$Te,base36upper:()=>KTe});var E_={};p.r(E_),p.d(E_,{base58btc:()=>ZTe,base58flickr:()=>HTe});var x_={};p.r(x_),p.d(x_,{base64:()=>GTe,base64pad:()=>WTe,base64url:()=>YTe,base64urlpad:()=>QTe});var S_={};p.r(S_),p.d(S_,{base256emoji:()=>tCe});var A_={};p.r(A_),p.d(A_,{sha256:()=>wCe,sha512:()=>ECe});var T_={};p.r(T_),p.d(T_,{identity:()=>SCe});var C_={};p.r(C_),p.d(C_,{code:()=>TCe,decode:()=>ICe,encode:()=>CCe,name:()=>ACe});var I_={};p.r(I_),p.d(I_,{code:()=>PCe,decode:()=>BCe,encode:()=>NCe,name:()=>OCe});var R_={};p.r(R_),p.d(R_,{identity:()=>ux});var D_={};p.r(D_),p.d(D_,{identity:()=>eOe});var O_={};p.r(O_),p.d(O_,{base2:()=>tOe});var P_={};p.r(P_),p.d(P_,{base8:()=>rOe});var N_={};p.r(N_),p.d(N_,{base10:()=>nOe});var B_={};p.r(B_),p.d(B_,{base16:()=>sOe,base16upper:()=>iOe});var L_={};p.r(L_),p.d(L_,{base32:()=>Hh,base32hex:()=>lOe,base32hexpad:()=>dOe,base32hexpadupper:()=>fOe,base32hexupper:()=>uOe,base32pad:()=>aOe,base32padupper:()=>cOe,base32upper:()=>oOe,base32z:()=>hOe});var k_={};p.r(k_),p.d(k_,{base36:()=>pOe,base36upper:()=>yOe});var U_={};p.r(U_),p.d(U_,{base58btc:()=>Qo,base58flickr:()=>gOe});var M_={};p.r(M_),p.d(M_,{base64:()=>bOe,base64pad:()=>_Oe,base64url:()=>L2,base64urlpad:()=>mOe});var F_={};p.r(F_),p.d(F_,{base256emoji:()=>SOe});var z_={};p.r(z_),p.d(z_,{sha256:()=>TOe,sha512:()=>COe});var V_={};p.r(V_),p.d(V_,{code:()=>ROe,decode:()=>OOe,encode:()=>DOe,name:()=>IOe});var j_={};p.r(j_),p.d(j_,{code:()=>LOe,decode:()=>UOe,encode:()=>kOe,name:()=>BOe});var $_={};p.r($_),p.d($_,{Decoder:()=>Rx,Encoder:()=>zLe,PacketType:()=>Rt,protocol:()=>FLe});var K_={};p.r(K_),p.d(K_,{identity:()=>rke});var Z_={};p.r(Z_),p.d(Z_,{base2:()=>nke});var H_={};p.r(H_),p.d(H_,{base8:()=>ske});var G_={};p.r(G_),p.d(G_,{base10:()=>ike});var W_={};p.r(W_),p.d(W_,{base16:()=>oke,base16upper:()=>ake});var Y_={};p.r(Y_),p.d(Y_,{base32:()=>cke,base32hex:()=>fke,base32hexpad:()=>pke,base32hexpadupper:()=>yke,base32hexupper:()=>hke,base32pad:()=>uke,base32padupper:()=>dke,base32upper:()=>lke,base32z:()=>gke});var Q_={};p.r(Q_),p.d(Q_,{base36:()=>bke,base36upper:()=>_ke});var J_={};p.r(J_),p.d(J_,{base58btc:()=>mke,base58flickr:()=>vke});var X_={};p.r(X_),p.d(X_,{base64:()=>wke,base64pad:()=>Eke,base64url:()=>xke,base64urlpad:()=>Ske});var q_={};p.r(q_),p.d(q_,{base256emoji:()=>Rke});var em={};p.r(em),p.d(em,{sha256:()=>Yke,sha512:()=>Qke});var tm={};p.r(tm),p.d(tm,{identity:()=>Xke});var rm={};p.r(rm),p.d(rm,{code:()=>eUe,decode:()=>rUe,encode:()=>tUe,name:()=>qke});var nm={};p.r(nm),p.d(nm,{code:()=>oUe,decode:()=>cUe,encode:()=>aUe,name:()=>iUe});var sm={};p.r(sm),p.d(sm,{identity:()=>QUe});var im={};p.r(im),p.d(im,{base2:()=>JUe});var om={};p.r(om),p.d(om,{base8:()=>XUe});var am={};p.r(am),p.d(am,{base10:()=>qUe});var cm={};p.r(cm),p.d(cm,{base16:()=>eMe,base16upper:()=>tMe});var lm={};p.r(lm),p.d(lm,{base32:()=>rMe,base32hex:()=>oMe,base32hexpad:()=>cMe,base32hexpadupper:()=>lMe,base32hexupper:()=>aMe,base32pad:()=>sMe,base32padupper:()=>iMe,base32upper:()=>nMe,base32z:()=>uMe});var um={};p.r(um),p.d(um,{base36:()=>dMe,base36upper:()=>fMe});var dm={};p.r(dm),p.d(dm,{base58btc:()=>hMe,base58flickr:()=>pMe});var fm={};p.r(fm),p.d(fm,{base64:()=>yMe,base64pad:()=>gMe,base64url:()=>bMe,base64urlpad:()=>_Me});var hm={};p.r(hm),p.d(hm,{base256emoji:()=>xMe});var pm={};p.r(pm),p.d(pm,{sha256:()=>$Me,sha512:()=>KMe});var ym={};p.r(ym),p.d(ym,{identity:()=>HMe});var gm={};p.r(gm),p.d(gm,{code:()=>WMe,decode:()=>QMe,encode:()=>YMe,name:()=>GMe});var bm={};p.r(bm),p.d(bm,{code:()=>eFe,decode:()=>rFe,encode:()=>tFe,name:()=>qMe});var _m={};p.r(_m),p.d(_m,{identity:()=>nze});var mm={};p.r(mm),p.d(mm,{base2:()=>sze});var vm={};p.r(vm),p.d(vm,{base8:()=>ize});var wm={};p.r(wm),p.d(wm,{base10:()=>oze});var Em={};p.r(Em),p.d(Em,{base16:()=>aze,base16upper:()=>cze});var xm={};p.r(xm),p.d(xm,{base32:()=>o0,base32hex:()=>fze,base32hexpad:()=>pze,base32hexpadupper:()=>yze,base32hexupper:()=>hze,base32pad:()=>uze,base32padupper:()=>dze,base32upper:()=>lze,base32z:()=>gze});var Sm={};p.r(Sm),p.d(Sm,{base36:()=>bze,base36upper:()=>_ze});var Am={};p.r(Am),p.d(Am,{base58btc:()=>Xo,base58flickr:()=>mze});var Tm={};p.r(Tm),p.d(Tm,{base64:()=>vze,base64pad:()=>wze,base64url:()=>Eze,base64urlpad:()=>xze});var Cm={};p.r(Cm),p.d(Cm,{base256emoji:()=>Ize});var Im={};p.r(Im),p.d(Im,{sha256:()=>fj,sha512:()=>Qze});var Rm={};p.r(Rm),p.d(Rm,{identity:()=>Xze});var Dm={};p.r(Dm),p.d(Dm,{code:()=>eVe,decode:()=>rVe,encode:()=>tVe,name:()=>qze});var Om={};p.r(Om),p.d(Om,{code:()=>oVe,decode:()=>cVe,encode:()=>aVe,name:()=>iVe});var Pm={};p.r(Pm),p.d(Pm,{identity:()=>sje});var Nm={};p.r(Nm),p.d(Nm,{base2:()=>ije});var Bm={};p.r(Bm),p.d(Bm,{base8:()=>oje});var Lm={};p.r(Lm),p.d(Lm,{base10:()=>aje});var km={};p.r(km),p.d(km,{base16:()=>cje,base16upper:()=>lje});var Um={};p.r(Um),p.d(Um,{base32:()=>uje,base32hex:()=>pje,base32hexpad:()=>gje,base32hexpadupper:()=>bje,base32hexupper:()=>yje,base32pad:()=>fje,base32padupper:()=>hje,base32upper:()=>dje,base32z:()=>_je});var Mm={};p.r(Mm),p.d(Mm,{base36:()=>mje,base36upper:()=>vje});var Fm={};p.r(Fm),p.d(Fm,{base58btc:()=>wje,base58flickr:()=>Eje});var zm={};p.r(zm),p.d(zm,{base64:()=>xje,base64pad:()=>Sje,base64url:()=>Aje,base64urlpad:()=>Tje});var Vm={};p.r(Vm),p.d(Vm,{base256emoji:()=>Oje});var jm={};p.r(jm),p.d(jm,{sha256:()=>Jje,sha512:()=>Xje});var $m={};p.r($m),p.d($m,{identity:()=>e$e});var Km={};p.r(Km),p.d(Km,{code:()=>r$e,decode:()=>s$e,encode:()=>n$e,name:()=>t$e});var Zm={};p.r(Zm),p.d(Zm,{code:()=>c$e,decode:()=>u$e,encode:()=>l$e,name:()=>a$e});var Hm={};p.r(Hm),p.d(Hm,{identity:()=>GKe});var Gm={};p.r(Gm),p.d(Gm,{base2:()=>WKe});var Wm={};p.r(Wm),p.d(Wm,{base8:()=>YKe});var Ym={};p.r(Ym),p.d(Ym,{base10:()=>QKe});var Qm={};p.r(Qm),p.d(Qm,{base16:()=>JKe,base16upper:()=>XKe});var Jm={};p.r(Jm),p.d(Jm,{base32:()=>qKe,base32hex:()=>nZe,base32hexpad:()=>iZe,base32hexpadupper:()=>oZe,base32hexupper:()=>sZe,base32pad:()=>tZe,base32padupper:()=>rZe,base32upper:()=>eZe,base32z:()=>aZe});var Xm={};p.r(Xm),p.d(Xm,{base36:()=>cZe,base36upper:()=>lZe});var qm={};p.r(qm),p.d(qm,{base58btc:()=>uZe,base58flickr:()=>dZe});var ev={};p.r(ev),p.d(ev,{base64:()=>fZe,base64pad:()=>hZe,base64url:()=>pZe,base64urlpad:()=>yZe});var tv={};p.r(tv),p.d(tv,{base256emoji:()=>vZe});var rv={};p.r(rv),p.d(rv,{sha256:()=>zZe,sha512:()=>VZe});var nv={};p.r(nv),p.d(nv,{identity:()=>$Ze});var sv={};p.r(sv),p.d(sv,{code:()=>ZZe,decode:()=>GZe,encode:()=>HZe,name:()=>KZe});var iv={};p.r(iv),p.d(iv,{code:()=>JZe,decode:()=>qZe,encode:()=>XZe,name:()=>QZe});var ov={};p.r(ov),p.d(ov,{sha256:()=>nA,sha512:()=>GHe});var av={};p.r(av),p.d(av,{identity:()=>sGe});var cv={};p.r(cv),p.d(cv,{base2:()=>iGe});var lv={};p.r(lv),p.d(lv,{base8:()=>oGe});var uv={};p.r(uv),p.d(uv,{base10:()=>aGe});var dv={};p.r(dv),p.d(dv,{base16:()=>cGe,base16upper:()=>lGe});var fv={};p.r(fv),p.d(fv,{base32:()=>_0,base32hex:()=>hGe,base32hexpad:()=>yGe,base32hexpadupper:()=>gGe,base32hexupper:()=>pGe,base32pad:()=>dGe,base32padupper:()=>fGe,base32upper:()=>uGe,base32z:()=>bGe});var hv={};p.r(hv),p.d(hv,{base36:()=>_Ge,base36upper:()=>mGe});var pv={};p.r(pv),p.d(pv,{base58btc:()=>ia,base58flickr:()=>vGe});var yv={};p.r(yv),p.d(yv,{base64:()=>wGe,base64pad:()=>EGe,base64url:()=>xGe,base64urlpad:()=>SGe});var gv={};p.r(gv),p.d(gv,{base256emoji:()=>RGe});var bv={};p.r(bv),p.d(bv,{identity:()=>OGe});var _v={};p.r(_v),p.d(_v,{code:()=>NGe,decode:()=>LGe,encode:()=>BGe,name:()=>PGe});var mv={};p.r(mv),p.d(mv,{code:()=>FGe,decode:()=>VGe,encode:()=>zGe,name:()=>MGe});var vv={};p.r(vv),p.d(vv,{identity:()=>FWe});var wv={};p.r(wv),p.d(wv,{base2:()=>zWe});var Ev={};p.r(Ev),p.d(Ev,{base8:()=>VWe});var xv={};p.r(xv),p.d(xv,{base10:()=>jWe});var Sv={};p.r(Sv),p.d(Sv,{base16:()=>$We,base16upper:()=>KWe});var Av={};p.r(Av),p.d(Av,{base32:()=>ZWe,base32hex:()=>YWe,base32hexpad:()=>JWe,base32hexpadupper:()=>XWe,base32hexupper:()=>QWe,base32pad:()=>GWe,base32padupper:()=>WWe,base32upper:()=>HWe,base32z:()=>qWe});var Tv={};p.r(Tv),p.d(Tv,{base36:()=>eYe,base36upper:()=>tYe});var Cv={};p.r(Cv),p.d(Cv,{base58btc:()=>rYe,base58flickr:()=>nYe});var Iv={};p.r(Iv),p.d(Iv,{base64:()=>sYe,base64pad:()=>iYe,base64url:()=>oYe,base64urlpad:()=>aYe});var Rv={};p.r(Rv),p.d(Rv,{base256emoji:()=>fYe});var Dv={};p.r(Dv),p.d(Dv,{sha256:()=>IK,sha512:()=>PYe});var Ov={};p.r(Ov),p.d(Ov,{identity:()=>BYe});var Pv={};p.r(Pv),p.d(Pv,{code:()=>kYe,decode:()=>MYe,encode:()=>UYe,name:()=>LYe});var Nv={};p.r(Nv),p.d(Nv,{code:()=>jYe,decode:()=>KYe,encode:()=>$Ye,name:()=>VYe});var Bv={};p.r(Bv),p.d(Bv,{identity:()=>qQe});var Lv={};p.r(Lv),p.d(Lv,{base2:()=>eJe});var kv={};p.r(kv),p.d(kv,{base8:()=>tJe});var Uv={};p.r(Uv),p.d(Uv,{base10:()=>rJe});var Mv={};p.r(Mv),p.d(Mv,{base16:()=>nJe,base16upper:()=>sJe});var Fv={};p.r(Fv),p.d(Fv,{base32:()=>iJe,base32hex:()=>lJe,base32hexpad:()=>dJe,base32hexpadupper:()=>fJe,base32hexupper:()=>uJe,base32pad:()=>aJe,base32padupper:()=>cJe,base32upper:()=>oJe,base32z:()=>hJe});var zv={};p.r(zv),p.d(zv,{base36:()=>pJe,base36upper:()=>yJe});var Vv={};p.r(Vv),p.d(Vv,{base58btc:()=>gJe,base58flickr:()=>bJe});var jv={};p.r(jv),p.d(jv,{base64:()=>_Je,base64pad:()=>mJe,base64url:()=>vJe,base64urlpad:()=>wJe});var $v={};p.r($v),p.d($v,{base256emoji:()=>TJe});var Kv={};p.r(Kv),p.d(Kv,{sha256:()=>HJe,sha512:()=>GJe});var Zv={};p.r(Zv),p.d(Zv,{identity:()=>YJe});var Hv={};p.r(Hv),p.d(Hv,{code:()=>JJe,decode:()=>qJe,encode:()=>XJe,name:()=>QJe});var Gv={};p.r(Gv),p.d(Gv,{code:()=>nXe,decode:()=>iXe,encode:()=>sXe,name:()=>rXe});var Wv={};p.r(Wv),p.d(Wv,{identity:()=>XXe});var Yv={};p.r(Yv),p.d(Yv,{base2:()=>qXe});var Qv={};p.r(Qv),p.d(Qv,{base8:()=>eqe});var Jv={};p.r(Jv),p.d(Jv,{base10:()=>tqe});var Xv={};p.r(Xv),p.d(Xv,{base16:()=>rqe,base16upper:()=>nqe});var qv={};p.r(qv),p.d(qv,{base32:()=>sqe,base32hex:()=>cqe,base32hexpad:()=>uqe,base32hexpadupper:()=>dqe,base32hexupper:()=>lqe,base32pad:()=>oqe,base32padupper:()=>aqe,base32upper:()=>iqe,base32z:()=>fqe});var e3={};p.r(e3),p.d(e3,{base36:()=>hqe,base36upper:()=>pqe});var t3={};p.r(t3),p.d(t3,{base58btc:()=>yqe,base58flickr:()=>gqe});var r3={};p.r(r3),p.d(r3,{base64:()=>bqe,base64pad:()=>_qe,base64url:()=>mqe,base64urlpad:()=>vqe});var n3={};p.r(n3),p.d(n3,{base256emoji:()=>Aqe});var s3={};p.r(s3),p.d(s3,{sha256:()=>Zqe,sha512:()=>Hqe});var i3={};p.r(i3),p.d(i3,{identity:()=>Wqe});var o3={};p.r(o3),p.d(o3,{code:()=>Qqe,decode:()=>Xqe,encode:()=>Jqe,name:()=>Yqe});var a3={};p.r(a3),p.d(a3,{code:()=>ret,decode:()=>set,encode:()=>net,name:()=>tet});var c3={};p.r(c3),p.d(c3,{identity:()=>Xet});var l3={};p.r(l3),p.d(l3,{base2:()=>qet});var u3={};p.r(u3),p.d(u3,{base8:()=>ett});var d3={};p.r(d3),p.d(d3,{base10:()=>ttt});var f3={};p.r(f3),p.d(f3,{base16:()=>rtt,base16upper:()=>ntt});var h3={};p.r(h3),p.d(h3,{base32:()=>stt,base32hex:()=>ctt,base32hexpad:()=>utt,base32hexpadupper:()=>dtt,base32hexupper:()=>ltt,base32pad:()=>ott,base32padupper:()=>att,base32upper:()=>itt,base32z:()=>ftt});var p3={};p.r(p3),p.d(p3,{base36:()=>htt,base36upper:()=>ptt});var y3={};p.r(y3),p.d(y3,{base58btc:()=>ytt,base58flickr:()=>gtt});var g3={};p.r(g3),p.d(g3,{base64:()=>btt,base64pad:()=>_tt,base64url:()=>mtt,base64urlpad:()=>vtt});var b3={};p.r(b3),p.d(b3,{base256emoji:()=>Att});var _3={};p.r(_3),p.d(_3,{sha256:()=>Ztt,sha512:()=>Htt});var m3={};p.r(m3),p.d(m3,{identity:()=>Wtt});var v3={};p.r(v3),p.d(v3,{code:()=>Qtt,decode:()=>Xtt,encode:()=>Jtt,name:()=>Ytt});var w3={};p.r(w3),p.d(w3,{code:()=>rrt,decode:()=>srt,encode:()=>nrt,name:()=>trt});var E3={};p.r(E3),p.d(E3,{base58btc:()=>fr,base58flickr:()=>gnt});var x3={};p.r(x3),p.d(x3,{base32:()=>k0,base32hex:()=>vnt,base32hexpad:()=>Ent,base32hexpadupper:()=>xnt,base32hexupper:()=>wnt,base32pad:()=>_nt,base32padupper:()=>mnt,base32upper:()=>bnt,base32z:()=>Snt});var S3={};p.r(S3),p.d(S3,{sha256:()=>Xg,sha512:()=>Pnt});var A3={};p.r(A3),p.d(A3,{identity:()=>ost});var T3={};p.r(T3),p.d(T3,{base2:()=>ast});var C3={};p.r(C3),p.d(C3,{base8:()=>cst});var I3={};p.r(I3),p.d(I3,{base10:()=>lst});var R3={};p.r(R3),p.d(R3,{base16:()=>ust,base16upper:()=>dst});var D3={};p.r(D3),p.d(D3,{base36:()=>fst,base36upper:()=>hst});var O3={};p.r(O3),p.d(O3,{base64:()=>pst,base64pad:()=>yst,base64url:()=>gst,base64urlpad:()=>bst});var P3={};p.r(P3),p.d(P3,{base256emoji:()=>Est});var N3={};p.r(N3),p.d(N3,{identity:()=>Sst});var B3={};p.r(B3),p.d(B3,{code:()=>Tst,decode:()=>Ist,encode:()=>Cst,name:()=>Ast});var L3={};p.r(L3),p.d(L3,{code:()=>Pst,decode:()=>Bst,encode:()=>Nst,name:()=>Ost});var k3={};p.r(k3),p.d(k3,{abortedError:()=>Zst,notFoundError:()=>Kst});var U3={};p.r(U3),p.d(U3,{create:()=>Hit,globSource:()=>Git,urlSource:()=>Wit});var B=p(71670);function mT(r){this.wrapped=r}function Td(r){var e,t;function s(o,a){try{var c=r[o](a),u=c.value,f=u instanceof mT;Promise.resolve(f?u.wrapped:u).then(function(E){f?s("return"===o?"return":"next",E):i(c.done?"return":"normal",E)},function(E){s("throw",E)})}catch(E){i("throw",E)}}function i(o,a){switch(o){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?s(e.key,e.arg):t=null}this._invoke=function n(o,a){return new Promise(function(c,u){var f={key:o,arg:a,resolve:c,reject:u,next:null};t?t=t.next=f:(e=t=f,s(o,a))})},"function"!=typeof r.return&&(this.return=void 0)}function Ee(r){return function(){return new Td(r.apply(this,arguments))}}Td.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Td.prototype.next=function(r){return this._invoke("next",r)},Td.prototype.throw=function(r){return this._invoke("throw",r)},Td.prototype.return=function(r){return this._invoke("return",r)};const Sr=p(30954);var fa=p(67318),Br=p(33570);const uG=function aG(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};new Uint8Array(0);class hG{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class pG{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return vT(this,e)}}class yG{constructor(e){this.decoders=e}or(e){return vT(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const vT=(r,e)=>new yG({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class gG{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new hG(e,t,n),this.decoder=new pG(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const wT=({name:r,prefix:e,encode:t,decode:n})=>new gG(r,e,t,n),ET=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=uG(t,e);return wT({prefix:r,name:e,encode:n,decode:i=>(r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")})(s(i))})},$s=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>wT({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),mG=ET({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),vG=(ET({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),$s({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),wG=($s({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),$s({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),$s({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),$s({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$s({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$s({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$s({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$s({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),$s({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}));function Be(r){return Object.assign(Br(r),{error:Br(`${r}:error`),trace:Br(`${r}:trace`)})}$s({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),$s({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),$s({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Br.formatters.b=r=>null==r?"undefined":mG.baseEncode(r),Br.formatters.t=r=>null==r?"undefined":vG.baseEncode(r),Br.formatters.m=r=>null==r?"undefined":wG.baseEncode(r),Br.formatters.p=r=>null==r?"undefined":r.toString(),Br.formatters.c=r=>null==r?"undefined":r.toString(),Br.formatters.k=r=>null==r?"undefined":r.toString();var ee=p(46436),ha=p(72158);const ul=ha.Reader,M3=ha.Writer,lt=ha.util,yn=ha.roots["ipfs-unixfs"]||(ha.roots["ipfs-unixfs"]={}),EG=yn.Data=(()=>{function r(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.Type=0,r.prototype.Data=lt.newBuffer([]),r.prototype.filesize=lt.Long?lt.Long.fromBits(0,0,!0):0,r.prototype.blocksizes=lt.emptyArray,r.prototype.hashType=lt.Long?lt.Long.fromBits(0,0,!0):0,r.prototype.fanout=lt.Long?lt.Long.fromBits(0,0,!0):0,r.prototype.mode=0,r.prototype.mtime=null,r.encode=function(t,n){if(n||(n=M3.create()),n.uint32(8).int32(t.Type),null!=t.Data&&Object.hasOwnProperty.call(t,"Data")&&n.uint32(18).bytes(t.Data),null!=t.filesize&&Object.hasOwnProperty.call(t,"filesize")&&n.uint32(24).uint64(t.filesize),null!=t.blocksizes&&t.blocksizes.length)for(var s=0;s<t.blocksizes.length;++s)n.uint32(32).uint64(t.blocksizes[s]);return null!=t.hashType&&Object.hasOwnProperty.call(t,"hashType")&&n.uint32(40).uint64(t.hashType),null!=t.fanout&&Object.hasOwnProperty.call(t,"fanout")&&n.uint32(48).uint64(t.fanout),null!=t.mode&&Object.hasOwnProperty.call(t,"mode")&&n.uint32(56).uint32(t.mode),null!=t.mtime&&Object.hasOwnProperty.call(t,"mtime")&&yn.UnixTime.encode(t.mtime,n.uint32(66).fork()).ldelim(),n},r.decode=function(t,n){t instanceof ul||(t=ul.create(t));for(var s=void 0===n?t.len:t.pos+n,i=new yn.Data;t.pos<s;){var o=t.uint32();switch(o>>>3){case 1:i.Type=t.int32();break;case 2:i.Data=t.bytes();break;case 3:i.filesize=t.uint64();break;case 4:if(i.blocksizes&&i.blocksizes.length||(i.blocksizes=[]),2==(7&o))for(var a=t.uint32()+t.pos;t.pos<a;)i.blocksizes.push(t.uint64());else i.blocksizes.push(t.uint64());break;case 5:i.hashType=t.uint64();break;case 6:i.fanout=t.uint64();break;case 7:i.mode=t.uint32();break;case 8:i.mtime=yn.UnixTime.decode(t,t.uint32());break;default:t.skipType(7&o)}}if(!i.hasOwnProperty("Type"))throw lt.ProtocolError("missing required 'Type'",{instance:i});return i},r.fromObject=function(t){if(t instanceof yn.Data)return t;var n=new yn.Data;switch(t.Type){case"Raw":case 0:n.Type=0;break;case"Directory":case 1:n.Type=1;break;case"File":case 2:n.Type=2;break;case"Metadata":case 3:n.Type=3;break;case"Symlink":case 4:n.Type=4;break;case"HAMTShard":case 5:n.Type=5}if(null!=t.Data&&("string"==typeof t.Data?lt.base64.decode(t.Data,n.Data=lt.newBuffer(lt.base64.length(t.Data)),0):t.Data.length&&(n.Data=t.Data)),null!=t.filesize&&(lt.Long?(n.filesize=lt.Long.fromValue(t.filesize)).unsigned=!0:"string"==typeof t.filesize?n.filesize=parseInt(t.filesize,10):"number"==typeof t.filesize?n.filesize=t.filesize:"object"==typeof t.filesize&&(n.filesize=new lt.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0))),t.blocksizes){if(!Array.isArray(t.blocksizes))throw TypeError(".Data.blocksizes: array expected");n.blocksizes=[];for(var s=0;s<t.blocksizes.length;++s)lt.Long?(n.blocksizes[s]=lt.Long.fromValue(t.blocksizes[s])).unsigned=!0:"string"==typeof t.blocksizes[s]?n.blocksizes[s]=parseInt(t.blocksizes[s],10):"number"==typeof t.blocksizes[s]?n.blocksizes[s]=t.blocksizes[s]:"object"==typeof t.blocksizes[s]&&(n.blocksizes[s]=new lt.LongBits(t.blocksizes[s].low>>>0,t.blocksizes[s].high>>>0).toNumber(!0))}if(null!=t.hashType&&(lt.Long?(n.hashType=lt.Long.fromValue(t.hashType)).unsigned=!0:"string"==typeof t.hashType?n.hashType=parseInt(t.hashType,10):"number"==typeof t.hashType?n.hashType=t.hashType:"object"==typeof t.hashType&&(n.hashType=new lt.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0))),null!=t.fanout&&(lt.Long?(n.fanout=lt.Long.fromValue(t.fanout)).unsigned=!0:"string"==typeof t.fanout?n.fanout=parseInt(t.fanout,10):"number"==typeof t.fanout?n.fanout=t.fanout:"object"==typeof t.fanout&&(n.fanout=new lt.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0))),null!=t.mode&&(n.mode=t.mode>>>0),null!=t.mtime){if("object"!=typeof t.mtime)throw TypeError(".Data.mtime: object expected");n.mtime=yn.UnixTime.fromObject(t.mtime)}return n},r.toObject=function(t,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.blocksizes=[]),n.defaults){if(s.Type=n.enums===String?"Raw":0,n.bytes===String?s.Data="":(s.Data=[],n.bytes!==Array&&(s.Data=lt.newBuffer(s.Data))),lt.Long){var i=new lt.Long(0,0,!0);s.filesize=n.longs===String?i.toString():n.longs===Number?i.toNumber():i}else s.filesize=n.longs===String?"0":0;lt.Long?(i=new lt.Long(0,0,!0),s.hashType=n.longs===String?i.toString():n.longs===Number?i.toNumber():i):s.hashType=n.longs===String?"0":0,lt.Long?(i=new lt.Long(0,0,!0),s.fanout=n.longs===String?i.toString():n.longs===Number?i.toNumber():i):s.fanout=n.longs===String?"0":0,s.mode=0,s.mtime=null}if(null!=t.Type&&t.hasOwnProperty("Type")&&(s.Type=n.enums===String?yn.Data.DataType[t.Type]:t.Type),null!=t.Data&&t.hasOwnProperty("Data")&&(s.Data=n.bytes===String?lt.base64.encode(t.Data,0,t.Data.length):n.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),null!=t.filesize&&t.hasOwnProperty("filesize")&&(s.filesize="number"==typeof t.filesize?n.longs===String?String(t.filesize):t.filesize:n.longs===String?lt.Long.prototype.toString.call(t.filesize):n.longs===Number?new lt.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0):t.filesize),t.blocksizes&&t.blocksizes.length){s.blocksizes=[];for(var o=0;o<t.blocksizes.length;++o)s.blocksizes[o]="number"==typeof t.blocksizes[o]?n.longs===String?String(t.blocksizes[o]):t.blocksizes[o]:n.longs===String?lt.Long.prototype.toString.call(t.blocksizes[o]):n.longs===Number?new lt.LongBits(t.blocksizes[o].low>>>0,t.blocksizes[o].high>>>0).toNumber(!0):t.blocksizes[o]}return null!=t.hashType&&t.hasOwnProperty("hashType")&&(s.hashType="number"==typeof t.hashType?n.longs===String?String(t.hashType):t.hashType:n.longs===String?lt.Long.prototype.toString.call(t.hashType):n.longs===Number?new lt.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0):t.hashType),null!=t.fanout&&t.hasOwnProperty("fanout")&&(s.fanout="number"==typeof t.fanout?n.longs===String?String(t.fanout):t.fanout:n.longs===String?lt.Long.prototype.toString.call(t.fanout):n.longs===Number?new lt.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0):t.fanout),null!=t.mode&&t.hasOwnProperty("mode")&&(s.mode=t.mode),null!=t.mtime&&t.hasOwnProperty("mtime")&&(s.mtime=yn.UnixTime.toObject(t.mtime,n)),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,ha.util.toJSONOptions)},r.DataType=function(){const e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),r})(),mo=(yn.UnixTime=(()=>{function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.Seconds=lt.Long?lt.Long.fromBits(0,0,!1):0,r.prototype.FractionalNanoseconds=0,r.encode=function(t,n){return n||(n=M3.create()),n.uint32(8).int64(t.Seconds),null!=t.FractionalNanoseconds&&Object.hasOwnProperty.call(t,"FractionalNanoseconds")&&n.uint32(21).fixed32(t.FractionalNanoseconds),n},r.decode=function(t,n){t instanceof ul||(t=ul.create(t));for(var s=void 0===n?t.len:t.pos+n,i=new yn.UnixTime;t.pos<s;){var o=t.uint32();switch(o>>>3){case 1:i.Seconds=t.int64();break;case 2:i.FractionalNanoseconds=t.fixed32();break;default:t.skipType(7&o)}}if(!i.hasOwnProperty("Seconds"))throw lt.ProtocolError("missing required 'Seconds'",{instance:i});return i},r.fromObject=function(t){if(t instanceof yn.UnixTime)return t;var n=new yn.UnixTime;return null!=t.Seconds&&(lt.Long?(n.Seconds=lt.Long.fromValue(t.Seconds)).unsigned=!1:"string"==typeof t.Seconds?n.Seconds=parseInt(t.Seconds,10):"number"==typeof t.Seconds?n.Seconds=t.Seconds:"object"==typeof t.Seconds&&(n.Seconds=new lt.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber())),null!=t.FractionalNanoseconds&&(n.FractionalNanoseconds=t.FractionalNanoseconds>>>0),n},r.toObject=function(t,n){n||(n={});var s={};if(n.defaults){if(lt.Long){var i=new lt.Long(0,0,!1);s.Seconds=n.longs===String?i.toString():n.longs===Number?i.toNumber():i}else s.Seconds=n.longs===String?"0":0;s.FractionalNanoseconds=0}return null!=t.Seconds&&t.hasOwnProperty("Seconds")&&(s.Seconds="number"==typeof t.Seconds?n.longs===String?String(t.Seconds):t.Seconds:n.longs===String?lt.Long.prototype.toString.call(t.Seconds):n.longs===Number?new lt.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber():t.Seconds),null!=t.FractionalNanoseconds&&t.hasOwnProperty("FractionalNanoseconds")&&(s.FractionalNanoseconds=t.FractionalNanoseconds),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,ha.util.toJSONOptions)},r})(),yn.Metadata=(()=>{function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.MimeType="",r.encode=function(t,n){return n||(n=M3.create()),null!=t.MimeType&&Object.hasOwnProperty.call(t,"MimeType")&&n.uint32(10).string(t.MimeType),n},r.decode=function(t,n){t instanceof ul||(t=ul.create(t));for(var s=void 0===n?t.len:t.pos+n,i=new yn.Metadata;t.pos<s;){var o=t.uint32();o>>>3==1?i.MimeType=t.string():t.skipType(7&o)}return i},r.fromObject=function(t){if(t instanceof yn.Metadata)return t;var n=new yn.Metadata;return null!=t.MimeType&&(n.MimeType=String(t.MimeType)),n},r.toObject=function(t,n){n||(n={});var s={};return n.defaults&&(s.MimeType=""),null!=t.MimeType&&t.hasOwnProperty("MimeType")&&(s.MimeType=t.MimeType),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,ha.util.toJSONOptions)},r})(),EG),xT=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],xG=["directory","hamt-sharded-directory"],ST=parseInt("0644",8),AT=parseInt("0755",8);function dl(r){if(null!=r)return"number"==typeof r?4095&r:"0"===(r=r.toString()).substring(0,1)?4095&parseInt(r,8):4095&parseInt(r,10)}function Cd(r){if(null==r)return;let e;if(null!=r.secs&&(e={secs:r.secs,nsecs:r.nsecs}),null!=r.Seconds&&(e={secs:r.Seconds,nsecs:r.FractionalNanoseconds}),Array.isArray(r)&&(e={secs:r[0],nsecs:r[1]}),r instanceof Date){const t=r.getTime(),n=Math.floor(t/1e3);e={secs:n,nsecs:1e3*(t-1e3*n)}}if(Object.prototype.hasOwnProperty.call(e,"secs")){if(null!=e&&null!=e.nsecs&&(e.nsecs<0||e.nsecs>999999999))throw ee(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}class ur{static unmarshal(e){const t=mo.decode(e),n=mo.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}),s=new ur({type:xT[n.Type],data:n.Data,blockSizes:n.blocksizes,mode:n.mode,mtime:n.mtime?{secs:n.mtime.Seconds,nsecs:n.mtime.FractionalNanoseconds}:void 0});return s._originalMode=n.mode||0,s}constructor(e={type:"file"}){const{type:t,data:n,blockSizes:s,hashType:i,fanout:o,mtime:a,mode:c}=e;if(t&&!xT.includes(t))throw ee(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t||"file",this.data=n,this.hashType=i,this.fanout=o,this.blockSizes=s||[],this._originalMode=0,this.mode=dl(c),a&&(this.mtime=Cd(a),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?AT:ST;const t=dl(e);void 0!==t&&(this._mode=t)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&xG.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach(t=>{e+=t}),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=mo.DataType.Raw;break;case"directory":e=mo.DataType.Directory;break;case"file":e=mo.DataType.File;break;case"metadata":e=mo.DataType.Metadata;break;case"symlink":e=mo.DataType.Symlink;break;case"hamt-sharded-directory":e=mo.DataType.HAMTShard;break;default:throw ee(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let n,s,t=this.data;if((!this.data||!this.data.length)&&(t=void 0),null!=this.mode&&(n=4294963200&this._originalMode|(dl(this.mode)||0),n===ST&&!this.isDirectory()&&(n=void 0),n===AT&&this.isDirectory()&&(n=void 0)),null!=this.mtime){const o=Cd(this.mtime);o&&(s={Seconds:o.secs,FractionalNanoseconds:o.nsecs},0===s.FractionalNanoseconds&&delete s.FractionalNanoseconds)}const i={Type:e,Data:t,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:n,mtime:s};return mo.encode(i).finish()}}var CG=Math.pow(2,31),DG=Math.pow(2,7),OG=Math.pow(2,14),PG=Math.pow(2,21),NG=Math.pow(2,28),BG=Math.pow(2,35),LG=Math.pow(2,42),kG=Math.pow(2,49),UG=Math.pow(2,56),MG=Math.pow(2,63),zG={encode:function CT(r,e,t){e=e||[];for(var n=t=t||0;r>=CG;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,CT.bytes=t-n+1,e},decode:function F3(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw F3.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return F3.bytes=i-n,t},encodingLength:function(r){return r<DG?1:r<OG?2:r<PG?3:r<NG?4:r<BG?5:r<LG?6:r<kG?7:r<UG?8:r<MG?9:10}};const $0=zG,z3=(r,e=0)=>[$0.decode(r,e),$0.decode.bytes],K0=(r,e,t=0)=>($0.encode(r,e,t),e),Z0=r=>$0.encodingLength(r),V3=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class j3{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const QG=function GG(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class JG{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class XG{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return RT(this,e)}}class qG{constructor(e){this.decoders=e}or(e){return RT(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const RT=(r,e)=>new qG({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class eW{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new JG(e,t,n),this.decoder=new XG(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const DT=({name:r,prefix:e,encode:t,decode:n})=>new eW(r,e,t,n),OT=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=QG(t,e);return DT({prefix:r,name:e,encode:n,decode:i=>V3(s(i))})},vo=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>DT({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),pa=OT({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),H0=(OT({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),vo({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),PT=(vo({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),vo({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),vo({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),vo({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),vo({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),vo({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),vo({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),vo({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),$3=r=>{const e=PT.get(r);if(null==e){const t=new Map;return PT.set(r,t),t}return e};class zr{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Id)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==aW)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return zr.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=((r,e)=>{const t=e.byteLength,n=Z0(r),s=n+Z0(t),i=new Uint8Array(s+t);return K0(r,i,0),K0(t,i,n),i.set(e,s),new j3(r,t,e,i)})(e,t);return zr.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return zr.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?iW(t,$3(r),e||pa.encoder):oW(t,$3(r),e||H0.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof zr)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new zr(n,s,i,o||NT(n,s,i.bytes))}if(!0===t[cW]){const{version:n,multihash:s,code:i}=t,o=(r=>{const e=V3(r),[t,n]=z3(e),[s,i]=z3(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new j3(t,s,o,e)})(s);return zr.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Id)throw new Error(`Version 0 CID must use dag-pb (code: ${Id}) block encoding`);return new zr(e,t,n,n.bytes);case 1:{const s=NT(e,t,n.bytes);return new zr(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return zr.create(0,Id,e)}static createV1(e,t){return zr.create(1,e,t)}static decode(e){const[t,n]=zr.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=zr.inspectBytes(e),n=t.size-t.multihashSize,s=V3(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new j3(t.multihashCode,t.digestSize,i,s);return[0===t.version?zr.createV0(o):zr.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=z3(e.subarray(t));return t+=T,E};let s=n(),i=Id;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=sW(e,t),i=zr.decode(s);return $3(i).set(n,e),i}}const sW=(r,e)=>{switch(r[0]){case"Q":return[pa.prefix,(e||pa).decode(`${pa.prefix}${r}`)];case pa.prefix:return[pa.prefix,(e||pa).decode(r)];case H0.prefix:return[H0.prefix,(e||H0).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},iW=(r,e,t)=>{const{prefix:n}=t;if(n!==pa.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},oW=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},Id=112,aW=18,NT=(r,e,t)=>{const n=Z0(r),s=n+Z0(e),i=new Uint8Array(s+t.byteLength);return K0(r,i,0),K0(e,i,n),i.set(t,s),i},cW=Symbol.for("@ipld/js-cid/CID"),lW=new TextDecoder;function K3(r,e){let t=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(e>=r.length)throw new Error("protobuf: unexpected end of data");const s=r[e++];if(t+=n<28?(127&s)<<n:(127&s)*2**n,s<128)break}return[t,e]}function G0(r,e){let t;[t,e]=K3(r,e);const n=e+t;if(t<0||n<0)throw new Error("protobuf: invalid length");if(n>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(e,n),n]}function BT(r,e){let t;return[t,e]=K3(r,e),[7&t,t>>3,e]}function uW(r){const e={},t=r.length;let n=0;for(;n<t;){let s,i;if([s,i,n]=BT(r,n),1===i){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==s)throw new Error(`protobuf: (PBLink) wrong wireType (${s}) for Hash`);if(void 0!==e.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==e.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,n]=G0(r,n)}else if(2===i){if(void 0!==e.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==s)throw new Error(`protobuf: (PBLink) wrong wireType (${s}) for Name`);if(void 0!==e.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,n]=G0(r,n),e.Name=lW.decode(o)}else{if(3!==i)throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${i}`);if(void 0!==e.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==s)throw new Error(`protobuf: (PBLink) wrong wireType (${s}) for Tsize`);[e.Tsize,n]=K3(r,n)}}if(n>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}const LT=new TextEncoder,kT=2**32;function hW(r,e){let t=e.length;if("number"==typeof r.Tsize){if(r.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(r.Tsize))throw new Error("Tsize too large for encoding");t=Rd(e,t,r.Tsize)-1,e[t]=24}if("string"==typeof r.Name){const n=LT.encode(r.Name);t-=n.length,e.set(n,t),t=Rd(e,t,n.length)-1,e[t]=18}return r.Hash&&(t-=r.Hash.length,e.set(r.Hash,t),t=Rd(e,t,r.Hash.length)-1,e[t]=10),e.length-t}function yW(r){let e=0;if(r.Hash){const t=r.Hash.length;e+=1+t+fl(t)}if("string"==typeof r.Name){const t=LT.encode(r.Name).length;e+=1+t+fl(t)}return"number"==typeof r.Tsize&&(e+=1+fl(r.Tsize)),e}function Rd(r,e,t){const n=e-=fl(t);for(;t>=2147483648;)r[e++]=127&t|128,t/=128;for(;t>=128;)r[e++]=127&t|128,t>>>=7;return r[e]=t,n}function fl(r){return r%2==0&&r++,Math.floor((function bW(r){let e=0;return r>=kT&&(r=Math.floor(r/kT),e=32),r>=65536&&(r>>>=16,e+=16),r>=256&&(r>>>=8,e+=8),e+_W[r]}(r)+6)/7)}const _W=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],mW=["Data","Links"],vW=["Hash","Name","Tsize"],Z3=new TextEncoder;function UT(r,e){if(r===e)return 0;const t=r.Name?Z3.encode(r.Name):[],n=e.Name?Z3.encode(e.Name):[];let s=t.length,i=n.length;for(let o=0,a=Math.min(s,i);o<a;++o)if(t[o]!==n[o]){s=t[o],i=n[o];break}return s<i?-1:i<s?1:0}function MT(r,e){return!Object.keys(r).some(t=>!e.includes(t))}function FT(r){if("object"==typeof r.asCID){const t=zr.asCID(r);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if("object"!=typeof r||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");const e={};if(r.Hash){let t=zr.asCID(r.Hash);try{t||("string"==typeof r.Hash?t=zr.parse(r.Hash):r.Hash instanceof Uint8Array&&(t=zr.decode(r.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}t&&(e.Hash=t)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return"string"==typeof r.Name&&(e.Name=r.Name),"number"==typeof r.Tsize&&(e.Tsize=r.Tsize),e}function Ki(r){if((r instanceof Uint8Array||"string"==typeof r)&&(r={Data:r}),"object"!=typeof r||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");const e={};if(void 0!==r.Data)if("string"==typeof r.Data)e.Data=Z3.encode(r.Data);else{if(!(r.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");e.Data=r.Data}if(void 0!==r.Links){if(!Array.isArray(r.Links))throw new TypeError("Invalid DAG-PB form");e.Links=r.Links.map(FT),e.Links.sort(UT)}else e.Links=[];return e}function zT(r){if(!r||"object"!=typeof r||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");if(!MT(r,mW))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==r.Data&&!(r.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(r.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<r.Links.length;e++){const t=r.Links[e];if(!t||"object"!=typeof t||Array.isArray(t))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!MT(t,vW))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!t.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash.asCID!==t.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==t.Name&&"string"!=typeof t.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==t.Tsize&&("number"!=typeof t.Tsize||t.Tsize%1!=0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&-1===UT(t,r.Links[e-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function wW(r,e=[]){return Ki({Data:r,Links:e})}function EW(r,e,t){return FT({Hash:t,Name:r,Tsize:e})}const xW="dag-pb",gr=112;function ir(r){zT(r);const e={};return r.Links&&(e.Links=r.Links.map(t=>{const n={};return t.Hash&&(n.Hash=t.Hash.bytes),void 0!==t.Name&&(n.Name=t.Name),void 0!==t.Tsize&&(n.Tsize=t.Tsize),n})),r.Data&&(e.Data=r.Data),function pW(r){const e=function gW(r){let e=0;if(r.Data){const t=r.Data.length;e+=1+t+fl(t)}if(r.Links)for(const t of r.Links){const n=yW(t);e+=1+n+fl(n)}return e}(r),t=new Uint8Array(e);let n=e;if(r.Data&&(n-=r.Data.length,t.set(r.Data,n),n=Rd(t,n,r.Data.length)-1,t[n]=10),r.Links)for(let s=r.Links.length-1;s>=0;s--){const i=hW(r.Links[s],t.subarray(0,n));n-=i,n=Rd(t,n,i)-1,t[n]=18}return t}(e)}function Vr(r){const e=function dW(r){const e=r.length;let n,i,t=0,s=!1;for(;t<e;){let a,c;if([a,c,t]=BT(r,t),2!==a)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(1===c){if(i)throw new Error("protobuf: (PBNode) duplicate Data section");[i,t]=G0(r,t),n&&(s=!0)}else{if(2!==c)throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`);{if(s)throw new Error("protobuf: (PBNode) duplicate Links section");let u;n||(n=[]),[u,t]=G0(r,t),n.push(uW(u))}}}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");const o={};return i&&(o.Data=i),o.Links=n||[],o}(r),t={};return e.Data&&(t.Data=e.Data),e.Links&&(t.Links=e.Links.map(n=>{const s={};try{s.Hash=zr.decode(n.Hash)}catch{}if(!s.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==n.Name&&(s.Name=n.Name),void 0!==n.Tsize&&(s.Tsize=n.Tsize),s})),t}const SW=["string","number","bigint","symbol"],AW=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];class Te{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}Te.uint=new Te(0,"uint",!0),Te.negint=new Te(1,"negint",!0),Te.bytes=new Te(2,"bytes",!0),Te.string=new Te(3,"string",!0),Te.array=new Te(4,"array",!1),Te.map=new Te(5,"map",!1),Te.tag=new Te(6,"tag",!1),Te.float=new Te(7,"float",!0),Te.false=new Te(7,"false",!0),Te.true=new Te(7,"true",!0),Te.null=new Te(7,"null",!0),Te.undefined=new Te(7,"undefined",!0),Te.break=new Te(7,"break",!0);class $e{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const hl=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,RW=new TextDecoder,DW=new TextEncoder;function W0(r){return hl&&globalThis.Buffer.isBuffer(r)}function H3(r){return r instanceof Uint8Array?W0(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r)}const OW=hl?(r,e,t)=>t-e>64?globalThis.Buffer.from(r.subarray(e,t)).toString("utf8"):$T(r,e,t):(r,e,t)=>t-e>64?RW.decode(r.subarray(e,t)):$T(r,e,t),VT=hl?r=>r.length>64?globalThis.Buffer.from(r):jT(r):r=>r.length>64?DW.encode(r):jT(r),wo=r=>Uint8Array.from(r),G3=hl?(r,e,t)=>W0(r)?new Uint8Array(r.subarray(e,t)):r.slice(e,t):(r,e,t)=>r.slice(e,t),PW=hl?(r,e)=>(r=r.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),H3(globalThis.Buffer.concat(r,e))):(r,e)=>{const t=new Uint8Array(e);let n=0;for(let s of r)n+s.length>t.length&&(s=s.subarray(0,t.length-n)),t.set(s,n),n+=s.length;return t},NW=hl?r=>globalThis.Buffer.allocUnsafe(r):r=>new Uint8Array(r);function jT(r,e=1/0){let t;const n=r.length;let s=null;const i=[];for(let o=0;o<n;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!s){if(t>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&i.push(239,191,189);continue}s=t;continue}if(t<56320){(e-=3)>-1&&i.push(239,191,189),s=t;continue}t=65536+(s-55296<<10|t-56320)}else s&&(e-=3)>-1&&i.push(239,191,189);if(s=null,t<128){if((e-=1)<0)break;i.push(t)}else if(t<2048){if((e-=2)<0)break;i.push(t>>6|192,63&t|128)}else if(t<65536){if((e-=3)<0)break;i.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return i}function $T(r,e,t){const n=[];for(;e<t;){const s=r[e];let i=null,o=s>239?4:s>223?3:s>191?2:1;if(e+o<=t){let a,c,u,f;switch(o){case 1:s<128&&(i=s);break;case 2:a=r[e+1],128==(192&a)&&(f=(31&s)<<6|63&a,f>127&&(i=f));break;case 3:a=r[e+1],c=r[e+2],128==(192&a)&&128==(192&c)&&(f=(15&s)<<12|(63&a)<<6|63&c,f>2047&&(f<55296||f>57343)&&(i=f));break;case 4:a=r[e+1],c=r[e+2],u=r[e+3],128==(192&a)&&128==(192&c)&&128==(192&u)&&(f=(15&s)<<18|(63&a)<<12|(63&c)<<6|63&u,f>65535&&f<1114112&&(i=f))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),e+=o}return ZT(n)}function ZT(r){const e=r.length;if(e<=4096)return String.fromCharCode.apply(String,r);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=4096));return t}class HT{constructor(e=256){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1)t.set(e,t.length-(this.maxCursor-this.cursor)-1);else{if(t){const s=t.length-(this.maxCursor-this.cursor)-1;s<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,s),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=NW(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){const n=this.chunks[0];e&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=G3(n,0,this.cursor)}else t=PW(this.chunks,this.cursor);return e&&this.reset(),t}}const ct="CBOR decode error:",yc="CBOR encode error:",Dd=[];function pl(r,e,t){if(r.length-e<t)throw new Error(`${ct} not enough data for type`)}Dd[23]=1,Dd[24]=2,Dd[25]=3,Dd[26]=5,Dd[27]=9;const gn=[24,256,65536,4294967296,BigInt("18446744073709551616")];function gc(r,e,t){pl(r,e,1);const n=r[e];if(!0===t.strict&&n<gn[0])throw new Error(`${ct} integer encoded in more bytes than necessary (strict decode)`);return n}function bc(r,e,t){pl(r,e,2);const n=r[e]<<8|r[e+1];if(!0===t.strict&&n<gn[1])throw new Error(`${ct} integer encoded in more bytes than necessary (strict decode)`);return n}function _c(r,e,t){pl(r,e,4);const n=16777216*r[e]+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];if(!0===t.strict&&n<gn[2])throw new Error(`${ct} integer encoded in more bytes than necessary (strict decode)`);return n}function mc(r,e,t){pl(r,e,8);const s=16777216*r[e+4]+(r[e+5]<<16)+(r[e+6]<<8)+r[e+7],i=(BigInt(16777216*r[e]+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3])<<BigInt(32))+BigInt(s);if(!0===t.strict&&i<gn[3])throw new Error(`${ct} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(!0===t.allowBigInt)return i;throw new Error(`${ct} integers outside of the safe integer range are not supported`)}function vc(r,e){return ni(r,0,e.value)}function ni(r,e,t){if(t<gn[0]){const n=Number(t);r.push([e|n])}else if(t<gn[1]){const n=Number(t);r.push([24|e,n])}else if(t<gn[2]){const n=Number(t);r.push([25|e,n>>>8,255&n])}else if(t<gn[3]){const n=Number(t);r.push([26|e,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(t);if(!(n<gn[4]))throw new Error(`${ct} encountered BigInt larger than allowable range`);{const s=[27|e,0,0,0,0,0,0,0];let i=Number(n&BigInt(4294967295)),o=Number(n>>BigInt(32)&BigInt(4294967295));s[8]=255&i,i>>=8,s[7]=255&i,i>>=8,s[6]=255&i,i>>=8,s[5]=255&i,s[4]=255&o,o>>=8,s[3]=255&o,o>>=8,s[2]=255&o,o>>=8,s[1]=255&o,r.push(s)}}}vc.encodedSize=function(e){return ni.encodedSize(e.value)},ni.encodedSize=function(e){return e<gn[0]?1:e<gn[1]?2:e<gn[2]?3:e<gn[3]?5:9},vc.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const W3=BigInt(-1),GT=BigInt(1);function Y3(r,e){const t=e.value;ni(r,e.type.majorEncoded,"bigint"==typeof t?t*W3-GT:-1*t-1)}function Od(r,e,t,n){pl(r,e,t+n);const s=G3(r,e+t,e+t+n);return new $e(Te.bytes,s,t+n)}function KW(r,e,t,n){return Od(r,e,1,t)}function Y0(r){return void 0===r.encodedBytes&&(r.encodedBytes=r.type===Te.string?VT(r.value):r.value),r.encodedBytes}function Q0(r,e){const t=Y0(e);ni(r,e.type.majorEncoded,t.length),r.push(t)}function Pd(r,e,t,n,s){const i=t+n;pl(r,e,i);const o=new $e(Te.string,OW(r,e+t,e+i),i);return!0===s.retainStringBytes&&(o.byteValue=G3(r,e+t,e+i)),o}function QW(r,e,t,n){return Pd(r,e,1,t,n)}Y3.encodedSize=function(e){const t=e.value,n="bigint"==typeof t?t*W3-GT:-1*t-1;return n<gn[0]?1:n<gn[1]?2:n<gn[2]?3:n<gn[3]?5:9},Y3.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},Q0.encodedSize=function(e){const t=Y0(e);return ni.encodedSize(t.length)+t.length},Q0.compareTokens=function(e,t){return function YW(r,e){return r.length<e.length?-1:r.length>e.length?1:function BW(r,e){if(W0(r)&&W0(e))return r.compare(e);for(let t=0;t<r.length;t++)if(r[t]!==e[t])return r[t]<e[t]?-1:1;return 0}(r,e)}(Y0(e),Y0(t))};const tY=Q0;function yl(r,e,t,n){return new $e(Te.array,n,t)}function rY(r,e,t,n){return yl(0,0,1,t)}function Q3(r,e){ni(r,Te.array.majorEncoded,e.value)}function gl(r,e,t,n){return new $e(Te.map,n,t)}function cY(r,e,t,n){return gl(0,0,1,t)}function J3(r,e){ni(r,Te.map.majorEncoded,e.value)}function pY(r,e,t,n){return new $e(Te.tag,t,1)}function X3(r,e){ni(r,Te.tag.majorEncoded,e.value)}function q3(r,e,t){if(t){if(!1===t.allowNaN&&Number.isNaN(r))throw new Error(`${ct} NaN values are not supported`);if(!1===t.allowInfinity&&(r===1/0||r===-1/0))throw new Error(`${ct} Infinity values are not supported`)}return new $e(Te.float,r,e)}function e6(r,e,t){const n=e.value;if(!1===n)r.push([20|Te.float.majorEncoded]);else if(!0===n)r.push([21|Te.float.majorEncoded]);else if(null===n)r.push([22|Te.float.majorEncoded]);else if(void 0===n)r.push([23|Te.float.majorEncoded]);else{let s,i=!1;(!t||!0!==t.float64)&&(YT(n),s=t6(_i,1),n===s||Number.isNaN(n)?(_i[0]=249,r.push(_i.slice(0,3)),i=!0):(QT(n),s=r6(_i,1),n===s&&(_i[0]=250,r.push(_i.slice(0,5)),i=!0))),i||(function IY(r){si.setFloat64(0,r,!1)}(n),s=JT(_i,1),_i[0]=251,r.push(_i.slice(0,9)))}}Q3.compareTokens=vc.compareTokens,Q3.encodedSize=function(e){return ni.encodedSize(e.value)},J3.compareTokens=vc.compareTokens,J3.encodedSize=function(e){return ni.encodedSize(e.value)},X3.compareTokens=vc.compareTokens,X3.encodedSize=function(e){return ni.encodedSize(e.value)},e6.encodedSize=function(e,t){const n=e.value;if(!1===n||!0===n||null==n)return 1;if(!t||!0!==t.float64){YT(n);let s=t6(_i,1);if(n===s||Number.isNaN(n))return 3;if(QT(n),s=r6(_i,1),n===s)return 5}return 9};const WT=new ArrayBuffer(9),si=new DataView(WT,1),_i=new Uint8Array(WT,0);function YT(r){if(r===1/0)si.setUint16(0,31744,!1);else if(r===-1/0)si.setUint16(0,64512,!1);else if(Number.isNaN(r))si.setUint16(0,32256,!1);else{si.setFloat32(0,r);const e=si.getUint32(0),t=(2139095040&e)>>23,n=8388607&e;if(255===t)si.setUint16(0,31744,!1);else if(0===t)si.setUint16(0,(2147483648&r)>>16|n>>13,!1);else{const s=t-127;s<-24?si.setUint16(0,0):si.setUint16(0,s<-14?(2147483648&e)>>16|1<<24+s:(2147483648&e)>>16|s+15<<10|n>>13,!1)}}}function t6(r,e){if(r.length-e<2)throw new Error(`${ct} not enough data for float16`);const t=(r[e]<<8)+r[e+1];if(31744===t)return 1/0;if(64512===t)return-1/0;if(32256===t)return NaN;const n=t>>10&31,s=1023&t;let i;return i=0===n?s*2**-24:31!==n?(s+1024)*2**(n-25):0===s?1/0:NaN,32768&t?-i:i}function QT(r){si.setFloat32(0,r,!1)}function r6(r,e){if(r.length-e<4)throw new Error(`${ct} not enough data for float32`);return new DataView(r.buffer,(r.byteOffset||0)+e,4).getFloat32(0,!1)}function JT(r,e){if(r.length-e<8)throw new Error(`${ct} not enough data for float64`);return new DataView(r.buffer,(r.byteOffset||0)+e,8).getFloat64(0,!1)}function Bt(r,e,t){throw new Error(`${ct} encountered invalid minor (${t}) for major ${r[e]>>>5}`)}function J0(r){return()=>{throw new Error(`${ct} ${r}`)}}e6.compareTokens=vc.compareTokens;const He=[];for(let r=0;r<=23;r++)He[r]=Bt;He[24]=function kW(r,e,t,n){return new $e(Te.uint,gc(r,e+1,n),2)},He[25]=function UW(r,e,t,n){return new $e(Te.uint,bc(r,e+1,n),3)},He[26]=function MW(r,e,t,n){return new $e(Te.uint,_c(r,e+1,n),5)},He[27]=function FW(r,e,t,n){return new $e(Te.uint,mc(r,e+1,n),9)},He[28]=Bt,He[29]=Bt,He[30]=Bt,He[31]=Bt;for(let r=32;r<=55;r++)He[r]=Bt;He[56]=function zW(r,e,t,n){return new $e(Te.negint,-1-gc(r,e+1,n),2)},He[57]=function VW(r,e,t,n){return new $e(Te.negint,-1-bc(r,e+1,n),3)},He[58]=function jW(r,e,t,n){return new $e(Te.negint,-1-_c(r,e+1,n),5)},He[59]=function $W(r,e,t,n){const s=mc(r,e+1,n);if("bigint"!=typeof s){const i=-1-s;if(i>=Number.MIN_SAFE_INTEGER)return new $e(Te.negint,i,9)}if(!0!==n.allowBigInt)throw new Error(`${ct} integers outside of the safe integer range are not supported`);return new $e(Te.negint,W3-BigInt(s),9)},He[60]=Bt,He[61]=Bt,He[62]=Bt,He[63]=Bt;for(let r=64;r<=87;r++)He[r]=KW;He[88]=function ZW(r,e,t,n){return Od(r,e,2,gc(r,e+1,n))},He[89]=function HW(r,e,t,n){return Od(r,e,3,bc(r,e+1,n))},He[90]=function GW(r,e,t,n){return Od(r,e,5,_c(r,e+1,n))},He[91]=function WW(r,e,t,n){const s=mc(r,e+1,n);if("bigint"==typeof s)throw new Error(`${ct} 64-bit integer bytes lengths not supported`);return Od(r,e,9,s)},He[92]=Bt,He[93]=Bt,He[94]=Bt,He[95]=J0("indefinite length bytes/strings are not supported");for(let r=96;r<=119;r++)He[r]=QW;He[120]=function JW(r,e,t,n){return Pd(r,e,2,gc(r,e+1,n),n)},He[121]=function XW(r,e,t,n){return Pd(r,e,3,bc(r,e+1,n),n)},He[122]=function qW(r,e,t,n){return Pd(r,e,5,_c(r,e+1,n),n)},He[123]=function eY(r,e,t,n){const s=mc(r,e+1,n);if("bigint"==typeof s)throw new Error(`${ct} 64-bit integer string lengths not supported`);return Pd(r,e,9,s,n)},He[124]=Bt,He[125]=Bt,He[126]=Bt,He[127]=J0("indefinite length bytes/strings are not supported");for(let r=128;r<=151;r++)He[r]=rY;He[152]=function nY(r,e,t,n){return yl(0,0,2,gc(r,e+1,n))},He[153]=function sY(r,e,t,n){return yl(0,0,3,bc(r,e+1,n))},He[154]=function iY(r,e,t,n){return yl(0,0,5,_c(r,e+1,n))},He[155]=function oY(r,e,t,n){const s=mc(r,e+1,n);if("bigint"==typeof s)throw new Error(`${ct} 64-bit integer array lengths not supported`);return yl(0,0,9,s)},He[156]=Bt,He[157]=Bt,He[158]=Bt,He[159]=function aY(r,e,t,n){if(!1===n.allowIndefinite)throw new Error(`${ct} indefinite length items not allowed`);return yl(0,0,1,1/0)};for(let r=160;r<=183;r++)He[r]=cY;He[184]=function lY(r,e,t,n){return gl(0,0,2,gc(r,e+1,n))},He[185]=function uY(r,e,t,n){return gl(0,0,3,bc(r,e+1,n))},He[186]=function dY(r,e,t,n){return gl(0,0,5,_c(r,e+1,n))},He[187]=function fY(r,e,t,n){const s=mc(r,e+1,n);if("bigint"==typeof s)throw new Error(`${ct} 64-bit integer map lengths not supported`);return gl(0,0,9,s)},He[188]=Bt,He[189]=Bt,He[190]=Bt,He[191]=function hY(r,e,t,n){if(!1===n.allowIndefinite)throw new Error(`${ct} indefinite length items not allowed`);return gl(0,0,1,1/0)};for(let r=192;r<=215;r++)He[r]=pY;He[216]=function yY(r,e,t,n){return new $e(Te.tag,gc(r,e+1,n),2)},He[217]=function gY(r,e,t,n){return new $e(Te.tag,bc(r,e+1,n),3)},He[218]=function bY(r,e,t,n){return new $e(Te.tag,_c(r,e+1,n),5)},He[219]=function _Y(r,e,t,n){return new $e(Te.tag,mc(r,e+1,n),9)},He[220]=Bt,He[221]=Bt,He[222]=Bt,He[223]=Bt;for(let r=224;r<=243;r++)He[r]=J0("simple values are not supported");He[244]=Bt,He[245]=Bt,He[246]=Bt,He[247]=function xY(r,e,t,n){if(!1===n.allowUndefined)throw new Error(`${ct} undefined values are not supported`);return!0===n.coerceUndefinedToNull?new $e(Te.null,null,1):new $e(Te.undefined,void 0,1)},He[248]=J0("simple values are not supported"),He[249]=function AY(r,e,t,n){return q3(t6(r,e+1),3,n)},He[250]=function TY(r,e,t,n){return q3(r6(r,e+1),5,n)},He[251]=function CY(r,e,t,n){return q3(JT(r,e+1),9,n)},He[252]=Bt,He[253]=Bt,He[254]=Bt,He[255]=function SY(r,e,t,n){if(!1===n.allowIndefinite)throw new Error(`${ct} indefinite length items not allowed`);return new $e(Te.break,void 0,1)};const Zi=[];for(let r=0;r<24;r++)Zi[r]=new $e(Te.uint,r,1);for(let r=-1;r>=-24;r--)Zi[31-r]=new $e(Te.negint,r,1);Zi[64]=new $e(Te.bytes,new Uint8Array(0),1),Zi[96]=new $e(Te.string,"",1),Zi[128]=new $e(Te.array,0,1),Zi[160]=new $e(Te.map,0,1),Zi[244]=new $e(Te.false,!1,1),Zi[245]=new $e(Te.true,!0,1),Zi[246]=new $e(Te.null,null,1);var DY=p(28069);const OY={float64:!1,mapSorter:function BY(r,e){const t=Array.isArray(r[0])?r[0][0]:r[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==n.type)return t.type.compare(n.type);const i=XT[t.type.major].compareTokens(t,n);return 0===i&&DY.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),i},quickEncodeToken:function RY(r){switch(r.type){case Te.false:return wo([244]);case Te.true:return wo([245]);case Te.null:return wo([246]);case Te.bytes:return r.value.length?void 0:wo([64]);case Te.string:return""===r.value?wo([96]):void 0;case Te.array:return 0===r.value?wo([128]):void 0;case Te.map:return 0===r.value?wo([160]):void 0;case Te.uint:return r.value<24?wo([Number(r.value)]):void 0;case Te.negint:if(r.value>=-24)return wo([31-Number(r.value)])}}},XT=function PY(){const r=[];return r[Te.uint.major]=vc,r[Te.negint.major]=Y3,r[Te.bytes.major]=Q0,r[Te.string.major]=tY,r[Te.array.major]=Q3,r[Te.map.major]=J3,r[Te.tag.major]=X3,r[Te.float.major]=e6,r}(),n6=new HT;class X0{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${yc} object contains circular references`);return new X0(t,e)}}const ya={null:new $e(Te.null,null),undefined:new $e(Te.undefined,void 0),true:new $e(Te.true,!0),false:new $e(Te.false,!1),emptyArray:new $e(Te.array,0),emptyMap:new $e(Te.map,0)},ga={number:(r,e,t,n)=>Number.isInteger(r)&&Number.isSafeInteger(r)?new $e(r>=0?Te.uint:Te.negint,r):new $e(Te.float,r),bigint:(r,e,t,n)=>r>=BigInt(0)?new $e(Te.uint,r):new $e(Te.negint,r),Uint8Array:(r,e,t,n)=>new $e(Te.bytes,r),string:(r,e,t,n)=>new $e(Te.string,r),boolean:(r,e,t,n)=>r?ya.true:ya.false,null:(r,e,t,n)=>ya.null,undefined:(r,e,t,n)=>ya.undefined,ArrayBuffer:(r,e,t,n)=>new $e(Te.bytes,new Uint8Array(r)),DataView:(r,e,t,n)=>new $e(Te.bytes,new Uint8Array(r.buffer,r.byteOffset,r.byteLength)),Array(r,e,t,n){if(!r.length)return!0===t.addBreakTokens?[ya.emptyArray,new $e(Te.break)]:ya.emptyArray;n=X0.createCheck(n,r);const s=[];let i=0;for(const o of r)s[i++]=q0(o,t,n);return t.addBreakTokens?[new $e(Te.array,r.length),s,new $e(Te.break)]:[new $e(Te.array,r.length),s]},Object(r,e,t,n){const s="Object"!==e,i=s?r.keys():Object.keys(r),o=s?r.size:i.length;if(!o)return!0===t.addBreakTokens?[ya.emptyMap,new $e(Te.break)]:ya.emptyMap;n=X0.createCheck(n,r);const a=[];let c=0;for(const u of i)a[c++]=[q0(u,t,n),q0(s?r.get(u):r[u],t,n)];return function NY(r,e){e.mapSorter&&r.sort(e.mapSorter)}(a,t),t.addBreakTokens?[new $e(Te.map,o),a,new $e(Te.break)]:[new $e(Te.map,o),a]}};ga.Map=ga.Object,ga.Buffer=ga.Uint8Array;for(const r of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))ga[`${r}Array`]=ga.DataView;function q0(r,e={},t){const n=function TW(r){if(null===r)return"null";if(void 0===r)return"undefined";if(!0===r||!1===r)return"boolean";const e=typeof r;if(SW.includes(e))return e;if("function"===e)return"Function";if(Array.isArray(r))return"Array";if(function CW(r){return r&&r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer.call(null,r)}(r))return"Buffer";const t=function IW(r){const e=Object.prototype.toString.call(r).slice(8,-1);if(AW.includes(e))return e}(r);return t||"Object"}(r),s=e&&e.typeEncoders&&e.typeEncoders[n]||ga[n];if("function"==typeof s){const o=s(r,n,e,t);if(null!=o)return o}const i=ga[n];if(!i)throw new Error(`${yc} unsupported type: ${n}`);return i(r,n,e,t)}function qT(r,e,t,n){if(Array.isArray(e))for(const s of e)qT(r,s,t,n);else t[e.type.major](r,e,n)}function eC(r,e,t){const n=q0(r,t);if(!Array.isArray(n)&&t.quickEncodeToken){const s=t.quickEncodeToken(n);if(s)return s;const i=e[n.type.major];if(i.encodedSize){const o=i.encodedSize(n,t),a=new HT(o);if(i(a,n,t),1!==a.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return H3(a.chunks[0])}}return n6.reset(),qT(n6,n,e,t),n6.toBytes(!0)}function bl(r,e){return e=Object.assign({},OY,e),eC(r,XT,e)}const LY={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class kY{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){const e=this.data[this.pos];let t=Zi[e];if(void 0===t){const n=He[e];if(!n)throw new Error(`${ct} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);t=n(this.data,this.pos,31&e,this.options)}return this.pos+=t.encodedLength,t}}const Nd=Symbol.for("DONE"),ep=Symbol.for("BREAK");function Bd(r,e){if(r.done())return Nd;const t=r.next();if(t.type===Te.break)return ep;if(t.type.terminal)return t.value;if(t.type===Te.array)return function UY(r,e,t){const n=[];for(let s=0;s<r.value;s++){const i=Bd(e,t);if(i===ep){if(r.value===1/0)break;throw new Error(`${ct} got unexpected break to lengthed array`)}if(i===Nd)throw new Error(`${ct} found array but not enough entries (got ${s}, expected ${r.value})`);n[s]=i}return n}(t,r,e);if(t.type===Te.map)return function MY(r,e,t){const n=!0===t.useMaps,s=n?void 0:{},i=n?new Map:void 0;for(let o=0;o<r.value;o++){const a=Bd(e,t);if(a===ep){if(r.value===1/0)break;throw new Error(`${ct} got unexpected break to lengthed map`)}if(a===Nd)throw new Error(`${ct} found map but not enough entries (got ${o} [no key], expected ${r.value})`);if(!0!==n&&"string"!=typeof a)throw new Error(`${ct} non-string keys not supported (got ${typeof a})`);const c=Bd(e,t);if(c===Nd)throw new Error(`${ct} found map but not enough entries (got ${o} [no value], expected ${r.value})`);n?i.set(a,c):s[a]=c}return n?i:s}(t,r,e);if(t.type===Te.tag){if(e.tags&&"function"==typeof e.tags[t.value]){const n=Bd(r,e);return e.tags[t.value](n)}throw new Error(`${ct} tag not supported (${t.value})`)}throw new Error("unsupported")}function Hi(r,e){if(!(r instanceof Uint8Array))throw new Error(`${ct} data to decode must be a Uint8Array`);const t=(e=Object.assign({},LY,e)).tokenizer||new kY(r,e),n=Bd(t,e);if(n===Nd)throw new Error(`${ct} did not find any content to decode`);if(n===ep)throw new Error(`${ct} got unexpected break`);if(!t.done())throw new Error(`${ct} too many terminals, data makes no sense`);return n}var jY=Math.pow(2,31),ZY=Math.pow(2,7),HY=Math.pow(2,14),GY=Math.pow(2,21),WY=Math.pow(2,28),YY=Math.pow(2,35),QY=Math.pow(2,42),JY=Math.pow(2,49),XY=Math.pow(2,56),qY=Math.pow(2,63),tQ={encode:function rC(r,e,t){e=e||[];for(var n=t=t||0;r>=jY;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,rC.bytes=t-n+1,e},decode:function s6(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw s6.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return s6.bytes=i-n,t},encodingLength:function(r){return r<ZY?1:r<HY?2:r<GY?3:r<WY?4:r<YY?5:r<QY?6:r<JY?7:r<XY?8:r<qY?9:10}};const tp=tQ,i6=(r,e=0)=>[tp.decode(r,e),tp.decode.bytes],rp=(r,e,t=0)=>(tp.encode(r,e,t),e),np=r=>tp.encodingLength(r),o6=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class a6{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const dQ=function cQ(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class fQ{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class hQ{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return sC(this,e)}}class pQ{constructor(e){this.decoders=e}or(e){return sC(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const sC=(r,e)=>new pQ({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class yQ{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new fQ(e,t,n),this.decoder=new hQ(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const iC=({name:r,prefix:e,encode:t,decode:n})=>new yQ(r,e,t,n),oC=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=dQ(t,e);return iC({prefix:r,name:e,encode:n,decode:i=>o6(s(i))})},Eo=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>iC({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),ba=oC({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),sp=(oC({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Eo({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),aC=(Eo({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Eo({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Eo({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Eo({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Eo({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Eo({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Eo({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Eo({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),c6=r=>{const e=aC.get(r);if(null==e){const t=new Map;return aC.set(r,t),t}return e};class nn{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Ld)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==EQ)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return nn.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=((r,e)=>{const t=e.byteLength,n=np(r),s=n+np(t),i=new Uint8Array(s+t);return rp(r,i,0),rp(t,i,n),i.set(e,s),new a6(r,t,e,i)})(e,t);return nn.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return nn.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?vQ(t,c6(r),e||ba.encoder):wQ(t,c6(r),e||sp.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof nn)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new nn(n,s,i,o||cC(n,s,i.bytes))}if(!0===t[xQ]){const{version:n,multihash:s,code:i}=t,o=(r=>{const e=o6(r),[t,n]=i6(e),[s,i]=i6(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new a6(t,s,o,e)})(s);return nn.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Ld)throw new Error(`Version 0 CID must use dag-pb (code: ${Ld}) block encoding`);return new nn(e,t,n,n.bytes);case 1:{const s=cC(e,t,n.bytes);return new nn(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return nn.create(0,Ld,e)}static createV1(e,t){return nn.create(1,e,t)}static decode(e){const[t,n]=nn.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=nn.inspectBytes(e),n=t.size-t.multihashSize,s=o6(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new a6(t.multihashCode,t.digestSize,i,s);return[0===t.version?nn.createV0(o):nn.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=i6(e.subarray(t));return t+=T,E};let s=n(),i=Ld;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=mQ(e,t),i=nn.decode(s);return c6(i).set(n,e),i}}const mQ=(r,e)=>{switch(r[0]){case"Q":return[ba.prefix,(e||ba).decode(`${ba.prefix}${r}`)];case ba.prefix:return[ba.prefix,(e||ba).decode(r)];case sp.prefix:return[sp.prefix,(e||sp).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},vQ=(r,e,t)=>{const{prefix:n}=t;if(n!==ba.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},wQ=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},Ld=112,EQ=18,cC=(r,e,t)=>{const n=np(r),s=n+np(e),i=new Uint8Array(s+t.byteLength);return rp(r,i,0),rp(e,i,n),i.set(t,s),i},xQ=Symbol.for("@ipld/js-cid/CID"),CQ={float64:!0,typeEncoders:{Object:function SQ(r){if(r.asCID!==r&&r["/"]!==r.bytes)return null;const e=nn.asCID(r);if(!e)return null;const t=new Uint8Array(e.bytes.byteLength+1);return t.set(e.bytes,1),[new $e(Te.tag,42),new $e(Te.bytes,t)]},undefined:function AQ(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function TQ(r){if(Number.isNaN(r))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(r===1/0||r===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}},uC={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};uC.tags[42]=function IQ(r){if(0!==r[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return nn.decode(r.subarray(1))};const RQ="dag-cbor",l6=113,u6=r=>bl(r,CQ),ip=r=>Hi(r,uC);var NQ=Math.pow(2,31),kQ=Math.pow(2,7),UQ=Math.pow(2,14),MQ=Math.pow(2,21),FQ=Math.pow(2,28),zQ=Math.pow(2,35),VQ=Math.pow(2,42),jQ=Math.pow(2,49),$Q=Math.pow(2,56),KQ=Math.pow(2,63),HQ={encode:function fC(r,e,t){e=e||[];for(var n=t=t||0;r>=NQ;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,fC.bytes=t-n+1,e},decode:function d6(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw d6.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return d6.bytes=i-n,t},encodingLength:function(r){return r<kQ?1:r<UQ?2:r<MQ?3:r<FQ?4:r<zQ?5:r<VQ?6:r<jQ?7:r<$Q?8:r<KQ?9:10}};const op=HQ,f6=(r,e=0)=>[op.decode(r,e),op.decode.bytes],ap=(r,e,t=0)=>(op.encode(r,e,t),e),cp=r=>op.encodingLength(r),h6=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class p6{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const rJ=function qQ(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class nJ{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class sJ{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return pC(this,e)}}class iJ{constructor(e){this.decoders=e}or(e){return pC(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const pC=(r,e)=>new iJ({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class oJ{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new nJ(e,t,n),this.decoder=new sJ(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const yC=({name:r,prefix:e,encode:t,decode:n})=>new oJ(r,e,t,n),gC=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=rJ(t,e);return yC({prefix:r,name:e,encode:n,decode:i=>h6(s(i))})},Ks=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>yC({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),_a=gC({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),lp=(gC({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Ks({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),bC=(Ks({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ks({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ks({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ks({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ks({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ks({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ks({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ks({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),y6=r=>{const e=bC.get(r);if(null==e){const t=new Map;return bC.set(r,t),t}return e};class sn{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==kd)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==hJ)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return sn.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=((r,e)=>{const t=e.byteLength,n=cp(r),s=n+cp(t),i=new Uint8Array(s+t);return ap(r,i,0),ap(t,i,n),i.set(e,s),new p6(r,t,e,i)})(e,t);return sn.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return sn.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?dJ(t,y6(r),e||_a.encoder):fJ(t,y6(r),e||lp.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof sn)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new sn(n,s,i,o||_C(n,s,i.bytes))}if(!0===t[pJ]){const{version:n,multihash:s,code:i}=t,o=(r=>{const e=h6(r),[t,n]=f6(e),[s,i]=f6(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new p6(t,s,o,e)})(s);return sn.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==kd)throw new Error(`Version 0 CID must use dag-pb (code: ${kd}) block encoding`);return new sn(e,t,n,n.bytes);case 1:{const s=_C(e,t,n.bytes);return new sn(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return sn.create(0,kd,e)}static createV1(e,t){return sn.create(1,e,t)}static decode(e){const[t,n]=sn.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=sn.inspectBytes(e),n=t.size-t.multihashSize,s=h6(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new p6(t.multihashCode,t.digestSize,i,s);return[0===t.version?sn.createV0(o):sn.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=f6(e.subarray(t));return t+=T,E};let s=n(),i=kd;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=uJ(e,t),i=sn.decode(s);return y6(i).set(n,e),i}}const uJ=(r,e)=>{switch(r[0]){case"Q":return[_a.prefix,(e||_a).decode(`${_a.prefix}${r}`)];case _a.prefix:return[_a.prefix,(e||_a).decode(r)];case lp.prefix:return[lp.prefix,(e||lp).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},dJ=(r,e,t)=>{const{prefix:n}=t;if(n!==_a.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},fJ=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},kd=112,hJ=18,_C=(r,e,t)=>{const n=cp(r),s=n+cp(e),i=new Uint8Array(s+t.byteLength);return ap(r,i,0),ap(e,i,n),i.set(t,s),i},pJ=Symbol.for("@ipld/js-cid/CID"),mC=Ks({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Ks({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ks({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ks({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});class gJ extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){const t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===Te.array&&(t.elements++,1!==t.elements&&e.push([44])),t.type===Te.map&&(t.elements++,1!==t.elements&&e.push(t.elements%2==1?[44]:[58])))}[Te.uint.major](e,t){this.prefix(e);const n=String(t.value),s=[];for(let i=0;i<n.length;i++)s[i]=n.charCodeAt(i);e.push(s)}[Te.negint.major](e,t){this[Te.uint.major](e,t)}[Te.bytes.major](e,t){throw new Error(`${yc} unsupported type: Uint8Array`)}[Te.string.major](e,t){this.prefix(e);const n=VT(JSON.stringify(t.value));e.push(n.length>32?H3(n):n)}[Te.array.major](e,t){this.prefix(e),this.inRecursive.push({type:Te.array,elements:0}),e.push([91])}[Te.map.major](e,t){this.prefix(e),this.inRecursive.push({type:Te.map,elements:0}),e.push([123])}[Te.tag.major](e,t){}[Te.float.major](e,t){if("break"===t.type.name){const o=this.inRecursive.pop();if(o){if(o.type===Te.array)e.push([93]);else{if(o.type!==Te.map)throw new Error("Unexpected recursive type; this should not happen!");e.push([125])}return}throw new Error("Unexpected break; this should not happen!")}if(void 0===t.value)throw new Error(`${yc} unsupported type: undefined`);if(this.prefix(e),"true"===t.type.name)return void e.push([116,114,117,101]);if("false"===t.type.name)return void e.push([102,97,108,115,101]);if("null"===t.type.name)return void e.push([110,117,108,108]);const n=String(t.value),s=[];let i=!1;for(let o=0;o<n.length;o++)s[o]=n.charCodeAt(o),!i&&(46===s[o]||101===s[o]||69===s[o])&&(i=!0);i||(s.push(46),s.push(48)),e.push(s)}}const _J={addBreakTokens:!0,mapSorter:function bJ(r,e){if(Array.isArray(r[0])||Array.isArray(e[0]))throw new Error(`${yc} complex map keys are not supported`);const t=r[0],n=e[0];if(t.type!==Te.string||n.type!==Te.string)throw new Error(`${yc} non-string map keys are not supported`);if(t<n)return-1;if(t>n)return 1;throw new Error(`${yc} unexpected duplicate map keys, this is not supported`)}};class vC{constructor(e,t={}){this.pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;32===e||9===e||13===e||10===e;)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${ct} unexpected end of input at position ${this.pos}`);for(let t=0;t<e.length;t++)if(this.data[this.pos++]!==e[t])throw new Error(`${ct} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){const e=this.pos;let t=!1,n=!1;const s=a=>{for(;!this.done();){const c=this.ch();if(!a.includes(c))break;this.pos++}};if(45===this.ch()&&(t=!0,this.pos++),48===this.ch()){if(this.pos++,46!==this.ch())return new $e(Te.uint,0,this.pos-e);this.pos++,n=!0}if(s([48,49,50,51,52,53,54,55,56,57]),t&&this.pos===e+1)throw new Error(`${ct} unexpected token at position ${this.pos}`);if(!this.done()&&46===this.ch()){if(n)throw new Error(`${ct} unexpected token at position ${this.pos}`);n=!0,this.pos++,s([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(101===this.ch()||69===this.ch())&&(n=!0,this.pos++,!this.done()&&(43===this.ch()||45===this.ch())&&this.pos++,s([48,49,50,51,52,53,54,55,56,57]));const i=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),o=parseFloat(i);return n?new $e(Te.float,o,this.pos-e):!0!==this.options.allowBigInt||Number.isSafeInteger(o)?new $e(o>=0?Te.uint:Te.negint,o,this.pos-e):new $e(o>=0?Te.uint:Te.negint,BigInt(i),this.pos-e)}parseString(){if(34!==this.ch())throw new Error(`${ct} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let i=this.pos,o=0;i<this.data.length&&o<65536;i++,o++){const a=this.data[i];if(92===a||a<32||a>=128)break;if(34===a){const c=String.fromCharCode.apply(null,this.data.subarray(this.pos,i));return this.pos=i+1,new $e(Te.string,c,o)}}const e=this.pos,t=[],n=()=>{if(this.pos+4>=this.data.length)throw new Error(`${ct} unexpected end of unicode escape sequence at position ${this.pos}`);let i=0;for(let o=0;o<4;o++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else{if(!(a>=65&&a<=70))throw new Error(`${ct} unexpected unicode escape character at position ${this.pos}`);a=a-65+10}i=16*i+a,this.pos++}return i},s=()=>{const i=this.ch();let c,u,f,E,o=null,a=i>239?4:i>223?3:i>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${ct} unexpected unicode sequence at position ${this.pos}`);switch(a){case 1:i<128&&(o=i);break;case 2:c=this.data[this.pos+1],128==(192&c)&&(E=(31&i)<<6|63&c,E>127&&(o=E));break;case 3:c=this.data[this.pos+1],u=this.data[this.pos+2],128==(192&c)&&128==(192&u)&&(E=(15&i)<<12|(63&c)<<6|63&u,E>2047&&(E<55296||E>57343)&&(o=E));break;case 4:c=this.data[this.pos+1],u=this.data[this.pos+2],f=this.data[this.pos+3],128==(192&c)&&128==(192&u)&&128==(192&f)&&(E=(15&i)<<18|(63&c)<<12|(63&u)<<6|63&f,E>65535&&E<1114112&&(o=E))}null===o?(o=65533,a=1):o>65535&&(o-=65536,t.push(o>>>10&1023|55296),o=56320|1023&o),t.push(o),this.pos+=a};for(;!this.done();){const i=this.ch();let o;switch(i){case 92:if(this.pos++,this.done())throw new Error(`${ct} unexpected string termination at position ${this.pos}`);switch(o=this.ch(),this.pos++,o){case 34:case 39:case 92:case 47:t.push(o);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(n());break;default:throw new Error(`${ct} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new $e(Te.string,ZT(t),this.pos-e);default:if(i<32)throw new Error(`${ct} invalid control character at position ${this.pos}`);i<128?(t.push(i),this.pos++):s()}}throw new Error(`${ct} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new $e(Te.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new $e(Te.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new $e(Te.null,null,4);case 102:return this.expect([102,97,108,115,101]),new $e(Te.false,!1,5);case 116:return this.expect([116,114,117,101]),new $e(Te.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${ct} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this.pos++,this.skipWhitespace(),new $e(Te.break,void 0,1);if(44!==this.ch())throw new Error(`${ct} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this.pos++,this.skipWhitespace(),new $e(Te.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new $e(Te.break,void 0,1);if(44!==this.ch())throw new Error(`${ct} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this.pos++,this.skipWhitespace(),new $e(Te.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error(`${ct} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${ct} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}}function wC(r){const e=mC.encode(r).slice(1);return[new $e(Te.map,1/0,1),new $e(Te.string,"/",1),new $e(Te.map,1/0,1),new $e(Te.string,"bytes",5),new $e(Te.string,e,e.length),new $e(Te.break,void 0,1),new $e(Te.break,void 0,1)]}const SJ={typeEncoders:{Object:function wJ(r){if(r.asCID!==r&&r["/"]!==r.bytes)return null;const e=sn.asCID(r);if(!e)return null;const t=e.toString();return[new $e(Te.map,1/0,1),new $e(Te.string,"/",1),new $e(Te.string,t,t.length),new $e(Te.break,void 0,1)]},Uint8Array:wC,Buffer:wC,undefined:function EJ(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function xJ(r){if(Number.isNaN(r))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(r===1/0||r===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};class AJ extends vC{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===Te.map){const t=this._next();if(t.type===Te.string&&"/"===t.value){const n=this._next();if(n.type===Te.string){if(this._next().type!==Te.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(n),new $e(Te.tag,42,0)}if(n.type===Te.map){const s=this._next();if(s.type===Te.string&&"bytes"===s.value){const i=this._next();if(i.type===Te.string){for(let a=0;a<2;a++)if(this._next().type!==Te.break)throw new Error("Invalid encoded Bytes form");const o=mC.decode(`m${i.value}`);return new $e(Te.bytes,o,i.value.length)}this.tokenBuffer.push(i)}this.tokenBuffer.push(s)}this.tokenBuffer.push(n)}this.tokenBuffer.push(t)}return e}}const g6={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};g6.tags[42]=sn.parse;const TJ="dag-json",EC=297,CJ=r=>function mJ(r,e){return e=Object.assign({},_J,e),eC(r,new gJ,e)}(r,SJ),IJ=r=>function vJ(r,e){return Hi(r,e=Object.assign({tokenizer:new vC(r,e)},e))}(r,Object.assign(g6,{tokenizer:new AJ(r,g6)}));const PJ=function RJ(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},b6=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class LJ{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class kJ{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return xC(this,e)}}class UJ{constructor(e){this.decoders=e}or(e){return xC(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const xC=(r,e)=>new UJ({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class MJ{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new LJ(e,t,n),this.decoder=new kJ(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const SC=({name:r,prefix:e,encode:t,decode:n})=>new MJ(r,e,t,n),AC=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=PJ(t,e);return SC({prefix:r,name:e,encode:n,decode:i=>b6(s(i))})},Zs=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>SC({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),TC=(Zs({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Zs({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Zs({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}));function xo(r){return TC.encode(r).slice(1)}function Gi(r){return TC.decode(`u${r}`)}Zs({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var KJ=Math.pow(2,31),GJ=Math.pow(2,7),WJ=Math.pow(2,14),YJ=Math.pow(2,21),QJ=Math.pow(2,28),JJ=Math.pow(2,35),XJ=Math.pow(2,42),qJ=Math.pow(2,49),eX=Math.pow(2,56),tX=Math.pow(2,63),nX={encode:function IC(r,e,t){e=e||[];for(var n=t=t||0;r>=KJ;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,IC.bytes=t-n+1,e},decode:function _6(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw _6.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return _6.bytes=i-n,t},encodingLength:function(r){return r<GJ?1:r<WJ?2:r<YJ?3:r<QJ?4:r<JJ?5:r<XJ?6:r<qJ?7:r<eX?8:r<tX?9:10}};const up=nX,m6=(r,e=0)=>[up.decode(r,e),up.decode.bytes],dp=(r,e,t=0)=>(up.encode(r,e,t),e),fp=r=>up.encodingLength(r);class v6{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const ma=AC({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),hp=(AC({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Zs({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),DC=(Zs({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Zs({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Zs({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Zs({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Zs({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Zs({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Zs({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Zs({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),w6=r=>{const e=DC.get(r);if(null==e){const t=new Map;return DC.set(r,t),t}return e};class Xr{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Ud)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==fX)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Xr.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=((r,e)=>{const t=e.byteLength,n=fp(r),s=n+fp(t),i=new Uint8Array(s+t);return dp(r,i,0),dp(t,i,n),i.set(e,s),new v6(r,t,e,i)})(e,t);return Xr.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Xr.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?uX(t,w6(r),e||ma.encoder):dX(t,w6(r),e||hp.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Xr)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new Xr(n,s,i,o||OC(n,s,i.bytes))}if(!0===t[hX]){const{version:n,multihash:s,code:i}=t,o=(r=>{const e=b6(r),[t,n]=m6(e),[s,i]=m6(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new v6(t,s,o,e)})(s);return Xr.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Ud)throw new Error(`Version 0 CID must use dag-pb (code: ${Ud}) block encoding`);return new Xr(e,t,n,n.bytes);case 1:{const s=OC(e,t,n.bytes);return new Xr(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return Xr.create(0,Ud,e)}static createV1(e,t){return Xr.create(1,e,t)}static decode(e){const[t,n]=Xr.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Xr.inspectBytes(e),n=t.size-t.multihashSize,s=b6(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new v6(t.multihashCode,t.digestSize,i,s);return[0===t.version?Xr.createV0(o):Xr.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=m6(e.subarray(t));return t+=T,E};let s=n(),i=Ud;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=lX(e,t),i=Xr.decode(s);return w6(i).set(n,e),i}}const lX=(r,e)=>{switch(r[0]){case"Q":return[ma.prefix,(e||ma).decode(`${ma.prefix}${r}`)];case ma.prefix:return[ma.prefix,(e||ma).decode(r)];case hp.prefix:return[hp.prefix,(e||hp).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},uX=(r,e,t)=>{const{prefix:n}=t;if(n!==ma.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},dX=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},Ud=112,fX=18,OC=(r,e,t)=>{const n=fp(r),s=n+fp(e),i=new Uint8Array(s+t.byteLength);return dp(r,i,0),dp(e,i,n),i.set(t,s),i},hX=Symbol.for("@ipld/js-cid/CID");function yX(r){const e={signature:Gi(r.signature)};return r.header&&(e.header=r.header),r.protected&&(e.protected=Gi(r.protected)),e}function bX(r){const e={signature:xo(r.signature)};return r.header&&(e.header=r.header),r.protected&&(e.protected=xo(r.protected)),e}function vX(r){const e={};return r.encrypted_key&&(e.encrypted_key=Gi(r.encrypted_key)),r.header&&(e.header=r.header),e}function EX(r){const e={};return r.encrypted_key&&(e.encrypted_key=xo(r.encrypted_key)),r.header&&(e.header=r.header),e}const SX="dag-jose",AX=133;function PC(r){return"payload"in r&&"string"==typeof r.payload&&"signatures"in r&&Array.isArray(r.signatures)}function NC(r){return"ciphertext"in r&&"string"==typeof r.ciphertext&&"iv"in r&&"string"==typeof r.iv&&"protected"in r&&"string"==typeof r.protected&&"tag"in r&&"string"==typeof r.tag}function BC(r){if("string"==typeof r){const e=r.split(".");if(3===e.length)return function pX(r){const[e,t,n]=r;return{payload:t,signatures:[{protected:e,signature:n}],link:Xr.decode(Gi(t))}}(e);if(5===e.length)return function mX(r){const[e,t,n,s,i]=r,o={ciphertext:s,iv:n,protected:e,tag:i};return t&&(o.recipients=[{encrypted_key:t}]),o}(e);throw new Error("Not a valid JOSE string")}if(PC(r)||NC(r))return r;throw new Error("Not a valid unencoded JOSE object")}function IX(r){let e;if("string"==typeof r&&(r=BC(r)),PC(r))e=function gX(r){const e=Gi(r.payload);try{Xr.decode(e)}catch{throw new Error("Not a valid DagJWS")}return{payload:e,signatures:r.signatures.map(yX)}}(r);else{if(!NC(r))throw new Error("Not a valid JOSE object");e=function wX(r){const e={ciphertext:Gi(r.ciphertext),protected:Gi(r.protected),iv:Gi(r.iv),tag:Gi(r.tag)};return r.aad&&(e.aad=Gi(r.aad)),r.recipients&&(e.recipients=r.recipients.map(vX)),r.unprotected&&(e.unprotected=r.unprotected),e}(r)}return new Uint8Array(u6(e))}function RX(r){let e;try{e=ip(r)}catch{throw new Error("Not a valid DAG-JOSE object")}if(function TX(r){return"payload"in r&&r.payload instanceof Uint8Array&&"signatures"in r&&Array.isArray(r.signatures)}(e))return function _X(r){const e={payload:xo(r.payload),signatures:r.signatures.map(bX)};return e.link=Xr.decode(new Uint8Array(r.payload)),e}(e);if(function CX(r){return"ciphertext"in r&&r.ciphertext instanceof Uint8Array&&"iv"in r&&r.iv instanceof Uint8Array&&"protected"in r&&r.protected instanceof Uint8Array&&"tag"in r&&r.tag instanceof Uint8Array}(e))return function xX(r){const e={ciphertext:xo(r.ciphertext),protected:xo(r.protected),iv:xo(r.iv),tag:xo(r.tag)};return r.aad&&(e.aad=xo(r.aad)),r.recipients&&(e.recipients=r.recipients.map(EX)),r.unprotected&&(e.unprotected=r.unprotected),e}(e);throw new Error("Not a valid DAG-JOSE object")}new Uint8Array(0);const _l=r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")};var UX=Math.pow(2,31),zX=Math.pow(2,7),VX=Math.pow(2,14),jX=Math.pow(2,21),$X=Math.pow(2,28),KX=Math.pow(2,35),ZX=Math.pow(2,42),HX=Math.pow(2,49),GX=Math.pow(2,56),WX=Math.pow(2,63),QX={encode:function kC(r,e,t){e=e||[];for(var n=t=t||0;r>=UX;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,kC.bytes=t-n+1,e},decode:function E6(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw E6.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return E6.bytes=i-n,t},encodingLength:function(r){return r<zX?1:r<VX?2:r<jX?3:r<$X?4:r<KX?5:r<ZX?6:r<HX?7:r<GX?8:r<WX?9:10}};const pp=QX,x6=(r,e=0)=>[pp.decode(r,e),pp.decode.bytes],yp=(r,e,t=0)=>(pp.encode(r,e,t),e),gp=r=>pp.encodingLength(r),bp=(r,e)=>{const t=e.byteLength,n=gp(r),s=n+gp(t),i=new Uint8Array(s+t);return yp(r,i,0),yp(t,i,n),i.set(e,s),new S6(r,t,e,i)},MC=r=>{const e=_l(r),[t,n]=x6(e),[s,i]=x6(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new S6(t,s,o,e)};class S6{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const zC=_l,A6={code:0,name:"identity",encode:zC,digest:r=>bp(0,zC(r))};const nq=function eq(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class sq{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class iq{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return VC(this,e)}}class oq{constructor(e){this.decoders=e}or(e){return VC(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const VC=(r,e)=>new oq({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class aq{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new sq(e,t,n),this.decoder=new iq(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const _p=({name:r,prefix:e,encode:t,decode:n})=>new aq(r,e,t,n),Md=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=nq(t,e);return _p({prefix:r,name:e,encode:n,decode:i=>_l(s(i))})},bn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>_p({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),uq=_p({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),dq=bn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),fq=bn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),hq=Md({prefix:"9",name:"base10",alphabet:"0123456789"}),pq=bn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),yq=bn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Fd=bn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),gq=bn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),bq=bn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),_q=bn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),mq=bn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),vq=bn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),wq=bn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Eq=bn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),xq=bn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),mp=Md({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Sq=Md({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Hs=Md({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Aq=Md({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Tq=bn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Cq=bn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Iq=bn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Rq=bn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),jC=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),Dq=jC.reduce((r,e,t)=>(r[t]=e,r),[]),Oq=jC.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),Bq=_p({prefix:"\u{1f680}",name:"base256emoji",encode:function Pq(r){return r.reduce((e,t)=>e+Dq[t],"")},decode:function Nq(r){const e=[];for(const t of r){const n=Oq[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}}),$C=({name:r,code:e,encode:t})=>new Lq(r,e,t);class Lq{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?bp(this.code,t):t.then(n=>bp(this.code,n))}throw Error("Unknown type, must be binary type")}}const KC=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),ml=$C({name:"sha2-256",code:18,encode:KC("SHA-256")}),kq=$C({name:"sha2-512",code:19,encode:KC("SHA-512")}),Uq="raw",T6=85,Mq=r=>_l(r),Fq=r=>_l(r),zq=new TextEncoder,Vq=new TextDecoder,jq="json",ZC=512,$q=r=>zq.encode(JSON.stringify(r)),Kq=r=>JSON.parse(Vq.decode(r)),HC=new WeakMap,C6=r=>{const e=HC.get(r);if(null==e){const t=new Map;return HC.set(r,t),t}return e};class qe{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==zd)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Yq)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return qe.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=bp(e,t);return qe.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return qe.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?Gq(t,C6(r),e||Hs.encoder):Wq(t,C6(r),e||Fd.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof qe)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new qe(n,s,i,o||GC(n,s,i.bytes))}if(!0===t[Qq]){const{version:n,multihash:s,code:i}=t,o=MC(s);return qe.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==zd)throw new Error(`Version 0 CID must use dag-pb (code: ${zd}) block encoding`);return new qe(e,t,n,n.bytes);case 1:{const s=GC(e,t,n.bytes);return new qe(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return qe.create(0,zd,e)}static createV1(e,t){return qe.create(1,e,t)}static decode(e){const[t,n]=qe.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=qe.inspectBytes(e),n=t.size-t.multihashSize,s=_l(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new S6(t.multihashCode,t.digestSize,i,s);return[0===t.version?qe.createV0(o):qe.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=x6(e.subarray(t));return t+=T,E};let s=n(),i=zd;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=Hq(e,t),i=qe.decode(s);return C6(i).set(n,e),i}}const Hq=(r,e)=>{switch(r[0]){case"Q":return[Hs.prefix,(e||Hs).decode(`${Hs.prefix}${r}`)];case Hs.prefix:return[Hs.prefix,(e||Hs).decode(r)];case Fd.prefix:return[Fd.prefix,(e||Fd).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},Gq=(r,e,t)=>{const{prefix:n}=t;if(n!==Hs.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},Wq=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},zd=112,Yq=18,GC=(r,e,t)=>{const n=gp(r),s=n+gp(e),i=new Uint8Array(s+t.byteLength);return yp(r,i,0),yp(e,i,n),i.set(t,s),i},Qq=Symbol.for("@ipld/js-cid/CID"),I6={...l,...h,...y,..._,...A,...O,...x,...g,...v,...R},Jq={...N,...m},Xq={raw:D,json:k};let WC=(()=>{class r extends Error{constructor(t="not initialized"){super(t),this.name="NotInitializedError",this.code=r.code}}return r.code="ERR_NOT_INITIALIZED",r})(),R6=(()=>{class r extends Error{constructor(t="cannot re-initialize an initialized node"){super(t),this.name="AlreadyInitializedError",this.code=r.code}}return r.code="ERR_ALREADY_INITIALIZED",r})(),YC=(()=>{class r extends Error{constructor(t="not started"){super(t),this.name="NotStartedError",this.code=r.code}}return r.code="ERR_NOT_STARTED",r})(),qq=(()=>{class r extends Error{constructor(t="cannot start, already startin"){super(t),this.name="AlreadyStartingError",this.code=r.code}}return r.code="ERR_ALREADY_STARTING",r})(),eee=(()=>{class r extends Error{constructor(t="cannot start, already started"){super(t),this.name="AlreadyStartedError",this.code=r.code}}return r.code="ERR_ALREADY_STARTED",r})(),D6=(()=>{class r extends Error{constructor(t="not enabled"){super(t),this.name="NotEnabledError",this.code=r.code}}return r.code="ERR_NOT_ENABLED",r})();function O6(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function QC(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?O6(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function JC(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const XC=JC("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),P6=JC("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=QC((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),qC={utf8:XC,"utf-8":XC,hex:I6.base16,latin1:P6,ascii:P6,binary:P6,...I6};function va(r,e="utf8"){const t=qC[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):O6(globalThis.Buffer.from(r,"utf-8"))}var Ar=p(62148);function X(r){return new mT(r)}function be(r){var e,t,n,s=2;for(typeof Symbol<"u"&&(t=Symbol.asyncIterator,n=Symbol.iterator);s--;){if(t&&null!=(e=r[t]))return e.call(r);if(n&&null!=(e=r[n]))return new vp(e.call(r));t="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function vp(r){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var n=t.done;return Promise.resolve(t.value).then(function(s){return{value:s,done:n}})}return(vp=function(n){this.s=n,this.n=n.next}).prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(n){var s=this.s.return;return void 0===s?Promise.resolve({value:n,done:!0}):e(s.apply(this.s,arguments))},throw:function(n){var s=this.s.return;return void 0===s?Promise.reject(n):e(s.apply(this.s,arguments))}},new vp(r)}const see=function tee(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},vl=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class lee{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class uee{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return eI(this,e)}}class dee{constructor(e){this.decoders=e}or(e){return eI(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const eI=(r,e)=>new dee({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class fee{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new lee(e,t,n),this.decoder=new uee(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const wp=({name:r,prefix:e,encode:t,decode:n})=>new fee(r,e,t,n),Vd=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=see(t,e);return wp({prefix:r,name:e,encode:n,decode:i=>vl(s(i))})},_n=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>wp({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),So=Vd({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),yee=Vd({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),jd=_n({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),gee=_n({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),bee=_n({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),_ee=_n({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),mee=_n({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),vee=_n({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),wee=_n({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Eee=_n({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),xee=_n({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Cee=Math.pow(2,31),Dee=Math.pow(2,7),Oee=Math.pow(2,14),Pee=Math.pow(2,21),Nee=Math.pow(2,28),Bee=Math.pow(2,35),Lee=Math.pow(2,42),kee=Math.pow(2,49),Uee=Math.pow(2,56),Mee=Math.pow(2,63),zee={encode:function rI(r,e,t){e=e||[];for(var n=t=t||0;r>=Cee;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,rI.bytes=t-n+1,e},decode:function N6(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw N6.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return N6.bytes=i-n,t},encodingLength:function(r){return r<Dee?1:r<Oee?2:r<Pee?3:r<Nee?4:r<Bee?5:r<Lee?6:r<kee?7:r<Uee?8:r<Mee?9:10}};const Ep=zee,B6=(r,e=0)=>[Ep.decode(r,e),Ep.decode.bytes],xp=(r,e,t=0)=>(Ep.encode(r,e,t),e),Sp=r=>Ep.encodingLength(r),Ap=(r,e)=>{const t=e.byteLength,n=Sp(r),s=n+Sp(t),i=new Uint8Array(s+t);return xp(r,i,0),xp(t,i,n),i.set(e,s),new L6(r,t,e,i)};class L6{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}function Tp(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}const wl=new class Kee{constructor(){Tp(this,"index",0),Tp(this,"input","")}new(e){return this.index=0,this.input=e,this}readAtomically(e){const t=this.index,n=e();return void 0===n&&(this.index=t),n}parseWith(e){const t=e();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically(()=>{const t=this.readChar();if(t===e)return t})}readSeparator(e,t,n){return this.readAtomically(()=>{if(!(t>0&&void 0===this.readGivenChar(e)))return n()})}readNumber(e,t,n,s){return this.readAtomically(()=>{let i=0,o=0;const a=this.peekChar();if(void 0===a)return;const c="0"===a,u=2**(8*s)-1;for(;;){const f=this.readAtomically(()=>{const E=this.readChar();if(void 0===E)return;const T=Number.parseInt(E,e);return Number.isNaN(T)?void 0:T});if(void 0===f)break;if(i*=e,i+=f,i>u||(o+=1,void 0!==t&&o>t))return}return 0!==o?!n&&c&&o>1?void 0:i:void 0})}readIPv4Addr(){return this.readAtomically(()=>{const e=new Uint8Array(4);for(let t=0;t<e.length;t++){const n=this.readSeparator(".",t,()=>this.readNumber(10,3,!1,1));if(void 0===n)return;e[t]=n}return e})}readIPv6Addr(){const e=t=>{for(let n=0;n<t.length/2;n++){const s=2*n;if(n<t.length-3){const o=this.readSeparator(":",n,()=>this.readIPv4Addr());if(void 0!==o)return t[s]=o[0],t[s+1]=o[1],t[s+2]=o[2],t[s+3]=o[3],[s+4,!0]}const i=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(void 0===i)return[s,!1];t[s]=i>>8,t[s+1]=255&i}return[t.length,!1]};return this.readAtomically(()=>{const t=new Uint8Array(16),[n,s]=e(t);if(16===n)return t;if(s||void 0===this.readGivenChar(":")||void 0===this.readGivenChar(":"))return;const i=new Uint8Array(14),o=16-(n+2),[a]=e(i.subarray(0,o));return t.set(i.subarray(0,a),16-a),t})}readIPAddr(){var e;return null!==(e=this.readIPv4Addr())&&void 0!==e?e:this.readIPv6Addr()}};function aI(r){return Boolean(function Wee(r){if(!(r.length>45))return wl.new(r).parseWith(()=>wl.readIPAddr())}(r))}const Xee=function Yee(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},El=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class nte{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ste{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return cI(this,e)}}class ite{constructor(e){this.decoders=e}or(e){return cI(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const cI=(r,e)=>new ite({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class ote{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new nte(e,t,n),this.decoder=new ste(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Cp=({name:r,prefix:e,encode:t,decode:n})=>new ote(r,e,t,n),$d=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=Xee(t,e);return Cp({prefix:r,name:e,encode:n,decode:i=>El(s(i))})},mn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Cp({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),lte=Cp({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),ute=mn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),dte=mn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),fte=$d({prefix:"9",name:"base10",alphabet:"0123456789"}),hte=mn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),pte=mn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),wc=mn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),yte=mn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),gte=mn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),bte=mn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),_te=mn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),mte=mn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),vte=mn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),wte=mn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ete=mn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),xte=$d({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ste=$d({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),mi=$d({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ate=$d({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Tte=mn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Cte=mn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ite=mn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Rte=mn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),lI=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),Dte=lI.reduce((r,e,t)=>(r[t]=e,r),[]),Ote=lI.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),Bte=Cp({prefix:"\u{1f680}",name:"base256emoji",encode:function Pte(r){return r.reduce((e,t)=>e+Dte[t],"")},decode:function Nte(r){const e=[];for(const t of r){const n=Ote[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var Mte=Math.pow(2,31),Vte=Math.pow(2,7),jte=Math.pow(2,14),$te=Math.pow(2,21),Kte=Math.pow(2,28),Zte=Math.pow(2,35),Hte=Math.pow(2,42),Gte=Math.pow(2,49),Wte=Math.pow(2,56),Yte=Math.pow(2,63),Jte={encode:function dI(r,e,t){e=e||[];for(var n=t=t||0;r>=Mte;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,dI.bytes=t-n+1,e},decode:function k6(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw k6.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return k6.bytes=i-n,t},encodingLength:function(r){return r<Vte?1:r<jte?2:r<$te?3:r<Kte?4:r<Zte?5:r<Hte?6:r<Gte?7:r<Wte?8:r<Yte?9:10}};const Ip=Jte,U6=(r,e=0)=>[Ip.decode(r,e),Ip.decode.bytes],Rp=(r,e,t=0)=>(Ip.encode(r,e,t),e),Dp=r=>Ip.encodingLength(r),Op=(r,e)=>{const t=e.byteLength,n=Dp(r),s=n+Dp(t),i=new Uint8Array(s+t);return Rp(r,i,0),Rp(t,i,n),i.set(e,s),new M6(r,t,e,i)},hI=r=>{const e=El(r),[t,n]=U6(e),[s,i]=U6(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new M6(t,s,o,e)};class M6{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const pI=({name:r,code:e,encode:t})=>new ere(r,e,t);class ere{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Op(this.code,t):t.then(n=>Op(this.code,n))}throw Error("Unknown type, must be binary type")}}const yI=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),tre=pI({name:"sha2-256",code:18,encode:yI("SHA-256")}),rre=pI({name:"sha2-512",code:19,encode:yI("SHA-512")}),bI=El,sre={code:0,name:"identity",encode:bI,digest:r=>Op(0,bI(r))},ire="raw",ore=85,are=r=>El(r),cre=r=>El(r),lre=new TextEncoder,ure=new TextDecoder,dre="json",fre=512,hre=r=>lre.encode(JSON.stringify(r)),pre=r=>JSON.parse(ure.decode(r)),_I=new WeakMap,F6=r=>{const e=_I.get(r);if(null==e){const t=new Map;return _I.set(r,t),t}return e};class on{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Kd)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==mre)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return on.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=Op(e,t);return on.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return on.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?bre(t,F6(r),e||mi.encoder):_re(t,F6(r),e||wc.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof on)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new on(n,s,i,o||mI(n,s,i.bytes))}if(!0===t[vre]){const{version:n,multihash:s,code:i}=t,o=hI(s);return on.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Kd)throw new Error(`Version 0 CID must use dag-pb (code: ${Kd}) block encoding`);return new on(e,t,n,n.bytes);case 1:{const s=mI(e,t,n.bytes);return new on(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return on.create(0,Kd,e)}static createV1(e,t){return on.create(1,e,t)}static decode(e){const[t,n]=on.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=on.inspectBytes(e),n=t.size-t.multihashSize,s=El(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new M6(t.multihashCode,t.digestSize,i,s);return[0===t.version?on.createV0(o):on.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=U6(e.subarray(t));return t+=T,E};let s=n(),i=Kd;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=gre(e,t),i=on.decode(s);return F6(i).set(n,e),i}}const gre=(r,e)=>{switch(r[0]){case"Q":return[mi.prefix,(e||mi).decode(`${mi.prefix}${r}`)];case mi.prefix:return[mi.prefix,(e||mi).decode(r)];case wc.prefix:return[wc.prefix,(e||wc).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},bre=(r,e,t)=>{const{prefix:n}=t;if(n!==mi.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},_re=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},Kd=112,mre=18,mI=(r,e,t)=>{const n=Dp(r),s=n+Dp(e),i=new Uint8Array(s+t.byteLength);return Rp(r,i,0),Rp(e,i,n),i.set(t,s),i},vre=Symbol.for("@ipld/js-cid/CID"),z6={...L,...K,...G,...C,...z,...te,...Z,...se,...ue,...oe};function V6(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function vI(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?V6(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function wI(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const EI=wI("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),j6=wI("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=vI((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),xI={utf8:EI,"utf-8":EI,hex:z6.base16,latin1:j6,ascii:j6,binary:j6,...z6};function vi(r,e="utf8"){const t=xI[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}const SI=function iI(r){return Boolean(function Hee(r){if(!(r.length>15))return wl.new(r).parseWith(()=>wl.readIPv4Addr())}(r))},wre=function oI(r){return Boolean(function Gee(r){if(!(r.length>45))return wl.new(r).parseWith(()=>wl.readIPv6Addr())}(r))},AI=function(r){let e=0;if(r=r.toString().trim(),SI(r)){const t=new Uint8Array(e+4);return r.split(/\./g).forEach(n=>{t[e++]=255&parseInt(n,10)}),t}if(wre(r)){const t=r.split(":",8);let n;for(n=0;n<t.length;n++){let o;SI(t[n])&&(o=AI(t[n]),t[n]=vi(o.slice(0,2),"base16")),null!=o&&++n<8&&t.splice(n,0,vi(o.slice(2,4),"base16"))}if(""===t[0])for(;t.length<8;)t.unshift("0");else if(""===t[t.length-1])for(;t.length<8;)t.push("0");else if(t.length<8){for(n=0;n<t.length&&""!==t[n];n++);const i=[n,1];for(n=9-t.length;n>0;n--)i.push("0");t.splice.apply(t,i)}const s=new Uint8Array(e+16);for(n=0;n<t.length;n++){const i=parseInt(t[n],16);s[e++]=i>>8&255,s[e++]=255&i}return s}throw new Error("invalid ip address")},wi=-1,Pp={},$6={};function jr(r){if("number"==typeof r){if(null!=$6[r])return $6[r];throw new Error(`no protocol with code: ${r}`)}if("string"==typeof r){if(null!=Pp[r])return Pp[r];throw new Error(`no protocol with name: ${r}`)}throw new Error("invalid protocol id type: "+typeof r)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,wi,"ip6zone"],[53,wi,"dns",!0],[54,wi,"dns4",!0],[55,wi,"dns6",!0],[56,wi,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,wi,"unix",!1,!0],[421,wi,"ipfs"],[421,wi,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,wi,"garlic64"],[460,0,"quic"],[465,0,"webtransport"],[466,wi,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,wi,"memory"]].forEach(r=>{const e=function xre(r,e,t,n,s){return{code:r,size:e,name:t,resolvable:Boolean(n),path:Boolean(s)}}(...r);$6[e.code]=e,Pp[e.name]=e});var vt=p(67213);function TI(r,e="utf8"){const t=xI[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):V6(globalThis.Buffer.from(r,"utf-8"))}function Ec(r,e){null==e&&(e=r.reduce((s,i)=>s+i.length,0));const t=vI(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return V6(t)}function CI(r,e){switch(jr(r).code){case 4:case 41:return function Are(r){const e=function(r,e=0,t){var n;e=~~e,t=null!==(n=t)&&void 0!==n?n:r.length-e;const s=new DataView(r.buffer);if(4===t){const i=[];for(let o=0;o<t;o++)i.push(r[e+o]);return i.join(".")}if(16===t){const i=[];for(let o=0;o<t;o+=2)i.push(s.getUint16(e+o).toString(16));return i.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""}(r,0,r.length);if(null==e)throw new Error("ipBuff is required");if(!aI(e))throw new Error("invalid ip address");return e}(e);case 6:case 273:case 33:case 132:return DI(e).toString();case 53:case 54:case 55:case 56:case 400:case 777:return function Cre(r){const e=vt.decode(r);if((r=r.slice(vt.decode.bytes)).length!==e)throw new Error("inconsistent lengths");return vi(r)}(e);case 421:return function Ore(r){const e=vt.decode(r),t=r.slice(vt.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return vi(t,"base58btc")}(e);case 444:case 445:return function OI(r){const e=r.slice(0,r.length-2),t=r.slice(r.length-2);return`${vi(e,"base32")}:${DI(t)}`}(e);case 466:return function Dre(r){const e=vt.decode(r),t=r.slice(vt.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return"u"+vi(t,"base64url")}(e);default:return vi(e,"base16")}}function II(r,e){switch(jr(r).code){case 4:case 41:return function RI(r){if(!aI(r))throw new Error("invalid ip address");return AI(r)}(e);case 6:case 273:case 33:case 132:return Z6(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 777:return function Tre(r){const e=TI(r),t=Uint8Array.from(vt.encode(e.length));return Ec([t,e],t.length+e.length)}(e);case 421:return function Ire(r){let e;e="Q"===r[0]||"1"===r[0]?hI(mi.decode(`z${r}`)).bytes:on.parse(r).multihash.bytes;const t=Uint8Array.from(vt.encode(e.length));return Ec([t,e],t.length+e.length)}(e);case 444:return function Pre(r){const e=r.split(":");if(2!==e.length)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(16!==e[0].length)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);const t=wc.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=Z6(n);return Ec([t,s],t.length+s.length)}(e);case 445:return function Nre(r){const e=r.split(":");if(2!==e.length)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(56!==e[0].length)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);const t=wc.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=Z6(n);return Ec([t,s],t.length+s.length)}(e);case 466:return function Rre(r){const e=Sre.decode(r),t=Uint8Array.from(vt.encode(e.length));return Ec([t,e],t.length+e.length)}(e);default:return TI(e,"base16")}}const K6=Object.values(z6).map(r=>r.decoder),Sre=function(){let r=K6[0].or(K6[1]);return K6.slice(2).forEach(e=>r=r.or(e)),r}();function Z6(r){const e=new ArrayBuffer(2);return new DataView(e).setUint16(0,r),new Uint8Array(e)}function DI(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function PI(r){return r.map(e=>{const t=Np(e);return null!=e[1]?[t.code,CI(t.code,e[1])]:[t.code]})}function NI(r){return G6(Ec(r.map(e=>{const t=Np(e);let n=Uint8Array.from(vt.encode(t.code));return e.length>1&&null!=e[1]&&(n=Ec([n,e[1]])),n})))}function BI(r,e){return r.size>0?r.size/8:0===r.size?0:vt.decode(e)+vt.decode.bytes}function H6(r){const e=[];let t=0;for(;t<r.length;){const n=vt.decode(r,t),s=vt.decode.bytes,o=BI(jr(n),r.slice(t+s));if(0===o){e.push([n]),t+=s;continue}const a=r.slice(t+s,t+s+o);if(t+=o+s,t>r.length)throw UI("Invalid address Uint8Array: "+vi(r,"base16"));e.push([n,a])}return e}function LI(r){return function Lre(r){const e=[];return r.map(t=>{const n=Np(t);return e.push(n.name),t.length>1&&null!=t[1]&&e.push(t[1]),null}),W6(e.join("/"))}(PI(H6(r)))}function G6(r){const e=function kI(r){try{H6(r)}catch(e){return e}}(r);if(null!=e)throw e;return Uint8Array.from(r)}function W6(r){return"/"+r.trim().split("/").filter(e=>e).join("/")}function UI(r){return new Error("Error parsing address: "+r)}function Np(r){return jr(r[0])}var Zd,Hd,Gd,MI,xl=function(r,e,t,n){if("a"===t&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?n:"a"===t?n.call(r):n?n.value:e.get(r)},Y6=function(r,e,t,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(r,t):s?s.value=t:e.set(r,t),t};const zre=Symbol.for("nodejs.util.inspect.custom"),FI=[jr("dns").code,jr("dns4").code,jr("dns6").code,jr("dnsaddr").code],Vre=[jr("p2p").code,jr("ipfs").code],zI=new Map,VI=Symbol.for("@multiformats/js-multiaddr/multiaddr");function jre(r,e){if(null==r)throw new Error("requires node address object");if(null==e)throw new Error("requires transport protocol");let t;switch(r.family){case 4:t="ip4";break;case 6:t="ip6";break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new wa("/"+[t,r.address,e,r.port].join("/"))}function Sl(r){return Boolean(r?.[VI])}class wa{constructor(e){if(Zd.set(this,void 0),Hd.set(this,void 0),Gd.set(this,void 0),this[MI]=!0,null==e&&(e=""),e instanceof Uint8Array)this.bytes=G6(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=function Mre(r){return function Ure(r){const e=function Bre(r){const e=[],t=r.split("/").slice(1);if(1===t.length&&""===t[0])return[];for(let n=0;n<t.length;n++){const s=t[n],i=jr(s);if(0!==i.size){if(n++,n>=t.length)throw UI("invalid address: "+r);if(!0===i.path){e.push([s,W6(t.slice(n).join("/"))]);break}e.push([s,t[n]])}else e.push([s])}return e}(r=W6(r)),t=function kre(r){return r.map(e=>{Array.isArray(e)||(e=[e]);const t=Np(e);return e.length>1?[t.code,II(t.code,e[1])]:[t.code]})}(e);return NI(t)}(r)}(e)}else{if(!Sl(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=G6(e.bytes)}}toString(){return null==xl(this,Zd,"f")&&Y6(this,Zd,LI(this.bytes),"f"),xl(this,Zd,"f")}toJSON(){return this.toString()}toOptions(){const e=this.protoCodes(),t=this.toString().split("/").slice(1);let n,s;if(t.length>2)FI.includes(e[0])&&Vre.includes(e[1])?(n=jr("tcp").name,s=443):(n=jr(t[2]).name,s=parseInt(t[3]));else{if(!FI.includes(e[0]))throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');n=jr("tcp").name,s=443}return{family:41===e[0]||55===e[0]?6:4,host:t[1],transport:n,port:s}}protos(){return this.protoCodes().map(e=>Object.assign({},jr(e)))}protoCodes(){const e=[],t=this.bytes;let n=0;for(;n<t.length;){const s=vt.decode(t,n),i=vt.decode.bytes;n+=BI(jr(s),t.slice(n+i))+i,e.push(s)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return null==xl(this,Hd,"f")&&Y6(this,Hd,H6(this.bytes),"f"),xl(this,Hd,"f")}stringTuples(){return null==xl(this,Gd,"f")&&Y6(this,Gd,PI(this.tuples()),"f"),xl(this,Gd,"f")}encapsulate(e){return e=new wa(e),new wa(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),s=n.lastIndexOf(t);if(s<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new wa(n.slice(0,s))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new wa(NI(t.slice(0,n)));return this}getPeerId(){try{const t=this.stringTuples().filter(n=>n[0]===Pp.ipfs.code).pop();if(null!=t?.[1]){const n=t[1];return vi("Q"===n[0]||"1"===n[0]?mi.decode(`z${n}`):on.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>!0===jr(t[0]).path)[0][1],null==e&&(e=null)}catch{e=null}return e}equals(e){return function Fre(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}(this.bytes,e.bytes)}resolve(e){var t=this;return(0,B.Z)(function*(){const n=t.protos().find(o=>o.resolvable);if(null==n)return[t];const s=zI.get(n.name);if(null==s)throw ee(new Error(`no available resolver for ${n.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(yield s(t,e)).map(o=>new wa(o))})()}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return!(2!==t.length||4!==t[0].code&&41!==t[0].code||6!==t[1].code&&273!==t[1].code)}[(Zd=new WeakMap,Hd=new WeakMap,Gd=new WeakMap,MI=VI,zre)](){return this.inspect()}inspect(){return"<Multiaddr "+vi(this.bytes,"base16")+" - "+LI(this.bytes)+">"}}function at(r){return new wa(r)}const Kre=ut("dns4"),Zre=ut("dns6"),Hre=ut("dnsaddr"),xc=qn(ut("dns"),Hre,Kre,Zre),Bp=qn(ut("ip4"),ut("ip6")),Wd=qn(mt(Bp,ut("tcp")),mt(xc,ut("tcp"))),jI=mt(Bp,ut("udp")),Gre=mt(jI,ut("utp")),Wre=mt(jI,ut("quic")),Al=qn(mt(Wd,ut("ws")),mt(xc,ut("ws"))),Sc=qn(mt(Wd,ut("wss")),mt(xc,ut("wss"))),Q6=qn(mt(Wd,ut("http")),mt(Bp,ut("http")),mt(xc,ut("http"))),J6=qn(mt(Wd,ut("https")),mt(Bp,ut("https")),mt(xc,ut("https"))),X6=qn(mt(Al,ut("p2p-webrtc-star"),ut("p2p")),mt(Sc,ut("p2p-webrtc-star"),ut("p2p")),mt(Al,ut("p2p-webrtc-star")),mt(Sc,ut("p2p-webrtc-star"))),$I=(qn(mt(Al,ut("p2p-websocket-star"),ut("p2p")),mt(Sc,ut("p2p-websocket-star"),ut("p2p")),mt(Al,ut("p2p-websocket-star")),mt(Sc,ut("p2p-websocket-star"))),qn(mt(Q6,ut("p2p-webrtc-direct"),ut("p2p")),mt(J6,ut("p2p-webrtc-direct"),ut("p2p")),mt(Q6,ut("p2p-webrtc-direct")),mt(J6,ut("p2p-webrtc-direct")))),Yd=qn(Al,Sc,Q6,J6,X6,$I,Wd,Gre,Wre,xc),Ea=(qn(mt(Yd,ut("p2p-stardust"),ut("p2p")),mt(Yd,ut("p2p-stardust"))),qn(mt(Yd,ut("p2p")),X6,$I,ut("p2p"))),KI=qn(mt(Ea,ut("p2p-circuit"),Ea),mt(Ea,ut("p2p-circuit")),mt(ut("p2p-circuit"),Ea),mt(Yd,ut("p2p-circuit")),mt(ut("p2p-circuit"),Yd),ut("p2p-circuit")),ZI=()=>qn(mt(KI,ZI),KI),Tl=ZI(),HI=qn(mt(Tl,Ea,Tl),mt(Ea,Tl),mt(Tl,Ea),Tl,Ea),Yre=HI;function GI(r){return function e(t){let n;try{n=at(t)}catch{return!1}const s=r(n.protoNames());return null!==s&&(!0===s||!1===s?s:0===s.length)}}function mt(...r){function e(t){if(t.length<r.length)return null;let n=t;return r.some(s=>(n="function"==typeof s?s().partialMatch(t):s.partialMatch(t),Array.isArray(n)&&(t=n),null===n)),n}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:GI(e),partialMatch:e}}function qn(...r){function e(n){let s=null;return r.some(i=>{const o="function"==typeof i?i().partialMatch(n):i.partialMatch(n);return null!=o&&(s=o,!0)}),s}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:GI(e),partialMatch:e}}function ut(r){const e=r;return{toString:function(){return e},matches:function t(s){let i;try{i=at(s)}catch{return!1}const o=i.protoNames();return 1===o.length&&o[0]===e},partialMatch:function n(s){return 0===s.length?null:s[0]===e?s.slice(1):null}}}const WI=new WeakMap,q6=r=>{const e=WI.get(r);if(null==e){const t=new Map;return WI.set(r,t),t}return e};class qr{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Qd)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==ene)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return qr.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=Ap(e,t);return qr.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return qr.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?Xre(t,q6(r),e||So.encoder):qre(t,q6(r),e||jd.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof qr)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new qr(n,s,i,o||YI(n,s,i.bytes))}if(!0===t[tne]){const{version:n,multihash:s,code:i}=t,o=(r=>{const e=vl(r),[t,n]=B6(e),[s,i]=B6(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new L6(t,s,o,e)})(s);return qr.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Qd)throw new Error(`Version 0 CID must use dag-pb (code: ${Qd}) block encoding`);return new qr(e,t,n,n.bytes);case 1:{const s=YI(e,t,n.bytes);return new qr(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return qr.create(0,Qd,e)}static createV1(e,t){return qr.create(1,e,t)}static decode(e){const[t,n]=qr.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=qr.inspectBytes(e),n=t.size-t.multihashSize,s=vl(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new L6(t.multihashCode,t.digestSize,i,s);return[0===t.version?qr.createV0(o):qr.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=B6(e.subarray(t));return t+=T,E};let s=n(),i=Qd;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=Jre(e,t),i=qr.decode(s);return q6(i).set(n,e),i}}const Jre=(r,e)=>{switch(r[0]){case"Q":return[So.prefix,(e||So).decode(`${So.prefix}${r}`)];case So.prefix:return[So.prefix,(e||So).decode(r)];case jd.prefix:return[jd.prefix,(e||jd).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},Xre=(r,e,t)=>{const{prefix:n}=t;if(n!==So.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},qre=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},Qd=112,ene=18,YI=(r,e,t)=>{const n=Sp(r),s=n+Sp(e),i=new Uint8Array(s+t.byteLength);return xp(r,i,0),xp(e,i,n),i.set(t,s),i},tne=Symbol.for("@ipld/js-cid/CID");var QI=p(47634);const rne=wp({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),nne=_n({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),sne=_n({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ine=Vd({prefix:"9",name:"base10",alphabet:"0123456789"}),one=_n({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ane=_n({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),cne=Vd({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),lne=Vd({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),une=_n({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),dne=_n({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),fne=_n({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),hne=_n({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),JI=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),pne=JI.reduce((r,e,t)=>(r[t]=e,r),[]),yne=JI.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),_ne=wp({prefix:"\u{1f680}",name:"base256emoji",encode:function gne(r){return r.reduce((e,t)=>e+pne[t],"")},decode:function bne(r){const e=[];for(const t of r){const n=yne[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}}),XI=({name:r,code:e,encode:t})=>new mne(r,e,t);class mne{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ap(this.code,t):t.then(n=>Ap(this.code,n))}throw Error("Unknown type, must be binary type")}}const qI=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),vne=XI({name:"sha2-256",code:18,encode:qI("SHA-256")}),wne=XI({name:"sha2-512",code:19,encode:qI("SHA-512")}),tR=vl,xne={code:0,name:"identity",encode:tR,digest:r=>Ap(0,tR(r))},Sne="raw",Ane=85,Tne=r=>vl(r),Cne=r=>vl(r),Ine=new TextEncoder,Rne=new TextDecoder,Dne="json",One=512,Pne=r=>Ine.encode(JSON.stringify(r)),Nne=r=>JSON.parse(Rne.decode(r)),rR={...ce,..._e,...de,...ye,...we,...Q,...xe,...j,...Ae,...Re};function nR(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const sR=nR("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),e5=nR("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function Lne(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?function Bne(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),kne={utf8:sR,"utf-8":sR,hex:rR.base16,latin1:e5,ascii:e5,binary:e5,...rR},Jd=/^\/(ip[fn]s)\/([^/?#]+)/,Lp=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,Mne=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function Xd(r){try{return Up(r)?Boolean(qr.parse(r)):r instanceof Uint8Array?Boolean(qr.decode(r)):Boolean(qr.asCID(r))}catch{return!1}}function qd(r,e,t=1,n=2){const s=t5(r);if(!1===s)return!1;const i=s.match(e);if(null==i||"ipfs"!==i[t])return!1;let o=i[n];return null!=o&&e===Lp&&(o=o.toLowerCase()),Xd(o)}function kp(r,e,t=1,n=2){const s=t5(r);if(!1===s)return!1;const i=s.match(e);if(null==i||"ipns"!==i[t])return!1;let o=i[n];if(null!=o&&e===Lp){if(o=o.toLowerCase(),Xd(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));const{hostname:a}=new QI.URL(`http://${o}`);return Mne.test(a)}catch{return!1}}return!0}function Up(r){return"string"==typeof r}function t5(r){return r instanceof Uint8Array?function Une(r,e="utf8"){const t=kne[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}(r,"base58btc"):!!Up(r)&&r}const r5=r=>qd(r,Jd)||kp(r,Jd),fR=r=>kp(r,Jd);const Xne=function Yne(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},Mp=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class rse{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class nse{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return hR(this,e)}}class sse{constructor(e){this.decoders=e}or(e){return hR(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const hR=(r,e)=>new sse({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class ise{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new rse(e,t,n),this.decoder=new nse(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Fp=({name:r,prefix:e,encode:t,decode:n})=>new ise(r,e,t,n),ef=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=Xne(t,e);return Fp({prefix:r,name:e,encode:n,decode:i=>Mp(s(i))})},vn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Fp({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),cse=Fp({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),lse=vn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),use=vn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),dse=ef({prefix:"9",name:"base10",alphabet:"0123456789"}),fse=vn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),hse=vn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),pse=vn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),yse=vn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),gse=vn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),bse=vn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),_se=vn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),mse=vn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),vse=vn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),wse=vn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ese=vn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),xse=ef({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Sse=ef({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Ase=ef({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Tse=ef({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Cse=vn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ise=vn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Rse=vn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Dse=vn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),pR=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),Ose=pR.reduce((r,e,t)=>(r[t]=e,r),[]),Pse=pR.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),Lse=Fp({prefix:"\u{1f680}",name:"base256emoji",encode:function Nse(r){return r.reduce((e,t)=>e+Ose[t],"")},decode:function Bse(r){const e=[];for(const t of r){const n=Pse[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var Fse=Math.pow(2,31),jse=Math.pow(2,7),$se=Math.pow(2,14),Kse=Math.pow(2,21),Zse=Math.pow(2,28),Hse=Math.pow(2,35),Gse=Math.pow(2,42),Wse=Math.pow(2,49),Yse=Math.pow(2,56),Qse=Math.pow(2,63),Xse={encode:function gR(r,e,t){e=e||[];for(var n=t=t||0;r>=Fse;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,gR.bytes=t-n+1,e},decode:function n5(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw n5.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return n5.bytes=i-n,t},encodingLength:function(r){return r<jse?1:r<$se?2:r<Kse?3:r<Zse?4:r<Hse?5:r<Gse?6:r<Wse?7:r<Yse?8:r<Qse?9:10}};const _R=Xse,mR=(r,e,t=0)=>(_R.encode(r,e,t),e),vR=r=>_R.encodingLength(r),s5=(r,e)=>{const t=e.byteLength,n=vR(r),s=n+vR(t),i=new Uint8Array(s+t);return mR(r,i,0),mR(t,i,n),i.set(e,s),new wR(r,t,e,i)};class wR{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const ER=({name:r,code:e,encode:t})=>new eie(r,e,t);class eie{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?s5(this.code,t):t.then(n=>s5(this.code,n))}throw Error("Unknown type, must be binary type")}}const xR=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),tie=ER({name:"sha2-256",code:18,encode:xR("SHA-256")}),rie=ER({name:"sha2-512",code:19,encode:xR("SHA-512")}),AR=Mp,sie={code:0,name:"identity",encode:AR,digest:r=>s5(0,AR(r))},iie="raw",oie=85,aie=r=>Mp(r),cie=r=>Mp(r),lie=new TextEncoder,uie=new TextDecoder,die="json",fie=512,hie=r=>lie.encode(JSON.stringify(r)),pie=r=>JSON.parse(uie.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const IR={...je,...Ke,...nt,...dt,...pt,...Xt,...Ft,...Ht,...Kt,...xr};function RR(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function DR(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const OR=DR("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),o5=DR("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function wie(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?RR(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),PR={utf8:OR,"utf-8":OR,hex:IR.base16,latin1:o5,ascii:o5,binary:o5,...IR},Ao="/",NR=(new TextEncoder).encode(Ao),zp=NR[0];class ft{constructor(e,t){if("string"==typeof e)this._buf=function xie(r,e="utf8"){const t=PR[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):RR(globalThis.Buffer.from(r,"utf-8"))}(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==zp)throw new Error("Invalid key")}toString(e="utf8"){return function Eie(r,e="utf8"){const t=PR[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new ft(e.join(Ao))}static random(){return new ft(((r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),""))().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"==typeof e?new ft(e):"function"==typeof e.uint8Array?new ft(e.uint8Array()):null}clean(){if((null==this._buf||0===this._buf.byteLength)&&(this._buf=NR),this._buf[0]!==zp){const e=new Uint8Array(this._buf.byteLength+1);e.fill(zp,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===zp;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),n=e.list();for(let s=0;s<t.length;s++){if(n.length<s+1)return!1;const i=t[s],o=n[s];if(i<o)return!0;if(i>o)return!1}return t.length<n.length}reverse(){return ft.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Ao).slice(1)}type(){return function Sie(r){const e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function Aie(r){const e=r.split(":");return e[e.length-1]}(this.baseNamespace())}instance(e){return new ft(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Ao)||(e+=Ao),e+=this.type(),new ft(e)}parent(){const e=this.list();return new ft(1===e.length?Ao:e.slice(0,-1).join(Ao))}child(e){return this.toString()===Ao?e:e.toString()===Ao?this:new ft(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(...e){return ft.withNamespaces([...this.namespaces(),...(r=e.map(t=>t.namespaces()),[].concat(...r))]);var r}}var wn=p(78196);let Cie=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/giu;function wt(r="",e="ms"){var t=null;return(r=(r+"").replace(/(\d)[,_](\d)/g,"$1$2")).replace(Cie,function(n,s,i){(i=BR(i))&&(t=(t||0)+parseFloat(s,10)*i)}),t&&t/(BR(e)||1)}function BR(r){return wt[r]||wt[r.toLowerCase().replace(/s$/,"")]}wt.nanosecond=wt.ns=1e-6,wt.\u00b5s=wt.\u03bcs=wt.us=wt.microsecond=.001,wt.millisecond=wt.ms=wt[""]=1,wt.second=wt.sec=wt.s=1e3*wt.ms,wt.minute=wt.min=wt.m=60*wt.s,wt.hour=wt.hr=wt.h=60*wt.m,wt.day=wt.d=24*wt.h,wt.week=wt.wk=wt.w=7*wt.d,wt.month=wt.b=30.4375*wt.d,wt.year=wt.yr=wt.y=365.25*wt.d;const Vp=wt;let a5=(()=>{class r extends Error{constructor(t="request timed out"){super(t),this.name="TimeoutError",this.code=r.code}}return r.code="ERR_TIMEOUT",r})();function ze(r,e){return(...t)=>{const n=t[e??t.length-1];if(!n||!n.timeout)return r(...t);const s="string"==typeof n.timeout?Vp(n.timeout):n.timeout,i=new Ar.TimeoutController(s);n.signal=(0,wn.anySignal)([n.signal,i.signal]);const o=r(...t),a=new Promise((f,E)=>{i.signal.addEventListener("abort",()=>{E(new a5)})}),c=Date.now(),u=()=>{if(i.signal.aborted)throw new a5;if(Date.now()-c>s)throw i.abort(),new a5};return o[Symbol.asyncIterator]?Ee(function*(){const f=o[Symbol.asyncIterator]();try{for(;;){const{value:E,done:T}=yield X(Promise.race([f.next(),a]));if(T)break;u(),yield E}}catch(E){throw u(),E}finally{i.clear(),f.return&&f.return()}})():(0,B.Z)(function*(){try{const f=yield Promise.race([o,a]);return u(),f}catch(f){throw u(),f}finally{i.clear()}})()}}var Oie=Math.pow(2,31),Bie=Math.pow(2,7),Lie=Math.pow(2,14),kie=Math.pow(2,21),Uie=Math.pow(2,28),Mie=Math.pow(2,35),Fie=Math.pow(2,42),zie=Math.pow(2,49),Vie=Math.pow(2,56),jie=Math.pow(2,63),Kie={encode:function kR(r,e,t){e=e||[];for(var n=t=t||0;r>=Oie;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,kR.bytes=t-n+1,e},decode:function c5(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw c5.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return c5.bytes=i-n,t},encodingLength:function(r){return r<Bie?1:r<Lie?2:r<kie?3:r<Uie?4:r<Mie?5:r<Fie?6:r<zie?7:r<Vie?8:r<jie?9:10}};const jp=Kie,l5=(r,e=0)=>[jp.decode(r,e),jp.decode.bytes],$p=(r,e,t=0)=>(jp.encode(r,e,t),e),Kp=r=>jp.encodingLength(r),Cl=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}),Zp=(r,e)=>{const t=e.byteLength,n=Kp(r),s=n+Kp(t),i=new Uint8Array(s+t);return $p(r,i,0),$p(t,i,n),i.set(e,s),new u5(r,t,e,i)};class u5{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const toe=function Xie(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class roe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class noe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return MR(this,e)}}class soe{constructor(e){this.decoders=e}or(e){return MR(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const MR=(r,e)=>new soe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class ioe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new roe(e,t,n),this.decoder=new noe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Hp=({name:r,prefix:e,encode:t,decode:n})=>new ioe(r,e,t,n),rf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=toe(t,e);return Hp({prefix:r,name:e,encode:n,decode:i=>Cl(s(i))})},En=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Hp({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),To=rf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),coe=rf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),nf=En({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),loe=En({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),uoe=En({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),doe=En({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),foe=En({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hoe=En({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),poe=En({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),yoe=En({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),goe=En({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),FR=new WeakMap,d5=r=>{const e=FR.get(r);if(null==e){const t=new Map;return FR.set(r,t),t}return e};class Lr{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==sf)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==woe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Lr.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=Zp(e,t);return Lr.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Lr.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?moe(t,d5(r),e||To.encoder):voe(t,d5(r),e||nf.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Lr)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new Lr(n,s,i,o||zR(n,s,i.bytes))}if(!0===t[Eoe]){const{version:n,multihash:s,code:i}=t,o=(r=>{const e=Cl(r),[t,n]=l5(e),[s,i]=l5(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new u5(t,s,o,e)})(s);return Lr.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==sf)throw new Error(`Version 0 CID must use dag-pb (code: ${sf}) block encoding`);return new Lr(e,t,n,n.bytes);case 1:{const s=zR(e,t,n.bytes);return new Lr(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return Lr.create(0,sf,e)}static createV1(e,t){return Lr.create(1,e,t)}static decode(e){const[t,n]=Lr.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Lr.inspectBytes(e),n=t.size-t.multihashSize,s=Cl(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new u5(t.multihashCode,t.digestSize,i,s);return[0===t.version?Lr.createV0(o):Lr.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=l5(e.subarray(t));return t+=T,E};let s=n(),i=sf;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=_oe(e,t),i=Lr.decode(s);return d5(i).set(n,e),i}}const _oe=(r,e)=>{switch(r[0]){case"Q":return[To.prefix,(e||To).decode(`${To.prefix}${r}`)];case To.prefix:return[To.prefix,(e||To).decode(r)];case nf.prefix:return[nf.prefix,(e||nf).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},moe=(r,e,t)=>{const{prefix:n}=t;if(n!==To.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},voe=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},sf=112,woe=18,zR=(r,e,t)=>{const n=Kp(r),s=n+Kp(e),i=new Uint8Array(s+t.byteLength);return $p(r,i,0),$p(e,i,n),i.set(t,s),i},Eoe=Symbol.for("@ipld/js-cid/CID");function of(r){if(r instanceof Uint8Array)try{r=Lr.decode(r)}catch(s){throw ee(s,"ERR_INVALID_CID")}let e=Lr.asCID(r);if(e)return{cid:e,path:void 0};(r=r.toString()).startsWith("/ipfs/")&&(r=r.substring("/ipfs/".length));const t=r.split("/");let n;try{e=Lr.parse(t.shift()||"")}catch(s){throw ee(s,"ERR_INVALID_CID")}return t.length&&(n=`/${t.join("/")}`),{cid:e,path:n}}const jR="This command must be run in online mode. Try running 'ipfs daemon' first.",f5=new ft("/local/filesroot"),h5=262144,Soe=r=>{if(qe.asCID(r))return`/ipfs/${r}`;const t=r.toString();try{return`/ipfs/${qe.parse(t)}`}catch{}if(r5(t))return t;throw ee(new Error(`invalid path: ${r}`),"ERR_BAD_PATH")},p5=r=>r instanceof Uint8Array?qe.decode(r).toString():(0===(r=r.toString()).indexOf("/ipfs/")&&(r=r.substring(6)),"/"===r.charAt(r.length-1)&&(r=r.substring(0,r.length-1)),r),Gp=function(){var r=(0,B.Z)(function*(e,t,n,s={}){const{cid:i,path:o}=of(n);o&&(s.path=o);let a=i,c=s.path||"";if(c.startsWith("/")&&(c=c.substring(1)),s.path)try{var E,u=!1,f=!1;try{for(var U,T=be(af(i,s.path,t,e,{signal:s.signal}));u=!(U=yield T.next()).done;u=!1){const{value:b,remainderPath:P}=U.value;if(!qe.asCID(b))break;c=P,a=b}}catch(b){f=!0,E=b}finally{try{u&&null!=T.return&&(yield T.return())}finally{if(f)throw E}}}catch(b){throw b.message.startsWith("Object has no property")&&(b.message=`no link named "${c.split("/")[0]}" under ${a}`,b.code="ERR_NO_LINK"),b}return{cid:a,remainderPath:c||""}});return function(t,n,s){return r.apply(this,arguments)}}(),$R=r=>{if("file"!==r.type&&"directory"!==r.type&&"raw"!==r.type)throw new Error(`Unknown node type '${r.type}'`);const e={cid:r.cid,path:r.path,name:r.name,size:r.size,type:"file"};return"directory"===r.type&&(e.type="dir"),"file"===r.type&&(e.size=r.unixfs.fileSize()),("file"===r.type||"directory"===r.type)&&(e.mode=r.unixfs.mode,void 0!==r.unixfs.mtime&&(e.mtime=r.unixfs.mtime)),e},Aoe=ze(function(){var r=(0,B.Z)(function*(e,t){return yield e});return function(e,t){return r.apply(this,arguments)}}()),af=function(){var r=Ee(function*(e,t,n,s,i){const o=function(){var f=(0,B.Z)(function*(E){const T=yield n.getCodec(E.code),U=yield s.blocks.get(E,i);return T.decode(U)});return function(T){return f.apply(this,arguments)}}(),a=t.split("/").filter(Boolean);let c=yield X(o(e)),u=e;for(;a.length;){const f=a.shift();if(!f)throw ee(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(e.code===gr&&Array.isArray(c.Links)){const E=c.Links.find(T=>T.Name===f);if(E){yield{value:E.Hash,remainderPath:a.join("/")},c=yield X(o(E.Hash)),u=E.Hash;continue}}if(!Object.prototype.hasOwnProperty.call(c,f))throw ee(new Error(`no link named "${f}" under ${u}`),"ERR_NO_LINK");c=c[f],yield{value:c,remainderPath:a.join("/")},qe.asCID(c)&&(u=c,c=yield X(o(c)))}yield{value:c,remainderPath:""}});return function(t,n,s,i,o){return r.apply(this,arguments)}}();class Ei{static create({start:e,stop:t}){return new Ei(e,t)}static start(e,t){return(0,B.Z)(function*(){const{state:n,activate:s}=e;switch(n.status){case"stopped":try{const i=s(t);e.state={status:"starting",ready:i};const o=yield i;return e.state={status:"started",value:o},o}catch(i){throw e.state={status:"stopped"},i}case"starting":throw new qq;case"started":throw new eee;case"stopping":return yield n.ready,yield Ei.start(e,t);default:return Ei.panic(e)}})()}static stop(e){return(0,B.Z)(function*(){const{state:t,deactivate:n}=e;switch(t.status){case"stopped":break;case"starting":try{yield t.ready}catch{}return yield Ei.stop(e);case"stopping":return yield t.ready;case"started":n&&(yield n(t.value)),e.state={status:"stopped"};break;default:Ei.panic(t)}})()}static try({state:e}){return"started"===e.status?e.value:null}static use({state:e},t){return(0,B.Z)(function*(){switch(e.status){case"started":return e.value;case"starting":return yield Aoe(e.ready,t);default:throw new YC}})()}static panic({state:e}){const t=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${t}, should never happen if you see this please report a bug`)}constructor(e,t){this.activate=e,this.deactivate=t,this.state={status:"stopped"}}use(e){var t=this;return(0,B.Z)(function*(){return yield Ei.use(t,e)})()}try(){return Ei.try(this)}}var cf=p(96156),Roe=p(12375);class KR extends Error{constructor(e){super(e),this.name="TimeoutError"}}class Doe extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const ZR=r=>void 0===globalThis.DOMException?new Doe(r):new DOMException(r),HR=r=>{const e=void 0===r.reason?ZR("This operation was aborted."):r.reason;return e instanceof Error?e:ZR(e)};var Co,Ac=function(r,e,t,n){if("a"===t&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?n:"a"===t?n.call(r):n?n.value:e.get(r)};class Noe{constructor(){Co.set(this,[])}enqueue(e,t){const n={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&Ac(this,Co,"f")[this.size-1].priority>=t.priority)return void Ac(this,Co,"f").push(n);const s=function Poe(r,e,t){let n=0,s=r.length;for(;s>0;){const i=Math.trunc(s/2);let o=n+i;t(r[o],e)<=0?(n=++o,s-=i+1):s=i}return n}(Ac(this,Co,"f"),n,(i,o)=>o.priority-i.priority);Ac(this,Co,"f").splice(s,0,n)}dequeue(){return Ac(this,Co,"f").shift()?.run}filter(e){return Ac(this,Co,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return Ac(this,Co,"f").length}}Co=new WeakMap;var $r,lf,uf,xa,Wp,df,Yp,xi,ff,Gs,Qp,Ws,hf,Sa,Jp,GR,WR,YR,QR,JR,XR,Xp,y5,g5,qp,e1,Tr=function(r,e,t,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(r,t):s?s.value=t:e.set(r,t),t},et=function(r,e,t,n){if("a"===t&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?n:"a"===t?n.call(r):n?n.value:e.get(r)};const Boe=new KR;class Loe extends Error{}class an extends Roe{constructor(e){var t,n,s,i;if(super(),$r.add(this),lf.set(this,void 0),uf.set(this,void 0),xa.set(this,0),Wp.set(this,void 0),df.set(this,void 0),Yp.set(this,0),xi.set(this,void 0),ff.set(this,void 0),Gs.set(this,void 0),Qp.set(this,void 0),Ws.set(this,0),hf.set(this,void 0),Sa.set(this,void 0),Jp.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Noe,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(n=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==n?n:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(i=null===(s=e.interval)||void 0===s?void 0:s.toString())&&void 0!==i?i:""}\` (${typeof e.interval})`);Tr(this,lf,e.carryoverConcurrencyCount,"f"),Tr(this,uf,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),Tr(this,Wp,e.intervalCap,"f"),Tr(this,df,e.interval,"f"),Tr(this,Gs,new e.queueClass,"f"),Tr(this,Qp,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,Tr(this,Jp,!0===e.throwOnTimeout,"f"),Tr(this,Sa,!1===e.autoStart,"f")}get concurrency(){return et(this,hf,"f")}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);Tr(this,hf,e,"f"),et(this,$r,"m",qp).call(this)}add(e,t={}){var n=this;return(0,B.Z)(function*(){return new Promise((s,i)=>{const o=function(){var a=(0,B.Z)(function*(){var c,u,f;Tr(n,Ws,(u=et(n,Ws,"f"),++u),"f"),Tr(n,xa,(f=et(n,xa,"f"),++f),"f");try{if(null!==(c=t.signal)&&void 0!==c&&c.aborted)return void i(new Loe("The task was aborted."));const T=yield void 0===n.timeout&&void 0===t.timeout?e({signal:t.signal}):function Ooe(r,e,t,n){let s;const i=new Promise((o,a)=>{if("number"!=typeof e||1!==Math.sign(e))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e!==Number.POSITIVE_INFINITY){if((n={customTimers:{setTimeout,clearTimeout},...n}).signal){const{signal:c}=n;c.aborted&&a(HR(c)),c.addEventListener("abort",()=>{a(HR(c))})}s=n.customTimers.setTimeout.call(void 0,()=>{if("function"==typeof t){try{o(t())}catch(f){a(f)}return}const u=t instanceof Error?t:new KR("string"==typeof t?t:`Promise timed out after ${e} milliseconds`);"function"==typeof r.cancel&&r.cancel(),a(u)},e),(0,B.Z)(function*(){try{o(yield r)}catch(c){a(c)}finally{n.customTimers.clearTimeout.call(void 0,s)}})()}else o(r)});return i.clear=()=>{clearTimeout(s),s=void 0},i}(Promise.resolve(e({signal:t.signal})),void 0===t.timeout?n.timeout:t.timeout,()=>{(void 0===t.throwOnTimeout?et(n,Jp,"f"):t.throwOnTimeout)&&i(Boe)});s(T),n.emit("completed",T)}catch(E){i(E),n.emit("error",E)}et(n,$r,"m",YR).call(n)});return function(){return a.apply(this,arguments)}}();et(n,Gs,"f").enqueue(o,t),et(n,$r,"m",Xp).call(n),n.emit("add")})})()}addAll(e,t){var n=this;return(0,B.Z)(function*(){return Promise.all(e.map(function(){var s=(0,B.Z)(function*(i){return n.add(i,t)});return function(i){return s.apply(this,arguments)}}()))})()}start(){return et(this,Sa,"f")?(Tr(this,Sa,!1,"f"),et(this,$r,"m",qp).call(this),this):this}pause(){Tr(this,Sa,!0,"f")}clear(){Tr(this,Gs,new(et(this,Qp,"f")),"f")}onEmpty(){var e=this;return(0,B.Z)(function*(){0!==et(e,Gs,"f").size&&(yield et(e,$r,"m",e1).call(e,"empty"))})()}onSizeLessThan(e){var t=this;return(0,B.Z)(function*(){et(t,Gs,"f").size<e||(yield et(t,$r,"m",e1).call(t,"next",()=>et(t,Gs,"f").size<e))})()}onIdle(){var e=this;return(0,B.Z)(function*(){0===et(e,Ws,"f")&&0===et(e,Gs,"f").size||(yield et(e,$r,"m",e1).call(e,"idle"))})()}get size(){return et(this,Gs,"f").size}sizeBy(e){return et(this,Gs,"f").filter(e).length}get pending(){return et(this,Ws,"f")}get isPaused(){return et(this,Sa,"f")}}lf=new WeakMap,uf=new WeakMap,xa=new WeakMap,Wp=new WeakMap,df=new WeakMap,Yp=new WeakMap,xi=new WeakMap,ff=new WeakMap,Gs=new WeakMap,Qp=new WeakMap,Ws=new WeakMap,hf=new WeakMap,Sa=new WeakMap,Jp=new WeakMap,$r=new WeakSet,GR=function(){return et(this,uf,"f")||et(this,xa,"f")<et(this,Wp,"f")},WR=function(){return et(this,Ws,"f")<et(this,hf,"f")},YR=function(){var e;Tr(this,Ws,(e=et(this,Ws,"f"),--e),"f"),et(this,$r,"m",Xp).call(this),this.emit("next")},QR=function(){this.emit("empty"),0===et(this,Ws,"f")&&this.emit("idle")},JR=function(){et(this,$r,"m",g5).call(this),et(this,$r,"m",y5).call(this),Tr(this,ff,void 0,"f")},XR=function(){const e=Date.now();if(void 0===et(this,xi,"f")){const t=et(this,Yp,"f")-e;if(!(t<0))return void 0===et(this,ff,"f")&&Tr(this,ff,setTimeout(()=>{et(this,$r,"m",JR).call(this)},t),"f"),!0;Tr(this,xa,et(this,lf,"f")?et(this,Ws,"f"):0,"f")}return!1},Xp=function(){if(0===et(this,Gs,"f").size)return et(this,xi,"f")&&clearInterval(et(this,xi,"f")),Tr(this,xi,void 0,"f"),et(this,$r,"m",QR).call(this),!1;if(!et(this,Sa,"f")){const e=!et(this,$r,"a",XR);if(et(this,$r,"a",GR)&&et(this,$r,"a",WR)){const t=et(this,Gs,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&et(this,$r,"m",y5).call(this),!0)}}return!1},y5=function(){et(this,uf,"f")||void 0!==et(this,xi,"f")||(Tr(this,xi,setInterval(()=>{et(this,$r,"m",g5).call(this)},et(this,df,"f")),"f"),Tr(this,Yp,Date.now()+et(this,df,"f"),"f"))},g5=function(){0===et(this,xa,"f")&&0===et(this,Ws,"f")&&et(this,xi,"f")&&(clearInterval(et(this,xi,"f")),Tr(this,xi,void 0,"f")),Tr(this,xa,et(this,lf,"f")?et(this,Ws,"f"):0,"f"),et(this,$r,"m",qp).call(this)},qp=function(){for(;et(this,$r,"m",Xp).call(this););},e1=function(){var r=(0,B.Z)(function*(t,n){return new Promise(s=>{const i=()=>{n&&!n()||(this.off(t,i),s())};this.on(t,i)})});return function e(t,n){return r.apply(this,arguments)}}();var Io=p(69071);const b5=new class Ioe{constructor(e){this.lru=cf(e)}get(e){const t=this.lru.get(e);if(t)return t.expire&&t.expire<Date.now()?void this.lru.remove(e):t.value}set(e,t,n){this.lru.set(e,{value:t,expire:Date.now()+n})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}}(1e3),Moe=new(an.default?an.default:an)({concurrency:4}),qR=r=>{if(r.Path)return r.Path;throw new Error(r.Message)};function _5(){return _5=(0,B.Z)(function*(r,e){return function(){var n=(0,B.Z)(function*(s,i={}){const o=new URLSearchParams(i);o.set("arg",s);const a=o.toString();if(!i.nocache&&b5.has(a)){const u=b5.get(a);return qR(u)}const c=yield Moe.add((0,B.Z)(function*(){const u=yield Io.get("https://ipfs.io/api/v0/dns",{searchParams:o}),f=new URL(u.url).search.slice(1),E=yield u.json();return b5.set(f,E,6e4),E}));return qR(c)});return function(i){return n.apply(this,arguments)}}()(r,e)}),_5.apply(this,arguments)}var Hoe=Math.pow(2,31),Yoe=Math.pow(2,7),Qoe=Math.pow(2,14),Joe=Math.pow(2,21),Xoe=Math.pow(2,28),qoe=Math.pow(2,35),eae=Math.pow(2,42),tae=Math.pow(2,49),rae=Math.pow(2,56),nae=Math.pow(2,63),iae={encode:function tD(r,e,t){e=e||[];for(var n=t=t||0;r>=Hoe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,tD.bytes=t-n+1,e},decode:function m5(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw m5.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return m5.bytes=i-n,t},encodingLength:function(r){return r<Yoe?1:r<Qoe?2:r<Joe?3:r<Xoe?4:r<qoe?5:r<eae?6:r<tae?7:r<rae?8:r<nae?9:10}};const t1=iae,v5=(r,e=0)=>[t1.decode(r,e),t1.decode.bytes],r1=(r,e,t=0)=>(t1.encode(r,e,t),e),n1=r=>t1.encodingLength(r),Il=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}),Rl=(r,e)=>{const t=e.byteLength,n=n1(r),s=n+n1(t),i=new Uint8Array(s+t);return r1(r,i,0),r1(t,i,n),i.set(e,s),new E5(r,t,e,i)},w5=r=>{const e=Il(r),[t,n]=v5(e),[s,i]=v5(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new E5(t,s,o,e)};class E5{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const yae=function fae(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class gae{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class bae{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return nD(this,e)}}class _ae{constructor(e){this.decoders=e}or(e){return nD(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const nD=(r,e)=>new _ae({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class mae{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new gae(e,t,n),this.decoder=new bae(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const s1=({name:r,prefix:e,encode:t,decode:n})=>new mae(r,e,t,n),pf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=yae(t,e);return s1({prefix:r,name:e,encode:n,decode:i=>Il(s(i))})},xn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>s1({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),Si=pf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Eae=pf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),yf=xn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),xae=xn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Sae=xn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Aae=xn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Tae=xn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Cae=xn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Iae=xn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Rae=xn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Dae=xn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),sD=new WeakMap,x5=r=>{const e=sD.get(r);if(null==e){const t=new Map;return sD.set(r,t),t}return e};class cn{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==gf)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Lae)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return cn.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=Rl(e,t);return cn.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return cn.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?Nae(t,x5(r),e||Si.encoder):Bae(t,x5(r),e||yf.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof cn)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new cn(n,s,i,o||iD(n,s,i.bytes))}if(!0===t[kae]){const{version:n,multihash:s,code:i}=t,o=w5(s);return cn.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==gf)throw new Error(`Version 0 CID must use dag-pb (code: ${gf}) block encoding`);return new cn(e,t,n,n.bytes);case 1:{const s=iD(e,t,n.bytes);return new cn(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return cn.create(0,gf,e)}static createV1(e,t){return cn.create(1,e,t)}static decode(e){const[t,n]=cn.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=cn.inspectBytes(e),n=t.size-t.multihashSize,s=Il(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new E5(t.multihashCode,t.digestSize,i,s);return[0===t.version?cn.createV0(o):cn.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=v5(e.subarray(t));return t+=T,E};let s=n(),i=gf;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=Pae(e,t),i=cn.decode(s);return x5(i).set(n,e),i}}const Pae=(r,e)=>{switch(r[0]){case"Q":return[Si.prefix,(e||Si).decode(`${Si.prefix}${r}`)];case Si.prefix:return[Si.prefix,(e||Si).decode(r)];case yf.prefix:return[yf.prefix,(e||yf).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},Nae=(r,e,t)=>{const{prefix:n}=t;if(n!==Si.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},Bae=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},gf=112,Lae=18,iD=(r,e,t)=>{const n=n1(r),s=n+n1(e),i=new Uint8Array(s+t.byteLength);return r1(r,i,0),r1(e,i,n),i.set(t,s),i},kae=Symbol.for("@ipld/js-cid/CID"),Uae=s1({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),Mae=xn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Fae=xn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),zae=pf({prefix:"9",name:"base10",alphabet:"0123456789"}),Vae=xn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),jae=xn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),$ae=pf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Kae=pf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Zae=xn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Hae=xn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Gae=xn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Wae=xn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),oD=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),Yae=oD.reduce((r,e,t)=>(r[t]=e,r),[]),Qae=oD.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),qae=s1({prefix:"\u{1f680}",name:"base256emoji",encode:function Jae(r){return r.reduce((e,t)=>e+Yae[t],"")},decode:function Xae(r){const e=[];for(const t of r){const n=Qae[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}}),aD=({name:r,code:e,encode:t})=>new ece(r,e,t);class ece{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Rl(this.code,t):t.then(n=>Rl(this.code,n))}throw Error("Unknown type, must be binary type")}}const cD=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),i1=aD({name:"sha2-256",code:18,encode:cD("SHA-256")}),tce=aD({name:"sha2-512",code:19,encode:cD("SHA-512")}),uD=Il,bf={code:0,name:"identity",encode:uD,digest:r=>Rl(0,uD(r))},nce="raw",sce=85,ice=r=>Il(r),oce=r=>Il(r),ace=new TextEncoder,cce=new TextDecoder,lce="json",uce=512,dce=r=>ace.encode(JSON.stringify(r)),fce=r=>JSON.parse(cce.decode(r)),dD={...Ye,...tt,...st,...ot,...ht,...yr,...St,...Tt,...zt,...er};function fD(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}const hD=Symbol.for("@libp2p/peer-id");function Tc(r){return null!=r&&Boolean(r[hD])}const pD=Object.values(dD).map(r=>r.decoder).reduce((r,e)=>r.or(e),dD.identity.decoder);class o1{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[hD](){return!0}toString(){return null==this.string&&(this.string=Si.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return cn.createV1(114,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(e instanceof Uint8Array)return fD(this.multihash.bytes,e);if("string"==typeof e)return bt(e).equals(this);if(null!=(null==e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return fD(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}}class _f extends o1{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}}class mf extends o1{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}}class vf extends o1{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}}function Sn(r){if("RSA"===r.type)return new _f(r);if("Ed25519"===r.type)return new mf(r);if("secp256k1"===r.type)return new vf(r);throw ee(new Error("Not a PeerId"),"ERR_INVALID_PARAMETERS")}function bt(r,e){var t;if(e=null!==(t=e)&&void 0!==t?t:pD,"1"===r.charAt(0)||"Q"===r.charAt(0)){const n=w5(Si.decode(`z${r}`));return r.startsWith("12D")?new mf({multihash:n}):r.startsWith("16U")?new vf({multihash:n}):new _f({multihash:n})}return Ai(pD.decode(r))}function Ai(r){try{const e=w5(r);if(e.code===bf.code){if(36===e.digest.length)return new mf({multihash:e});if(37===e.digest.length)return new vf({multihash:e})}if(e.code===i1.code)return new _f({multihash:e})}catch{return function hce(r){if(null==r||null==r.multihash||null==r.version||1===r.version&&114!==r.code)throw new Error("Supplied PeerID CID is invalid");const e=r.multihash;if(e.code===i1.code)return new _f({multihash:r.multihash});if(e.code===bf.code){if(36===e.digest.length)return new mf({multihash:r.multihash});if(37===e.digest.length)return new vf({multihash:r.multihash})}throw new Error("Supplied PeerID CID is invalid")}(cn.decode(r))}throw new Error("Supplied PeerID CID is invalid")}function Ti(r,e){return T5.apply(this,arguments)}function T5(){return(T5=(0,B.Z)(function*(r,e){return 36===r.length?new mf({multihash:Rl(bf.code,r),privateKey:e}):37===r.length?new vf({multihash:Rl(bf.code,r),privateKey:e}):new _f({multihash:yield i1.digest(r),publicKey:r,privateKey:e})})).apply(this,arguments)}function yce(r){try{return bt(r).toBytes()}catch{return qe.parse(r).bytes}}function Ys(r){return C5.apply(this,arguments)}function C5(){return(C5=(0,B.Z)(function*(r){let e;var s,t=!1,n=!1;try{for(var o,i=be(r);t=!(o=yield i.next()).done;t=!1)e=o.value}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield i.return())}finally{if(n)throw s}}return e})).apply(this,arguments)}function Fe(r,e){var t={},n=!1;function s(i,o){return n=!0,o=new Promise(function(a){a(r[i](o))}),{done:!1,value:e(o)}}return t[typeof Symbol<"u"&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(i){return n?(n=!1,i):s("next",i)},"function"==typeof r.throw&&(t.throw=function(i){if(n)throw n=!1,i;return s("throw",i)}),"function"==typeof r.return&&(t.return=function(i){return n?(n=!1,i):s("return",i)}),t}function wf(r){return I5.apply(this,arguments)}function I5(){return(I5=Ee(function*(r){if(null==r)throw ee(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT");const e=Lr.asCID(r);if(e)yield Ci({cid:e});else{if(!(r instanceof String||"string"==typeof r)){if(null!=r.cid||null!=r.path)return yield Ci(r);if(Symbol.iterator in r){const T=r[Symbol.iterator](),U=T.next();if(U.done)return T;if(Lr.asCID(U.value)||U.value instanceof String||"string"==typeof U.value){yield Ci({cid:U.value});for(const b of T)yield Ci({cid:b});return}if(null!=U.value.cid||null!=U.value.path){yield Ci(U.value);for(const b of T)yield Ci(b);return}throw ee(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in r){const T=r[Symbol.asyncIterator](),U=yield X(T.next());if(U.done)return T;if(Lr.asCID(U.value)||U.value instanceof String||"string"==typeof U.value){yield Ci({cid:U.value});var s,t=!1,n=!1;try{for(var o,i=be(T);t=!(o=yield X(i.next())).done;t=!1){const b=o.value;yield Ci({cid:b})}}catch(b){n=!0,s=b}finally{try{t&&null!=i.return&&(yield X(i.return()))}finally{if(n)throw s}}return}if(null!=U.value.cid||null!=U.value.path){yield Ci(U.value);var u,a=!1,c=!1;try{for(var E,f=be(T);a=!(E=yield X(f.next())).done;a=!1){const b=E.value;yield Ci(b)}}catch(b){c=!0,u=b}finally{try{a&&null!=f.return&&(yield X(f.return()))}finally{if(c)throw u}}return}throw ee(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}throw ee(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}yield Ci({path:r})}})).apply(this,arguments)}function Ci(r){const e=r.cid||`${r.path}`;if(!e)throw ee(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const t={path:e,recursive:!1!==r.recursive};return null!=r.metadata&&(t.metadata=r.metadata),t}const jt={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};function Ef(r,e,t){const n={type:r,cid:e};return t&&(n.metadata=t),n}class wce{constructor({codecs:e,repo:t}){const n=function bce({repo:r,codecs:e}){function n(){return n=Ee(function*(s,i={}){const o=function(){var u=Ee(function*(){var T,f=!1,E=!1;try{for(var b,U=be(wf(s));f=!(b=yield X(U.next())).done;f=!1){const{path:P,recursive:F,metadata:M}=b.value,{cid:H}=yield X(Gp(r,e,P)),{reason:$}=yield X(r.pins.isPinnedWithType(H,[jt.recursive,jt.direct]));if("recursive"===$&&!F)throw new Error(`${H} already pinned recursively`);F?yield X(r.pins.pinRecursively(H,{metadata:M})):yield X(r.pins.pinDirectly(H,{metadata:M})),yield H}}catch(P){E=!0,T=P}finally{try{f&&null!=U.return&&(yield X(U.return()))}finally{if(E)throw T}}});return function(){return u.apply(this,arguments)}}();if(!Boolean(i.lock))return void(yield*Fe(be(o()),X));const c=yield X(r.gcLock.readLock());try{yield*Fe(be(o()),X)}finally{c()}}),n.apply(this,arguments)}return ze(function t(s){return n.apply(this,arguments)})}({codecs:e,repo:t});this.addAll=n,this.add=function gce({addAll:r}){return(e,t={})=>{let n;const s=qe.asCID(e);return n=r(s?[{cid:s,...t}]:[{path:e.toString(),...t}],t),Ys(n)}}({addAll:n});const s=function vce({repo:r,codecs:e}){function n(){return(n=Ee(function*(s,i={}){const o=yield X(r.gcLock.readLock());try{var u,a=!1,c=!1;try{for(var E,f=be(wf(s));a=!(E=yield X(f.next())).done;a=!1){const{path:T,recursive:U}=E.value,{cid:b}=yield X(Gp(r,e,T)),{pinned:P,reason:F}=yield X(r.pins.isPinnedWithType(b,jt.all));if(!P)throw new Error(`${b} is not pinned`);switch(F){case jt.recursive:if(!U)throw new Error(`${b} is pinned recursively`);yield X(r.pins.unpin(b)),yield b;break;case jt.direct:yield X(r.pins.unpin(b)),yield b;break;default:throw new Error(`${b} is pinned indirectly under ${F}`)}}}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield X(f.return()))}finally{if(c)throw u}}}finally{o()}})).apply(this,arguments)}return ze(function t(s){return n.apply(this,arguments)})}({codecs:e,repo:t});var i;this.rmAll=s,this.rm=function mce({rmAll:r}){function t(){return(t=(0,B.Z)(function*(n,s={}){const i=yield Ys(r([{path:n,...s}],s));if(!i)throw new Error("CID expected");return i})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}({rmAll:s}),this.ls=function _ce({repo:r,codecs:e}){function n(){return(n=Ee(function*(s={}){let i=jt.all;if(s.type&&(i=s.type,!Object.keys(jt).includes(i)))throw ee(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(s.paths){let Ce=!1;var c,o=!1,a=!1;try{for(var f,u=be(wf(s.paths));o=!(f=yield X(u.next())).done;o=!1){const{path:De}=f.value,{cid:Je}=yield X(Gp(r,e,De)),{reason:Xe,pinned:gt,parent:Pr,metadata:ti}=yield X(r.pins.isPinnedWithType(Je,i));if(!gt)throw ee(new Error(`path '${De}' is not pinned`),"ERR_NOT_PINNED");switch(Xe){case jt.direct:case jt.recursive:Ce=!0,yield Ef(Xe,Je,ti);break;default:Ce=!0,yield Ef(`${jt.indirect} through ${Pr}`,Je,ti)}}}catch(De){a=!0,c=De}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}if(!Ce)throw new Error("No match found")}else{if(i===jt.recursive||i===jt.all){var U,E=!1,T=!1;try{for(var P,b=be(r.pins.recursiveKeys());E=!(P=yield X(b.next())).done;E=!1){const{cid:Ce,metadata:De}=P.value;yield Ef(jt.recursive,Ce,De)}}catch(Ce){T=!0,U=Ce}finally{try{E&&null!=b.return&&(yield X(b.return()))}finally{if(T)throw U}}}if(i===jt.indirect||i===jt.all){var H,F=!1,M=!1;try{for(var V,$=be(r.pins.indirectKeys(s));F=!(V=yield X($.next())).done;F=!1){const Ce=V.value;yield Ef(jt.indirect,Ce)}}catch(Ce){M=!0,H=Ce}finally{try{F&&null!=$.return&&(yield X($.return()))}finally{if(M)throw H}}}if(i===jt.direct||i===jt.all){var Y,W=!1,ne=!1;try{for(var ge,q=be(r.pins.directKeys());W=!(ge=yield X(q.next())).done;W=!1){const{cid:Ce,metadata:De}=ge.value;yield Ef(jt.direct,Ce,De)}}catch(Ce){ne=!0,Y=Ce}finally{try{W&&null!=q.return&&(yield X(q.return()))}finally{if(ne)throw Y}}}}})).apply(this,arguments)}return ze(function t(){return n.apply(this,arguments)})}({codecs:e,repo:t}),this.remote={add:(i,o={})=>Promise.reject(new Error("Not implemented")),ls:(i=Ee(function*(o,a={}){return Promise.reject(new Error("Not implemented"))}),function(a){return i.apply(this,arguments)}),rm:(i,o={})=>Promise.reject(new Error("Not implemented")),rmAll:(i,o={})=>Promise.reject(new Error("Not implemented")),service:{add:(i,o)=>Promise.reject(new Error("Not implemented")),rm:(i,o={})=>Promise.reject(new Error("Not implemented")),ls:(i={})=>Promise.reject(new Error("Not implemented"))}}}}function gD(r){return r=r||new Error("Cannot open database"),ee(r,"ERR_DB_OPEN_FAILED")}function bD(r){return r=r||new Error("Delete failed"),ee(r,"ERR_DB_DELETE_FAILED")}function R5(r){return r=r||new Error("Write failed"),ee(r,"ERR_DB_WRITE_FAILED")}function Wi(r){return r=r||new Error("Not Found"),ee(r,"ERR_NOT_FOUND")}function ts(r,e="utf8"){const t=qC[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}var xce=p(68202),_D=p(58158),Sce=p(60469),mD=p(98526),Ace=p(8071),Tce=p(90683);!function Cce(){Tce._configure(),_D._configure(Sce),mD._configure(Ace)}();const vD=["uint64","int64","sint64","fixed64","sfixed64"];function Cr(r,e){const t=function Rce(r){return function Ice(r){for(const e of vD){if(null==r[e])continue;const t=r[e];r[e]=function(){return BigInt(t.call(this).toString())}}return r}(new _D(r))}(r instanceof Uint8Array?r:r.subarray());return e.decode(t)}function Ir(r,e){const t=function Oce(){return function Dce(r){for(const e of vD){if(null==r[e])continue;const t=r[e];r[e]=function(n){return t.call(this,n.toString())}}return r}(mD.create())}();return e.encode(r,t,{lengthDelimited:!1}),t.finish()}var xf=(()=>{return(r=xf||(xf={}))[r.VARINT=0]="VARINT",r[r.BIT64=1]="BIT64",r[r.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",r[r.START_GROUP=3]="START_GROUP",r[r.END_GROUP=4]="END_GROUP",r[r.BIT32=5]="BIT32",xf;var r})();function wD(r,e,t,n){return{name:r,type:e,encode:t,decode:n}}function Cc(r){function e(s){if(null==r[s.toString()])throw new Error("Invalid enum value");return r[s]}return wD("enum",xf.VARINT,function(i,o){const a=e(i);o.int32(a)},function(i){return e(i.int32())})}function Rr(r,e){return wD("message",xf.LENGTH_DELIMITED,r,e)}var Dl,Ol,Kr=(()=>{return(r=Kr||(Kr={})).RSA="RSA",r.Ed25519="Ed25519",r.Secp256k1="Secp256k1",Kr;var r})(),a1=(()=>{return(r=a1||(a1={}))[r.RSA=0]="RSA",r[r.Ed25519=1]="Ed25519",r[r.Secp256k1=2]="Secp256k1",a1;var r})();(Kr||(Kr={})).codec=()=>Cc(a1),function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{!1!==s.lengthDelimited&&n.fork(),null!=t.Type&&(n.uint32(8),Kr.codec().encode(t.Type,n)),null!=t.Data&&(n.uint32(18),n.bytes(t.Data)),!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();switch(o>>>3){case 1:s.Type=Kr.codec().decode(t);break;case 2:s.Data=t.bytes();break;default:t.skipType(7&o)}}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(Dl||(Dl={})),function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{!1!==s.lengthDelimited&&n.fork(),null!=t.Type&&(n.uint32(8),Kr.codec().encode(t.Type,n)),null!=t.Data&&(n.uint32(18),n.bytes(t.Data)),!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();switch(o>>>3){case 1:s.Type=Kr.codec().decode(t);break;case 2:s.Data=t.bytes();break;default:t.skipType(7&o)}}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(Ol||(Ol={})),p(97238),p(87027);var tr=p(67779);const Lce=function Pce(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},c1=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class Fce{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class zce{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return ED(this,e)}}class Vce{constructor(e){this.decoders=e}or(e){return ED(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ED=(r,e)=>new Vce({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class jce{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new Fce(e,t,n),this.decoder=new zce(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const l1=({name:r,prefix:e,encode:t,decode:n})=>new jce(r,e,t,n),Sf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=Lce(t,e);return l1({prefix:r,name:e,encode:n,decode:i=>c1(s(i))})},An=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>l1({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),Zce=l1({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),Hce=An({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Gce=An({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Wce=Sf({prefix:"9",name:"base10",alphabet:"0123456789"}),Yce=An({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Qce=An({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Jce=An({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Xce=An({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),qce=An({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ele=An({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),tle=An({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),rle=An({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),nle=An({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),sle=An({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ile=An({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ole=Sf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ale=Sf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),xD=Sf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),cle=Sf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),D5=An({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),lle=An({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ule=An({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),dle=An({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),SD=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),fle=SD.reduce((r,e,t)=>(r[t]=e,r),[]),hle=SD.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),gle=l1({prefix:"\u{1f680}",name:"base256emoji",encode:function ple(r){return r.reduce((e,t)=>e+fle[t],"")},decode:function yle(r){const e=[];for(const t of r){const n=hle[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var vle=Math.pow(2,31),xle=Math.pow(2,7),Sle=Math.pow(2,14),Ale=Math.pow(2,21),Tle=Math.pow(2,28),Cle=Math.pow(2,35),Ile=Math.pow(2,42),Rle=Math.pow(2,49),Dle=Math.pow(2,56),Ole=Math.pow(2,63),Nle={encode:function TD(r,e,t){e=e||[];for(var n=t=t||0;r>=vle;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,TD.bytes=t-n+1,e},decode:function O5(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw O5.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return O5.bytes=i-n,t},encodingLength:function(r){return r<xle?1:r<Sle?2:r<Ale?3:r<Tle?4:r<Cle?5:r<Ile?6:r<Rle?7:r<Dle?8:r<Ole?9:10}};const ID=Nle,RD=(r,e,t=0)=>(ID.encode(r,e,t),e),DD=r=>ID.encodingLength(r),P5=(r,e)=>{const t=e.byteLength,n=DD(r),s=n+DD(t),i=new Uint8Array(s+t);return RD(r,i,0),RD(t,i,n),i.set(e,s),new OD(r,t,e,i)};class OD{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const PD=({name:r,code:e,encode:t})=>new Lle(r,e,t);class Lle{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?P5(this.code,t):t.then(n=>P5(this.code,n))}throw Error("Unknown type, must be binary type")}}const ND=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),Ro=PD({name:"sha2-256",code:18,encode:ND("SHA-256")}),kle=PD({name:"sha2-512",code:19,encode:ND("SHA-512")}),LD=c1,kD={code:0,name:"identity",encode:LD,digest:r=>P5(0,LD(r))},Mle="raw",Fle=85,zle=r=>c1(r),Vle=r=>c1(r),jle=new TextEncoder,$le=new TextDecoder,Kle="json",Zle=512,Hle=r=>jle.encode(JSON.stringify(r)),Gle=r=>JSON.parse($le.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const FD={...$u,...Ku,...Zu,...Hu,...Gu,...Wu,...Yu,...Qu,...Ju,...Xu};function B5(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function zD(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?B5(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function VD(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const jD=VD("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),L5=VD("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=zD((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),$D={utf8:jD,"utf-8":jD,hex:FD.base16,latin1:L5,ascii:L5,binary:L5,...FD};function Aa(r,e="utf8"){const t=$D[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):B5(globalThis.Buffer.from(r,"utf-8"))}function Pl(r,e){null==e&&(e=r.reduce((s,i)=>s+i.length,0));const t=zD(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return B5(t)}const Tn={get(r=globalThis){const e=r.crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var sue=p(35813);function Yi(r,e="utf8"){const t=$D[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}function Qi(r,e){let t=Uint8Array.from(r.abs().toByteArray());if(t=0===t[0]?t.slice(1):t,null!=e){if(t.length>e)throw new Error("byte array longer than desired length");t=Pl([new Uint8Array(e-t.length),t])}return Yi(t,"base64url")}function Ii(r){const e=function M5(r,e){let t=Aa(r,"base64urlpad");if(null!=e){if(t.length>e)throw new Error("byte array longer than desired length");t=Pl([new Uint8Array(e-t.length),t])}return t}(r);return new tr.jsbn.BigInteger(Yi(e,"base16"),16)}function Ic(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}p(53837);function WD(r){var e,t,n,s,i,o;const a=null!==(e=r?.algorithm)&&void 0!==e?e:"AES-GCM";let c=null!==(t=r?.keyLength)&&void 0!==t?t:16;const u=null!==(n=r?.nonceLength)&&void 0!==n?n:12,f=null!==(s=r?.digest)&&void 0!==s?s:"SHA-256",E=null!==(i=r?.saltLength)&&void 0!==i?i:16,T=null!==(o=r?.iterations)&&void 0!==o?o:32767,U=Tn.get();function P(){return(P=(0,B.Z)(function*($,V){const W=U.getRandomValues(new Uint8Array(E)),ne=U.getRandomValues(new Uint8Array(u)),Y={name:a,iv:ne};"string"==typeof V&&(V=Aa(V));const q={name:"PBKDF2",salt:W,iterations:T,hash:{name:f}},ge=yield U.subtle.importKey("raw",V,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),Ce=yield U.subtle.deriveKey(q,ge,{name:a,length:c},!0,["encrypt"]),De=yield U.subtle.encrypt(Y,Ce,$);return Pl([W,Y.iv,new Uint8Array(De)])})).apply(this,arguments)}function M(){return(M=(0,B.Z)(function*($,V){const W=$.slice(0,E),ne=$.slice(E,E+u),Y=$.slice(E+u),q={name:a,iv:ne};"string"==typeof V&&(V=Aa(V));const ge={name:"PBKDF2",salt:W,iterations:T,hash:{name:f}},Ce=yield U.subtle.importKey("raw",V,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),De=yield U.subtle.deriveKey(ge,Ce,{name:a,length:c},!0,["decrypt"]),Je=yield U.subtle.decrypt(q,De,Y);return new Uint8Array(Je)})).apply(this,arguments)}return c*=8,{encrypt:function b($,V){return P.apply(this,arguments)},decrypt:function F($,V){return M.apply(this,arguments)}}}function cue(r,e){return V5.apply(this,arguments)}function V5(){return(V5=(0,B.Z)(function*(r,e){const t=D5.decode(r);return yield WD().decrypt(t,e)})).apply(this,arguments)}Object.keys({"P-256":256,"P-384":384,"P-521":521}).join(" / "),p(26243);var lue=p(95856),uue=p.t(lue,2);const Ct=BigInt(0),dr=BigInt(1),Ta=BigInt(2),Tf=BigInt(3),due=BigInt(8),Gt=Object.freeze({a:Ct,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:dr,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")});function YD(r){const{a:e,b:t}=Gt,n=We(r*r),s=We(n*r);return We(s+e*r+t)}const u1=Gt.a===Ct;class j5 extends Error{constructor(e){super(e)}}class Wt{constructor(e,t,n){this.x=e,this.y=t,this.z=n}static fromAffine(e){if(!(e instanceof $t))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new Wt(e.x,e.y,dr)}static toAffineBatch(e){const t=function gue(r,e=Gt.P){const t=new Array(r.length),s=kl(r.reduce((i,o,a)=>o===Ct?i:(t[a]=i,We(i*o,e)),dr),e);return r.reduceRight((i,o,a)=>o===Ct?i:(t[a]=We(i*t[a],e),We(i*o,e)),s),t}(e.map(n=>n.z));return e.map((n,s)=>n.toAffine(t[s]))}static normalizeZ(e){return Wt.toAffineBatch(e).map(Wt.fromAffine)}equals(e){if(!(e instanceof Wt))throw new TypeError("JacobianPoint expected");const{x:t,y:n,z:s}=this,{x:i,y:o,z:a}=e,c=We(s*s),u=We(a*a),f=We(t*u),E=We(i*c),T=We(We(n*a)*u),U=We(We(o*s)*c);return f===E&&T===U}negate(){return new Wt(this.x,We(-this.y),this.z)}double(){const{x:e,y:t,z:n}=this,s=We(e*e),i=We(t*t),o=We(i*i),a=e+i,c=We(Ta*(We(a*a)-s-o)),u=We(Tf*s),f=We(u*u),E=We(f-Ta*c),T=We(u*(c-E)-due*o),U=We(Ta*t*n);return new Wt(E,T,U)}add(e){if(!(e instanceof Wt))throw new TypeError("JacobianPoint expected");const{x:t,y:n,z:s}=this,{x:i,y:o,z:a}=e;if(i===Ct||o===Ct)return this;if(t===Ct||n===Ct)return e;const c=We(s*s),u=We(a*a),f=We(t*u),E=We(i*c),T=We(We(n*a)*u),U=We(We(o*s)*c),b=We(E-f),P=We(U-T);if(b===Ct)return P===Ct?this.double():Wt.ZERO;const F=We(b*b),M=We(b*F),H=We(f*F),$=We(P*P-M-Ta*H),V=We(P*(H-$)-T*M),W=We(s*a*b);return new Wt($,V,W)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){const t=Wt.ZERO;if("bigint"==typeof e&&e===Ct)return t;let n=XD(e);if(n===dr)return this;if(!u1){let E=t,T=this;for(;n>Ct;)n&dr&&(E=E.add(T)),T=T.double(),n>>=dr;return E}let{k1neg:s,k1:i,k2neg:o,k2:a}=eO(n),c=t,u=t,f=this;for(;i>Ct||a>Ct;)i&dr&&(c=c.add(f)),a&dr&&(u=u.add(f)),f=f.double(),i>>=dr,a>>=dr;return s&&(c=c.negate()),o&&(u=u.negate()),u=new Wt(We(u.x*Gt.beta),u.y,u.z),c.add(u)}precomputeWindow(e){const t=u1?128/e+1:256/e+1,n=[];let s=this,i=s;for(let o=0;o<t;o++){i=s,n.push(i);for(let a=1;a<2**(e-1);a++)i=i.add(s),n.push(i);s=i.double()}return n}wNAF(e,t){!t&&this.equals(Wt.BASE)&&(t=$t.BASE);const n=t&&t._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let s=t&&$5.get(t);s||(s=this.precomputeWindow(n),t&&1!==n&&(s=Wt.normalizeZ(s),$5.set(t,s)));let i=Wt.ZERO,o=Wt.ZERO;const a=1+(u1?128/n:256/n),c=2**(n-1),u=BigInt(2**n-1),f=2**n,E=BigInt(n);for(let T=0;T<a;T++){const U=T*c;let b=Number(e&u);if(e>>=E,b>c&&(b-=f,e+=dr),0===b){let P=s[U];T%2&&(P=P.negate()),o=o.add(P)}else{let P=s[U+Math.abs(b)-1];b<0&&(P=P.negate()),i=i.add(P)}}return{p:i,f:o}}multiply(e,t){let s,i,n=XD(e);if(u1){const{k1neg:o,k1:a,k2neg:c,k2:u}=eO(n);let{p:f,f:E}=this.wNAF(a,t),{p:T,f:U}=this.wNAF(u,t);o&&(f=f.negate()),c&&(T=T.negate()),T=new Wt(We(T.x*Gt.beta),T.y,T.z),s=f.add(T),i=E.add(U)}else{const{p:o,f:a}=this.wNAF(n,t);s=o,i=a}return Wt.normalizeZ([s,i])[0]}toAffine(e=kl(this.z)){const{x:t,y:n,z:s}=this,i=e,o=We(i*i),a=We(o*i),c=We(t*o),u=We(n*a);if(We(s*i)!==dr)throw new Error("invZ was invalid");return new $t(c,u)}}Wt.BASE=new Wt(Gt.Gx,Gt.Gy,dr),Wt.ZERO=new Wt(Ct,dr,Ct);const $5=new WeakMap;class $t{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,$5.delete(this)}hasEvenY(){return this.y%Ta===Ct}static fromCompressedHex(e){const t=32===e.length,n=Ps(t?e:e.subarray(1));if(!f1(n))throw new Error("Point is not on curve");let i=function yue(r){const{P:e}=Gt,t=BigInt(6),n=BigInt(11),s=BigInt(22),i=BigInt(23),o=BigInt(44),a=BigInt(88),c=r*r*r%e,u=c*c*r%e,f=ii(u,Tf)*u%e,E=ii(f,Tf)*u%e,T=ii(E,Ta)*c%e,U=ii(T,n)*T%e,b=ii(U,s)*U%e,P=ii(b,o)*b%e,F=ii(P,a)*P%e,M=ii(F,o)*b%e,H=ii(M,Tf)*u%e,$=ii(H,i)*U%e,V=ii($,t)*c%e;return ii(V,Ta)}(YD(n));const o=(i&dr)===dr;t?o&&(i=We(-i)):1==(1&e[0])!==o&&(i=We(-i));const a=new $t(n,i);return a.assertValidity(),a}static fromUncompressedHex(e){const t=Ps(e.subarray(1,33)),n=Ps(e.subarray(33,65)),s=new $t(t,n);return s.assertValidity(),s}static fromHex(e){const t=Ji(e),n=t.length,s=t[0];if(32===n||33===n&&(2===s||3===s))return this.fromCompressedHex(t);if(65===n&&4===s)return this.fromUncompressedHex(t);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return $t.BASE.multiply(Rc(e))}static fromSignature(e,t,n){const s=tO(e=Ji(e)),{r:i,s:o}=sO(t);if(0!==n&&1!==n)throw new Error("Cannot recover signature: invalid recovery bit");const c=$t.fromHex((1&n?"03":"02")+Ia(i)),{n:u}=Gt,f=kl(i,u),E=We(-s*f,u),T=We(o*f,u),U=$t.BASE.multiplyAndAddUnsafe(c,E,T);if(!U)throw new Error("Cannot recover signature: point at infinify");return U.assertValidity(),U}toRawBytes(e=!1){return Ra(this.toHex(e))}toHex(e=!1){const t=Ia(this.x);return e?`${this.hasEvenY()?"02":"03"}${t}`:`04${t}${Ia(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const e="Point is not on elliptic curve",{x:t,y:n}=this;if(!f1(t)||!f1(n))throw new Error(e);const s=We(n*n);if(We(s-YD(t))!==Ct)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new $t(this.x,We(-this.y))}double(){return Wt.fromAffine(this).double().toAffine()}add(e){return Wt.fromAffine(this).add(Wt.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Wt.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,t,n){const s=Wt.fromAffine(this),i=t===Ct||t===dr||this!==$t.BASE?s.multiplyUnsafe(t):s.multiply(t),o=Wt.fromAffine(e).multiplyUnsafe(n),a=i.add(o);return a.equals(Wt.ZERO)?void 0:a.toAffine()}}function QD(r){return Number.parseInt(r[0],16)>=8?"00"+r:r}function JD(r){if(r.length<2||2!==r[0])throw new Error(`Invalid signature integer tag: ${Bl(r)}`);const e=r[1],t=r.subarray(2,e+2);if(!e||t.length!==e)throw new Error("Invalid signature integer: wrong length");if(0===t[0]&&t[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Ps(t),left:r.subarray(e+2)}}$t.BASE=new $t(Gt.Gx,Gt.Gy),$t.ZERO=new $t(Ct,Ct);class Ca{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromCompact(e){const t=e instanceof Uint8Array,n="Signature.fromCompact";if("string"!=typeof e&&!t)throw new TypeError(`${n}: Expected string or Uint8Array`);const s=t?Bl(e):e;if(128!==s.length)throw new Error(`${n}: Expected 64-byte hex`);return new Ca(d1(s.slice(0,64)),d1(s.slice(64,128)))}static fromDER(e){const t=e instanceof Uint8Array;if("string"!=typeof e&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r:n,s}=function fue(r){if(r.length<2||48!=r[0])throw new Error(`Invalid signature tag: ${Bl(r)}`);if(r[1]!==r.length-2)throw new Error("Invalid signature: incorrect length");const{data:e,left:t}=JD(r.subarray(2)),{data:n,left:s}=JD(t);if(s.length)throw new Error(`Invalid signature: left bytes after parsing: ${Bl(s)}`);return{r:e,s:n}}(t?e:Ra(e));return new Ca(n,s)}static fromHex(e){return this.fromDER(e)}assertValidity(){const{r:e,s:t}=this;if(!Ml(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Ml(t))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){return this.s>Gt.n>>dr}normalizeS(){return this.hasHighS()?new Ca(this.r,Gt.n-this.s):this}toDERRawBytes(e=!1){return Ra(this.toDERHex(e))}toDERHex(e=!1){const t=QD(Cf(this.s));if(e)return t;const n=QD(Cf(this.r)),s=Cf(n.length/2),i=Cf(t.length/2);return`30${Cf(n.length/2+t.length/2+4)}02${s}${n}02${i}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Ra(this.toCompactHex())}toCompactHex(){return Ia(this.r)+Ia(this.s)}}function Nl(...r){if(!r.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(1===r.length)return r[0];const e=r.reduce((n,s)=>n+s.length,0),t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}const hue=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Bl(r){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let t=0;t<r.length;t++)e+=hue[r[t]];return e}const pue=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function Ia(r){if("bigint"!=typeof r)throw new Error("Expected bigint");if(!(Ct<=r&&r<pue))throw new Error("Expected number < 2^256");return r.toString(16).padStart(64,"0")}function Ll(r){const e=Ra(Ia(r));if(32!==e.length)throw new Error("Error: expected 32 bytes");return e}function Cf(r){const e=r.toString(16);return 1&e.length?`0${e}`:e}function d1(r){if("string"!=typeof r)throw new TypeError("hexToNumber: expected string, got "+typeof r);return BigInt(`0x${r}`)}function Ra(r){if("string"!=typeof r)throw new TypeError("hexToBytes: expected string, got "+typeof r);if(r.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+r.length);const e=new Uint8Array(r.length/2);for(let t=0;t<e.length;t++){const n=2*t,s=r.slice(n,n+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");e[t]=i}return e}function Ps(r){return d1(Bl(r))}function Ji(r){return r instanceof Uint8Array?Uint8Array.from(r):Ra(r)}function XD(r){if("number"==typeof r&&Number.isSafeInteger(r)&&r>0)return BigInt(r);if("bigint"==typeof r&&Ml(r))return r;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function We(r,e=Gt.P){const t=r%e;return t>=Ct?t:e+t}function ii(r,e){const{P:t}=Gt;let n=r;for(;e-- >Ct;)n*=n,n%=t;return n}function kl(r,e=Gt.P){if(r===Ct||e<=Ct)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=We(r,e),n=e,s=Ct,i=dr,o=dr,a=Ct;for(;t!==Ct;){const u=n/t,f=n%t,E=s-o*u,T=i-a*u;n=t,t=f,s=o,i=a,o=E,a=T}if(n!==dr)throw new Error("invert: does not exist");return We(s,e)}const qD=(r,e)=>(r+e/Ta)/e,bue={a1:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),b1:-dr*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a2:BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),b2:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),POW_2_128:BigInt("0x100000000000000000000000000000000")};function eO(r){const{n:e}=Gt,{a1:t,b1:n,a2:s,b2:i,POW_2_128:o}=bue,a=qD(i*r,e),c=qD(-n*r,e);let u=We(r-a*t-c*s,e),f=We(-a*n-c*i,e);const E=u>o,T=f>o;if(E&&(u=e-u),T&&(f=e-f),u>o||f>o)throw new Error("splitScalarEndo: Endomorphism failed, k="+r);return{k1neg:E,k1:u,k2neg:T,k2:f}}function tO(r){const{n:e}=Gt,n=8*r.length-256;let s=Ps(r);return n>0&&(s>>=BigInt(n)),s>=e&&(s-=e),s}let Ul,If;class rO{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return Ns.hmacSha256(this.k,...e)}hmacSync(...e){return If(this.k,...e)}checkSync(){if("function"!=typeof If)throw new j5("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}reseed(e=new Uint8Array){var t=this;return(0,B.Z)(function*(){t.k=yield t.hmac(t.v,Uint8Array.from([0]),e),t.v=yield t.hmac(t.v),0!==e.length&&(t.k=yield t.hmac(t.v,Uint8Array.from([1]),e),t.v=yield t.hmac(t.v))})()}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),0!==e.length&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}generate(){var e=this;return(0,B.Z)(function*(){return e.incr(),e.v=yield e.hmac(e.v),e.v})()}generateSync(){return this.checkSync(),this.incr(),this.v=this.hmacSync(this.v),this.v}}function Ml(r){return Ct<r&&r<Gt.n}function f1(r){return Ct<r&&r<Gt.P}function nO(r,e,t){const n=Ps(r);if(!Ml(n))return;const{n:s}=Gt,i=$t.BASE.multiply(n),o=We(i.x,s);if(o===Ct)return;const a=We(kl(n,s)*We(e+t*o,s),s);if(a===Ct)return;const c=new Ca(o,a);return{sig:c,recovery:(i.x===c.r?0:2)|Number(i.y&dr)}}function Rc(r){let e;if("bigint"==typeof r)e=r;else if("number"==typeof r&&Number.isSafeInteger(r)&&r>0)e=BigInt(r);else if("string"==typeof r){if(64!==r.length)throw new Error("Expected 32 bytes of private key");e=d1(r)}else{if(!(r instanceof Uint8Array))throw new TypeError("Expected valid private key");if(32!==r.length)throw new Error("Expected 32 bytes of private key");e=Ps(r)}if(!Ml(e))throw new Error("Expected private key: 0 < key < n");return e}function sO(r){if(r instanceof Ca)return r.assertValidity(),r;try{return Ca.fromDER(r)}catch{return Ca.fromCompact(r)}}function iO(r,e=!1){return $t.fromPrivateKey(r).toRawBytes(e)}function aO(r){return Ps(r.length>32?r.slice(0,32):r)}function _ue(r){const e=aO(r),t=We(e,Gt.n);return cO(t<Ct?e:t)}function cO(r){return Ll(r)}function lO(r,e,t){if(null==r)throw new Error(`sign: expected valid message hash, not "${r}"`);const n=Ji(r),s=Rc(e),i=[cO(s),_ue(n)];if(null!=t){!0===t&&(t=Ns.randomBytes(32));const c=Ji(t);if(32!==c.length)throw new Error("sign: Expected 32 bytes of extra data");i.push(c)}return{seed:Nl(...i),m:aO(n),d:s}}function uO(r,e){let{sig:t,recovery:n}=r;const{canonical:s,der:i,recovered:o}=Object.assign({canonical:!0,der:!0},e);s&&t.hasHighS()&&(t=t.normalizeS(),n^=1);const a=i?t.toDERRawBytes():t.toCompactRawBytes();return o?[a,n]:a}function mue(r,e){return Z5.apply(this,arguments)}function Z5(){return(Z5=(0,B.Z)(function*(r,e,t={}){const{seed:n,m:s,d:i}=lO(r,e,t.extraEntropy);let o;const a=new rO;for(yield a.reseed(n);!(o=nO(yield a.generate(),s,i));)yield a.reseed();return uO(o,t)})).apply(this,arguments)}const vue={strict:!0};function wue(r,e,t,n=vue){let s;try{s=sO(r),e=Ji(e)}catch{return!1}const{r:i,s:o}=s;if(n.strict&&s.hasHighS())return!1;const a=tO(e);let c;try{c=function K5(r){return r instanceof $t?(r.assertValidity(),r):$t.fromHex(r)}(t)}catch{return!1}const{n:u}=Gt,f=kl(o,u),E=We(a*f,u),T=We(i*f,u),U=$t.BASE.multiplyAndAddUnsafe(c,E,T);return!!U&&We(U.x,u)===i}$t.BASE._setWindowSize(8);const Qs={node:uue,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},p1={},Ns={bytesToHex:Bl,hexToBytes:Ra,concatBytes:Nl,mod:We,invert:kl,isValidPrivateKey(r){try{return Rc(r),!0}catch{return!1}},_bigintTo32Bytes:Ll,_normalizePrivateKey:Rc,hashToPrivateKey:r=>{if((r=Ji(r)).length<40||r.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return Ll(We(Ps(r),Gt.n-dr)+dr)},randomBytes:(r=32)=>{if(Qs.web)return Qs.web.getRandomValues(new Uint8Array(r));if(Qs.node){const{randomBytes:e}=Qs.node;return Uint8Array.from(e(r))}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Ns.hashToPrivateKey(Ns.randomBytes(40)),sha256:(r=(0,B.Z)(function*(...e){if(Qs.web){const t=yield Qs.web.subtle.digest("SHA-256",Nl(...e));return new Uint8Array(t)}if(Qs.node){const{createHash:t}=Qs.node,n=t("sha256");return e.forEach(s=>n.update(s)),Uint8Array.from(n.digest())}throw new Error("The environment doesn't have sha256 function")}),function(){return r.apply(this,arguments)}),hmacSha256:function(){var r=(0,B.Z)(function*(e,...t){if(Qs.web){const n=yield Qs.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),s=Nl(...t),i=yield Qs.web.subtle.sign("HMAC",n,s);return new Uint8Array(i)}if(Qs.node){const{createHmac:n}=Qs.node,s=n("sha256",e);return t.forEach(i=>s.update(i)),Uint8Array.from(s.digest())}throw new Error("The environment doesn't have hmac-sha256 function")});return function(t){return r.apply(this,arguments)}}(),sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:function(){var r=(0,B.Z)(function*(e,...t){let n=p1[e];if(void 0===n){const s=yield Ns.sha256(Uint8Array.from(e,i=>i.charCodeAt(0)));n=Nl(s,s),p1[e]=n}return Ns.sha256(n,...t)});return function(t){return r.apply(this,arguments)}}(),taggedHashSync:(r,...e)=>{if("function"!=typeof Ul)throw new j5("sha256Sync is undefined, you need to set it");let t=p1[r];if(void 0===t){const n=Ul(Uint8Array.from(r,s=>s.charCodeAt(0)));t=Nl(n,n),p1[r]=t}return Ul(t,...e)},precompute(r=8,e=$t.BASE){const t=e===$t.BASE?e:new $t(e.x,e.y);return t._setWindowSize(r),t.multiply(Tf),t}};var r;function Rf(r){if(isNaN(r)||r<=0)throw ee(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return Ns.randomBytes(r)}function Aue(r){const e=tr.asn1.fromDer(Yi(r,"ascii")),t=tr.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Qi(t.n),e:Qi(t.e),d:Qi(t.d),p:Qi(t.p),q:Qi(t.q),dp:Qi(t.dP),dq:Qi(t.dQ),qi:Qi(t.qInv),alg:"RS256"}}function gO(r,e){return e.map(t=>Ii(r[t]))}function Oue(r){return W5.apply(this,arguments)}function W5(){return W5=(0,B.Z)(function*(r){const e=yield Tn.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),t=yield _O(e);return{privateKey:t[0],publicKey:t[1]}}),W5.apply(this,arguments)}function bO(r){return Y5.apply(this,arguments)}function Y5(){return Y5=(0,B.Z)(function*(r){const t=[yield Tn.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),yield Bue(r)],n=yield _O({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}),Y5.apply(this,arguments)}function Q5(){return Q5=(0,B.Z)(function*(r,e){const t=yield Tn.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=yield Tn.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},t,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}),Q5.apply(this,arguments)}function J5(){return J5=(0,B.Z)(function*(r,e,t){const n=yield Tn.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return yield Tn.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,t)}),J5.apply(this,arguments)}function _O(r){return X5.apply(this,arguments)}function X5(){return X5=(0,B.Z)(function*(r){if(null==r.privateKey||null==r.publicKey)throw ee(new Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return yield Promise.all([Tn.get().subtle.exportKey("jwk",r.privateKey),Tn.get().subtle.exportKey("jwk",r.publicKey)])}),X5.apply(this,arguments)}function Bue(r){return q5.apply(this,arguments)}function q5(){return q5=(0,B.Z)(function*(r){return yield Tn.get().subtle.importKey("jwk",{kty:r.kty,n:r.n,e:r.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}),q5.apply(this,arguments)}function mO(r,e,t,n){const s=e?function Due(r){return tr.pki.setRsaPublicKey(...gO(r,["n","e"]))}(r):function Rue(r){return tr.pki.setRsaPrivateKey(...gO(r,["n","e","d","p","q","dp","dq","qi"]))}(r);return Aa(n(Yi(Uint8Array.from(t),"ascii"),s),"ascii")}function e8(r,e){return t8.apply(this,arguments)}function t8(){return t8=(0,B.Z)(function*(r,e){const n=yield WD().encrypt(r,e);return D5.encode(n)}),t8.apply(this,arguments)}Object.defineProperties(Ns,{sha256Sync:{configurable:!1,get:()=>Ul,set(r){Ul||(Ul=r)}},hmacSha256Sync:{configurable:!1,get:()=>If,set(r){If||(If=r)}}}),p(11812);class r8{constructor(e){this._key=e}verify(e,t){var n=this;return(0,B.Z)(function*(){return yield function Nue(r,e,t){return J5.apply(this,arguments)}(n._key,t,e)})()}marshal(){return function Iue(r){if(null==r.n||null==r.e)throw ee(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");const e=tr.pki.publicKeyToAsn1({n:Ii(r.n),e:Ii(r.e)});return Aa(tr.asn1.toDer(e).getBytes(),"ascii")}(this._key)}get bytes(){return Dl.encode({Type:Kr.RSA,Data:this.marshal()}).subarray()}encrypt(e){return function Lue(r,e){return mO(r,!0,e,(t,n)=>n.encrypt(t))}(this._key,e)}equals(e){return Ic(this.bytes,e.bytes)}hash(){var e=this;return(0,B.Z)(function*(){const{bytes:t}=yield Ro.digest(e.bytes);return t})()}}class y1{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return Rf(16)}sign(e){var t=this;return(0,B.Z)(function*(){return yield function Pue(r,e){return Q5.apply(this,arguments)}(t._key,e)})()}get public(){if(null==this._publicKey)throw ee(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new r8(this._publicKey)}decrypt(e){return function kue(r,e){return mO(r,!1,e,(t,n)=>n.decrypt(t))}(this._key,e)}marshal(){return function Tue(r){if(null==r.n||null==r.e||null==r.d||null==r.p||null==r.q||null==r.dp||null==r.dq||null==r.qi)throw ee(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");const e=tr.pki.privateKeyToAsn1({n:Ii(r.n),e:Ii(r.e),d:Ii(r.d),p:Ii(r.p),q:Ii(r.q),dP:Ii(r.dp),dQ:Ii(r.dq),qInv:Ii(r.qi)});return Aa(tr.asn1.toDer(e).getBytes(),"ascii")}(this._key)}get bytes(){return Ol.encode({Type:Kr.RSA,Data:this.marshal()}).subarray()}equals(e){return Ic(this.bytes,e.bytes)}hash(){var e=this;return(0,B.Z)(function*(){const{bytes:t}=yield Ro.digest(e.bytes);return t})()}id(){var e=this;return(0,B.Z)(function*(){return Yi(yield e.public.hash(),"base58btc")})()}export(e,t="pkcs-8"){var n=this;return(0,B.Z)(function*(){if("pkcs-8"===t){const s=new tr.util.ByteBuffer(n.marshal()),i=tr.asn1.fromDer(s),o=tr.pki.privateKeyFromAsn1(i);return tr.pki.encryptRsaPrivateKey(o,e,{algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"})}if("libp2p-key"===t)return yield e8(n.bytes,e);throw ee(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")})()}}function Uue(r){return n8.apply(this,arguments)}function n8(){return n8=(0,B.Z)(function*(r){const e=Aue(r),t=yield bO(e);return new y1(t.privateKey,t.publicKey)}),n8.apply(this,arguments)}function Mue(r){const e=function Cue(r){const e=tr.asn1.fromDer(Yi(r,"ascii")),t=tr.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Qi(t.n),e:Qi(t.e)}}(r);return new r8(e)}function Fue(r){return s8.apply(this,arguments)}function s8(){return s8=(0,B.Z)(function*(r){const e=yield bO(r);return new y1(e.privateKey,e.publicKey)}),s8.apply(this,arguments)}function zue(r){return i8.apply(this,arguments)}function i8(){return i8=(0,B.Z)(function*(r){const e=yield Oue(r);return new y1(e.privateKey,e.publicKey)}),i8.apply(this,arguments)}var Vue=p(7420),jue=p.t(Vue,2);const kr=BigInt(0),xt=BigInt(1),zl=BigInt(2),vO=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),rr=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:vO,n:vO,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),wO=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Df=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),$ue=(BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235")),Kue=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Zue=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Hue=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class Lt{constructor(e,t,n,s){this.x=e,this.y=t,this.z=n,this.t=s}static fromAffine(e){if(!(e instanceof Dr))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(Dr.ZERO)?Lt.ZERO:new Lt(e.x,e.y,xt,Pe(e.x*e.y))}static toAffineBatch(e){const t=function Yue(r,e=rr.P){const t=new Array(r.length),s=g1(r.reduce((i,o,a)=>o===kr?i:(t[a]=i,Pe(i*o,e)),xt),e);return r.reduceRight((i,o,a)=>o===kr?i:(t[a]=Pe(i*t[a],e),Pe(i*o,e)),s),t}(e.map(n=>n.z));return e.map((n,s)=>n.toAffine(t[s]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){EO(e);const{x:t,y:n,z:s}=this,{x:i,y:o,z:a}=e,c=Pe(t*a),u=Pe(i*s),f=Pe(n*a),E=Pe(o*s);return c===u&&f===E}negate(){return new Lt(Pe(-this.x),this.y,this.z,Pe(-this.t))}double(){const{x:e,y:t,z:n}=this,{a:s}=rr,i=Pe(e*e),o=Pe(t*t),a=Pe(zl*Pe(n*n)),c=Pe(s*i),u=e+t,f=Pe(Pe(u*u)-i-o),E=c+o,T=E-a,U=c-o,b=Pe(f*T),P=Pe(E*U),F=Pe(f*U),M=Pe(T*E);return new Lt(b,P,M,F)}add(e){EO(e);const{x:t,y:n,z:s,t:i}=this,{x:o,y:a,z:c,t:u}=e,f=Pe((n-t)*(a+o)),E=Pe((n+t)*(a-o)),T=Pe(E-f);if(T===kr)return this.double();const U=Pe(s*zl*u),b=Pe(i*zl*c),P=b+U,F=E+f,M=b-U,H=Pe(P*T),$=Pe(F*M),V=Pe(P*M),W=Pe(T*F);return new Lt(H,$,W,V)}subtract(e){return this.add(e.negate())}precomputeWindow(e){const t=1+256/e,n=[];let s=this,i=s;for(let o=0;o<t;o++){i=s,n.push(i);for(let a=1;a<2**(e-1);a++)i=i.add(s),n.push(i);s=i.double()}return n}wNAF(e,t){!t&&this.equals(Lt.BASE)&&(t=Dr.BASE);const n=t&&t._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let s=t&&c8.get(t);s||(s=this.precomputeWindow(n),t&&1!==n&&(s=Lt.normalizeZ(s),c8.set(t,s)));let i=Lt.ZERO,o=Lt.ZERO;const a=1+256/n,c=2**(n-1),u=BigInt(2**n-1),f=2**n,E=BigInt(n);for(let T=0;T<a;T++){const U=T*c;let b=Number(e&u);if(e>>=E,b>c&&(b-=f,e+=xt),0===b){let P=s[U];T%2&&(P=P.negate()),o=o.add(P)}else{let P=s[U+Math.abs(b)-1];b<0&&(P=P.negate()),i=i.add(P)}}return Lt.normalizeZ([i,o])[0]}multiply(e,t){return this.wNAF(Kl(e,rr.l),t)}multiplyUnsafe(e){let t=Kl(e,rr.l,!1);const n=Lt.BASE,s=Lt.ZERO;if(t===kr)return s;if(this.equals(s)||t===xt)return this;if(this.equals(n))return this.wNAF(t);let i=s,o=this;for(;t>kr;)t&xt&&(i=i.add(o)),o=o.double(),t>>=xt;return i}isSmallOrder(){return this.multiplyUnsafe(rr.h).equals(Lt.ZERO)}isTorsionFree(){return this.multiplyUnsafe(rr.l).equals(Lt.ZERO)}toAffine(e=g1(this.z)){const{x:t,y:n,z:s}=this,i=Pe(t*e),o=Pe(n*e);if(Pe(s*e)!==xt)throw new Error("invZ was invalid");return new Dr(i,o)}fromRistrettoBytes(){a8()}toRistrettoBytes(){a8()}fromRistrettoHash(){a8()}}function EO(r){if(!(r instanceof Lt))throw new TypeError("ExtendedPoint expected")}function o8(r){if(!(r instanceof oi))throw new TypeError("RistrettoPoint expected")}function a8(){throw new Error("Legacy method: switch to RistrettoPoint")}Lt.BASE=new Lt(rr.Gx,rr.Gy,xt,Pe(rr.Gx*rr.Gy)),Lt.ZERO=new Lt(kr,xt,xt,kr);class oi{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){const{d:t}=rr,n=Pe(Df*e*e),s=Pe((n+xt)*Zue);let i=BigInt(-1);const o=Pe((i-t*n)*Pe(n+t));let{isValid:a,value:c}=d8(s,o),u=Pe(c*e);Oa(u)||(u=Pe(-u)),a||(c=u),a||(i=n);const f=Pe(i*(n-xt)*Hue-o),E=c*c,T=Pe((c+c)*o),U=Pe(f*$ue),b=Pe(xt-E),P=Pe(xt+E);return new Lt(Pe(T*P),Pe(b*U),Pe(U*P),Pe(T*b))}static hashToCurve(e){const t=u8((e=Di(e,64)).slice(0,32)),n=this.calcElligatorRistrettoMap(t),s=u8(e.slice(32,64)),i=this.calcElligatorRistrettoMap(s);return new oi(n.add(i))}static fromHex(e){e=Di(e,32);const{a:t,d:n}=rr,s="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",i=u8(e);if(!function Que(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}(jl(i),e)||Oa(i))throw new Error(s);const o=Pe(i*i),a=Pe(xt+t*o),c=Pe(xt-t*o),u=Pe(a*a),f=Pe(c*c),E=Pe(t*n*u-f),{isValid:T,value:U}=TO(Pe(E*f)),b=Pe(U*c),P=Pe(U*b*E);let F=Pe((i+i)*b);Oa(F)&&(F=Pe(-F));const M=Pe(a*P),H=Pe(F*M);if(!T||Oa(H)||M===kr)throw new Error(s);return new oi(new Lt(F,M,xt,H))}toRawBytes(){let{x:e,y:t,z:n,t:s}=this.ep;const i=Pe(Pe(n+t)*Pe(n-t)),o=Pe(e*t),a=Pe(o*o),{value:c}=TO(Pe(i*a)),u=Pe(c*i),f=Pe(c*o),E=Pe(u*f*s);let T;if(Oa(s*E)){let b=Pe(t*Df),P=Pe(e*Df);e=b,t=P,T=Pe(u*Kue)}else T=f;Oa(e*E)&&(t=Pe(-t));let U=Pe((n-t)*T);return Oa(U)&&(U=Pe(-U)),jl(U)}toHex(){return Of(this.toRawBytes())}toString(){return this.toHex()}equals(e){o8(e);const t=this.ep,n=e.ep,s=Pe(t.x*n.y)===Pe(t.y*n.x),i=Pe(t.y*n.y)===Pe(t.x*n.x);return s||i}add(e){return o8(e),new oi(this.ep.add(e.ep))}subtract(e){return o8(e),new oi(this.ep.subtract(e.ep))}multiply(e){return new oi(this.ep.multiply(e))}multiplyUnsafe(e){return new oi(this.ep.multiplyUnsafe(e))}}oi.BASE=new oi(Lt.BASE),oi.ZERO=new oi(Lt.ZERO);const c8=new WeakMap;class Dr{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,c8.delete(this)}static fromHex(e,t=!0){const{d:n,P:s}=rr,i=(e=Di(e,32)).slice();i[31]=-129&e[31];const o=Dc(i);if(t&&o>=s)throw new Error("Expected 0 < hex < P");if(!t&&o>=wO)throw new Error("Expected 0 < hex < 2**256");const a=Pe(o*o),c=Pe(a-xt),u=Pe(n*a+xt);let{isValid:f,value:E}=d8(c,u);if(!f)throw new Error("Point.fromHex: invalid y coordinate");return 0!=(128&e[31])!=((E&xt)===xt)&&(E=Pe(-E)),new Dr(E,o)}static fromPrivateKey(e){return(0,B.Z)(function*(){return(yield Nf(e)).point})()}toRawBytes(){const e=jl(this.y);return e[31]|=this.x&xt?128:0,e}toHex(){return Of(this.toRawBytes())}toX25519(){const{y:e}=this;return jl(Pe((xt+e)*g1(xt-e)))}isTorsionFree(){return Lt.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Dr(Pe(-this.x),this.y)}add(e){return Lt.fromAffine(this).add(Lt.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Lt.fromAffine(this).multiply(e,this).toAffine()}}Dr.BASE=new Dr(rr.Gx,rr.Gy),Dr.ZERO=new Dr(kr,xt);class Vl{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){const t=Di(e,64),n=Dr.fromHex(t.slice(0,32),!1),s=Dc(t.slice(32,64));return new Vl(n,s)}assertValidity(){const{r:e,s:t}=this;if(!(e instanceof Dr))throw new Error("Expected Point instance");return Kl(t,rr.l,!1),this}toRawBytes(){const e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(jl(this.s),32),e}toHex(){return Of(this.toRawBytes())}}function xO(...r){if(!r.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(1===r.length)return r[0];const e=r.reduce((n,s)=>n+s.length,0),t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}const Gue=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Of(r){if(!(r instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let t=0;t<r.length;t++)e+=Gue[r[t]];return e}function l8(r){if("string"!=typeof r)throw new TypeError("hexToBytes: expected string, got "+typeof r);if(r.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(r.length/2);for(let t=0;t<e.length;t++){const n=2*t,s=r.slice(n,n+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");e[t]=i}return e}function SO(r){return l8(r.toString(16).padStart(64,"0"))}function jl(r){return SO(r).reverse()}function Oa(r){return(Pe(r)&xt)===xt}function Dc(r){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Of(Uint8Array.from(r).reverse()))}const Wue=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function u8(r){return Pe(Dc(r)&Wue)}function Pe(r,e=rr.P){const t=r%e;return t>=kr?t:e+t}function g1(r,e=rr.P){if(r===kr||e<=kr)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=Pe(r,e),n=e,s=kr,i=xt,o=xt,a=kr;for(;t!==kr;){const u=n/t,f=n%t,E=s-o*u,T=i-a*u;n=t,t=f,s=o,i=a,o=E,a=T}if(n!==xt)throw new Error("invert: does not exist");return Pe(s,e)}function Ri(r,e){const{P:t}=rr;let n=r;for(;e-- >kr;)n*=n,n%=t;return n}function d8(r,e){const t=Pe(e*e*e),n=Pe(t*t*e);let i=Pe(r*t*function AO(r){const{P:e}=rr,t=BigInt(5),n=BigInt(10),s=BigInt(20),i=BigInt(40),o=BigInt(80),c=r*r%e*r%e,u=Ri(c,zl)*c%e,f=Ri(u,xt)*r%e,E=Ri(f,t)*f%e,T=Ri(E,n)*E%e,U=Ri(T,s)*T%e,b=Ri(U,i)*U%e,P=Ri(b,o)*b%e,F=Ri(P,o)*b%e,M=Ri(F,n)*E%e;return{pow_p_5_8:Ri(M,zl)*r%e,b2:c}}(r*n).pow_p_5_8);const o=Pe(e*i*i),a=i,c=Pe(i*Df),u=o===r,f=o===Pe(-r),E=o===Pe(-r*Df);return u&&(i=a),(f||E)&&(i=c),Oa(i)&&(i=Pe(-i)),{isValid:u||f,value:i}}function TO(r){return d8(xt,r)}function $l(r){return Pe(Dc(r),rr.l)}function Di(r,e){const t=r instanceof Uint8Array?Uint8Array.from(r):l8(r);if("number"==typeof e&&t.length!==e)throw new Error(`Expected ${e} bytes`);return t}function Kl(r,e,t=!0){if(!e)throw new TypeError("Specify max value");if("number"==typeof r&&Number.isSafeInteger(r)&&(r=BigInt(r)),"bigint"==typeof r&&r<e)if(t){if(kr<r)return r}else if(kr<=r)return r;throw new TypeError("Expected valid scalar: 0 < scalar < max")}function IO(r){if(32!==(r="bigint"==typeof r||"number"==typeof r?SO(Kl(r,wO)):Di(r)).length)throw new Error("Expected 32 bytes");return r}function RO(r){const e=function CO(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}(r.slice(0,32)),t=r.slice(32,64),n=$l(e),s=Dr.BASE.multiply(n),i=s.toRawBytes();return{head:e,prefix:t,scalar:n,point:s,pointBytes:i}}let Pf;function Nf(r){return f8.apply(this,arguments)}function f8(){return f8=(0,B.Z)(function*(r){return RO(yield Oc.sha512(IO(r)))}),f8.apply(this,arguments)}function DO(r){return p8.apply(this,arguments)}function p8(){return p8=(0,B.Z)(function*(r){return(yield Nf(r)).pointBytes}),p8.apply(this,arguments)}function que(r,e){return y8.apply(this,arguments)}function y8(){return y8=(0,B.Z)(function*(r,e){r=Di(r);const{prefix:t,scalar:n,pointBytes:s}=yield Nf(e),i=$l(yield Oc.sha512(t,r)),o=Dr.BASE.multiply(i),c=Pe(i+$l(yield Oc.sha512(o.toRawBytes(),s,r))*n,rr.l);return new Vl(o,c).toRawBytes()}),y8.apply(this,arguments)}function OO(r,e,t){e=Di(e),t instanceof Dr||(t=Dr.fromHex(t,!1));const{r:n,s}=r instanceof Vl?r.assertValidity():Vl.fromHex(r);return{r:n,s,SB:Lt.BASE.multiplyUnsafe(s),pub:t,msg:e}}function PO(r,e,t,n){const s=$l(n),i=Lt.fromAffine(r).multiplyUnsafe(s);return Lt.fromAffine(e).add(i).subtract(t).multiplyUnsafe(rr.h).equals(Lt.ZERO)}function tde(r,e,t){return g8.apply(this,arguments)}function g8(){return g8=(0,B.Z)(function*(r,e,t){const{r:n,SB:s,msg:i,pub:o}=OO(r,e,t),a=yield Oc.sha512(n.toRawBytes(),o.toRawBytes(),i);return PO(o,n,s,a)}),g8.apply(this,arguments)}Dr.BASE._setWindowSize(8);const Pa={node:jue,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},Oc={bytesToHex:Of,hexToBytes:l8,concatBytes:xO,getExtendedPublicKey:Nf,mod:Pe,invert:g1,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:r=>{if((r=Di(r)).length<40||r.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return Pe(Dc(r),rr.l-xt)+xt},randomBytes:(r=32)=>{if(Pa.web)return Pa.web.getRandomValues(new Uint8Array(r));if(Pa.node){const{randomBytes:e}=Pa.node;return new Uint8Array(e(r).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Oc.randomBytes(32),sha512:function(){var r=(0,B.Z)(function*(...e){const t=xO(...e);if(Pa.web){const n=yield Pa.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(n)}if(Pa.node)return Uint8Array.from(Pa.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")});return function(){return r.apply(this,arguments)}}(),precompute(r=8,e=Dr.BASE){const t=e.equals(Dr.BASE)?e:new Dr(e.x,e.y);return t._setWindowSize(r),t.multiply(zl),t},sha512Sync:void 0};function ode(){return m8.apply(this,arguments)}function m8(){return m8=(0,B.Z)(function*(){const r=Oc.randomPrivateKey(),e=yield DO(r);return{privateKey:NO(r,e),publicKey:e}}),m8.apply(this,arguments)}function ade(r){return v8.apply(this,arguments)}function v8(){return v8=(0,B.Z)(function*(r){if(32!==r.length)throw new TypeError('"seed" must be 32 bytes in length.');if(!(r instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const e=r,t=yield DO(e);return{privateKey:NO(e,t),publicKey:t}}),v8.apply(this,arguments)}function w8(){return w8=(0,B.Z)(function*(r,e){const t=r.slice(0,32);return yield que(e,t)}),w8.apply(this,arguments)}function E8(){return E8=(0,B.Z)(function*(r,e,t){return yield tde(e,t,r)}),E8.apply(this,arguments)}function NO(r,e){const t=new Uint8Array(64);for(let n=0;n<32;n++)t[n]=r[n],t[32+n]=e[n];return t}Object.defineProperties(Oc,{sha512Sync:{configurable:!1,get:()=>Pf,set(r){Pf||(Pf=r)}}});class x8{constructor(e){this._key=Zl(e,32)}verify(e,t){var n=this;return(0,B.Z)(function*(){return yield function lde(r,e,t){return E8.apply(this,arguments)}(n._key,t,e)})()}marshal(){return this._key}get bytes(){return Dl.encode({Type:Kr.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Ic(this.bytes,e.bytes)}hash(){var e=this;return(0,B.Z)(function*(){const{bytes:t}=yield Ro.digest(e.bytes);return t})()}}class Lf{constructor(e,t){this._key=Zl(e,64),this._publicKey=Zl(t,32)}sign(e){var t=this;return(0,B.Z)(function*(){return yield function cde(r,e){return w8.apply(this,arguments)}(t._key,e)})()}get public(){return new x8(this._publicKey)}marshal(){return this._key}get bytes(){return Ol.encode({Type:Kr.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Ic(this.bytes,e.bytes)}hash(){var e=this;return(0,B.Z)(function*(){const{bytes:t}=yield Ro.digest(e.bytes);return t})()}id(){var e=this;return(0,B.Z)(function*(){const t=yield kD.digest(e.public.bytes);return xD.encode(t.bytes).substring(1)})()}export(e,t="libp2p-key"){var n=this;return(0,B.Z)(function*(){if("libp2p-key"===t)return yield e8(n.bytes,e);throw ee(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")})()}}function ude(r){if(r.length>64){const n=(r=Zl(r,96)).slice(0,64),s=r.slice(64,r.length);return new Lf(n,s)}const e=(r=Zl(r,64)).slice(0,64),t=r.slice(32);return new Lf(e,t)}function dde(r){return r=Zl(r,32),new x8(r)}function fde(){return S8.apply(this,arguments)}function S8(){return S8=(0,B.Z)(function*(){const{privateKey:r,publicKey:e}=yield ode();return new Lf(r,e)}),S8.apply(this,arguments)}function BO(r){return A8.apply(this,arguments)}function A8(){return A8=(0,B.Z)(function*(r){const{privateKey:e,publicKey:t}=yield ade(r);return new Lf(e,t)}),A8.apply(this,arguments)}function Zl(r,e){var t;if((r=Uint8Array.from(null!==(t=r)&&void 0!==t?t:[])).length!==e)throw ee(new Error(`Key must be a Uint8Array of length ${e}, got ${r.length}`),"ERR_INVALID_KEY_TYPE");return r}function hde(){return Ns.randomPrivateKey()}function T8(){return T8=(0,B.Z)(function*(r,e){const{digest:t}=yield Ro.digest(e);try{return yield mue(t,r)}catch(n){throw ee(n,"ERR_INVALID_INPUT")}}),T8.apply(this,arguments)}function C8(){return C8=(0,B.Z)(function*(r,e,t){try{const{digest:n}=yield Ro.digest(t);return wue(e,n,r)}catch(n){throw ee(n,"ERR_INVALID_INPUT")}}),C8.apply(this,arguments)}function LO(r){try{$t.fromHex(r)}catch(e){throw ee(e,"ERR_INVALID_PUBLIC_KEY")}}class I8{constructor(e){LO(e),this._key=e}verify(e,t){var n=this;return(0,B.Z)(function*(){return yield function yde(r,e,t){return C8.apply(this,arguments)}(n._key,t,e)})()}marshal(){return function gde(r){return $t.fromHex(r).toRawBytes(!0)}(this._key)}get bytes(){return Dl.encode({Type:Kr.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Ic(this.bytes,e.bytes)}hash(){var e=this;return(0,B.Z)(function*(){const{bytes:t}=yield Ro.digest(e.bytes);return t})()}}class R8{constructor(e,t){this._key=e,this._publicKey=t??function _de(r){try{return iO(r,!0)}catch(e){throw ee(e,"ERR_INVALID_PRIVATE_KEY")}}(e),function bde(r){try{iO(r,!0)}catch(e){throw ee(e,"ERR_INVALID_PRIVATE_KEY")}}(this._key),LO(this._publicKey)}sign(e){var t=this;return(0,B.Z)(function*(){return yield function pde(r,e){return T8.apply(this,arguments)}(t._key,e)})()}get public(){return new I8(this._publicKey)}marshal(){return this._key}get bytes(){return Ol.encode({Type:Kr.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Ic(this.bytes,e.bytes)}hash(){var e=this;return(0,B.Z)(function*(){const{bytes:t}=yield Ro.digest(e.bytes);return t})()}id(){var e=this;return(0,B.Z)(function*(){return Yi(yield e.public.hash(),"base58btc")})()}export(e,t="libp2p-key"){var n=this;return(0,B.Z)(function*(){if("libp2p-key"===t)return yield e8(n.bytes,e);throw ee(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")})()}}function mde(r){return new R8(r)}function vde(r){return new I8(r)}function wde(){return D8.apply(this,arguments)}function D8(){return D8=(0,B.Z)(function*(){const r=yield hde();return new R8(r)}),D8.apply(this,arguments)}const Do={rsa:nd,ed25519:sd,secp256k1:id};function O8(r){const e=Object.keys(Do).join(" / ");return ee(new Error(`invalid or unsupported key type ${r}. Must be ${e}`),"ERR_UNSUPPORTED_KEY_TYPE")}function P8(r){if("rsa"===(r=r.toLowerCase())||"ed25519"===r||"secp256k1"===r)return Do[r];throw O8(r)}function N8(r,e){return B8.apply(this,arguments)}function B8(){return B8=(0,B.Z)(function*(r,e){return yield P8(r).generateKeyPair(e??2048)}),B8.apply(this,arguments)}function Pc(r){var e,t;const n=Dl.decode(r),s=null!==(e=n.Data)&&void 0!==e?e:new Uint8Array;switch(n.Type){case Kr.RSA:return Do.rsa.unmarshalRsaPublicKey(s);case Kr.Ed25519:return Do.ed25519.unmarshalEd25519PublicKey(s);case Kr.Secp256k1:return Do.secp256k1.unmarshalSecp256k1PublicKey(s);default:throw O8(null!==(t=n.Type)&&void 0!==t?t:"RSA")}}function k8(r,e){var t;return P8(e=(null!==(t=e)&&void 0!==t?t:"rsa").toLowerCase()),r.bytes}function Oo(r){return U8.apply(this,arguments)}function U8(){return U8=(0,B.Z)(function*(r){var e,t;const n=Ol.decode(r),s=null!==(e=n.Data)&&void 0!==e?e:new Uint8Array;switch(n.Type){case Kr.RSA:return yield Do.rsa.unmarshalRsaPrivateKey(s);case Kr.Ed25519:return Do.ed25519.unmarshalEd25519PrivateKey(s);case Kr.Secp256k1:return Do.secp256k1.unmarshalSecp256k1PrivateKey(s);default:throw O8(null!==(t=n.Type)&&void 0!==t?t:"RSA")}}),U8.apply(this,arguments)}function Ede(r,e){var t;return P8(e=(null!==(t=e)&&void 0!==t?t:"rsa").toLowerCase()),r.bytes}function kf(r,e){return M8.apply(this,arguments)}function M8(){return M8=(0,B.Z)(function*(r,e){try{const s=yield cue(r,e);return yield Oo(s)}catch{}const t=tr.pki.decryptRsaPrivateKey(r,e);if(null===t)throw ee(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=tr.asn1.toDer(tr.pki.privateKeyToAsn1(t));return n=Aa(n.getBytes(),"ascii"),yield Do.rsa.unmarshalRsaPrivateKey(n)}),M8.apply(this,arguments)}const Tde=function xde(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},Uf=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class Dde{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ode{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return kO(this,e)}}class Pde{constructor(e){this.decoders=e}or(e){return kO(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const kO=(r,e)=>new Pde({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class Nde{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new Dde(e,t,n),this.decoder=new Ode(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const v1=({name:r,prefix:e,encode:t,decode:n})=>new Nde(r,e,t,n),Mf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=Tde(t,e);return v1({prefix:r,name:e,encode:n,decode:i=>Uf(s(i))})},Cn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>v1({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),kde=Cn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),UO=Cn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ude=Cn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Mde=Cn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Fde=Cn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),zde=Cn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Vde=Cn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),jde=Cn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$de=Cn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Kde=v1({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),Zde=Cn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Hde=Cn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Gde=Mf({prefix:"9",name:"base10",alphabet:"0123456789"}),Wde=Cn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Yde=Cn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Qde=Mf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Jde=Mf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Xde=Mf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qde=Mf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),efe=Cn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),tfe=Cn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),rfe=Cn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),nfe=Cn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),MO=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),sfe=MO.reduce((r,e,t)=>(r[t]=e,r),[]),ife=MO.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),cfe=v1({prefix:"\u{1f680}",name:"base256emoji",encode:function ofe(r){return r.reduce((e,t)=>e+sfe[t],"")},decode:function afe(r){const e=[];for(const t of r){const n=ife[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var ffe=Math.pow(2,31),yfe=Math.pow(2,7),gfe=Math.pow(2,14),bfe=Math.pow(2,21),_fe=Math.pow(2,28),mfe=Math.pow(2,35),vfe=Math.pow(2,42),wfe=Math.pow(2,49),Efe=Math.pow(2,56),xfe=Math.pow(2,63),Afe={encode:function zO(r,e,t){e=e||[];for(var n=t=t||0;r>=ffe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,zO.bytes=t-n+1,e},decode:function F8(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw F8.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return F8.bytes=i-n,t},encodingLength:function(r){return r<yfe?1:r<gfe?2:r<bfe?3:r<_fe?4:r<mfe?5:r<vfe?6:r<wfe?7:r<Efe?8:r<xfe?9:10}};const w1=Afe,jO=(r,e=0)=>[w1.decode(r,e),w1.decode.bytes],$O=(r,e,t=0)=>(w1.encode(r,e,t),e),KO=r=>w1.encodingLength(r),z8=(r,e)=>{const t=e.byteLength,n=KO(r),s=n+KO(t),i=new Uint8Array(s+t);return $O(r,i,0),$O(t,i,n),i.set(e,s),new ZO(r,t,e,i)};class ZO{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const HO=({name:r,code:e,encode:t})=>new Ife(r,e,t);class Ife{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?z8(this.code,t):t.then(n=>z8(this.code,n))}throw Error("Unknown type, must be binary type")}}const GO=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),Rfe=HO({name:"sha2-256",code:18,encode:GO("SHA-256")}),Dfe=HO({name:"sha2-512",code:19,encode:GO("SHA-512")}),YO=Uf,QO={code:0,name:"identity",encode:YO,digest:r=>z8(0,YO(r))},Pfe="raw",Nfe=85,Bfe=r=>Uf(r),Lfe=r=>Uf(r),kfe=new TextEncoder,Ufe=new TextDecoder,Mfe="json",Ffe=512,zfe=r=>kfe.encode(JSON.stringify(r)),Vfe=r=>JSON.parse(Ufe.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const qO={...ad,..._o,...ll,...cd,...ld,...od,...ud,...dd,...fd,...$i};function j8(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function eP(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?j8(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function tP(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const rP=tP("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),$8=tP("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=eP((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),nP={utf8:rP,"utf-8":rP,hex:qO.base16,latin1:$8,ascii:$8,binary:$8,...qO};function E1(r,e="utf8"){const t=nP[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):j8(globalThis.Buffer.from(r,"utf-8"))}const K8="ERR_UNRECOGNIZED_VALIDITY",Nc="ERR_SIGNATURE_VERIFICATION",sP="ERR_UNDEFINED_PARAMETER";var Xi;function Z8(r,e){null==e&&(e=r.reduce((s,i)=>s+i.length,0));const t=eP(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return j8(t)}!function(r){let e,t,n;var s;(e=r.ValidityType||(r.ValidityType={})).EOL="EOL",(s=t||(t={}))[s.EOL=0]="EOL",function(s){s.codec=()=>Cc(t)}(e=r.ValidityType||(r.ValidityType={})),r.codec=()=>(null==n&&(n=Rr((s,i,o={})=>{!1!==o.lengthDelimited&&i.fork(),null!=s.value&&(i.uint32(10),i.bytes(s.value)),null!=s.signature&&(i.uint32(18),i.bytes(s.signature)),null!=s.validityType&&(i.uint32(24),r.ValidityType.codec().encode(s.validityType,i)),null!=s.validity&&(i.uint32(34),i.bytes(s.validity)),null!=s.sequence&&(i.uint32(40),i.uint64(s.sequence)),null!=s.ttl&&(i.uint32(48),i.uint64(s.ttl)),null!=s.pubKey&&(i.uint32(58),i.bytes(s.pubKey)),null!=s.signatureV2&&(i.uint32(66),i.bytes(s.signatureV2)),null!=s.data&&(i.uint32(74),i.bytes(s.data)),!1!==o.lengthDelimited&&i.ldelim()},(s,i)=>{const o={},a=null==i?s.len:s.pos+i;for(;s.pos<a;){const c=s.uint32();switch(c>>>3){case 1:o.value=s.bytes();break;case 2:o.signature=s.bytes();break;case 3:o.validityType=r.ValidityType.codec().decode(s);break;case 4:o.validity=s.bytes();break;case 5:o.sequence=s.uint64();break;case 6:o.ttl=s.uint64();break;case 7:o.pubKey=s.bytes();break;case 8:o.signatureV2=s.bytes();break;case 9:o.data=s.bytes();break;default:s.skipType(7&c)}}return o})),n),r.encode=s=>Ir(s,r.codec()),r.decode=s=>Cr(s,r.codec())}(Xi||(Xi={}));const iP=Be("ipns:utils"),oP=E1("/ipns/");function H8(r){const e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),t=String(r).trim().match(e);if(null==t)throw new Error("Invalid format");const n=parseInt(t[1],10),s=parseInt(t[2],10)-1,i=parseInt(t[3],10),o=parseInt(t[4],10),a=parseInt(t[5],10),c=parseInt(t[6],10),u=parseInt(t[7].slice(0,-6),10);return new Date(Date.UTC(n,s,i,o,a,c,u))}const ehe=function(){var r=(0,B.Z)(function*(e,t){if(null==t||null==e){const s=new Error("one or more of the provided parameters are not defined");throw iP.error(s),ee(s,sP)}let n;if(null!=t.pubKey){try{n=Pc(t.pubKey)}catch(i){throw iP.error(i),i}if(!(yield Ti(t.pubKey)).equals(e))throw ee(new Error("Embedded public key did not match PeerID"),"ERR_INVALID_EMBEDDED_KEY")}else null!=e.publicKey&&(n=Pc(e.publicKey));if(null!=n)return n;throw ee(new Error("no public key is available"),sP)});return function(t,n){return r.apply(this,arguments)}}(),aP=r=>Z8([E1("ipns-signature:"),r]),x1=r=>{var e,t,n,s,i,o;const a=Xi.decode(r);return null!=a.sequence&&(a.sequence=BigInt(a.sequence)),null!=a.ttl&&(a.ttl=BigInt(a.ttl)),{value:null!==(e=a.value)&&void 0!==e?e:new Uint8Array(0),signature:null!==(t=a.signature)&&void 0!==t?t:new Uint8Array(0),validityType:null!==(n=a.validityType)&&void 0!==n?n:Xi.ValidityType.EOL,validity:null!==(s=a.validity)&&void 0!==s?s:new Uint8Array(0),sequence:null!==(i=a.sequence)&&void 0!==i?i:0n,pubKey:a.pubKey,ttl:null!==(o=a.ttl)&&void 0!==o?o:void 0,signatureV2:a.signatureV2,data:a.data}},S1=r=>Z8([oP,r.toBytes()]);function G8(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}const cP=Be("ipns"),ohe=QO.code,A1="/ipns/",W8=A1.length,ahe=function(){var r=(0,B.Z)(function*(e,t,n,s){const i=new xce(Date.now()+Number(s)),o=Xi.ValidityType.EOL,[a,c]=s.toString().split("."),u=BigInt(a)*BigInt(1e5)+BigInt(c??"0");return yield che(e,t,n,o,i,u)});return function(t,n,s,i){return r.apply(this,arguments)}}(),che=function(){var r=(0,B.Z)(function*(e,t,n,s,i,o){n=BigInt(n);const a=E1(i.toString());if(null==e.privateKey)throw ee(new Error("Missing private key"),"ERR_MISSING_PRIVATE_KEY");const c=yield Oo(e.privateKey),u=yield uhe(c,t,s,a),f=((r,e,t,n,s)=>{let i;if(t!==Xi.ValidityType.EOL)throw ee(new Error("Unknown validity type"),K8);return i=0,bl({Value:r,Validity:e,ValidityType:0,Sequence:n,TTL:s})})(t,a,s,n,o),E=aP(f),U={value:t,signature:u,validityType:s,validity:a,sequence:n,ttl:o,signatureV2:yield c.sign(E),data:f};if(null!=e.publicKey){const b=(r=>{const e=Uf(r),[t,n]=jO(e),[s,i]=jO(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new ZO(t,s,o,e)})(e.toBytes());(b.code!==ohe||!G8(e.publicKey,b.digest))&&(U.pubKey=e.publicKey)}return cP("ipns entry for %b created",t),U});return function(t,n,s,i,o,a){return r.apply(this,arguments)}}(),Y8=r=>new ft(`/ipns/${(r=>UO.encode(r).slice(1))(r)}`),uhe=function(){var r=(0,B.Z)(function*(e,t,n,s){try{const i=((r,e,t)=>Z8([r,t,E1(e)]))(t,n,s);return yield e.sign(i)}catch(i){throw cP.error("record signature creation failed",i),ee(new Error("record signature creation failed"),"ERR_SIGNATURE_CREATION")}});return function(t,n,s,i){return r.apply(this,arguments)}}(),ai=Be("ipfs:ipns:publisher"),lP=Wi().code;let Q8=(()=>{class r{constructor(t,n){this._routing=t,this._datastore=n}publishWithEOL(t,n,s,i){var o=this;return(0,B.Z)(function*(){const a=yield o._updateOrCreateRecord(t,n,s,i);return o._putRecordToRouting(a,t,i)})()}publish(t,n,s){return this.publishWithEOL(t,n,36e5,s)}_putRecordToRouting(t,n,s){var i=this;return(0,B.Z)(function*(){if(!Tc(n)){const a="peerId received is not valid";throw ai.error(a),ee(new Error(a),"ERR_INVALID_PEER_ID")}if(null==n.publicKey)throw ee(new Error("Public key was missing"),"ERR_MISSING_PUBLIC_KEY");const o=S1(n);return yield i._publishEntry(o,t,s),t})()}_publishEntry(t,n,s){var i=this;return(0,B.Z)(function*(){try{const o=yield i._routing.put(t,n,s);return ai(`ipns record for ${ts(t,"base32")} was stored in the routing`),o}catch(o){const a=`ipns record for ${ts(t,"base32")} could not be stored in the routing - ${o.stack}`;throw ai.error(a),ai.error(o),ee(new Error(a),"ERR_PUTTING_TO_ROUTING")}})()}_getPublished(t,n={}){var s=this;return(0,B.Z)(function*(){if(!Tc(t)){const o="peerId received is not valid";throw ai.error(o),ee(new Error(o),"ERR_INVALID_PEER_ID")}const i=!1!==n.checkRouting;try{const o=yield s._datastore.get(Y8(t.toBytes()));return s._unmarshalData(o)}catch(o){if(o.code!==lP){const a=`unexpected error getting the ipns record ${t.toString()} from datastore`;throw ai.error(a),ee(new Error(a),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!i)throw ee(o,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{const a=S1(t),c=yield s._routing.get(a);return s._unmarshalData(c)}catch(a){throw ai.error(a),a}}})()}_unmarshalData(t){try{return x1(t)}catch(n){throw ee(n,"ERR_INVALID_RECORD_DATA")}}_updateOrCreateRecord(t,n,s,i){var o=this;return(0,B.Z)(function*(){if(!Tc(t)){const E="peerId received is not valid";throw ai.error(E),ee(new Error(E),"ERR_INVALID_PEER_ID")}const a={checkRouting:!0};let c;try{c=yield o._getPublished(t,a)}catch(E){if(E.code!==lP){const T=`unexpected error when determining the last published IPNS record for ${t.toString()} ${E.stack}`;throw ai.error(T),ee(new Error(T),"ERR_DETERMINING_PUBLISHED_RECORD")}}let f,u=0n;c&&void 0!==c.sequence&&(u=function Ece(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}(c.value,n)?c.sequence:c.sequence+BigInt(1));try{f=yield ahe(t,n,u,s)}catch(E){const T=`ipns record for ${n} could not be created`;throw ai.error(E),ee(new Error(T),"ERR_CREATING_IPNS_RECORD")}try{const E=(r=>Xi.encode(r))(f);return yield o._datastore.put(Y8(t.toBytes()),E,i),ai(`ipns record for ${ts(n,"base32")} was stored in the datastore`),E}catch{const T=`ipns record for ${n} could not be stored in the datastore`;throw ai.error(T),ee(new Error(T),"ERR_STORING_IN_DATASTORE")}})()}}return r.defaultRecordLifetime=36e5,r})();const T1=Be("ipfs:ipns:republisher");class hhe{constructor(e,t,n,s,i={pass:""}){this._publisher=e,this._datastore=t,this._peerId=n,this._keychain=s,this._options=i,this._republishHandle=null}start(){var e=this;return(0,B.Z)(function*(){if(e._republishHandle)throw ee(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");const t={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:i=>{t._timeoutId=setTimeout((0,B.Z)(function*(){t._timeoutId=null;try{t._inflightTask=t._task(),yield t._inflightTask,t._task&&t.runPeriodically(i)}catch(o){T1.error(o)}}),i())},cancel:(i=(0,B.Z)(function*(){null!=t._timeoutId&&clearTimeout(t._timeoutId),t._task=null,yield t._inflightTask}),function(){return i.apply(this,arguments)})},{pass:n}=e._options;var i;let s=!0;t._task=(0,B.Z)(function*(){const i=new Ar.TimeoutController(3e4);try{yield e._republishEntries(e._peerId,n,{signal:i.signal})}finally{i.clear()}}),t.runPeriodically(()=>s?(s=!1,e._options.initialBroadcastInterval||6e4):e._options.broadcastInterval||144e5),e._republishHandle=t})()}stop(){var e=this;return(0,B.Z)(function*(){const t=e._republishHandle;if(!t)throw ee(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");e._republishHandle=null,yield t.cancel()})()}_republishEntries(e,t,n){var s=this;return(0,B.Z)(function*(){try{yield s._republishEntry(e,n)}catch{return void T1.error("cannot republish entry for the node's private key")}if(t)try{const i=yield s._keychain.listKeys();for(const o of i){if("self"===o.name)continue;const a=yield s._keychain.exportKey(o.name,t),c=yield kf(a,t),u=yield Ti(c.public.bytes,c.bytes);yield s._republishEntry(u,n)}}catch(i){T1.error(i)}})()}_republishEntry(e,t){var n=this;return(0,B.Z)(function*(){try{const s=yield n._getPreviousValue(e);yield n._publisher.publishWithEOL(e,s,864e5,t)}catch(s){if("ERR_NO_ENTRY_FOUND"===s.code)return;throw s}})()}_getPreviousValue(e){var t=this;return(0,B.Z)(function*(){if(!Tc(e))throw ee(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{const n=yield t._datastore.get(Y8(e.toBytes()));if(!(n instanceof Uint8Array))throw ee(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return x1(n).value}catch(s){throw T1.error(s),ee(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(n){throw n&&n.notFound?ee(new Error(`no previous entry for record with id: ${e.toString()}`),"ERR_NO_ENTRY_FOUND"):n}})()}}function zf(r,e){null==e&&(e=r.reduce((s,i)=>s+i.length,0));const t=QC(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return O6(t)}function J8(r,e="utf8"){const t=nP[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}const Vf=Be("ipns:validator"),phe=function(){var r=(0,B.Z)(function*(e,t){const{value:n,validityType:s,validity:i}=t;let o,a,c;if(null==t.signatureV2||null==t.data)throw ee(new Error("missing data or signatureV2"),Nc);a=t.signatureV2,o=aP(t.data),yhe(t);try{c=yield e.verify(o,a)}catch{c=!1}if(!c)throw Vf.error("record signature verification failed"),ee(new Error("record signature verification failed"),Nc);if(null!=i&&s===Xi.ValidityType.EOL){let u;try{u=H8(J8(i))}catch{throw Vf.error("unrecognized validity format (not an rfc3339 format)"),ee(new Error("unrecognized validity format (not an rfc3339 format)"),"ERR_UNRECOGNIZED_FORMAT")}if(u.getTime()<Date.now())throw Vf.error("record has expired"),ee(new Error("record has expired"),"ERR_IPNS_EXPIRED_RECORD")}else if(null!=s)throw Vf.error("unrecognized validity type"),ee(new Error("unrecognized validity type"),K8);Vf("ipns entry for %b is valid",n)});return function(t,n){return r.apply(this,arguments)}}(),yhe=r=>{if(null==r.data)throw ee(new Error("Record data is missing"),"ERR_INVALID_RECORD_DATA");const e=(r=>{const e=Hi(r);if(0!==e.ValidityType)throw ee(new Error("Unknown validity type"),K8);return e.ValidityType=Xi.ValidityType.EOL,Number.isInteger(e.Sequence)&&(e.Sequence=BigInt(e.Sequence)),Number.isInteger(e.TTL)&&(e.TTL=BigInt(e.TTL)),e})(r.data);if(!G8(e.Value,r.value))throw ee(new Error('Field "value" did not match between protobuf and CBOR'),Nc);if(!G8(e.Validity,r.validity))throw ee(new Error('Field "validity" did not match between protobuf and CBOR'),Nc);if(e.ValidityType!==r.validityType)throw ee(new Error('Field "validityType" did not match between protobuf and CBOR'),Nc);if(e.Sequence!==r.sequence)throw ee(new Error('Field "sequence" did not match between protobuf and CBOR'),Nc);if(e.TTL!==r.ttl)throw ee(new Error('Field "ttl" did not match between protobuf and CBOR'),Nc)},X8=function(){var r=(0,B.Z)(function*(e,t){const n=(r=>Ai(r.slice(oP.length)))(e),s=x1(t),i=yield ehe(n,s);yield phe(i,s)});return function(t,n){return r.apply(this,arguments)}}(),q8=Be("ipfs:ipns:resolver"),ghe=Wi().code;class bhe{constructor(e){this._routing=e}resolve(e,t={}){var n=this;return(0,B.Z)(function*(){if("string"!=typeof e)throw ee(new Error("invalid name"),"ERR_INVALID_NAME");const s=t.recursive&&"true"===t.recursive.toString(),i=e.split("/");if(3!==i.length||""!==i[0])throw ee(new Error("invalid name"),"ERR_INVALID_NAME");const o=i[2];let a=1/0;s&&(a=32);const c=yield n.resolver(o,a,t);return q8(`${e} was locally resolved correctly`),c})()}resolver(e,t,n){var s=this;return(0,B.Z)(function*(){if(0===t){const a="could not resolve name (recursion limit of 32 exceeded)";throw q8.error(a),ee(new Error(a),"ERR_RESOLVE_RECURSION_LIMIT")}const i=yield s._resolveName(e,n),o=i.split("/");return"ipfs"!==o[1]&&t?s.resolver(o[2],t-1,n):i})()}_resolveName(e,t){var n=this;return(0,B.Z)(function*(){const s=bt(e),i=S1(s);let o;try{o=yield n._routing.get(i,t)}catch(a){throw q8.error("could not get record from routing",a),a.code===ghe?ee(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND"):ee(new Error(`unexpected error getting the ipns record ${s.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}return n._validateRecord(s,o)})()}_validateRecord(e,t){return(0,B.Z)(function*(){return yield X8(zf([va("/ipns/"),e.toBytes()]),t),ts(x1(t).value)})()}}class _he{constructor(e){this.lru=cf(e)}get(e){const t=this.lru.get(e);if(t)return t.expire&&t.expire<Date.now()?void this.lru.remove(e):t.value}set(e,t,n){this.lru.set(e,{value:t,expire:Date.now()+n})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}}const jf=Be("ipfs:ipns");class yP{constructor(e,t,n,s,i){this.publisher=new Q8(e,t),this.republisher=new hhe(this.publisher,t,n,s,i),this.resolver=new bhe(e),this.cache=new _he(1e3),this.routing=e}publish(e,t,n=Q8.defaultRecordLifetime,s){var i=this;return(0,B.Z)(function*(){try{yield i.publisher.publishWithEOL(e,t,n,s),jf(`IPNS value ${ts(t,"base32")} was published correctly`);const o=e.toString(),a=parseFloat(n);return i.cache.set(o,t,a<6e4?a:6e4),jf(`IPNS value ${ts(t,"base32")} was cached correctly`),{name:o,value:t}}catch(o){throw jf.error(o),o}})()}resolve(e,t={}){var n=this;return(0,B.Z)(function*(){if("string"!=typeof e)throw ee(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!t.nocache&&!t.recursive){const s=e.split("/")[2],i=n.cache.get(s);if(i)return i}try{const s=yield n.resolver.resolve(e,t);return jf(`IPNS record from ${e} was resolved correctly`),s}catch(s){throw jf.error(s),s}})()}initializeKeyspace(e,t,n){var s=this;return(0,B.Z)(function*(){return s.publish(e,t,Q8.defaultRecordLifetime,n)})()}}var mhe=p(32062);const gP=(r,e)=>Ee(function*(){const t=yield X(mhe(r));yield*Fe(be(t.sort(e)),X)})();var C1=p(74817),Hl=p(62785),bP=p(93445);class I1{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}putMany(e,t={}){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(e);s=!(c=yield X(a.next())).done;s=!1){const{key:u,value:f}=c.value;yield X(n.put(u,f,t)),yield{key:u,value:f}}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()}getMany(e,t={}){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(e);s=!(c=yield X(a.next())).done;s=!1){const u=c.value;yield n.get(u,t)}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()}deleteMany(e,t={}){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(e);s=!(c=yield X(a.next())).done;s=!1){const u=c.value;yield X(n.delete(u,t)),yield u}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()}batch(){var e=this;let t=[],n=[];return{put(s,i){t.push({key:s,value:i})},delete(s){n.push(s)},commit:(s=(0,B.Z)(function*(i){yield C1(e.putMany(t,i)),t=[],yield C1(e.deleteMany(n,i)),n=[]}),function(o){return s.apply(this,arguments)})};var s}_all(e,t){return Ee(function*(){throw new Error("._all is not implemented")})()}_allKeys(e,t){return Ee(function*(){throw new Error("._allKeys is not implemented")})()}query(e,t){let n=this._all(e,t);if(null!=e.prefix&&(n=Hl(n,s=>s.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(n=e.filters.reduce((s,i)=>Hl(s,i),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((s,i)=>gP(s,i),n)),null!=e.offset){let s=0;n=Hl(n,()=>s++>=e.offset)}return null!=e.limit&&(n=bP(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(null!=e.prefix&&(n=Hl(n,s=>s.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(n=e.filters.reduce((s,i)=>Hl(s,i),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((s,i)=>gP(s,i),n)),null!=e.offset){let s=0;n=Hl(n,()=>s++>=e.offset)}return null!=e.limit&&(n=bP(n,e.limit)),n}}class _P{constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class e4{constructor(e={}){var t;this.hwm=null!==(t=e.splitLimit)&&void 0!==t?t:16,this.head=new _P(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){null!=e?.value&&(this.size+=this.calculateSize(e.value)),this.head.push(e)||(this.head=this.head.next=new _P(2*this.head.buffer.length),this.head.push(e))}shift(){var e;let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const n=this.tail.next;this.tail.next=null,this.tail=n,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}function ss(r={}){return mP(t=>{const n=t.shift();if(null==n)return{done:!0};if(null!=n.error)throw n.error;return{done:!0===n.done,value:n.value}},r)}function mP(r,e){var t;let i,o,a,n=(e=null!==(t=e)&&void 0!==t?t:{}).onEnd,s=new e4;const c=function(){var F=(0,B.Z)(function*(){return s.isEmpty()?a?{done:!0}:yield new Promise((M,H)=>{o=$=>{o=null,s.push($);try{M(r(s))}catch(V){H(V)}return i}}):r(s)});return function(){return F.apply(this,arguments)}}(),u=F=>null!=o?o(F):(s.push(F),i),E=F=>{var M;if(a)return i;if(!0!==(null===(M=e)||void 0===M?void 0:M.objectMode)&&null==F?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return u({done:!1,value:F})},T=F=>a?i:(a=!0,null!=F?(F=>(s=new e4,null!=o?o({error:F}):(s.push({error:F}),i)))(F):u({done:!0}));if(i={[Symbol.asyncIterator](){return this},next:c,return:()=>(s=new e4,T(),{done:!0}),throw:F=>(T(F),{done:!0}),push:E,end:T,get readableLength(){return s.size}},null==n)return i;const P=i;return i={[Symbol.asyncIterator](){return this},next:()=>P.next(),throw:F=>(P.throw(F),null!=n&&(n(F),n=void 0),{done:!0}),return:()=>(P.return(),null!=n&&(n(),n=void 0),{done:!0}),push:E,end:F=>(P.end(F),null!=n&&(n(F),n=void 0),i),get readableLength(){return P.readableLength}},i}const whe=Be("datastore:core:tiered");class Ehe extends I1{constructor(e){super(),this.stores=e.slice()}open(){var e=this;return(0,B.Z)(function*(){try{yield Promise.all(e.stores.map(t=>t.open()))}catch{throw gD()}})()}put(e,t,n){var s=this;return(0,B.Z)(function*(){try{yield Promise.all(s.stores.map(i=>i.put(e,t,n)))}catch{throw R5()}})()}get(e,t){var n=this;return(0,B.Z)(function*(){for(const s of n.stores)try{const i=yield s.get(e,t);if(i)return i}catch(i){whe.error(i)}throw Wi()})()}has(e,t){var n=this;return(0,B.Z)(function*(){for(const s of n.stores)if(yield s.has(e,t))return!0;return!1})()}delete(e,t){var n=this;return(0,B.Z)(function*(){try{yield Promise.all(n.stores.map(s=>s.delete(e,t)))}catch{throw bD()}})()}putMany(e,t={}){var n=this;return Ee(function*(){let s;const i=n.stores.map(E=>{const T=ss({objectMode:!0});return C1(E.putMany(T,t)).catch(U=>{s=U}),T});try{var c,o=!1,a=!1;try{for(var f,u=be(e);o=!(f=yield X(u.next())).done;o=!1){const E=f.value;if(s)throw s;i.forEach(T=>T.push(E)),yield E}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}}finally{i.forEach(E=>E.end())}})()}deleteMany(e,t={}){var n=this;return Ee(function*(){let s;const i=n.stores.map(E=>{const T=ss({objectMode:!0});return C1(E.deleteMany(T,t)).catch(U=>{s=U}),T});try{var c,o=!1,a=!1;try{for(var f,u=be(e);o=!(f=yield X(u.next())).done;o=!1){const E=f.value;if(s)throw s;i.forEach(T=>T.push(E)),yield E}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}}finally{i.forEach(E=>E.end())}})()}close(){var e=this;return(0,B.Z)(function*(){yield Promise.all(e.stores.map(t=>t.close()))})()}batch(){const e=this.stores.map(t=>t.batch());return{put:(t,n)=>{e.forEach(s=>s.put(t,n))},delete:t=>{e.forEach(n=>n.delete(t))},commit:(t=(0,B.Z)(function*(n){for(const s of e)yield s.commit(n)}),function(s){return t.apply(this,arguments)})};var t}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}}var Ot=p(79289);const vP=(r,e)=>{const t=e.map((n,s)=>({entry:Xi.decode(n),index:s}));return t.sort((n,s)=>{var i,o,a,c;if(null!=n.entry.signatureV2&&null==s.entry.signatureV2)return-1;if(null==n.entry.signatureV2&&null!=s.entry.signatureV2)return 1;const u=null!==(i=n.entry.sequence)&&void 0!==i?i:0n,f=null!==(o=s.entry.sequence)&&void 0!==o?o:0n;if(u>f)return-1;if(u<f)return 1;const E=null!==(a=n.entry.validity)&&void 0!==a?a:new Uint8Array(0),T=null!==(c=s.entry.validity)&&void 0!==c?c:new Uint8Array(0),U=H8(J8(E)),b=H8(J8(T));return U.getTime()>b.getTime()?-1:U.getTime()<b.getTime()?1:0}),t[0].index};class Ihe extends I1{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}put(e,t){var n=this;return(0,B.Z)(function*(){n.data[e.toString()]=t})()}get(e){var t=this;return(0,B.Z)(function*(){if(!(yield t.has(e)))throw Wi();return t.data[e.toString()]})()}has(e){var t=this;return(0,B.Z)(function*(){return void 0!==t.data[e.toString()]})()}delete(e){var t=this;return(0,B.Z)(function*(){delete t.data[e.toString()]})()}_all(){var e=this;return Ee(function*(){yield*Fe(be(Object.entries(e.data).map(([t,n])=>({key:new ft(t),value:n}))),X)})()}_allKeys(){var e=this;return Ee(function*(){yield*Fe(be(Object.entries(e.data).map(([t])=>new ft(t))),X)})()}}p(49072);var Rhe=p(85273);const wP=r=>null!=r&&("function"==typeof r[Symbol.asyncIterator]||"function"==typeof r[Symbol.iterator]||"function"==typeof r.next),r4=r=>null!=r&&"function"==typeof r.sink&&wP(r.source),Ohe=r=>e=>{const t=r.sink(e);if(null!=t.then){const n=ss({objectMode:!0});return t.then(()=>{n.end()},i=>{n.end(i)}),Rhe(n,function(){var i=Ee(function*(){yield*Fe(be(r.source),X),n.end()});return function(){return i.apply(this,arguments)}}()())}return r.source};function _t(r,...e){if(r4(r)){const n=r;r=()=>n.source}else if(wP(r)){const n=r;r=()=>n}const t=[r,...e];if(t.length>1&&r4(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let n=1;n<t.length-1;n++)r4(t[n])&&(t[n]=Ohe(t[n]));return((...r)=>{let e;for(;r.length>0;)e=r.shift()(e);return e})(...t)}new ft("SHARDING"),new ft("_README"),p(61700);const Lhe=function Phe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},R1=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class Fhe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class zhe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return EP(this,e)}}class Vhe{constructor(e){this.decoders=e}or(e){return EP(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const EP=(r,e)=>new Vhe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class jhe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new Fhe(e,t,n),this.decoder=new zhe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const D1=({name:r,prefix:e,encode:t,decode:n})=>new jhe(r,e,t,n),Zf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=Lhe(t,e);return D1({prefix:r,name:e,encode:n,decode:i=>R1(s(i))})},In=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>D1({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),Zhe=D1({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),Hhe=In({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Ghe=In({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Whe=Zf({prefix:"9",name:"base10",alphabet:"0123456789"}),Yhe=In({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Qhe=In({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Jhe=In({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Xhe=In({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),qhe=In({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),e0e=In({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),t0e=In({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),r0e=In({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),n0e=In({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),s0e=In({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),i0e=In({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),o0e=Zf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),a0e=Zf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),c0e=Zf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),l0e=Zf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),u0e=In({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),d0e=In({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),f0e=In({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),h0e=In({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),xP=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),p0e=xP.reduce((r,e,t)=>(r[t]=e,r),[]),y0e=xP.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),_0e=D1({prefix:"\u{1f680}",name:"base256emoji",encode:function g0e(r){return r.reduce((e,t)=>e+p0e[t],"")},decode:function b0e(r){const e=[];for(const t of r){const n=y0e[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var E0e=Math.pow(2,31),A0e=Math.pow(2,7),T0e=Math.pow(2,14),C0e=Math.pow(2,21),I0e=Math.pow(2,28),R0e=Math.pow(2,35),D0e=Math.pow(2,42),O0e=Math.pow(2,49),P0e=Math.pow(2,56),N0e=Math.pow(2,63),L0e={encode:function AP(r,e,t){e=e||[];for(var n=t=t||0;r>=E0e;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,AP.bytes=t-n+1,e},decode:function n4(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw n4.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return n4.bytes=i-n,t},encodingLength:function(r){return r<A0e?1:r<T0e?2:r<C0e?3:r<I0e?4:r<R0e?5:r<D0e?6:r<O0e?7:r<P0e?8:r<N0e?9:10}};const CP=L0e,IP=(r,e,t=0)=>(CP.encode(r,e,t),e),RP=r=>CP.encodingLength(r),s4=(r,e)=>{const t=e.byteLength,n=RP(r),s=n+RP(t),i=new Uint8Array(s+t);return IP(r,i,0),IP(t,i,n),i.set(e,s),new DP(r,t,e,i)};class DP{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const OP=({name:r,code:e,encode:t})=>new U0e(r,e,t);class U0e{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?s4(this.code,t):t.then(n=>s4(this.code,n))}throw Error("Unknown type, must be binary type")}}const PP=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),M0e=OP({name:"sha2-256",code:18,encode:PP("SHA-256")}),F0e=OP({name:"sha2-512",code:19,encode:PP("SHA-512")}),BP=R1,V0e={code:0,name:"identity",encode:BP,digest:r=>s4(0,BP(r))},j0e="raw",$0e=85,K0e=r=>R1(r),Z0e=r=>R1(r),H0e=new TextEncoder,G0e=new TextDecoder,W0e="json",Y0e=512,Q0e=r=>H0e.encode(JSON.stringify(r)),J0e=r=>JSON.parse(G0e.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const UP={...bd,..._d,...md,...vd,...wd,...xs,...Ed,...xd,...Sd,...Ad};function MP(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function FP(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const zP=FP("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),o4=FP("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function spe(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?MP(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),VP={utf8:zP,"utf-8":zP,hex:UP.base16,latin1:o4,ascii:o4,binary:o4,...UP};function jP(r,e="utf8"){const t=VP[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}function $P(r,e="utf8"){const t=VP[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):MP(globalThis.Buffer.from(r,"utf-8"))}const O1="/record/";function KP(r){return jP(r,"base32")}function P1(r){("string"==typeof r||r instanceof String)&&(r=$P(r.toString()));const e=jP(r,"base64url");return`${O1}${e}`}const Rn=Be("datastore-pubsub:publisher");class ape extends I1{constructor(e,t,n,s,i,o){if(super(),!s)throw ee(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if("function"!=typeof s)throw ee(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if("function"!=typeof i)throw ee(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(o&&"function"!=typeof o)throw ee(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=t,this._peerId=n,this._validator=s,this._selector=i,this._handleSubscriptionKeyFn=o,this._onMessage=this._onMessage.bind(this),this._pubsub.addEventListener("message",this._onMessage)}put(e,t,n){var s=this;return(0,B.Z)(function*(){if(!(e instanceof Uint8Array)){const o="datastore key does not have a valid format";throw Rn.error(o),ee(new Error(o),"ERR_INVALID_DATASTORE_KEY")}if(!(t instanceof Uint8Array)){const o="received value is not a Uint8Array";throw Rn.error(o),ee(new Error(o),"ERR_INVALID_VALUE_RECEIVED")}const i=P1(e);Rn(`publish value for topic ${i}`),yield s._pubsub.publish(i,t)})()}get(e,t){var n=this;return(0,B.Z)(function*(){if(!(e instanceof Uint8Array)){const o="datastore key does not have a valid format";throw Rn.error(o),ee(new Error(o),"ERR_INVALID_DATASTORE_KEY")}const s=P1(e),i=yield n._pubsub.getTopics();if(i&&Array.isArray(i)&&i.indexOf(s)>-1)return n._getLocal(e,t);try{yield n._pubsub.subscribe(s)}catch{const a=`cannot subscribe topic ${s}`;throw Rn.error(a),ee(new Error(a),"ERR_SUBSCRIBING_TOPIC")}return Rn(`subscribed values for key ${s}`),n._getLocal(e)})()}unsubscribe(e){const t=P1(e);return this._pubsub.unsubscribe(t)}_getLocal(e,t){var n=this;return(0,B.Z)(function*(){const s=new ft("/"+KP(e),!1);let i;try{i=yield n._datastore.get(s,t)}catch(o){if("ERR_NOT_FOUND"!==o.code){const c=`unexpected error getting the ipns record for ${s.toString()}`;throw Rn.error(c),ee(new Error(c),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}const a=`local record requested was not found for ${s.toString()}`;throw Rn.error(a),ee(new Error(a),"ERR_NOT_FOUND")}if(!(i instanceof Uint8Array)){const o="found record that we couldn't convert to a value";throw Rn.error(o),ee(new Error(o),"ERR_INVALID_RECORD_RECEIVED")}return i})()}_onMessage(e){var t=this;return(0,B.Z)(function*(){const n=e.detail;if("signed"!==n.type)return void Rn.error("unsigned message received, this module can only work with signed messages");const{data:s,from:i,topic:o}=n;let a;try{a=function ipe(r){if(r.substring(0,O1.length)!==O1)throw ee(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");return $P(r.substring(O1.length),"base64url")}(o)}catch(c){return void Rn.error(c)}if(Rn(`message received for topic ${o}`),t._peerId.equals(i))Rn("message discarded as it is from the same peer");else{if(t._handleSubscriptionKeyFn){let c;try{c=yield t._handleSubscriptionKeyFn(a)}catch{return void Rn.error("message discarded by the subscriptionKeyFn")}a=c}try{yield t._storeIfSubscriptionIsBetter(a,s)}catch(c){Rn.error(c)}}})()}_storeIfSubscriptionIsBetter(e,t,n){var s=this;return(0,B.Z)(function*(){let i=!1;try{i=yield s._isBetter(e,t)}catch(o){if("ERR_NOT_VALID_RECORD"!==o.code)throw o}i&&(yield s._storeRecord(e,t,n))})()}_validateRecord(e,t){var n=this;return(0,B.Z)(function*(){return n._validator(e,t)})()}_selectRecord(e,t){var n=this;return(0,B.Z)(function*(){return 0===(yield n._selector(e,t))})()}_isBetter(e,t){var n=this;return(0,B.Z)(function*(){try{yield n._validateRecord(e,t)}catch{const a="record received through pubsub is not valid";throw Rn.error(a),ee(new Error(a),"ERR_NOT_VALID_RECORD")}const s=new ft(e);let i;try{i=yield n._getLocal(s.uint8Array())}catch{return!0}return!function ope(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}(i,t)&&n._selectRecord(e,[i,t])})()}_storeRecord(e,t,n){var s=this;return(0,B.Z)(function*(){const i=new ft("/"+KP(e),!1);yield s._datastore.put(i,t,n),Rn(`record for ${P1(e)} was stored in the datastore`)})()}}const N1=Be("ipfs:ipns:pubsub");class a4{constructor(e,t,n){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new ape(e,t,n,X8,vP,this._handleSubscriptionKey)}put(e,t,n){var s=this;return(0,B.Z)(function*(){try{yield s._pubsubDs.put(e,t,n)}catch(i){throw N1.error(i),i}})()}get(e,t){var n=this;return(0,B.Z)(function*(){let s,i;try{s=yield n._pubsubDs.get(e,t)}catch(a){i=a}if(ts(e.slice(0,W8))===A1){const a=Hs.encode(e).substring(1),c=Hs.encode(e.slice(W8)).substring(1);n._subscriptions[a]=c,N1(`subscribed to pubsub topic ${a}, id ${c}`)}if(i)throw i;return s})()}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=ts(e,"base58btc"));const t=this._subscriptions[e];if(!t)throw ee(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");try{return S1(bt(t))}catch(n){throw N1.error(n),n}}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map(t=>`${A1}${t}`)}cancel(e){var t=this;return(0,B.Z)(function*(){if("string"!=typeof e)throw ee(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(A1)&&(e=e.substring(W8));const n=Object.keys(t._subscriptions).find(i=>t._subscriptions[i]===e);if(!n)return{canceled:!1};const s=va(n);return t._pubsubDs.unsubscribe(s),delete t._subscriptions[n],N1(`unsubscribed pubsub ${n}: ${e}`),{canceled:!0}})()}}var B1;function cpe(r){const e=r.getUTCFullYear(),t=String(r.getUTCMonth()+1).padStart(2,"0"),n=String(r.getUTCDate()).padStart(2,"0"),s=String(r.getUTCHours()).padStart(2,"0"),i=String(r.getUTCMinutes()).padStart(2,"0"),o=String(r.getUTCSeconds()).padStart(2,"0"),a=r.getUTCMilliseconds();return`${e}-${t}-${n}T${s}:${i}:${o}.${String(1e3*a*1e3).padStart(9,"0")}Z`}!function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{!1!==s.lengthDelimited&&n.fork(),(!0===s.writeDefaults||null!=t.key&&t.key.byteLength>0)&&(n.uint32(10),n.bytes(t.key)),(!0===s.writeDefaults||null!=t.value&&t.value.byteLength>0)&&(n.uint32(18),n.bytes(t.value)),(!0===s.writeDefaults||""!==t.timeReceived)&&(n.uint32(42),n.string(t.timeReceived)),!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={key:new Uint8Array(0),value:new Uint8Array(0),timeReceived:""},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();switch(o>>>3){case 1:s.key=t.bytes();break;case 2:s.value=t.bytes();break;case 5:s.timeReceived=t.string();break;default:t.skipType(7&o)}}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(B1||(B1={}));class Ts{constructor(e,t,n){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=n}serialize(){return B1.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:cpe(this.timeReceived)}}static deserialize(e){const t=B1.decode(e);return new Ts(t.key,t.value,new Date(t.timeReceived))}static fromDeserialized(e){const t=function lpe(r){const e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),t=String(r).trim().match(e);if(null==t)throw new Error("Invalid format");const n=parseInt(t[1],10),s=parseInt(t[2],10)-1,i=parseInt(t[3],10),o=parseInt(t[4],10),a=parseInt(t[5],10),c=parseInt(t[6],10),u=parseInt(t[7].slice(0,-6),10);return new Date(Date.UTC(n,s,i,o,a,c,u))}(e.timeReceived);if(null==e.key)throw new Error("key missing from deserialized object");if(null==e.value)throw new Error("value missing from deserialized object");return new Ts(e.key,e.value,t)}}const c4=Be("ipfs:ipns:offline-datastore");class ZP{constructor(e){this._datastore=e,this.stores=[]}put(e,t,n){var s=this;return(0,B.Z)(function*(){if(!(e instanceof Uint8Array))throw ee(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(t instanceof Uint8Array))throw ee(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let i;try{i=s._routingKey(e)}catch(a){throw c4.error(a),ee(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const o=new Ts(e,t,new Date);yield s._datastore.put(i,o.serialize(),n)})()}get(e,t){var n=this;return(0,B.Z)(function*(){if(!(e instanceof Uint8Array))throw ee(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let s;try{s=n._routingKey(e)}catch(a){throw c4.error(a),ee(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const i=yield n._datastore.get(s,t);let o;try{o=Ts.deserialize(i)}catch(a){throw c4.error(a),a}return o.value})()}_routingKey(e){return new ft("/dht/record/"+ts(e,"base32"),!1)}}function Oi(r){return l4.apply(this,arguments)}function l4(){return l4=(0,B.Z)(function*(r){var n,e=!1,t=!1;try{for(var s=be(r);e=!(yield s.next()).done;e=!1);}catch(o){t=!0,n=o}finally{try{e&&null!=s.return&&(yield s.return())}finally{if(t)throw n}}}),l4.apply(this,arguments)}const upe=Be("ipfs:ipns:dht-datastore");class dpe{constructor(e){this._dht=e}put(e,t,n){var s=this;return(0,B.Z)(function*(){try{yield Oi(s._dht.put(e,t,n))}catch(i){throw upe.error(i),i}})()}get(e,t){var n=this;return(0,B.Z)(function*(){var o,s=!1,i=!1;try{for(var c,a=be(n._dht.get(e,t));s=!(c=yield a.next()).done;s=!1){const u=c.value;if("VALUE"===u.name)return u.value}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield a.return())}finally{if(i)throw o}}throw Wi()})()}}const hpe=Be("ipfs:components:ipns");class ppe{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){const e=this.online||this.offline;if(e)return e;throw new WC}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:t,keychain:n}){if(null!=this.offline)throw new R6;hpe("initializing IPNS keyspace (offline)");const s=new ZP(e.datastore),i=new yP(s,e.datastore,t,n,this.options);this.offline=i}startOnline({libp2p:e,repo:t,peerId:n,keychain:s}){var i=this;return(0,B.Z)(function*(){if(null!=i.online)throw new R6;const o=function fpe({libp2p:r,repo:e,peerId:t,options:n}){const s=[];let i;if(Ot(n,"EXPERIMENTAL.ipnsPubsub",!1)&&(i=new a4(r.pubsub,e.datastore,t),s.push(i)),!0!==Ot(n,"offline",!1)&&["dht","dhtclient","dhtserver"].includes(Ot(n,"config.Routing.Type","none"))&&s.push(new dpe(r.dht)),Ot(n,"offline",!1)||0===s.length){const o=new ZP(e.datastore);s.push(o)}return new Ehe(s)}({libp2p:e,repo:t,peerId:n,options:i.options}),a=new yP(o,t.datastore,n,s,i.options);yield a.republisher.start(),i.online=a})()}stop(){var e=this;return(0,B.Z)(function*(){const t=e.online;t&&(yield t.republisher.stop(),e.online=null)})()}publish(e,t,n,s){return this.getIPNS().publish(e,t,n,s)}resolve(e,t){return this.getIPNS().resolve(e,t)}initializeKeyspace(e,t,n){return this.getIPNS().initializeKeyspace(e,t,n)}}function ype(r,e,t){return u4.apply(this,arguments)}function u4(){return u4=(0,B.Z)(function*({ipns:r,repo:e,codecs:t},n,s){if(fR(n))return r.resolve(n);const{cid:i,path:o}=of(n);yield Oi(af(i,o||"",t,e,s))}),u4.apply(this,arguments)}const d4=Be("ipfs:name:publish");var bpe=p(23919);const _pe=Sr.bind({ignoreUndefined:!0}),mpe=Be("ipfs:name:resolve"),HP=(r,e)=>e.length>0?r+"/"+e.join("/"):r;function f4(r,e){if(!r||!e||!e.ipnsPubsub)throw ee(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(r.routing instanceof a4)return r.routing;const t=(r.routing.stores||[]).find(n=>n instanceof a4);if(!t)throw ee(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return t}class Spe{constructor({ipns:e,options:t}){this.cancel=function wpe({ipns:r,options:e}){const t=e.EXPERIMENTAL;function s(){return(s=(0,B.Z)(function*(i,o={}){return f4(r,t).cancel(i,o)})).apply(this,arguments)}return ze(function n(i){return s.apply(this,arguments)})}({ipns:e,options:t}),this.state=function Epe({ipns:r,options:e}){const t=e.EXPERIMENTAL;function s(){return(s=(0,B.Z)(function*(i={}){try{return{enabled:Boolean(f4(r,t))}}catch{return{enabled:!1}}})).apply(this,arguments)}return ze(function n(){return s.apply(this,arguments)})}({ipns:e,options:t}),this.subs=function xpe({ipns:r,options:e}){const t=e.EXPERIMENTAL;function s(){return(s=(0,B.Z)(function*(i={}){return f4(r,t).getSubscriptions(i)})).apply(this,arguments)}return ze(function n(){return s.apply(this,arguments)})}({ipns:e,options:t})}}class Ape{constructor({dns:e,ipns:t,repo:n,codecs:s,peerId:i,isOnline:o,keychain:a,options:c}){this.publish=function gpe({ipns:r,repo:e,codecs:t,peerId:n,isOnline:s,keychain:i}){const o=function(){var u=(0,B.Z)(function*(f){let E;if("self"===f&&null!=n.privateKey)E=yield Oo(n.privateKey);else try{const T=yield i.exportKey(f,"temp");E=yield kf(T,"temp")}catch(T){throw d4.error(T),ee(T,"ERR_CANNOT_GET_KEY")}return Ti(E.public.bytes,E.bytes)});return function(E){return u.apply(this,arguments)}}();function c(){return(c=(0,B.Z)(function*(u,f={}){const E=!1!==f.resolve,T=f.lifetime||"24h",U=f.key||"self";if(!s())throw ee(new Error(jR),"OFFLINE_ERROR");try{u=Soe(u)}catch(H){throw d4.error(H),H}let b=0;try{b=Vp(T)||0,b=parseFloat(b.toFixed(6))}catch(H){throw d4.error(H),H}const P=yield Promise.all([o(U),E?ype({ipns:r,repo:e,codecs:t},u):Promise.resolve()]),F=va(u),M=yield r.publish(P[0],F,b,f);return{name:M.name,value:ts(M.value)}})).apply(this,arguments)}return ze(function a(u){return c.apply(this,arguments)})}({ipns:t,repo:n,codecs:s,peerId:i,isOnline:o,keychain:a}),this.resolve=function vpe({dns:r,ipns:e,isOnline:t,options:{offline:n}}){function i(){return(i=Ee(function*(o,a={}){if(a=_pe({nocache:!1,recursive:!0},a),n&&a&&a.nocache)throw ee(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");if(!t()&&!n)throw ee(new Error(jR),"OFFLINE_ERROR");let c=o.toString();c.startsWith("/ipns/")||(c=`/ipns/${c}`);let[u,f,...E]=c.slice(1).split("/");try{if("1"===f.substring(0,1)){const U=bt(f),b=MC(U.toBytes());f=qe.createV1(114,b).toString(mp)}else{const U=qe.parse(f);1===U.version&&(f=U.toString(mp))}}catch(U){if(bpe(f))return void(yield HP(yield X(r(f,a)),E));throw mpe.error(U),ee(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}const T=yield X(e.resolve(`/${u}/${f}`,a));yield HP(T instanceof Uint8Array?ts(T):T,E)})).apply(this,arguments)}return ze(function s(o){return i.apply(this,arguments)})}({dns:e,ipns:t,isOnline:o,options:c}),this.pubsub=new Spe({ipns:t,options:c})}}const Tpe=Wi().code;function Ipe(r,e,t){const{cid:n,path:s}=of(e);return!1!==t.preload&&r(n),`/ipfs/${n}${s||""}`}function Rpe(r,e,t,n,s){return p4.apply(this,arguments)}function p4(){return p4=Ee(function*(r,e,t,n,s){const i=yield X(r(n,s)),{cid:o}=of(i),a=null!=s.maxDepth?s.maxDepth:1/0,c=s.unique||!1;var E,u=!1,f=!1;try{for(var U,T=be(Ope(e,t,o,a,c,s));u=!(U=yield X(T.next())).done;u=!1){const b=U.value;!b.parent||b.isDuplicate||(yield{ref:Dpe(b.parent.cid,b.node.cid,b.node.name,s.format)})}}catch(b){f=!0,E=b}finally{try{u&&null!=T.return&&(yield X(T.return()))}finally{if(f)throw E}}}),p4.apply(this,arguments)}function Dpe(r,e,t="",n="<dst>"){let s=n.replace(/<src>/g,r.toString());return s=s.replace(/<dst>/g,e.toString()),s=s.replace(/<linkname>/g,t),s}function Ope(r,e,t,n,s,i){return y4.apply(this,arguments)}function y4(){return y4=Ee(function*(r,e,t,n,s,i){const o=new Set;function a(u,f){return c.apply(this,arguments)}function c(){return(c=Ee(function*(u,f){const E=f+1;if(!(E>n))try{var b,T=!1,U=!1;try{for(var F,P=be(Ppe(r,e,u.cid,i));T=!(F=yield X(P.next())).done;T=!1){const M=F.value;yield{parent:u,node:M,isDuplicate:s&&o.has(M.cid.toString())},s&&o.add(M.cid.toString()),yield*Fe(be(a(M,E)),X)}}catch(M){U=!0,b=M}finally{try{T&&null!=P.return&&(yield X(P.return()))}finally{if(U)throw b}}}catch(M){throw M.code===Tpe&&(M.message=`Could not find object with CID: ${u.cid}`),M}})).apply(this,arguments)}yield*Fe(be(a({cid:t},0)),X)}),y4.apply(this,arguments)}function Ppe(r,e,t,n){return g4.apply(this,arguments)}function g4(){return g4=Ee(function*(r,e,t,n){const s=yield X(r.blocks.get(t,n)),o=(yield X(e.getCodec(t.code))).decode(s),a=t.code===gr,c=[];for(const[u,f]of b4(o,c)){if(a){const E=u.match(/^Links\/(\d+)\/Hash$/);if(E){const T=Number(E[1]);if(T<o.Links.length){yield{name:o.Links[T].Name,cid:f};continue}}}yield{name:u,cid:f}}}),g4.apply(this,arguments)}const b4=function*(r,e){if(null!=r&&!(r instanceof Uint8Array)){for(const[t,n]of Object.entries(r)){const s=[...e,t];if(null!=n&&"object"==typeof n)if(Array.isArray(n))for(const[i,o]of n.entries()){const a=[...s,i],c=qe.asCID(o);c?yield[a.join("/"),c]:"object"==typeof o&&(yield*b4(o,a))}else{const i=qe.asCID(n);i?yield[s.join("/"),i]:yield*b4(n,s)}}return[]}};function Npe({repo:r}){function t(){return(t=Ee(function*(n={}){var o,s=!1,i=!1;try{for(var c,a=be(r.blocks.queryKeys({},{signal:n.signal}));s=!(c=yield X(a.next())).done;s=!1)yield{ref:c.value.toString()}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})).apply(this,arguments)}return ze(function e(){return t.apply(this,arguments)})}function GP({network:r}){function t(){return(t=(0,B.Z)(function*(n={}){const s=(yield r.use(n)).bitswap,i=s.stat().snapshot;return{provideBufLen:parseInt(i.providesBufferLength.toString()),blocksReceived:BigInt(i.blocksReceived.toString()),wantlist:Array.from(s.getWantlist()).map(o=>o[1].cid),peers:s.peers(),dupBlksReceived:BigInt(i.dupBlksReceived.toString()),dupDataReceived:BigInt(i.dupDataReceived.toString()),dataReceived:BigInt(i.dataReceived.toString()),blocksSent:BigInt(i.blocksSent.toString()),dataSent:BigInt(i.dataSent.toString())}})).apply(this,arguments)}return ze(function e(){return t.apply(this,arguments)})}class Upe{constructor({network:e}){this.wantlist=function Bpe({network:r}){function t(){return(t=(0,B.Z)(function*(n={}){const{bitswap:s}=yield r.use(n),i=s.getWantlist();return Array.from(i).map(o=>o[1].cid)})).apply(this,arguments)}return ze(function e(){return t.apply(this,arguments)})}({network:e}),this.wantlistForPeer=function Lpe({network:r}){function t(){return(t=(0,B.Z)(function*(n,s={}){const{bitswap:i}=yield r.use(s),o=i.wantlistForPeer(n);return Array.from(o).map(a=>a[1].cid)})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}({network:e}),this.unwant=function kpe({network:r}){function t(){return(t=(0,B.Z)(function*(n,s={}){const{bitswap:i}=yield r.use(s);return Array.isArray(n)||(n=[n]),i.unwant(n)})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}({network:e}),this.stat=GP({network:e})}}function WP(r){try{return Yre.matches(r)}catch{return!1}}class $pe{constructor({repo:e}){this.add=function Mpe({repo:r}){function t(){return(t=(0,B.Z)(function*(n,s={}){if(!WP(n))throw new Error(`${n} is not a valid Multiaddr`);const i=yield r.config.getAll(s),o=i.Bootstrap||[];return o.push(n.toString()),i.Bootstrap=Array.from(new Set(o)).sort((a,c)=>a.localeCompare(c)),yield r.config.replace(i),{Peers:[n]}})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}({repo:e}),this.list=function zpe({repo:r}){function t(){return(t=(0,B.Z)(function*(n={}){return{Peers:((yield r.config.get("Bootstrap",n))||[]).map(i=>at(i))}})).apply(this,arguments)}return ze(function e(){return t.apply(this,arguments)})}({repo:e}),this.rm=function jpe({repo:r}){function t(){return(t=(0,B.Z)(function*(n,s={}){if(!WP(n))throw new Error(`${n} is not a valid Multiaddr`);const i=yield r.config.getAll(s);return i.Bootstrap=(i.Bootstrap||[]).filter(o=>o.toString()!==n.toString()),yield r.config.replace(i),{Peers:[n]}})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}({repo:e}),this.clear=function Fpe({repo:r}){function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.config.getAll(n),i=s.Bootstrap||[];return s.Bootstrap=[],yield r.config.replace(s),{Peers:i.map(o=>at(o))}})).apply(this,arguments)}return ze(function e(){return t.apply(this,arguments)})}({repo:e}),this.reset=function Vpe({repo:r}){function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.config.getAll(n);return s.Bootstrap=["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],yield r.config.replace(s),{Peers:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"].map(i=>at(i))}})).apply(this,arguments)}return ze(function e(){return t.apply(this,arguments)})}({repo:e})}}function en(){const r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r}var _4;const L1=null!==(_4=globalThis.CustomEvent)&&void 0!==_4?_4:Event;function k1(r){return m4.apply(this,arguments)}function m4(){return m4=Ee(function*(r,e={}){var t;let n=null!==(t=e.concurrency)&&void 0!==t?t:1/0;n<1&&(n=1/0);const s=e.ordered??!1,i=new EventTarget,o=[];let f,a=en(),c=en(),u=!1,E=!1;function T(){var P;return s?null===(P=o[0])||void 0===P?void 0:P.done:Boolean(o.find(F=>F.done))}function*U(){for(;o.length>0&&o[0].done;){const P=o[0];if(o.shift(),!P.ok)throw E=!0,a.resolve(),P.err;yield P.value,a.resolve()}}function*b(){for(;T();)for(let P=0;P<o.length;P++)if(o[P].done){const F=o[P];if(o.splice(P,1),P--,!F.ok)throw E=!0,a.resolve(),F.err;yield F.value,a.resolve()}}for(i.addEventListener("task-complete",()=>{c.resolve()}),Promise.resolve().then((0,B.Z)(function*(){try{var M,P=!1,F=!1;try{for(var $,H=be(r);P=!($=yield H.next()).done;P=!1){const V=$.value;if(o.length===n&&(a=en(),yield a.promise),E)break;const W={done:!1};o.push(W),V().then(ne=>{W.done=!0,W.ok=!0,W.value=ne,i.dispatchEvent(new L1("task-complete"))},ne=>{W.done=!0,W.err=ne,i.dispatchEvent(new L1("task-complete"))})}}catch(V){F=!0,M=V}finally{try{P&&null!=H.return&&(yield H.return())}finally{if(F)throw M}}u=!0,i.dispatchEvent(new L1("task-complete"))}catch(V){f=V,i.dispatchEvent(new L1("task-complete"))}}));;){if(T()||(c=en(),yield X(c.promise)),null!=f)throw f;if(s?yield*Fe(be(U()),X):yield*Fe(be(b()),X),u&&0===o.length)break}}),m4.apply(this,arguments)}function os(r,e){return v4.apply(this,arguments)}function v4(){return v4=Ee(function*(r,e){var s,t=!1,n=!1;try{for(var o,i=be(r);t=!(o=yield X(i.next())).done;t=!1){const a=o.value;yield e(a)}}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield X(i.return()))}finally{if(n)throw s}}}),v4.apply(this,arguments)}function Js(r,e){return w4.apply(this,arguments)}function w4(){return w4=Ee(function*(r,e){var s,t=!1,n=!1;try{for(var o,i=be(r);t=!(o=yield X(i.next())).done;t=!1){const a=o.value;(yield X(e(a)))&&(yield a)}}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield X(i.return()))}finally{if(n)throw s}}}),w4.apply(this,arguments)}function YP(r){return r instanceof Uint8Array?qe.decode(r):qe.parse(r.toString())}class Ype{constructor({codecs:e,hashers:t,preload:n,repo:s}){this.get=function Kpe({preload:r,repo:e}){function n(){return(n=(0,B.Z)(function*(s,i={}){return!1!==i.preload&&r(s),e.blocks.get(s,i)})).apply(this,arguments)}return ze(function t(s){return n.apply(this,arguments)})}({preload:n,repo:s}),this.put=function Zpe({codecs:r,hashers:e,repo:t,preload:n}){function i(){return(i=(0,B.Z)(function*(o,a={}){const c=a.pin?yield t.gcLock.readLock():null;try{const u=null!=a.version?a.version:0,f=a.format||(0===u?"dag-pb":"raw"),T=yield(yield e.getHasher(a.mhtype||"sha2-256")).digest(o),U=yield r.getCodec(f),b=qe.create(u,U.code,T);return yield t.blocks.put(b,o,{signal:a.signal}),!1!==a.preload&&n(b),!0===a.pin&&(yield t.pins.pinRecursively(b,{signal:a.signal})),b}finally{c&&c()}})).apply(this,arguments)}return ze(function s(o){return i.apply(this,arguments)})}({codecs:e,hashers:t,preload:n,repo:s}),this.rm=function Gpe({repo:r}){function t(){return(t=Ee(function*(n,s={}){Array.isArray(n)||(n=[n]);const i=yield X(r.gcLock.writeLock());try{yield*Fe(be(_t(n,o=>os(o,a=>(0,B.Z)(function*(){const c={cid:a=YP(a)};try{if(!(yield r.blocks.has(a)))throw ee(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");yield r.blocks.delete(a)}catch(u){s.force||(u.message=`cannot remove ${a}: ${u.message}`,c.error=u)}return c})),o=>k1(o,{concurrency:8}),o=>Js(o,()=>!s.quiet))),X)}finally{i()}})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}({repo:s}),this.stat=function Wpe({repo:r,preload:e}){function n(){return(n=(0,B.Z)(function*(s,i={}){return s=YP(s),!1!==i.preload&&e(s),{cid:s,size:(yield r.blocks.get(s)).length}})).apply(this,arguments)}return ze(function t(s){return n.apply(this,arguments)})}({preload:n,repo:s})}}const Qpe=Hp({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),Jpe=En({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Xpe=En({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),qpe=rf({prefix:"9",name:"base10",alphabet:"0123456789"}),e1e=En({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),t1e=En({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),r1e=rf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),n1e=rf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),s1e=En({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),i1e=En({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),o1e=En({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),a1e=En({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),QP=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),c1e=QP.reduce((r,e,t)=>(r[t]=e,r),[]),l1e=QP.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),f1e=Hp({prefix:"\u{1f680}",name:"base256emoji",encode:function u1e(r){return r.reduce((e,t)=>e+c1e[t],"")},decode:function d1e(r){const e=[];for(const t of r){const n=l1e[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}}),JP=({name:r,code:e,encode:t})=>new h1e(r,e,t);class h1e{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Zp(this.code,t):t.then(n=>Zp(this.code,n))}throw Error("Unknown type, must be binary type")}}const XP=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),p1e=JP({name:"sha2-256",code:18,encode:XP("SHA-256")}),y1e=JP({name:"sha2-512",code:19,encode:XP("SHA-512")}),eN=Cl,b1e={code:0,name:"identity",encode:eN,digest:r=>Zp(0,eN(r))},_1e="raw",m1e=85,v1e=r=>Cl(r),w1e=r=>Cl(r),E1e=new TextEncoder,x1e=new TextDecoder,S1e="json",A1e=512,T1e=r=>E1e.encode(JSON.stringify(r)),C1e=r=>JSON.parse(x1e.decode(r)),tN={...Ne,...Le,...Ge,...Ze,...Vt,...Dt,...Nr,...pr,...Xn,...pn};function rN(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function nN(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const sN=nN("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),E4=nN("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function I1e(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?rN(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),R1e={utf8:sN,"utf-8":sN,hex:tN.base16,latin1:E4,ascii:E4,binary:E4,...tN};function Yl(r){return x4.apply(this,arguments)}function x4(){return x4=Ee(function*(r,e={}){const t=r.getReader();try{for(;;){const n=yield X(t.read());if(n.done)return;yield n.value}}finally{!0!==e.preventCancel&&(yield X(t.cancel())),t.releaseLock()}}),x4.apply(this,arguments)}function O1e(r){return Yl("function"==typeof r.stream?r.stream():new Response(r).body)}function Gf(r){const[e,t]=null!=r[Symbol.asyncIterator]?[r[Symbol.asyncIterator](),Symbol.asyncIterator]:[r[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>e.next(),push:s=>{n.push(s)},next:()=>n.length>0?{done:!1,value:n.shift()}:e.next(),[t](){return this}}}function Bc(r){return S4.apply(this,arguments)}function S4(){return S4=(0,B.Z)(function*(r){const e=[];var s,t=!1,n=!1;try{for(var o,i=be(r);t=!(o=yield i.next()).done;t=!1)e.push(o.value)}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield i.return())}finally{if(n)throw s}}return e}),S4.apply(this,arguments)}function Ba(r){return ArrayBuffer.isView(r)||r instanceof ArrayBuffer}function Wf(r){return r.constructor&&("Blob"===r.constructor.name||"File"===r.constructor.name)&&"function"==typeof r.stream}function A4(r){return"object"==typeof r&&(r.path||r.content)}const Yf=r=>r&&"function"==typeof r.getReader;function U1(r){return T4.apply(this,arguments)}function T4(){return T4=Ee(function*(r){yield r}),T4.apply(this,arguments)}function iN(r){return C4.apply(this,arguments)}function C4(){return C4=(0,B.Z)(function*(r){if(Ba(r))return U1(I4(r));if("string"==typeof r||r instanceof String)return U1(I4(r.toString()));if(Wf(r))return O1e(r);if(Yf(r)&&(r=Yl(r)),Symbol.iterator in r||Symbol.asyncIterator in r){const e=Gf(r),{value:t,done:n}=yield e.peek();if(n)return U1(new Uint8Array(0));if(e.push(t),Number.isInteger(t))return U1(Uint8Array.from(yield Bc(e)));if(Ba(t)||"string"==typeof t||t instanceof String)return os(e,I4)}throw ee(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT")}),C4.apply(this,arguments)}function I4(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?new Uint8Array(r):Array.isArray(r)?Uint8Array.from(r):function D1e(r,e="utf8"){const t=R1e[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):rN(globalThis.Buffer.from(r,"utf-8"))}(r.toString())}function R4(){return R4=Ee(function*(r,e){if(null==r)throw ee(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT");if("string"==typeof r||r instanceof String)yield M1(r.toString(),e);else if(Ba(r)||Wf(r))yield M1(r,e);else{if(Yf(r)&&(r=Yl(r)),Symbol.iterator in r||Symbol.asyncIterator in r){const t=Gf(r),{value:n,done:s}=yield X(t.peek());if(s)return void(yield{content:[]});if(t.push(n),Number.isInteger(n)||Ba(n)||"string"==typeof n||n instanceof String)return void(yield M1(t,e));throw ee(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(!A4(r))throw ee(new Error('Unexpected input: cannot convert "'+typeof r+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT");yield M1(r,e)}}),R4.apply(this,arguments)}function M1(r,e){return D4.apply(this,arguments)}function D4(){return D4=(0,B.Z)(function*(r,e){const{path:t,mode:n,mtime:s,content:i}=r,o={path:t||"",mode:dl(n),mtime:Cd(s)};return i?o.content=yield e(i):t||(o.content=yield e(r)),o}),D4.apply(this,arguments)}function oN(r){return function P1e(r,e){return R4.apply(this,arguments)}(r,iN)}function F1(r){return O4.apply(this,arguments)}function O4(){return O4=Ee(function*(r,e=1){let t=[];e<1&&(e=1);var i,n=!1,s=!1;try{for(var a,o=be(r);n=!(a=yield X(o.next())).done;n=!1)for(t.push(a.value);t.length>=e;)yield t.slice(0,e),t=t.slice(e)}catch(c){s=!0,i=c}finally{try{n&&null!=o.return&&(yield X(o.return()))}finally{if(s)throw i}}for(;t.length>0;)yield t.slice(0,e),t=t.slice(e)}),O4.apply(this,arguments)}function aN(r){return P4.apply(this,arguments)}function P4(){return P4=Ee(function*(r,e=1){var s,t=!1,n=!1;try{for(var o,i=be(F1(r,e));t=!(o=yield X(i.next())).done;t=!1){const c=o.value.map(function(){var u=(0,B.Z)(function*(f){return yield f().then(E=>({ok:!0,value:E}),E=>({ok:!1,err:E}))});return function(f){return u.apply(this,arguments)}}());for(let u=0;u<c.length;u++){const f=yield X(c[u]);if(!f.ok)throw f.err;yield f.value}}}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield X(i.return()))}finally{if(n)throw s}}}),P4.apply(this,arguments)}new Uint8Array(0);const Ql=r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")};var V1e=Math.pow(2,31),K1e=Math.pow(2,7),Z1e=Math.pow(2,14),H1e=Math.pow(2,21),G1e=Math.pow(2,28),W1e=Math.pow(2,35),Y1e=Math.pow(2,42),Q1e=Math.pow(2,49),J1e=Math.pow(2,56),X1e=Math.pow(2,63),eye={encode:function lN(r,e,t){e=e||[];for(var n=t=t||0;r>=V1e;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,lN.bytes=t-n+1,e},decode:function N4(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw N4.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return N4.bytes=i-n,t},encodingLength:function(r){return r<K1e?1:r<Z1e?2:r<H1e?3:r<G1e?4:r<W1e?5:r<Y1e?6:r<Q1e?7:r<J1e?8:r<X1e?9:10}};const z1=eye,B4=(r,e=0)=>[z1.decode(r,e),z1.decode.bytes],V1=(r,e,t=0)=>(z1.encode(r,e,t),e),j1=r=>z1.encodingLength(r),$1=(r,e)=>{const t=e.byteLength,n=j1(r),s=n+j1(t),i=new Uint8Array(s+t);return V1(r,i,0),V1(t,i,n),i.set(e,s),new L4(r,t,e,i)};class L4{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const dN=({name:r,code:e,encode:t})=>new sye(r,e,t);class sye{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?$1(this.code,t):t.then(n=>$1(this.code,n))}throw Error("Unknown type, must be binary type")}}const fN=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),K1=dN({name:"sha2-256",code:18,encode:fN("SHA-256")}),iye=dN({name:"sha2-512",code:19,encode:fN("SHA-512")}),oye=new Uint8Array(0),hN=r=>{const e=r.match(/../g);return e?new Uint8Array(e.map(t=>parseInt(t,16))):oye};var dye=Math.pow(2,31),pye=Math.pow(2,7),yye=Math.pow(2,14),gye=Math.pow(2,21),bye=Math.pow(2,28),_ye=Math.pow(2,35),mye=Math.pow(2,42),vye=Math.pow(2,49),wye=Math.pow(2,56),Eye=Math.pow(2,63),Sye={encode:function yN(r,e,t){e=e||[];for(var n=t=t||0;r>=dye;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,yN.bytes=t-n+1,e},decode:function k4(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw k4.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return k4.bytes=i-n,t},encodingLength:function(r){return r<pye?1:r<yye?2:r<gye?3:r<bye?4:r<_ye?5:r<mye?6:r<vye?7:r<wye?8:r<Eye?9:10}};const bN=Sye,_N=(r,e,t=0)=>(bN.encode(r,e,t),e),mN=r=>bN.encodingLength(r),vN=(r,e)=>{const t=e.byteLength,n=mN(r),s=n+mN(t),i=new Uint8Array(s+t);return _N(r,i,0),_N(t,i,n),i.set(e,s),new wN(r,t,e,i)};class wN{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const U4=({name:r,code:e,encode:t})=>new Tye(r,e,t);class Tye{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?vN(this.code,t):t.then(n=>vN(this.code,n))}throw Error("Unknown type, must be binary type")}}const Dye=function Cye(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class Oye{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Pye{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return EN(this,e)}}class Nye{constructor(e){this.decoders=e}or(e){return EN(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const EN=(r,e)=>new Nye({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class Bye{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new Oye(e,t,n),this.decoder=new Pye(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const xN=({name:r,prefix:e,encode:t,decode:n})=>new Bye(r,e,t,n),SN=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=Dye(t,e);return xN({prefix:r,name:e,encode:n,decode:i=>(r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")})(s(i))})},Po=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>xN({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)});SN({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),SN({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Po({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Po({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Po({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Po({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Po({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Po({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Po({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Po({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Po({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");var F4=p(48019);U4({name:"murmur3-32",code:35,encode:r=>function $ye(r){const e=new Array(4);for(let t=0;t<4;t++)e[t]=255&r,r>>=8;return new Uint8Array(e)}(F4.x86.hash32(r))});const Z1=U4({name:"murmur3-128",code:34,encode:r=>hN(F4.x64.hash128(r))});function z4(){return z4=(0,B.Z)(function*(r){return(yield Z1.encode(r)).slice(0,8).reverse()}),z4.apply(this,arguments)}U4({name:"murmur3-x64-64",code:34,encode:r=>hN(F4.x64.hash128(r)).subarray(0,8)});const Zye={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:K1,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:0x3df305dfb2a804,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:function Kye(r){return z4.apply(this,arguments)},hamtHashCode:34,hamtBucketBits:8},Hye=(r={})=>Sr.bind({ignoreUndefined:!0})(Zye,r);const Qye=function Gye(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class Jye{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Xye{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return CN(this,e)}}class qye{constructor(e){this.decoders=e}or(e){return CN(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const CN=(r,e)=>new qye({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class e2e{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new Jye(e,t,n),this.decoder=new Xye(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const H1=({name:r,prefix:e,encode:t,decode:n})=>new e2e(r,e,t,n),Jf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=Qye(t,e);return H1({prefix:r,name:e,encode:n,decode:i=>Ql(s(i))})},Dn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>H1({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),No=Jf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),n2e=Jf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Xf=Dn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),s2e=Dn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),i2e=Dn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),o2e=Dn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),a2e=Dn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),c2e=Dn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l2e=Dn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),u2e=Dn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d2e=Dn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),IN=new WeakMap,V4=r=>{const e=IN.get(r);if(null==e){const t=new Map;return IN.set(r,t),t}return e};class On{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==qf)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==g2e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return On.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=$1(e,t);return On.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return On.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?p2e(t,V4(r),e||No.encoder):y2e(t,V4(r),e||Xf.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof On)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new On(n,s,i,o||RN(n,s,i.bytes))}if(!0===t[b2e]){const{version:n,multihash:s,code:i}=t,o=(r=>{const e=Ql(r),[t,n]=B4(e),[s,i]=B4(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new L4(t,s,o,e)})(s);return On.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==qf)throw new Error(`Version 0 CID must use dag-pb (code: ${qf}) block encoding`);return new On(e,t,n,n.bytes);case 1:{const s=RN(e,t,n.bytes);return new On(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return On.create(0,qf,e)}static createV1(e,t){return On.create(1,e,t)}static decode(e){const[t,n]=On.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=On.inspectBytes(e),n=t.size-t.multihashSize,s=Ql(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new L4(t.multihashCode,t.digestSize,i,s);return[0===t.version?On.createV0(o):On.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=B4(e.subarray(t));return t+=T,E};let s=n(),i=qf;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=h2e(e,t),i=On.decode(s);return V4(i).set(n,e),i}}const h2e=(r,e)=>{switch(r[0]){case"Q":return[No.prefix,(e||No).decode(`${No.prefix}${r}`)];case No.prefix:return[No.prefix,(e||No).decode(r)];case Xf.prefix:return[Xf.prefix,(e||Xf).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},p2e=(r,e,t)=>{const{prefix:n}=t;if(n!==No.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},y2e=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},qf=112,g2e=18,RN=(r,e,t)=>{const n=j1(r),s=n+j1(e),i=new Uint8Array(s+t.byteLength);return V1(r,i,0),V1(e,i,n),i.set(t,s),i},b2e=Symbol.for("@ipld/js-cid/CID"),Jl=function(){var r=(0,B.Z)(function*(e,t,n){n.codec||(n.codec=w),n.hasher||(n.hasher=K1),void 0===n.cidVersion&&(n.cidVersion=1),n.codec===w&&n.hasher!==K1&&(n.cidVersion=1);const s=yield n.hasher.digest(e),i=On.create(n.cidVersion,n.codec.code,s);return n.onlyHash||(yield t.put(i,e,{signal:n.signal})),i});return function(t,n,s){return r.apply(this,arguments)}}(),_2e=function(){var r=(0,B.Z)(function*(e,t,n){const s=new ur({type:"directory",mtime:e.mtime,mode:e.mode}),i=ir(Ki({Data:s.marshal()}));return{cid:yield Jl(i,t,n),path:e.path,unixfs:s,size:i.length}});return function(t,n,s){return r.apply(this,arguments)}}(),m2e="raw",j4=85,v2e=r=>Ql(r),w2e=r=>Ql(r);function $4(){return $4=(0,B.Z)(function*(r,e){return e(yield Bc(r))}),$4.apply(this,arguments)}function DN(r,e,t){return K4.apply(this,arguments)}function K4(){return K4=(0,B.Z)(function*(r,e,t){const n=[];var o,s=!1,i=!1;try{for(var c,a=be(F1(r,t.maxChildrenPerNode));s=!(c=yield a.next()).done;s=!1){const u=c.value;n.push(yield e(u))}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield a.return())}finally{if(i)throw o}}return n.length>1?DN(n,e,t):n[0]}),K4.apply(this,arguments)}function Z4(){return Z4=(0,B.Z)(function*(r,e,t){const n=new I2e(t.layerRepeat);let s=0,i=1,o=n;var u,a=!1,c=!1;try{for(var E,f=be(F1(r,t.maxChildrenPerNode));a=!(E=yield f.next()).done;a=!1){const T=E.value;o.isFull()&&(o!==n&&n.addChild(yield o.reduce(e)),s&&s%t.layerRepeat==0&&i++,o=new ON(i,t.layerRepeat,s),s++),o.append(T)}}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield f.return())}finally{if(c)throw u}}return o&&o!==n&&n.addChild(yield o.reduce(e)),n.reduce(e)}),Z4.apply(this,arguments)}class ON{constructor(e,t,n=0){this.maxDepth=e,this.layerRepeat=t,this.currentDepth=1,this.iteration=n,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;const e=this._findParent(this.node,this.currentDepth);return!e||(this._addNextNodeToParent(e),!1)}_addNextNodeToParent(e){this.parent=e;const t={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(t),this.currentDepth=t.depth,this.node=t}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}_reduce(e,t){var n=this;return(0,B.Z)(function*(){let s=[];return e.children.length&&(s=yield Promise.all(e.children.filter(i=>i.data).map(i=>n._reduce(i,t)))),t((e.data||[]).concat(s))})()}_findParent(e,t){const n=e.parent;if(n&&0!==n.depth)return n.children.length!==n.maxChildren&&n.maxChildren?n:this._findParent(n,t)}}class I2e extends ON{constructor(e){super(0,e),this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}}function H4(){return H4=Ee(function*(r,e,t){var i,n=!1,s=!1;try{for(var a,o=be(r.content);n=!(a=yield X(o.next())).done;n=!1){let c=a.value;yield(0,B.Z)(function*(){let u;t.progress(c.length,r.path);const f={codec:w,cidVersion:t.cidVersion,hasher:t.hasher,onlyHash:t.onlyHash};return t.rawLeaves?(f.codec=j0,f.cidVersion=1):(u=new ur({type:t.leafType,data:c}),c=ir({Data:u.marshal(),Links:[]})),{cid:yield Jl(c,e,f),unixfs:u,size:c.length}})}}catch(c){s=!0,i=c}finally{try{n&&null!=o.return&&(yield X(o.return()))}finally{if(s)throw i}}}),H4.apply(this,arguments)}const D2e=function R2e(r,e,t){return H4.apply(this,arguments)},O2e={flat:function E2e(r,e){return $4.apply(this,arguments)},balanced:function S2e(r,e,t){return DN(r,e,t)},trickle:function T2e(r,e,t){return Z4.apply(this,arguments)}};function G4(){return G4=Ee(function*(r,e,t){let s,i,n=-1;i="function"==typeof t.bufferImporter?t.bufferImporter:D2e;var c,o=!1,a=!1;try{for(var f,u=be(aN(i(r,e,t),t.blockWriteConcurrency));o=!(f=yield X(u.next())).done;o=!1){const E=f.value;n++,0!==n?(1===n&&s&&(yield s,s=null),yield E):s=E}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}s&&(s.single=!0,yield s)}),G4.apply(this,arguments)}const N2e=(r,e,t)=>{function s(){return(s=(0,B.Z)(function*(i){if(1===i.length&&i[0].single&&t.reduceSingleLeafToSelf){const E=i[0];if(void 0!==r.mtime||void 0!==r.mode){let T=yield e.get(E.cid);E.unixfs=new ur({type:"file",mtime:r.mtime,mode:r.mode,data:T}),T=ir(Ki({Data:E.unixfs.marshal()})),E.cid=yield Jl(T,e,{...t,codec:w,hasher:t.hasher,cidVersion:t.cidVersion}),E.size=T.length}return{cid:E.cid,path:r.path,unixfs:E.unixfs,size:E.size}}const o=new ur({type:"file",mtime:r.mtime,mode:r.mode}),a=i.filter(E=>!!(E.cid.code===j4&&E.size||E.unixfs&&!E.unixfs.data&&E.unixfs.fileSize())||Boolean(E.unixfs&&E.unixfs.data&&E.unixfs.data.length)).map(E=>E.cid.code===j4?(o.addBlockSize(E.size),{Name:"",Tsize:E.size,Hash:E.cid}):(o.addBlockSize(E.unixfs&&E.unixfs.data?E.unixfs.data.length:E.unixfs&&E.unixfs.fileSize()||0),{Name:"",Tsize:E.size,Hash:E.cid})),c={Data:o.marshal(),Links:a},u=ir(Ki(c));return{cid:yield Jl(u,e,t),path:r.path,unixfs:o,size:u.length+c.Links.reduce((E,T)=>E+T.Tsize,0)}})).apply(this,arguments)}return function n(i){return s.apply(this,arguments)}},L2e=function B2e(r,e,t){const n=O2e[t.strategy];if(!n)throw ee(new Error(`Unknown importer build strategy name: ${t.strategy}`),"ERR_BAD_STRATEGY");return n(function P2e(r,e,t){return G4.apply(this,arguments)}(r,e,t),N2e(r,e,t),t)};function W4(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function La(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.alloc)?W4(globalThis.Buffer.alloc(r)):new Uint8Array(r)}function Y4(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?W4(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function PN(r,e){null==e&&(e=r.reduce((s,i)=>s+i.length,0));const t=Y4(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return W4(t)}function k2e(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}const NN=Symbol.for("@achingbrain/uint8arraylist");function BN(r,e){if(null==e||e<0)throw new RangeError("index is out of bounds");let t=0;for(const n of r){const s=t+n.byteLength;if(e<s)return{buf:n,index:e-t};t=s}throw new RangeError("index is out of bounds")}function Xl(r){return Boolean(r?.[NN])}class Or{constructor(...e){Object.defineProperty(this,NN,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let t=0;for(const n of e)if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.push(n);else{if(!Xl(n))throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");t+=n.byteLength,this.bufs.push(...n.bufs)}this.length+=t}prepend(...e){this.prependAll(e)}prependAll(e){let t=0;for(const n of e.reverse())if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.unshift(n);else{if(!Xl(n))throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");t+=n.byteLength,this.bufs.unshift(...n.bufs)}this.length+=t}get(e){const t=BN(this.bufs,e);return t.buf[t.index]}set(e,t){const n=BN(this.bufs,e);n.buf[n.index]=t}write(e,t=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(t+n,e[n]);else{if(!Xl(e))throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList");for(let n=0;n<e.length;n++)this.set(t+n,e.get(n))}}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0))for(;this.bufs.length>0;){if(!(e>=this.bufs[0].byteLength)){this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift()}}slice(e,t){const{bufs:n,length:s}=this._subList(e,t);return PN(n,s)}subarray(e,t){const{bufs:n,length:s}=this._subList(e,t);return 1===n.length?n[0]:PN(n,s)}sublist(e,t){const{bufs:n,length:s}=this._subList(e,t),i=new Or;return i.length=s,i.bufs=n,i}_subList(e,t){var n,s;if(e=null!==(n=e)&&void 0!==n?n:0,t=null!==(s=t)&&void 0!==s?s:this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(0===e&&t===this.length)return{bufs:[...this.bufs],length:this.length};const i=[];let o=0;for(let a=0;a<this.bufs.length;a++){const c=this.bufs[a],u=o,f=u+c.byteLength;if(o=f,e>=f)continue;const E=e>=u&&e<f,T=t>u&&t<=f;if(E&&T){if(e===u&&t===f){i.push(c);break}const U=e-u;i.push(c.subarray(U,U+(t-e)));break}if(E){if(0===e){i.push(c);continue}i.push(c.subarray(e-u))}else{if(T){if(t===f){i.push(c);break}i.push(c.subarray(0,t-u));break}i.push(c)}}return{bufs:i,length:t-e}}getInt8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}setInt8(e,t){const n=Y4(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,t),this.write(n,e)}getInt16(e,t){const n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,t)}setInt16(e,t,n){const s=La(2);new DataView(s.buffer,s.byteOffset,s.byteLength).setInt16(0,t,n),this.write(s,e)}getInt32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,t)}setInt32(e,t,n){const s=La(4);new DataView(s.buffer,s.byteOffset,s.byteLength).setInt32(0,t,n),this.write(s,e)}getBigInt64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,t)}setBigInt64(e,t,n){const s=La(8);new DataView(s.buffer,s.byteOffset,s.byteLength).setBigInt64(0,t,n),this.write(s,e)}getUint8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}setUint8(e,t){const n=Y4(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,t),this.write(n,e)}getUint16(e,t){const n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,t)}setUint16(e,t,n){const s=La(2);new DataView(s.buffer,s.byteOffset,s.byteLength).setUint16(0,t,n),this.write(s,e)}getUint32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,t)}setUint32(e,t,n){const s=La(4);new DataView(s.buffer,s.byteOffset,s.byteLength).setUint32(0,t,n),this.write(s,e)}getBigUint64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,t)}setBigUint64(e,t,n){const s=La(8);new DataView(s.buffer,s.byteOffset,s.byteLength).setBigUint64(0,t,n),this.write(s,e)}getFloat32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,t)}setFloat32(e,t,n){const s=La(4);new DataView(s.buffer,s.byteOffset,s.byteLength).setFloat32(0,t,n),this.write(s,e)}getFloat64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,t)}setFloat64(e,t,n){const s=La(8);new DataView(s.buffer,s.byteOffset,s.byteLength).setFloat64(0,t,n),this.write(s,e)}equals(e){if(null==e||!(e instanceof Or)||e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!k2e(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){const n=new Or;return n.bufs=e,null==t&&(t=e.reduce((s,i)=>s+i.byteLength,0)),n.length=t,n}}var U2e=p(4148);function Q4(){return Q4=Ee(function*(r,e){let t,n,s;if(e.minChunkSize&&e.maxChunkSize&&e.avgChunkSize)s=e.avgChunkSize,t=e.minChunkSize,n=e.maxChunkSize;else{if(!e.avgChunkSize)throw ee(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");s=e.avgChunkSize,t=s/3,n=s+s/2}if(t<16)throw ee(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");n<t&&(n=t),s<t&&(s=t);const i=Math.floor(Math.log2(s));var c,o=!1,a=!1;try{for(var f,u=be(z2e(r,{min:t,max:n,bits:i,window:e.window,polynomial:e.polynomial}));o=!(f=yield X(u.next())).done;o=!1)yield f.value}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}}),Q4.apply(this,arguments)}const F2e=function M2e(r,e){return Q4.apply(this,arguments)};function z2e(r,e){return J4.apply(this,arguments)}function J4(){return J4=Ee(function*(r,e){const t=yield X((0,U2e.create)(e.bits,e.min,e.max,e.window)),n=new Or;var o,s=!1,i=!1;try{for(var c,a=be(r);s=!(c=yield X(a.next())).done;s=!1){const u=c.value;n.append(u);const f=t.fingerprint(u);for(let E=0;E<f.length;E++){const T=f[E],U=n.slice(0,T);n.consume(T),yield U}}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}n.length&&(yield n.subarray(0))}),J4.apply(this,arguments)}function X4(){return X4=Ee(function*(r,e){let t=new Or,n=0,s=!1;const i=e.maxChunkSize;var c,o=!1,a=!1;try{for(var f,u=be(r);o=!(f=yield X(u.next())).done;o=!1){const E=f.value;for(t.append(E),n+=E.length;n>=i;)if(yield t.slice(0,i),s=!0,i===t.length)t=new Or,n=0;else{const T=new Or;T.append(t.sublist(i)),t=T,n-=i}}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}(!s||n)&&(yield t.subarray(0,n))}),X4.apply(this,arguments)}const j2e=function V2e(r,e){return X4.apply(this,arguments)},$2e=H1({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),K2e=Dn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Z2e=Dn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),H2e=Jf({prefix:"9",name:"base10",alphabet:"0123456789"}),G2e=Dn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),W2e=Dn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Y2e=Jf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Q2e=Jf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),J2e=Dn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),X2e=Dn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),q2e=Dn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ege=Dn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),LN=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),tge=LN.reduce((r,e,t)=>(r[t]=e,r),[]),rge=LN.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),ige=H1({prefix:"\u{1f680}",name:"base256emoji",encode:function nge(r){return r.reduce((e,t)=>e+tge[t],"")},decode:function sge(r){const e=[];for(const t of r){const n=rge[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}}),UN=Ql,age={code:0,name:"identity",encode:UN,digest:r=>$1(0,UN(r))},cge=new TextEncoder,lge=new TextDecoder,uge="json",dge=512,fge=r=>cge.encode(JSON.stringify(r)),hge=r=>JSON.parse(lge.decode(r)),MN={...rb,...nb,...sb,...ib,...ob,...pc,...ab,...ri,...cb,...lb};function FN(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function zN(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const VN=zN("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),q4=zN("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function pge(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?FN(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),yge={utf8:VN,"utf-8":VN,hex:MN.base16,latin1:q4,ascii:q4,binary:q4,...MN};function gge(r,e="utf8"){const t=yge[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):FN(globalThis.Buffer.from(r,"utf-8"))}function ew(){return ew=Ee(function*(r){var n,e=!1,t=!1;try{for(var i,s=be(r);e=!(i=yield X(s.next())).done;e=!1){const o=i.value;if(void 0===o.length)throw ee(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if("string"==typeof o||o instanceof String)yield gge(o.toString());else if(Array.isArray(o))yield Uint8Array.from(o);else{if(!(o instanceof Uint8Array))throw ee(new Error("Content was invalid"),"ERR_INVALID_CONTENT");yield o}}}catch(o){t=!0,n=o}finally{try{e&&null!=s.return&&(yield X(s.return()))}finally{if(t)throw n}}}),ew.apply(this,arguments)}const _ge=function bge(r){return ew.apply(this,arguments)};function wge(r){try{if(r instanceof Uint8Array)return Ee(function*(){yield r})();if(function mge(r){return Symbol.iterator in r}(r))return Ee(function*(){yield*Fe(be(r),X)})();if(function vge(r){return Symbol.asyncIterator in r}(r))return r}catch{throw ee(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw ee(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}function tw(){return tw=Ee(function*(r,e,t){var i,n=!1,s=!1;try{for(var a,o=be(r);n=!(a=yield X(o.next())).done;n=!1){const c=a.value;if(c.path&&("./"===c.path.substring(0,2)&&(t.wrapWithDirectory=!0),c.path=c.path.split("/").filter(u=>u&&"."!==u).join("/")),c.content){let u,f;u="function"==typeof t.chunker?t.chunker:"rabin"===t.chunker?F2e:j2e,f="function"==typeof t.chunkValidator?t.chunkValidator:_ge;const E={path:c.path,mtime:c.mtime,mode:c.mode,content:u(f(wge(c.content),t),t)};yield()=>L2e(E,e,t)}else{if(!c.path)throw new Error("Import candidate must have content or path or both");{const u={path:c.path,mtime:c.mtime,mode:c.mode};yield()=>_2e(u,e,t)}}}}catch(c){s=!0,i=c}finally{try{n&&null!=o.return&&(yield X(o.return()))}finally{if(s)throw i}}}),tw.apply(this,arguments)}const xge=function Ege(r,e,t){return tw.apply(this,arguments)},eh=class Sge{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}put(e,t){return(0,B.Z)(function*(){})()}get(e){return Promise.resolve(this)}eachChildSeries(){return Ee(function*(){})()}flush(e){return Ee(function*(){})()}},rw=class Age extends eh{constructor(e,t){super(e,t),this._children={}}put(e,t){var n=this;return(0,B.Z)(function*(){n.cid=void 0,n.size=void 0,n._children[e]=t})()}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}eachChildSeries(){var e=this;return Ee(function*(){const t=Object.keys(e._children);for(let n=0;n<t.length;n++){const s=t[n];yield{key:s,child:e._children[s]}}})()}flush(e){var t=this;return Ee(function*(){const n=Object.keys(t._children),s=[];for(let P=0;P<n.length;P++){let F=t._children[n[P]];if(F instanceof eh){var a,i=!1,o=!1;try{for(var u,c=be(F.flush(e));i=!(u=yield X(c.next())).done;i=!1)F=u.value,yield F}catch(M){o=!0,a=M}finally{try{i&&null!=c.return&&(yield X(c.return()))}finally{if(o)throw a}}}null!=F.size&&F.cid&&s.push({Name:n[P],Tsize:F.size,Hash:F.cid})}const f=new ur({type:"directory",mtime:t.mtime,mode:t.mode}),E={Data:f.marshal(),Links:s},T=ir(Ki(E)),U=yield X(Jl(T,e,t.options)),b=T.length+E.Links.reduce((P,F)=>P+(F.Tsize??0),0);t.cid=U,t.size=b,yield{cid:U,unixfs:f,path:t.path,size:b}})()}};var Tge=p(20007);const Dge=function Cge(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},G1=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class Bge{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Lge{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return jN(this,e)}}class kge{constructor(e){this.decoders=e}or(e){return jN(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const jN=(r,e)=>new kge({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class Uge{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new Bge(e,t,n),this.decoder=new Lge(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const W1=({name:r,prefix:e,encode:t,decode:n})=>new Uge(r,e,t,n),th=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=Dge(t,e);return W1({prefix:r,name:e,encode:n,decode:i=>G1(s(i))})},Pn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>W1({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),zge=W1({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),Vge=Pn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),jge=Pn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),$ge=th({prefix:"9",name:"base10",alphabet:"0123456789"}),Kge=Pn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Zge=Pn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Hge=Pn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Gge=Pn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Wge=Pn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Yge=Pn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Qge=Pn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Jge=Pn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Xge=Pn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),qge=Pn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ebe=Pn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),tbe=th({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),rbe=th({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),nbe=th({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),sbe=th({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ibe=Pn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),obe=Pn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),abe=Pn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),cbe=Pn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),$N=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),lbe=$N.reduce((r,e,t)=>(r[t]=e,r),[]),ube=$N.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),hbe=W1({prefix:"\u{1f680}",name:"base256emoji",encode:function dbe(r){return r.reduce((e,t)=>e+lbe[t],"")},decode:function fbe(r){const e=[];for(const t of r){const n=ube[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var bbe=Math.pow(2,31),vbe=Math.pow(2,7),wbe=Math.pow(2,14),Ebe=Math.pow(2,21),xbe=Math.pow(2,28),Sbe=Math.pow(2,35),Abe=Math.pow(2,42),Tbe=Math.pow(2,49),Cbe=Math.pow(2,56),Ibe=Math.pow(2,63),Dbe={encode:function ZN(r,e,t){e=e||[];for(var n=t=t||0;r>=bbe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,ZN.bytes=t-n+1,e},decode:function nw(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw nw.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return nw.bytes=i-n,t},encodingLength:function(r){return r<vbe?1:r<wbe?2:r<Ebe?3:r<xbe?4:r<Sbe?5:r<Abe?6:r<Tbe?7:r<Cbe?8:r<Ibe?9:10}};const GN=Dbe,WN=(r,e,t=0)=>(GN.encode(r,e,t),e),YN=r=>GN.encodingLength(r),sw=(r,e)=>{const t=e.byteLength,n=YN(r),s=n+YN(t),i=new Uint8Array(s+t);return WN(r,i,0),WN(t,i,n),i.set(e,s),new QN(r,t,e,i)};class QN{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const JN=({name:r,code:e,encode:t})=>new Pbe(r,e,t);class Pbe{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?sw(this.code,t):t.then(n=>sw(this.code,n))}throw Error("Unknown type, must be binary type")}}const XN=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),Nbe=JN({name:"sha2-256",code:18,encode:XN("SHA-256")}),Bbe=JN({name:"sha2-512",code:19,encode:XN("SHA-512")}),eB=G1,kbe={code:0,name:"identity",encode:eB,digest:r=>sw(0,eB(r))},Ube="raw",Mbe=85,Fbe=r=>G1(r),zbe=r=>G1(r),Vbe=new TextEncoder,jbe=new TextDecoder,$be="json",Kbe=512,Zbe=r=>Vbe.encode(JSON.stringify(r)),Hbe=r=>JSON.parse(jbe.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const nB={...fb,...hb,...pb,...yb,...gb,...bb,..._b,...mb,...vb,...wb};function ow(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function sB(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?ow(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function iB(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const oB=iB("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),aw=iB("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=sB((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),qbe={utf8:oB,"utf-8":oB,hex:nB.base16,latin1:aw,ascii:aw,binary:aw,...nB};class ls{constructor(e,t,n=0){this._options=e,this._popCount=0,this._parent=t,this._posAtParent=n,this._children=new Tge,this.key=null}put(e,t){var n=this;return(0,B.Z)(function*(){const s=yield n._findNewBucketAndPos(e);yield s.bucket._putAt(s,e,t)})()}get(e){var t=this;return(0,B.Z)(function*(){const n=yield t._findChild(e);if(null!=n)return n.value})()}del(e){var t=this;return(0,B.Z)(function*(){const n=yield t._findPlace(e),s=n.bucket._at(n.pos);null!=s&&s.key===e&&n.bucket._delAt(n.pos)})()}leafCount(){return this._children.compactArray().reduce((t,n)=>n instanceof ls?t+n.leafCount():t+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const e=this._children.compactArray();for(const t of e)t instanceof ls?yield*t.eachLeafSeries():yield t}serialize(e,t){return t(this._children.reduce((s,i,o)=>(null!=i&&s.push(i instanceof ls?i.serialize(e,t):e(i,o)),s),[]))}asyncTransform(e,t){var n=this;return(0,B.Z)(function*(){return yield aB(n,e,t)})()}toJSON(){return this.serialize(r_e,n_e)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}_findChild(e){var t=this;return(0,B.Z)(function*(){const n=yield t._findPlace(e),s=n.bucket._at(n.pos);if(!(s instanceof ls)&&null!=s&&s.key===e)return s})()}_findPlace(e){var t=this;return(0,B.Z)(function*(){const n=t._options.hash("string"==typeof e?function e_e(r,e="utf8"){const t=qbe[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):ow(globalThis.Buffer.from(r,"utf-8"))}(e):e),s=yield n.take(t._options.bits),i=t._children.get(s);return i instanceof ls?yield i._findPlace(n):{bucket:t,pos:s,hash:n,existingChild:i}})()}_findNewBucketAndPos(e){var t=this;return(0,B.Z)(function*(){const n=yield t._findPlace(e);if(null!=n.existingChild&&n.existingChild.key!==e){const s=new ls(t._options,n.bucket,n.pos);n.bucket._putObjectAt(n.pos,s);const i=yield s._findPlace(n.existingChild.hash);return i.bucket._putAt(i,n.existingChild.key,n.existingChild.value),yield s._findNewBucketAndPos(n.hash)}return n})()}_putAt(e,t,n){this._putObjectAt(e.pos,{key:t,value:n,hash:e.hash})}_putObjectAt(e,t){null==this._children.get(e)&&this._popCount++,this._children.set(e,t)}_delAt(e){if(-1===e)throw new Error("Invalid position");null!=this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(null!=this._parent&&this._popCount<=1)if(1===this._popCount){const e=this._children.find(t_e);if(null!=e&&!(e instanceof ls)){const t=e.hash;t.untake(this._options.bits),this._parent._putAt({pos:this._posAtParent,hash:t,bucket:this._parent},e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}}function t_e(r){return Boolean(r)}function r_e(r,e){return r.key}function n_e(r){return r}function aB(r,e,t){return cw.apply(this,arguments)}function cw(){return cw=(0,B.Z)(function*(r,e,t){const n=[];for(const s of r._children.compactArray())if(s instanceof ls)yield aB(s,e,t);else{const i=yield e(s);n.push({bitField:r._children.bitField(),children:i})}return yield t(n)}),cw.apply(this,arguments)}const s_e=[255,254,252,248,240,224,192,128],i_e=[1,3,7,15,31,63,127,255];class o_e{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,n=0;for(;t>0&&this._haveBits();){const s=this._value[this._currentBytePos],i=this._currentBitPos+1,o=Math.min(i,t);n=(n<<o)+a_e(s,i-o,o),t-=o,this._currentBitPos-=o,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return n}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function a_e(r,e,t){const n=function c_e(r,e){return s_e[r]&i_e[Math.min(e+r-1,7)]}(e,t);return(r&n)>>>e}function u_e(r){return function e(t){return t instanceof cB?t:new cB(t,r)}}class cB{constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}take(e){var t=this;return(0,B.Z)(function*(){let n=e;for(;t._availableBits<n;)yield t._produceMoreBits();let s=0;for(;n>0;){const i=t._buffers[t._currentBufferIndex],o=Math.min(i.availableBits(),n);s=(s<<o)+i.take(o),n-=o,t._availableBits-=o,0===i.availableBits()&&t._currentBufferIndex++}return s})()}untake(e){let t=e;for(;t>0;){const n=this._buffers[this._currentBufferIndex],s=Math.min(n.totalBits()-n.availableBits(),t);n.untake(s),t-=s,this._availableBits+=s,this._currentBufferIndex>0&&n.totalBits()===n.availableBits()&&(this._depth--,this._currentBufferIndex--)}}_produceMoreBits(){var e=this;return(0,B.Z)(function*(){e._depth++;const t=e._depth>0?function l_e(r,e){null==e&&(e=r.reduce((s,i)=>s+i.length,0));const t=sB(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return ow(t)}([e._value,Uint8Array.from([e._depth])]):e._value,n=yield e._hashFn(t),s=new o_e(n);e._buffers.push(s),e._availableBits+=s.availableBits()})()}}function Y1(r){var e;if(null==r||null==r.hashFn)throw new Error("please define an options.hashFn");const t={bits:null!==(e=r.bits)&&void 0!==e?e:8,hash:u_e(r.hashFn)};return new ls(t)}const f_e=class d_e extends eh{constructor(e,t){super(e,t),this._bucket=Y1({hashFn:t.hamtHashFn,bits:t.hamtBucketBits})}put(e,t){var n=this;return(0,B.Z)(function*(){yield n._bucket.put(e,t)})()}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}eachChildSeries(){var e=this;return Ee(function*(){var s,t=!1,n=!1;try{for(var o,i=be(e._bucket.eachLeafSeries());t=!(o=yield X(i.next())).done;t=!1){const{key:a,value:c}=o.value;yield{key:a,child:c}}}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield X(i.return()))}finally{if(n)throw s}}})()}flush(e){var t=this;return Ee(function*(){var i,n=!1,s=!1;try{for(var a,o=be(lB(t._bucket,e,t,t.options));n=!(a=yield X(o.next())).done;n=!1)yield{...a.value,path:t.path}}catch(c){s=!0,i=c}finally{try{n&&null!=o.return&&(yield X(o.return()))}finally{if(s)throw i}}})()}};function lB(r,e,t,n){return lw.apply(this,arguments)}function lw(){return lw=Ee(function*(r,e,t,n){const s=r._children,i=[];let o=0;for(let Y=0;Y<s.length;Y++){const q=s.get(Y);if(!q)continue;const ge=Y.toString(16).toUpperCase().padStart(2,"0");if(q instanceof ls){let Ce;var u,a=!1,c=!1;try{for(var E,f=be(yield X(lB(q,e,null,n)));a=!(E=yield X(f.next())).done;a=!1)Ce=E.value}catch(De){c=!0,u=De}finally{try{a&&null!=f.return&&(yield X(f.return()))}finally{if(c)throw u}}if(!Ce)throw new Error("Could not flush sharded directory, no subshard found");i.push({Name:ge,Tsize:Ce.size,Hash:Ce.cid}),o+=Ce.size}else if("function"==typeof q.value.flush){const Ce=q.value;let De;var b,T=!1,U=!1;try{for(var F,P=be(Ce.flush(e));T=!(F=yield X(P.next())).done;T=!1)De=F.value,yield De}catch(Xe){U=!0,b=Xe}finally{try{T&&null!=P.return&&(yield X(P.return()))}finally{if(U)throw b}}i.push({Name:ge+q.key,Tsize:De.size,Hash:De.cid}),o+=De.size}else{const Ce=q.value;if(!Ce.cid)continue;const Je=Ce.size;i.push({Name:ge+q.key,Tsize:Je,Hash:Ce.cid}),o+=Je}}const M=Uint8Array.from(s.bitField().reverse()),H=new ur({type:"hamt-sharded-directory",data:M,fanout:r.tableSize(),hashType:n.hamtHashCode,mtime:t&&t.mtime,mode:t&&t.mode}),V=ir(Ki({Data:H.marshal(),Links:i})),W=yield X(Jl(V,e,n)),ne=V.length+o;yield{cid:W,unixfs:H,size:ne}}),lw.apply(this,arguments)}function uB(r,e,t,n){return uw.apply(this,arguments)}function uw(){return uw=(0,B.Z)(function*(r,e,t,n){let s=e;e instanceof rw&&e.directChildrenCount()>=t&&(s=yield h_e(e,n));const i=s.parent;if(i){if(s!==e){if(r&&(r.parent=s),!s.parentKey)throw new Error("No parent key found");yield i.put(s.parentKey,s)}return uB(s,i,t,n)}return s}),uw.apply(this,arguments)}function h_e(r,e){return dw.apply(this,arguments)}function dw(){return dw=(0,B.Z)(function*(r,e){const t=new f_e({root:r.root,dir:!0,parent:r.parent,parentKey:r.parentKey,path:r.path,dirty:r.dirty,flat:!1,mtime:r.mtime,mode:r.mode},e);var i,n=!1,s=!1;try{for(var a,o=be(r.eachChildSeries());n=!(a=yield o.next()).done;n=!1){const{key:c,child:u}=a.value;yield t.put(c,u)}}catch(c){s=!0,i=c}finally{try{n&&null!=o.return&&(yield o.return())}finally{if(s)throw i}}return t}),dw.apply(this,arguments)}const p_e=uB,y_e=(r="")=>(r.trim().match(/([^\\/]|\\\/)+/g)||[]).filter(Boolean);function g_e(r,e,t){return fw.apply(this,arguments)}function fw(){return fw=(0,B.Z)(function*(r,e,t){const n=y_e(r.path||""),s=n.length-1;let i=e,o="";for(let a=0;a<n.length;a++){const c=n[a];o+=`${o?"/":""}${c}`;const u=a===s;if(i.dirty=!0,i.cid=void 0,i.size=void 0,u)yield i.put(c,r),e=yield p_e(null,i,t.shardSplitThreshold,t);else{let f=yield i.get(c);(!f||!(f instanceof eh))&&(f=new rw({root:!1,dir:!0,parent:i,parentKey:c,path:o,dirty:!0,flat:!0,mtime:f&&f.unixfs&&f.unixfs.mtime,mode:f&&f.unixfs&&f.unixfs.mode},t)),yield i.put(c,f),i=f}}return e}),fw.apply(this,arguments)}function dB(r,e){return hw.apply(this,arguments)}function hw(){return hw=Ee(function*(r,e){r instanceof eh?yield*Fe(be(r.flush(e)),X):r&&r.unixfs&&r.unixfs.isDirectory()&&(yield r)}),hw.apply(this,arguments)}function pw(){return pw=Ee(function*(r,e,t){let n=new rw({root:!0,dir:!0,path:"",dirty:!0,flat:!0},t);var o,s=!1,i=!1;try{for(var c,a=be(r);s=!(c=yield X(a.next())).done;s=!1){const b=c.value;!b||(n=yield X(g_e(b,n,t)),(!b.unixfs||!b.unixfs.isDirectory())&&(yield b))}}catch(b){i=!0,o=b}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}if(t.wrapWithDirectory)yield*Fe(be(dB(n,e)),X);else{var E,u=!1,f=!1;try{for(var U,T=be(n.eachChildSeries());u=!(U=yield X(T.next())).done;u=!1){const b=U.value;!b||(yield*Fe(be(dB(b.child,e)),X))}}catch(b){f=!0,E=b}finally{try{u&&null!=T.return&&(yield X(T.return()))}finally{if(f)throw E}}}}),pw.apply(this,arguments)}const __e=function b_e(r,e,t){return pw.apply(this,arguments)};function yw(r,e){return gw.apply(this,arguments)}function gw(){return gw=Ee(function*(r,e,t={}){const n=Hye(t);let s,i,o;s="function"==typeof t.dagBuilder?t.dagBuilder:xge,i="function"==typeof t.treeBuilder?t.treeBuilder:__e,o=Symbol.asyncIterator in r||Symbol.iterator in r?r:[r];var u,a=!1,c=!1;try{for(var E,f=be(i(aN(s(o,e,n),n.fileImportConcurrency),e,n));a=!(E=yield X(f.next())).done;a=!1){const T=E.value;yield{cid:T.cid,path:T.path,unixfs:T.unixfs,size:T.size}}}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield X(f.return()))}finally{if(c)throw u}}}),gw.apply(this,arguments)}function fB(r,e){return bw.apply(this,arguments)}function bw(){return bw=Ee(function*(r,e){if("string"==typeof r||r instanceof String||Ba(r)||Wf(r)||r._readableState)throw ee(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(Yf(r)&&(r=Yl(r)),Symbol.iterator in r||Symbol.asyncIterator in r){const t=Gf(r),{value:n,done:s}=yield X(t.peek());if(s)return void(yield*Fe(be([]),X));if(t.push(n),Number.isInteger(n))throw ee(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(n._readableState)return void(yield*Fe(be(os(t,i=>_w({content:i},e))),X));if(Ba(n))return void(yield _w({content:t},e));if(A4(n)||n[Symbol.iterator]||n[Symbol.asyncIterator]||Yf(n)||Wf(n))return void(yield*Fe(be(os(t,i=>_w(i,e))),X))}throw A4(r)?ee(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):ee(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}),bw.apply(this,arguments)}function _w(r,e){return mw.apply(this,arguments)}function mw(){return mw=(0,B.Z)(function*(r,e){const{path:t,mode:n,mtime:s,content:i}=r,o={path:t||"",mode:dl(n),mtime:Cd(s)};return i?o.content=yield e(i):t||(o.content=yield e(r)),o}),mw.apply(this,arguments)}function m_e(r){return fB(r,iN)}const v_e=r=>{if(r){if(r.startsWith("size-")){const e=r.split("-")[1],t=parseInt(e);if(isNaN(t))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:t}}if(r.startsWith("rabin"))return{chunker:"rabin",...w_e(r)};throw new Error(`Unrecognized chunker option: ${r}`)}return{chunker:"fixed"}},w_e=r=>{const e={},t=r.split("-");switch(t.length){case 1:e.avgChunkSize=262144;break;case 2:e.avgChunkSize=Q1(t[1],"avg");break;case 4:e.minChunkSize=Q1(t[1],"min"),e.avgChunkSize=Q1(t[2],"avg"),e.maxChunkSize=Q1(t[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return e},Q1=(r,e)=>{const t=parseInt(r);if(isNaN(t))throw new Error(`Chunker parameter ${e} must be an integer`);return t},E_e=Sr.bind({ignoreUndefined:!0});function S_e(r){function t(){return(t=Ee(function*(n){var o,s=!1,i=!1;try{for(var c,a=be(n);s=!(c=yield X(a.next())).done;s=!1){const u=c.value;let f=u.cid;1===r.cidVersion&&(f=f.toV1());let E=u.path?u.path:f.toString();r.wrapWithDirectory&&!u.path&&(E=""),yield{path:E,cid:f,size:u.size,mode:u.unixfs&&u.unixfs.mode,mtime:u.unixfs&&u.unixfs.mtime}}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}function A_e(r,e){function n(){return(n=Ee(function*(s){var a,i=!1,o=!1;try{for(var u,c=be(s);i=!(u=yield X(c.next())).done;i=!1){const f=u.value;(!f.path||e.wrapWithDirectory?""===f.path:!f.path.includes("/"))&&!e.onlyHash&&!1!==e.preload&&r(f.cid),yield f}}catch(f){o=!0,a=f}finally{try{i&&null!=c.return&&(yield X(c.return()))}finally{if(o)throw a}}})).apply(this,arguments)}return function t(s){return n.apply(this,arguments)}}function T_e(r,e){function n(){return(n=Ee(function*(s){var a,i=!1,o=!1;try{for(var u,c=be(s);i=!(u=yield X(c.next())).done;i=!1){const f=u.value,E=!(f.path&&f.path.includes("/"));(e.pin??!0)&&E&&!e.onlyHash&&(yield X(r.pins.pinRecursively(f.cid))),yield f}}catch(f){o=!0,a=f}finally{try{i&&null!=c.return&&(yield X(c.return()))}finally{if(o)throw a}}})).apply(this,arguments)}return function t(s){return n.apply(this,arguments)}}var D_e=Math.pow(2,31),N_e=Math.pow(2,7),B_e=Math.pow(2,14),L_e=Math.pow(2,21),k_e=Math.pow(2,28),U_e=Math.pow(2,35),M_e=Math.pow(2,42),F_e=Math.pow(2,49),z_e=Math.pow(2,56),V_e=Math.pow(2,63),$_e={encode:function pB(r,e,t){e=e||[];for(var n=t=t||0;r>=D_e;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,pB.bytes=t-n+1,e},decode:function vw(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw vw.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return vw.bytes=i-n,t},encodingLength:function(r){return r<N_e?1:r<B_e?2:r<L_e?3:r<k_e?4:r<U_e?5:r<M_e?6:r<F_e?7:r<z_e?8:r<V_e?9:10}};const J1=$_e,ww=(r,e=0)=>[J1.decode(r,e),J1.decode.bytes],X1=(r,e,t=0)=>(J1.encode(r,e,t),e),q1=r=>J1.encodingLength(r),ey=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}),bB=r=>{const e=ey(r),[t,n]=ww(e),[s,i]=ww(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new Ew(t,s,o,e)};class Ew{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const J_e=function W_e(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class X_e{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class q_e{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return _B(this,e)}}class eme{constructor(e){this.decoders=e}or(e){return _B(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _B=(r,e)=>new eme({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class tme{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new X_e(e,t,n),this.decoder=new q_e(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const mB=({name:r,prefix:e,encode:t,decode:n})=>new tme(r,e,t,n),vB=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=J_e(t,e);return mB({prefix:r,name:e,encode:n,decode:i=>ey(s(i))})},Bo=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>mB({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),ka=vB({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ty=(vB({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Bo({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),wB=(Bo({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Bo({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Bo({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Bo({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Bo({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Bo({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Bo({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Bo({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),xw=r=>{const e=wB.get(r);if(null==e){const t=new Map;return wB.set(r,t),t}return e};class Hr{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==nh)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==cme)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Hr.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=((r,e)=>{const t=e.byteLength,n=q1(r),s=n+q1(t),i=new Uint8Array(s+t);return X1(r,i,0),X1(t,i,n),i.set(e,s),new Ew(r,t,e,i)})(e,t);return Hr.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Hr.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?ome(t,xw(r),e||ka.encoder):ame(t,xw(r),e||ty.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Hr)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new Hr(n,s,i,o||EB(n,s,i.bytes))}if(!0===t[lme]){const{version:n,multihash:s,code:i}=t,o=bB(s);return Hr.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==nh)throw new Error(`Version 0 CID must use dag-pb (code: ${nh}) block encoding`);return new Hr(e,t,n,n.bytes);case 1:{const s=EB(e,t,n.bytes);return new Hr(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return Hr.create(0,nh,e)}static createV1(e,t){return Hr.create(1,e,t)}static decode(e){const[t,n]=Hr.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Hr.inspectBytes(e),n=t.size-t.multihashSize,s=ey(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new Ew(t.multihashCode,t.digestSize,i,s);return[0===t.version?Hr.createV0(o):Hr.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=ww(e.subarray(t));return t+=T,E};let s=n(),i=nh;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=ime(e,t),i=Hr.decode(s);return xw(i).set(n,e),i}}const ime=(r,e)=>{switch(r[0]){case"Q":return[ka.prefix,(e||ka).decode(`${ka.prefix}${r}`)];case ka.prefix:return[ka.prefix,(e||ka).decode(r)];case ty.prefix:return[ty.prefix,(e||ty).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},ome=(r,e,t)=>{const{prefix:n}=t;if(n!==ka.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},ame=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},nh=112,cme=18,EB=(r,e,t)=>{const n=q1(r),s=n+q1(e),i=new Uint8Array(s+t.byteLength);return X1(r,i,0),X1(e,i,n),i.set(t,s),i},lme=Symbol.for("@ipld/js-cid/CID"),fme=function(){var r=(0,B.Z)(function*(e){return(yield Z1.encode(e)).slice(0,8).reverse()});return function(t){return r.apply(this,arguments)}}(),TB=r=>r.toString(16).toUpperCase().padStart(2,"0").substring(0,2),CB=function(){var r=(0,B.Z)(function*(e,t,n,s,i){if(!s){const E=Y1({hashFn:fme});s={rootBucket:E,hamtDepth:1,lastBucket:E}}yield((r,e,t)=>Promise.all(r.map(n=>{if(null==n.Name)throw new Error("Unexpected Link without a Name");if(2===n.Name.length){const s=parseInt(n.Name,16);return e._putObjectAt(s,new ls({hash:t._options.hash,bits:t._options.bits},e,s))}return t.put(n.Name.substring(2),!0)})))(e.Links,s.lastBucket,s.rootBucket);const o=yield s.rootBucket._findNewBucketAndPos(t);let a=TB(o.pos);const c=(r=>{let e=r.bucket;const t=[];for(;e._parent;)t.push(e),e=e._parent;return t.push(e),t.reverse()})(o);c.length>s.hamtDepth&&(s.lastBucket=c[s.hamtDepth],a=TB(s.lastBucket._posAtParent));const u=e.Links.find(E=>{if(null==E.Name)return!1;const T=E.Name.substring(0,2),U=E.Name.substring(2);return!(T!==a||U&&U!==t)});return u?null!=u.Name&&u.Name.substring(2)===t?u.Hash:(s.hamtDepth++,e=Vr(yield n.get(u.Hash,i)),CB(e,t,n,s,i)):null});return function(t,n,s,i,o){return r.apply(this,arguments)}}(),yme=CB,ry=function gme(r,e,t,n){const i=e+r.length;return t>=i||n<e?new Uint8Array(0):(n>=e&&n<i&&(r=r.subarray(0,n-e)),t>=e&&t<i&&(r=r.subarray(t-e)),r)},Sw=(r,e,t)=>{if(e||(e=0),e<0)throw ee(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(e>r)throw ee(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!t&&0!==t&&(t=r-e),t<0)throw ee(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return e+t>r&&(t=r-e),{offset:e,length:t}};function IB(r,e,t,n,s,i,o,a){return Aw.apply(this,arguments)}function Aw(){return Aw=(0,B.Z)(function*(r,e,t,n,s,i,o,a){if(e instanceof Uint8Array)return void t.push(ry(e,n,s,i));if(null==e.Data)throw ee(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let c;try{c=ur.unmarshal(e.Data)}catch(f){throw ee(f,"ERR_NOT_UNIXFS")}if(null!=c.data){const E=ry(c.data,n,s,i);t.push(E),n+=E.byteLength}const u=[];for(let f=0;f<e.Links.length;f++){const E=e.Links[f],T=n,U=T+c.blockSizes[f];if((s>=T&&s<U||i>=T&&i<=U||s<T&&i>U)&&u.push({link:E,blockStart:n}),(n=U)>i)break}yield _t(u,f=>os(f,E=>(0,B.Z)(function*(){const T=yield r.get(E.link.Hash,{signal:a.signal});return{...E,block:T}})),f=>k1(f,{ordered:!0}),function(){var f=(0,B.Z)(function*(E){var b,T=!1,U=!1;try{for(var F,P=be(E);T=!(F=yield P.next()).done;T=!1){const{link:M,block:H,blockStart:$}=F.value;let V;switch(M.Hash.code){case gr:V=Vr(H);break;case 85:V=H;break;default:return void t.end(ee(new Error(`Unsupported codec: ${M.Hash.code}`),"ERR_NOT_UNIXFS"))}o.add((0,B.Z)(function*(){yield IB(r,V,t,$,s,i,o,a)}))}}catch(M){U=!0,b=M}finally{try{T&&null!=P.return&&(yield P.return())}finally{if(U)throw b}}});return function(E){return f.apply(this,arguments)}}())}),Aw.apply(this,arguments)}const RB=(r,e,t,n,s,i,o)=>{function c(){return(c=Ee(function*(u={}){const f=t.fileSize();if(void 0===f)throw new Error("File was a directory");const{offset:E,length:T}=Sw(f,u.offset,u.length);if(0===T)return;const U=new an({concurrency:1}),b=ss();U.add((0,B.Z)(function*(){yield IB(o,e,b,0,E,E+T,U,u)})),U.on("error",W=>{b.end(W)});let P=0;var H,F=!1,M=!1;try{for(var V,$=be(b);F=!(V=yield X($.next())).done;F=!1){const W=V.value;null!=W&&(P+=W.byteLength,P===T&&b.end(),yield W)}}catch(W){M=!0,H=W}finally{try{F&&null!=$.return&&(yield X($.return()))}finally{if(M)throw H}}})).apply(this,arguments)}return function a(){return c.apply(this,arguments)}};function DB(r,e,t,n,s,i){return Tw.apply(this,arguments)}function Tw(){return Tw=Ee(function*(r,e,t,n,s,i){const o=r.Links;for(const T of o){const U=null!=T.Name?T.Name.substring(2):null;if(U)yield(yield X(t(T.Hash,U,`${e}/${U}`,[],n+1,s,i))).entry;else{r=Vr(yield X(s.get(T.Hash)));var u,a=!1,c=!1;try{for(var E,f=be(DB(r,e,t,n,s,i));a=!(E=yield X(f.next())).done;a=!1)yield E.value}catch(P){c=!0,u=P}finally{try{a&&null!=f.return&&(yield X(f.return()))}finally{if(c)throw u}}}}}),Tw.apply(this,arguments)}const wme={raw:RB,file:RB,directory:(r,e,t,n,s,i,o)=>{function c(){return(c=Ee(function*(u={}){const T=e.Links.slice(u.offset||0,u.length||e.Links.length);for(const U of T){const b=yield X(s(U.Hash,U.Name||"",`${n}/${U.Name||""}`,[],i+1,o,u));b.entry&&(yield b.entry)}})).apply(this,arguments)}return function a(){return c.apply(this,arguments)}},"hamt-sharded-directory":(r,e,t,n,s,i,o)=>function a(c={}){return DB(e,n,s,i,o,c)},metadata:(r,e,t,n,s,i,o)=>()=>[],symlink:(r,e,t,n,s,i,o)=>()=>[]},Eme=function(){var r=(0,B.Z)(function*(e,t,n,s,i,o,a,c){const f=Vr(yield a.get(e,c));let E,T;if(t||(t=e.toString()),null==f.Data)throw ee(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{E=ur.unmarshal(f.Data)}catch(U){throw ee(U,"ERR_NOT_UNIXFS")}if(n||(n=t),s.length){let U;if(U=E&&"hamt-sharded-directory"===E.type?yield yme(f,s[0],a):((r,e)=>{const t=r.Links.find(n=>n.Name===e);return t&&t.Hash})(f,s[0]),!U)throw ee(new Error("file does not exist"),"ERR_NOT_FOUND");const b=s.shift();T={cid:U,toResolve:s,name:b||"",path:`${n}/${b}`}}return{entry:{type:E.isDirectory()?"directory":"file",name:t,path:n,cid:e,content:wme[E.type](e,f,E,n,i,o,a),unixfs:E,depth:o,node:f,size:E.fileSize()},next:T}});return function(t,n,s,i,o,a,c,u){return r.apply(this,arguments)}}(),xme=r=>{function t(){return(t=Ee(function*(n={}){const{offset:s,length:i}=Sw(r.length,n.offset,n.length);yield ry(r,0,s,s+i)})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}},Sme=function(){var r=(0,B.Z)(function*(e,t,n,s,i,o,a,c){if(s.length)throw ee(new Error(`No link named ${n} found in raw node ${e}`),"ERR_NOT_FOUND");const u=yield a.get(e,c);return{entry:{type:"raw",name:t,path:n,cid:e,content:xme(u),depth:o,size:u.length,node:u}}});return function(t,n,s,i,o,a,c,u){return r.apply(this,arguments)}}(),Ame=function(){var r=(0,B.Z)(function*(e,t,n,s,i,o,a,c){const u=yield a.get(e),f=ip(u);let E=f,T=n;for(;s.length;){const U=s[0];if(!(U in E))throw ee(new Error(`No property named ${U} found in cbor node ${e}`),"ERR_NO_PROP");{s.shift(),T=`${T}/${U}`;const b=Hr.asCID(E[U]);if(b)return{entry:{type:"object",name:t,path:n,cid:e,node:u,depth:o,size:u.length,content:function(){var P=Ee(function*(){yield f});return function(){return P.apply(this,arguments)}}()},next:{cid:b,name:U,path:T,toResolve:s}};E=E[U]}}return{entry:{type:"object",name:t,path:n,cid:e,node:u,depth:o,size:u.length,content:(U=Ee(function*(){yield f}),function(){return U.apply(this,arguments)})}};var U});return function(t,n,s,i,o,a,c,u){return r.apply(this,arguments)}}(),Tme=r=>{function t(){return(t=Ee(function*(n={}){const{offset:s,length:i}=Sw(r.length,n.offset,n.length);yield ry(r,0,s,s+i)})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}},Cme=function(){var r=(0,B.Z)(function*(e,t,n,s,i,o,a,c){if(s.length)throw ee(new Error(`No link named ${n} found in raw node ${e}`),"ERR_NOT_FOUND");const u=yield bB(e.multihash.bytes);return{entry:{type:"identity",name:t,path:n,cid:e,content:Tme(u.digest),depth:o,size:u.digest.length,node:u.digest}}});return function(t,n,s,i,o,a,c,u){return r.apply(this,arguments)}}(),Ime={[gr]:Eme,85:Sme,[l6]:Ame,0:Cme},Rme=function OB(r,e,t,n,s,i,o){const a=Ime[r.code];if(!a)throw ee(new Error(`No resolver for code ${r.code}`),"ERR_NO_RESOLVER");return a(r,e,t,n,OB,s,i,o)},Ome=r=>{if(r instanceof Uint8Array)return{cid:Hr.decode(r),toResolve:[]};const e=Hr.asCID(r);if(e)return{cid:e,toResolve:[]};if("string"==typeof r){0===r.indexOf("/ipfs/")&&(r=r.substring(6));const t=((r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean))(r);return{cid:Hr.parse(t[0]),toResolve:t.slice(1)}}throw ee(new Error(`Unknown path type ${r}`),"ERR_BAD_PATH")};function PB(r,e){return Cw.apply(this,arguments)}function Cw(){return Cw=Ee(function*(r,e,t={}){let{cid:n,toResolve:s}=Ome(r),i=n.toString(),o=i;const a=s.length;for(;;){const c=yield X(Rme(n,i,o,s,a,e,t));if(!c.entry&&!c.next)throw ee(new Error(`Could not resolve ${r}`),"ERR_NOT_FOUND");if(c.entry&&(yield c.entry),!c.next)return;s=c.next.toResolve,n=c.next.cid,i=c.next.name,o=c.next.path}}),Cw.apply(this,arguments)}function Lo(r,e){return Iw.apply(this,arguments)}function Iw(){return Iw=(0,B.Z)(function*(r,e,t={}){const n=yield Ys(PB(r,e,t));if(!n)throw ee(new Error(`Could not resolve ${r}`),"ERR_NOT_FOUND");return n}),Iw.apply(this,arguments)}function NB(r,e){return Rw.apply(this,arguments)}function Rw(){return Rw=Ee(function*(r,e,t={}){const n=yield X(Lo(r,e,t));if(n&&(yield n,"directory"===n.type)){var o,s=!1,i=!1;try{for(var c,a=be(u(n,t));s=!(c=yield X(a.next())).done;s=!1)yield c.value}catch(E){i=!0,o=E}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}}function u(E,T){return f.apply(this,arguments)}function f(){return(f=Ee(function*(E,T){var P,U=!1,b=!1;try{for(var M,F=be(E.content(T));U=!(M=yield X(F.next())).done;U=!1){const H=M.value;yield H,!(H instanceof Uint8Array)&&"directory"===H.type&&(yield*Fe(be(u(H,T)),X))}}catch(H){b=!0,P=H}finally{try{U&&null!=F.return&&(yield X(F.return()))}finally{if(b)throw P}}})).apply(this,arguments)}}),Rw.apply(this,arguments)}const kme=function Nme(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},ny=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class zme{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Vme{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return BB(this,e)}}class jme{constructor(e){this.decoders=e}or(e){return BB(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const BB=(r,e)=>new jme({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class $me{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new zme(e,t,n),this.decoder=new Vme(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const sy=({name:r,prefix:e,encode:t,decode:n})=>new $me(r,e,t,n),sh=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=kme(t,e);return sy({prefix:r,name:e,encode:n,decode:i=>ny(s(i))})},Nn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>sy({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),Hme=sy({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),Gme=Nn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Wme=Nn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Yme=sh({prefix:"9",name:"base10",alphabet:"0123456789"}),Qme=Nn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Jme=Nn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Xme=Nn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),qme=Nn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),eve=Nn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),tve=Nn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),rve=Nn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),nve=Nn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),sve=Nn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ive=Nn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ove=Nn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ave=sh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),cve=sh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),lve=sh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),uve=sh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),dve=Nn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),fve=Nn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),hve=Nn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),pve=Nn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),LB=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),yve=LB.reduce((r,e,t)=>(r[t]=e,r),[]),gve=LB.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),mve=sy({prefix:"\u{1f680}",name:"base256emoji",encode:function bve(r){return r.reduce((e,t)=>e+yve[t],"")},decode:function _ve(r){const e=[];for(const t of r){const n=gve[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var xve=Math.pow(2,31),Tve=Math.pow(2,7),Cve=Math.pow(2,14),Ive=Math.pow(2,21),Rve=Math.pow(2,28),Dve=Math.pow(2,35),Ove=Math.pow(2,42),Pve=Math.pow(2,49),Nve=Math.pow(2,56),Bve=Math.pow(2,63),kve={encode:function UB(r,e,t){e=e||[];for(var n=t=t||0;r>=xve;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,UB.bytes=t-n+1,e},decode:function Dw(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw Dw.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return Dw.bytes=i-n,t},encodingLength:function(r){return r<Tve?1:r<Cve?2:r<Ive?3:r<Rve?4:r<Dve?5:r<Ove?6:r<Pve?7:r<Nve?8:r<Bve?9:10}};const FB=kve,zB=(r,e,t=0)=>(FB.encode(r,e,t),e),VB=r=>FB.encodingLength(r),Ow=(r,e)=>{const t=e.byteLength,n=VB(r),s=n+VB(t),i=new Uint8Array(s+t);return zB(r,i,0),zB(t,i,n),i.set(e,s),new jB(r,t,e,i)};class jB{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const $B=({name:r,code:e,encode:t})=>new Mve(r,e,t);class Mve{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ow(this.code,t):t.then(n=>Ow(this.code,n))}throw Error("Unknown type, must be binary type")}}const KB=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),ZB=$B({name:"sha2-256",code:18,encode:KB("SHA-256")}),Fve=$B({name:"sha2-512",code:19,encode:KB("SHA-512")}),GB=ny,Vve={code:0,name:"identity",encode:GB,digest:r=>Ow(0,GB(r))},jve="raw",$ve=85,Kve=r=>ny(r),Zve=r=>ny(r),Hve=new TextEncoder,Gve=new TextDecoder,Wve="json",Yve=512,Qve=r=>Hve.encode(JSON.stringify(r)),Jve=r=>JSON.parse(Gve.decode(r));p(28069),Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const QB={...Tb,...Cb,...Ib,...Rb,...Db,...Ob,...Pb,...Nb,...Bb,...Lb};var o3e=p(66762);function JB(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const XB=JB("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),Pw=JB("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=(0,o3e.E)(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),qB={utf8:XB,"utf-8":XB,hex:QB.base16,latin1:Pw,ascii:Pw,binary:Pw,...QB};function ay(r,e="utf8"){const t=qB[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}function Ur(r,e="utf8"){const t=qB[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):globalThis.Buffer.from(r,"utf8")}"0".charCodeAt(0),Ur("ustar\0","binary"),Ur("ustar ","binary"),Ur(" \0","binary");var b3e=p(6743),_3e=p(96151);const w3e="0".charCodeAt(0),E3e=Ur("ustar\0","binary"),x3e=Ur("00","binary"),S3e=parseInt("7777",8),Ma=function(r,e){const t=r.toString(8);return Ur(t.length>e?"7777777777777777777".slice(0,e)+" ":"0000000000000000000".slice(0,e-t.length)+t+" ")},Bw=function(r){const e=Ur(r).byteLength;let t=Math.floor(Math.log(e)/Math.log(10))+1;return e+t>=Math.pow(10,t)&&t++,`${e+t}${r}`};function Lw(r){var e,t;const n=new Uint8Array(512);let s=r.name,i="";if(5===r.typeflag&&"/"!==s[s.length-1]&&(s+="/"),Ur(s).byteLength!==s.length)return null;for(;Ur(s).byteLength>100;){const o=s.indexOf("/");if(-1===o)return null;i+=""!==i?"/"+s.slice(0,o):s.slice(0,o),s=s.slice(o+1)}return Ur(s).byteLength>100||Ur(i).byteLength>155||null!=r.linkname&&Ur(r.linkname).byteLength>100?null:(n.set(Ur(s),0),n.set(Ma(r.mode&S3e,6),100),n.set(Ma(r.uid,6),108),n.set(Ma(r.gid,6),116),n.set(Ma(r.size,11),124),n.set(Ma(r.mtime.getTime()/1e3|0,11),136),n[156]=w3e+function(r){switch(r){case"file":default:return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}}(r.type),null!=r.linkname&&n.set(Ur(r.linkname),157),n.set(E3e,257),n.set(x3e,263),null!=r.uname&&n.set(Ur(r.uname),265),null!=r.gname&&n.set(Ur(r.gname),297),n.set(Ma(null!==(e=r.devmajor)&&void 0!==e?e:0,6),329),n.set(Ma(null!==(t=r.devminor)&&void 0!==t?t:0,6),337),null!=i&&n.set(Ur(i),345),n.set(Ma(function(r){let e=256;for(let t=0;t<148;t++)e+=r[t];for(let t=156;t<512;t++)e+=r[t];return e}(n),6),148),n)}const{S_IFMT:D3e,S_IFBLK:O3e,S_IFCHR:P3e,S_IFDIR:N3e,S_IFIFO:B3e,S_IFLNK:L3e}=b3e,k3e=parseInt("755",8),U3e=parseInt("644",8),rL=new Uint8Array(1024);function M3e(r=0){switch(r&D3e){case O3e:return"block-device";case P3e:return"character-device";case N3e:return"directory";case B3e:return"fifo";case L3e:return"symlink";default:return"file"}}function kw(r){return 0!=(r&=511)?rL.subarray(0,512-r):new Uint8Array(0)}function Uw(r){if(null==r.pax){const e=Lw(r);if(null!=e)return e}return function F3e(r){var e,t;const n=function R3e(r){let e="";null!=r.name&&(e+=Bw(" path="+r.name+"\n")),null!=r.linkname&&(e+=Bw(" linkpath="+r.linkname+"\n"));const t=r.pax;if(null!=t)for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e+=Bw(" "+n+"="+t[n]+"\n"));return Ur(e)}(r),s={name:"PaxHeader",mode:r.mode,uid:r.uid,gid:r.gid,size:n.length,mtime:r.mtime,type:"pax-header",linkname:r.linkname,uname:r.uname,gname:r.gname,devmajor:r.devmajor,devminor:r.devminor};return new Or(null!==(e=Lw(s))&&void 0!==e?e:new Uint8Array(0),n,kw(n.length),null!==(t=Lw({...s,size:r.size,type:r.type}))&&void 0!==t?t:new Uint8Array(0)).subarray()}(r)}function nL(){return function(){var r=Ee(function*(e){var s,t=!1,n=!1;try{for(var o,i=be(e);t=!(o=yield X(i.next())).done;t=!1){var a,c,u,f,E,T;let{header:$,body:V}=o.value;const W={...$,size:"symlink"===$.type?0:null!==(a=$.size)&&void 0!==a?a:0,type:null!==(c=$.type)&&void 0!==c?c:M3e($.mode),mode:null!==(u=$.mode)&&void 0!==u?u:"directory"===$.type?k3e:U3e,uid:null!==(f=$.uid)&&void 0!==f?f:0,gid:null!==(E=$.gid)&&void 0!==E?E:0,mtime:null!==(T=$.mtime)&&void 0!==T?T:new Date};if("string"==typeof V&&(V=Ur(V)),V instanceof Uint8Array||Xl(V)){W.size=V.length,yield Uw(W),yield Xl(V)?V.subarray():V,yield kw(W.size);continue}if("symlink"===W.type&&null==W.linkname){if(null==V)throw new Error("type was symlink but no linkname or body specified");W.linkname=ay(yield X(_3e(V))),yield Uw(W);continue}if(yield Uw(W),"file"!==W.type&&"contiguous-file"!==W.type)continue;let ne=0;var P,U=!1,b=!1;try{for(var M,F=be(null!==(H=V)&&void 0!==H?H:[]);U=!(M=yield X(F.next())).done;U=!1){var H;const Y=M.value;ne+=Y.length,yield Xl(Y)?Y.subarray():Y}}catch(Y){b=!0,P=Y}finally{try{U&&null!=F.return&&(yield X(F.return()))}finally{if(b)throw P}}if(ne!==W.size)throw new Error(`size mismatch, wrote ${ne} of ${W.size} bytes`);yield kw(W.size)}}catch($){n=!0,s=$}finally{try{t&&null!=i.return&&(yield X(i.return()))}finally{if(n)throw s}}yield rL});return function(e){return r.apply(this,arguments)}}()}function eu(r){let e=r.length;for(;--e>=0;)r[e]=0}const jw=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ly=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),G3e=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),dL=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ko=new Array(576);eu(ko);const lh=new Array(60);eu(lh);const uh=new Array(512);eu(uh);const dh=new Array(256);eu(dh);const $w=new Array(29);eu($w);const uy=new Array(30);function Kw(r,e,t,n,s){this.static_tree=r,this.extra_bits=e,this.extra_base=t,this.elems=n,this.max_length=s,this.has_stree=r&&r.length}let fL,hL,pL;function Zw(r,e){this.dyn_tree=r,this.max_code=0,this.stat_desc=e}eu(uy);const yL=r=>r<256?uh[r]:uh[256+(r>>>7)],fh=(r,e)=>{r.pending_buf[r.pending++]=255&e,r.pending_buf[r.pending++]=e>>>8&255},Bs=(r,e,t)=>{r.bi_valid>16-t?(r.bi_buf|=e<<r.bi_valid&65535,fh(r,r.bi_buf),r.bi_buf=e>>16-r.bi_valid,r.bi_valid+=t-16):(r.bi_buf|=e<<r.bi_valid&65535,r.bi_valid+=t)},qi=(r,e,t)=>{Bs(r,t[2*e],t[2*e+1])},gL=(r,e)=>{let t=0;do{t|=1&r,r>>>=1,t<<=1}while(--e>0);return t>>>1},bL=(r,e,t)=>{const n=new Array(16);let i,o,s=0;for(i=1;i<=15;i++)n[i]=s=s+t[i-1]<<1;for(o=0;o<=e;o++){let a=r[2*o+1];0!==a&&(r[2*o]=gL(n[a]++,a))}},_L=r=>{let e;for(e=0;e<286;e++)r.dyn_ltree[2*e]=0;for(e=0;e<30;e++)r.dyn_dtree[2*e]=0;for(e=0;e<19;e++)r.bl_tree[2*e]=0;r.dyn_ltree[512]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0},mL=r=>{r.bi_valid>8?fh(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0},vL=(r,e,t,n)=>{const s=2*e,i=2*t;return r[s]<r[i]||r[s]===r[i]&&n[e]<=n[t]},Hw=(r,e,t)=>{const n=r.heap[t];let s=t<<1;for(;s<=r.heap_len&&(s<r.heap_len&&vL(e,r.heap[s+1],r.heap[s],r.depth)&&s++,!vL(e,n,r.heap[s],r.depth));)r.heap[t]=r.heap[s],t=s,s<<=1;r.heap[t]=n},wL=(r,e,t)=>{let n,s,o,a,i=0;if(0!==r.last_lit)do{n=r.pending_buf[r.d_buf+2*i]<<8|r.pending_buf[r.d_buf+2*i+1],s=r.pending_buf[r.l_buf+i],i++,0===n?qi(r,s,e):(o=dh[s],qi(r,o+256+1,e),a=jw[o],0!==a&&(s-=$w[o],Bs(r,s,a)),n--,o=yL(n),qi(r,o,t),a=ly[o],0!==a&&(n-=uy[o],Bs(r,n,a)))}while(i<r.last_lit);qi(r,256,e)},Gw=(r,e)=>{const t=e.dyn_tree,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,i=e.stat_desc.elems;let o,a,u,c=-1;for(r.heap_len=0,r.heap_max=573,o=0;o<i;o++)0!==t[2*o]?(r.heap[++r.heap_len]=c=o,r.depth[o]=0):t[2*o+1]=0;for(;r.heap_len<2;)u=r.heap[++r.heap_len]=c<2?++c:0,t[2*u]=1,r.depth[u]=0,r.opt_len--,s&&(r.static_len-=n[2*u+1]);for(e.max_code=c,o=r.heap_len>>1;o>=1;o--)Hw(r,t,o);u=i;do{o=r.heap[1],r.heap[1]=r.heap[r.heap_len--],Hw(r,t,1),a=r.heap[1],r.heap[--r.heap_max]=o,r.heap[--r.heap_max]=a,t[2*u]=t[2*o]+t[2*a],r.depth[u]=(r.depth[o]>=r.depth[a]?r.depth[o]:r.depth[a])+1,t[2*o+1]=t[2*a+1]=u,r.heap[1]=u++,Hw(r,t,1)}while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],((r,e)=>{const t=e.dyn_tree,n=e.max_code,s=e.stat_desc.static_tree,i=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,c=e.stat_desc.max_length;let u,f,E,T,U,b,P=0;for(T=0;T<=15;T++)r.bl_count[T]=0;for(t[2*r.heap[r.heap_max]+1]=0,u=r.heap_max+1;u<573;u++)f=r.heap[u],T=t[2*t[2*f+1]+1]+1,T>c&&(T=c,P++),t[2*f+1]=T,!(f>n)&&(r.bl_count[T]++,U=0,f>=a&&(U=o[f-a]),b=t[2*f],r.opt_len+=b*(T+U),i&&(r.static_len+=b*(s[2*f+1]+U)));if(0!==P){do{for(T=c-1;0===r.bl_count[T];)T--;r.bl_count[T]--,r.bl_count[T+1]+=2,r.bl_count[c]--,P-=2}while(P>0);for(T=c;0!==T;T--)for(f=r.bl_count[T];0!==f;)E=r.heap[--u],!(E>n)&&(t[2*E+1]!==T&&(r.opt_len+=(T-t[2*E+1])*t[2*E],t[2*E+1]=T),f--)}})(r,e),bL(t,c,r.bl_count)},EL=(r,e,t)=>{let n,i,s=-1,o=e[1],a=0,c=7,u=4;for(0===o&&(c=138,u=3),e[2*(t+1)+1]=65535,n=0;n<=t;n++)i=o,o=e[2*(n+1)+1],!(++a<c&&i===o)&&(a<u?r.bl_tree[2*i]+=a:0!==i?(i!==s&&r.bl_tree[2*i]++,r.bl_tree[32]++):a<=10?r.bl_tree[34]++:r.bl_tree[36]++,a=0,s=i,0===o?(c=138,u=3):i===o?(c=6,u=3):(c=7,u=4))},xL=(r,e,t)=>{let n,i,s=-1,o=e[1],a=0,c=7,u=4;for(0===o&&(c=138,u=3),n=0;n<=t;n++)if(i=o,o=e[2*(n+1)+1],!(++a<c&&i===o)){if(a<u)do{qi(r,i,r.bl_tree)}while(0!=--a);else 0!==i?(i!==s&&(qi(r,i,r.bl_tree),a--),qi(r,16,r.bl_tree),Bs(r,a-3,2)):a<=10?(qi(r,17,r.bl_tree),Bs(r,a-3,3)):(qi(r,18,r.bl_tree),Bs(r,a-11,7));a=0,s=i,0===o?(c=138,u=3):i===o?(c=6,u=3):(c=7,u=4)}};let SL=!1;const AL=(r,e,t,n)=>{Bs(r,0+(n?1:0),3),((r,e,t,n)=>{mL(r),fh(r,t),fh(r,~t),r.pending_buf.set(r.window.subarray(e,e+t),r.pending),r.pending+=t})(r,e,t)};var d6e={_tr_init:r=>{SL||((()=>{let r,e,t,n,s;const i=new Array(16);for(t=0,n=0;n<28;n++)for($w[n]=t,r=0;r<1<<jw[n];r++)dh[t++]=n;for(dh[t-1]=n,s=0,n=0;n<16;n++)for(uy[n]=s,r=0;r<1<<ly[n];r++)uh[s++]=n;for(s>>=7;n<30;n++)for(uy[n]=s<<7,r=0;r<1<<ly[n]-7;r++)uh[256+s++]=n;for(e=0;e<=15;e++)i[e]=0;for(r=0;r<=143;)ko[2*r+1]=8,r++,i[8]++;for(;r<=255;)ko[2*r+1]=9,r++,i[9]++;for(;r<=279;)ko[2*r+1]=7,r++,i[7]++;for(;r<=287;)ko[2*r+1]=8,r++,i[8]++;for(bL(ko,287,i),r=0;r<30;r++)lh[2*r+1]=5,lh[2*r]=gL(r,5);fL=new Kw(ko,jw,257,286,15),hL=new Kw(lh,ly,0,30,15),pL=new Kw(new Array(0),G3e,0,19,7)})(),SL=!0),r.l_desc=new Zw(r.dyn_ltree,fL),r.d_desc=new Zw(r.dyn_dtree,hL),r.bl_desc=new Zw(r.bl_tree,pL),r.bi_buf=0,r.bi_valid=0,_L(r)},_tr_stored_block:AL,_tr_flush_block:(r,e,t,n)=>{let s,i,o=0;r.level>0?(2===r.strm.data_type&&(r.strm.data_type=(r=>{let t,e=4093624447;for(t=0;t<=31;t++,e>>>=1)if(1&e&&0!==r.dyn_ltree[2*t])return 0;if(0!==r.dyn_ltree[18]||0!==r.dyn_ltree[20]||0!==r.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==r.dyn_ltree[2*t])return 1;return 0})(r)),Gw(r,r.l_desc),Gw(r,r.d_desc),o=(r=>{let e;for(EL(r,r.dyn_ltree,r.l_desc.max_code),EL(r,r.dyn_dtree,r.d_desc.max_code),Gw(r,r.bl_desc),e=18;e>=3&&0===r.bl_tree[2*dL[e]+1];e--);return r.opt_len+=3*(e+1)+5+5+4,e})(r),s=r.opt_len+3+7>>>3,i=r.static_len+3+7>>>3,i<=s&&(s=i)):s=i=t+5,t+4<=s&&-1!==e?AL(r,e,t,n):4===r.strategy||i===s?(Bs(r,2+(n?1:0),3),wL(r,ko,lh)):(Bs(r,4+(n?1:0),3),((r,e,t,n)=>{let s;for(Bs(r,e-257,5),Bs(r,t-1,5),Bs(r,n-4,4),s=0;s<n;s++)Bs(r,r.bl_tree[2*dL[s]+1],3);xL(r,r.dyn_ltree,e-1),xL(r,r.dyn_dtree,t-1)})(r,r.l_desc.max_code+1,r.d_desc.max_code+1,o+1),wL(r,r.dyn_ltree,r.dyn_dtree)),_L(r),n&&mL(r)},_tr_tally:(r,e,t)=>(r.pending_buf[r.d_buf+2*r.last_lit]=e>>>8&255,r.pending_buf[r.d_buf+2*r.last_lit+1]=255&e,r.pending_buf[r.l_buf+r.last_lit]=255&t,r.last_lit++,0===e?r.dyn_ltree[2*t]++:(r.matches++,e--,r.dyn_ltree[2*(dh[t]+256+1)]++,r.dyn_dtree[2*yL(e)]++),r.last_lit===r.lit_bufsize-1),_tr_align:r=>{Bs(r,2,3),qi(r,256,ko),(r=>{16===r.bi_valid?(fh(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=255&r.bi_buf,r.bi_buf>>=8,r.bi_valid-=8)})(r)}},hh=(r,e,t,n)=>{let s=65535&r|0,i=r>>>16&65535|0,o=0;for(;0!==t;){o=t>2e3?2e3:t,t-=o;do{s=s+e[n++]|0,i=i+s|0}while(--o);s%=65521,i%=65521}return s|i<<16|0};const h6e=new Uint32Array((()=>{let r,e=[];for(var t=0;t<256;t++){r=t;for(var n=0;n<8;n++)r=1&r?3988292384^r>>>1:r>>>1;e[t]=r}return e})());var ln=(r,e,t,n)=>{const s=h6e,i=n+t;r^=-1;for(let o=n;o<i;o++)r=r>>>8^s[255&(r^e[o])];return-1^r},kc={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Uc={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:p6e,_tr_stored_block:y6e,_tr_flush_block:g6e,_tr_tally:Fa,_tr_align:b6e}=d6e,{Z_NO_FLUSH:Mc,Z_PARTIAL_FLUSH:_6e,Z_FULL_FLUSH:m6e,Z_FINISH:za,Z_BLOCK:TL,Z_OK:eo,Z_STREAM_END:CL,Z_STREAM_ERROR:ci,Z_DATA_ERROR:v6e,Z_BUF_ERROR:Ww,Z_DEFAULT_COMPRESSION:w6e,Z_FILTERED:E6e,Z_HUFFMAN_ONLY:dy,Z_RLE:x6e,Z_FIXED:S6e,Z_DEFAULT_STRATEGY:A6e,Z_UNKNOWN:T6e,Z_DEFLATED:fy}=Uc,Pi=262,ja=(r,e)=>(r.msg=kc[e],e),IL=r=>(r<<1)-(r>4?9:0),$a=r=>{let e=r.length;for(;--e>=0;)r[e]=0};let Ka=(r,e,t)=>(e<<r.hash_shift^t)&r.hash_mask;const Za=r=>{const e=r.state;let t=e.pending;t>r.avail_out&&(t=r.avail_out),0!==t&&(r.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+t),r.next_out),r.next_out+=t,e.pending_out+=t,r.total_out+=t,r.avail_out-=t,e.pending-=t,0===e.pending&&(e.pending_out=0))},Bn=(r,e)=>{g6e(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,e),r.block_start=r.strstart,Za(r.strm)},kt=(r,e)=>{r.pending_buf[r.pending++]=e},gh=(r,e)=>{r.pending_buf[r.pending++]=e>>>8&255,r.pending_buf[r.pending++]=255&e},U6e=(r,e,t,n)=>{let s=r.avail_in;return s>n&&(s=n),0===s?0:(r.avail_in-=s,e.set(r.input.subarray(r.next_in,r.next_in+s),t),1===r.state.wrap?r.adler=hh(r.adler,e,s,t):2===r.state.wrap&&(r.adler=ln(r.adler,e,s,t)),r.next_in+=s,r.total_in+=s,s)},RL=(r,e)=>{let s,i,t=r.max_chain_length,n=r.strstart,o=r.prev_length,a=r.nice_match;const c=r.strstart>r.w_size-Pi?r.strstart-(r.w_size-Pi):0,u=r.window,f=r.w_mask,E=r.prev,T=r.strstart+258;let U=u[n+o-1],b=u[n+o];r.prev_length>=r.good_match&&(t>>=2),a>r.lookahead&&(a=r.lookahead);do{if(s=e,u[s+o]===b&&u[s+o-1]===U&&u[s]===u[n]&&u[++s]===u[n+1]){n+=2,s++;do{}while(u[++n]===u[++s]&&u[++n]===u[++s]&&u[++n]===u[++s]&&u[++n]===u[++s]&&u[++n]===u[++s]&&u[++n]===u[++s]&&u[++n]===u[++s]&&u[++n]===u[++s]&&n<T);if(i=258-(T-n),n=T-258,i>o){if(r.match_start=e,o=i,i>=a)break;U=u[n+o-1],b=u[n+o]}}}while((e=E[e&f])>c&&0!=--t);return o<=r.lookahead?o:r.lookahead},Vc=r=>{const e=r.w_size;let t,n,s,i,o;do{if(i=r.window_size-r.lookahead-r.strstart,r.strstart>=e+(e-Pi)){r.window.set(r.window.subarray(e,e+e),0),r.match_start-=e,r.strstart-=e,r.block_start-=e,n=r.hash_size,t=n;do{s=r.head[--t],r.head[t]=s>=e?s-e:0}while(--n);n=e,t=n;do{s=r.prev[--t],r.prev[t]=s>=e?s-e:0}while(--n);i+=e}if(0===r.strm.avail_in)break;if(n=U6e(r.strm,r.window,r.strstart+r.lookahead,i),r.lookahead+=n,r.lookahead+r.insert>=3)for(o=r.strstart-r.insert,r.ins_h=r.window[o],r.ins_h=Ka(r,r.ins_h,r.window[o+1]);r.insert&&(r.ins_h=Ka(r,r.ins_h,r.window[o+3-1]),r.prev[o&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=o,o++,r.insert--,!(r.lookahead+r.insert<3)););}while(r.lookahead<Pi&&0!==r.strm.avail_in)},Jw=(r,e)=>{let t,n;for(;;){if(r.lookahead<Pi){if(Vc(r),r.lookahead<Pi&&e===Mc)return 1;if(0===r.lookahead)break}if(t=0,r.lookahead>=3&&(r.ins_h=Ka(r,r.ins_h,r.window[r.strstart+3-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),0!==t&&r.strstart-t<=r.w_size-Pi&&(r.match_length=RL(r,t)),r.match_length>=3)if(n=Fa(r,r.strstart-r.match_start,r.match_length-3),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=3){r.match_length--;do{r.strstart++,r.ins_h=Ka(r,r.ins_h,r.window[r.strstart+3-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart}while(0!=--r.match_length);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=Ka(r,r.ins_h,r.window[r.strstart+1]);else n=Fa(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(n&&(Bn(r,!1),0===r.strm.avail_out))return 1}return r.insert=r.strstart<2?r.strstart:2,e===za?(Bn(r,!0),0===r.strm.avail_out?3:4):r.last_lit&&(Bn(r,!1),0===r.strm.avail_out)?1:2},nu=(r,e)=>{let t,n,s;for(;;){if(r.lookahead<Pi){if(Vc(r),r.lookahead<Pi&&e===Mc)return 1;if(0===r.lookahead)break}if(t=0,r.lookahead>=3&&(r.ins_h=Ka(r,r.ins_h,r.window[r.strstart+3-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=2,0!==t&&r.prev_length<r.max_lazy_match&&r.strstart-t<=r.w_size-Pi&&(r.match_length=RL(r,t),r.match_length<=5&&(r.strategy===E6e||3===r.match_length&&r.strstart-r.match_start>4096)&&(r.match_length=2)),r.prev_length>=3&&r.match_length<=r.prev_length){s=r.strstart+r.lookahead-3,n=Fa(r,r.strstart-1-r.prev_match,r.prev_length-3),r.lookahead-=r.prev_length-1,r.prev_length-=2;do{++r.strstart<=s&&(r.ins_h=Ka(r,r.ins_h,r.window[r.strstart+3-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart)}while(0!=--r.prev_length);if(r.match_available=0,r.match_length=2,r.strstart++,n&&(Bn(r,!1),0===r.strm.avail_out))return 1}else if(r.match_available){if(n=Fa(r,0,r.window[r.strstart-1]),n&&Bn(r,!1),r.strstart++,r.lookahead--,0===r.strm.avail_out)return 1}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(n=Fa(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<2?r.strstart:2,e===za?(Bn(r,!0),0===r.strm.avail_out?3:4):r.last_lit&&(Bn(r,!1),0===r.strm.avail_out)?1:2};function to(r,e,t,n,s){this.good_length=r,this.max_lazy=e,this.nice_length=t,this.max_chain=n,this.func=s}const bh=[new to(0,0,0,0,(r,e)=>{let t=65535;for(t>r.pending_buf_size-5&&(t=r.pending_buf_size-5);;){if(r.lookahead<=1){if(Vc(r),0===r.lookahead&&e===Mc)return 1;if(0===r.lookahead)break}r.strstart+=r.lookahead,r.lookahead=0;const n=r.block_start+t;if((0===r.strstart||r.strstart>=n)&&(r.lookahead=r.strstart-n,r.strstart=n,Bn(r,!1),0===r.strm.avail_out)||r.strstart-r.block_start>=r.w_size-Pi&&(Bn(r,!1),0===r.strm.avail_out))return 1}return r.insert=0,e===za?(Bn(r,!0),0===r.strm.avail_out?3:4):(r.strstart>r.block_start&&Bn(r,!1),1)}),new to(4,4,8,4,Jw),new to(4,5,16,8,Jw),new to(4,6,32,32,Jw),new to(4,4,16,16,nu),new to(8,16,32,32,nu),new to(8,16,128,128,nu),new to(8,32,128,256,nu),new to(32,128,258,1024,nu),new to(32,258,258,4096,nu)];function j6e(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=fy,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),$a(this.dyn_ltree),$a(this.dyn_dtree),$a(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),$a(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),$a(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const DL=r=>{if(!r||!r.state)return ja(r,ci);r.total_in=r.total_out=0,r.data_type=T6e;const e=r.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:113,r.adler=2===e.wrap?0:1,e.last_flush=Mc,p6e(e),eo},OL=r=>{const e=DL(r);return e===eo&&(r=>{r.window_size=2*r.w_size,$a(r.head),r.max_lazy_match=bh[r.level].max_lazy,r.good_match=bh[r.level].good_length,r.nice_match=bh[r.level].nice_length,r.max_chain_length=bh[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0})(r.state),e},PL=(r,e,t,n,s,i)=>{if(!r)return ci;let o=1;if(e===w6e&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),s<1||s>9||t!==fy||n<8||n>15||e<0||e>9||i<0||i>S6e)return ja(r,ci);8===n&&(n=9);const a=new j6e;return r.state=a,a.strm=r,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=e,a.strategy=i,a.method=t,OL(r)};var _h_deflateInit2=PL,_h_deflateSetHeader=(r,e)=>r&&r.state&&2===r.state.wrap?(r.state.gzhead=e,eo):ci,_h_deflate=(r,e)=>{let t,n;if(!r||!r.state||e>TL||e<0)return r?ja(r,ci):ci;const s=r.state;if(!r.output||!r.input&&0!==r.avail_in||666===s.status&&e!==za)return ja(r,0===r.avail_out?Ww:ci);s.strm=r;const i=s.last_flush;if(s.last_flush=e,42===s.status)if(2===s.wrap)r.adler=0,kt(s,31),kt(s,139),kt(s,8),s.gzhead?(kt(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),kt(s,255&s.gzhead.time),kt(s,s.gzhead.time>>8&255),kt(s,s.gzhead.time>>16&255),kt(s,s.gzhead.time>>24&255),kt(s,9===s.level?2:s.strategy>=dy||s.level<2?4:0),kt(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(kt(s,255&s.gzhead.extra.length),kt(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(r.adler=ln(r.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(kt(s,0),kt(s,0),kt(s,0),kt(s,0),kt(s,0),kt(s,9===s.level?2:s.strategy>=dy||s.level<2?4:0),kt(s,3),s.status=113);else{let o=fy+(s.w_bits-8<<4)<<8,a=-1;a=s.strategy>=dy||s.level<2?0:s.level<6?1:6===s.level?2:3,o|=a<<6,0!==s.strstart&&(o|=32),o+=31-o%31,s.status=113,gh(s,o),0!==s.strstart&&(gh(s,r.adler>>>16),gh(s,65535&r.adler)),r.adler=1}if(69===s.status)if(s.gzhead.extra){for(t=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>t&&(r.adler=ln(r.adler,s.pending_buf,s.pending-t,t)),Za(r),t=s.pending,s.pending!==s.pending_buf_size));)kt(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>t&&(r.adler=ln(r.adler,s.pending_buf,s.pending-t,t)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){t=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>t&&(r.adler=ln(r.adler,s.pending_buf,s.pending-t,t)),Za(r),t=s.pending,s.pending===s.pending_buf_size)){n=1;break}n=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,kt(s,n)}while(0!==n);s.gzhead.hcrc&&s.pending>t&&(r.adler=ln(r.adler,s.pending_buf,s.pending-t,t)),0===n&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){t=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>t&&(r.adler=ln(r.adler,s.pending_buf,s.pending-t,t)),Za(r),t=s.pending,s.pending===s.pending_buf_size)){n=1;break}n=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,kt(s,n)}while(0!==n);s.gzhead.hcrc&&s.pending>t&&(r.adler=ln(r.adler,s.pending_buf,s.pending-t,t)),0===n&&(s.status=103)}else s.status=103;if(103===s.status&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&Za(r),s.pending+2<=s.pending_buf_size&&(kt(s,255&r.adler),kt(s,r.adler>>8&255),r.adler=0,s.status=113)):s.status=113),0!==s.pending){if(Za(r),0===r.avail_out)return s.last_flush=-1,eo}else if(0===r.avail_in&&IL(e)<=IL(i)&&e!==za)return ja(r,Ww);if(666===s.status&&0!==r.avail_in)return ja(r,Ww);if(0!==r.avail_in||0!==s.lookahead||e!==Mc&&666!==s.status){let o=s.strategy===dy?((r,e)=>{let t;for(;;){if(0===r.lookahead&&(Vc(r),0===r.lookahead)){if(e===Mc)return 1;break}if(r.match_length=0,t=Fa(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,t&&(Bn(r,!1),0===r.strm.avail_out))return 1}return r.insert=0,e===za?(Bn(r,!0),0===r.strm.avail_out?3:4):r.last_lit&&(Bn(r,!1),0===r.strm.avail_out)?1:2})(s,e):s.strategy===x6e?((r,e)=>{let t,n,s,i;const o=r.window;for(;;){if(r.lookahead<=258){if(Vc(r),r.lookahead<=258&&e===Mc)return 1;if(0===r.lookahead)break}if(r.match_length=0,r.lookahead>=3&&r.strstart>0&&(s=r.strstart-1,n=o[s],n===o[++s]&&n===o[++s]&&n===o[++s])){i=r.strstart+258;do{}while(n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&s<i);r.match_length=258-(i-s),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=3?(t=Fa(r,1,r.match_length-3),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(t=Fa(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),t&&(Bn(r,!1),0===r.strm.avail_out))return 1}return r.insert=0,e===za?(Bn(r,!0),0===r.strm.avail_out?3:4):r.last_lit&&(Bn(r,!1),0===r.strm.avail_out)?1:2})(s,e):bh[s.level].func(s,e);if((3===o||4===o)&&(s.status=666),1===o||3===o)return 0===r.avail_out&&(s.last_flush=-1),eo;if(2===o&&(e===_6e?b6e(s):e!==TL&&(y6e(s,0,0,!1),e===m6e&&($a(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),Za(r),0===r.avail_out))return s.last_flush=-1,eo}return e!==za?eo:s.wrap<=0?CL:(2===s.wrap?(kt(s,255&r.adler),kt(s,r.adler>>8&255),kt(s,r.adler>>16&255),kt(s,r.adler>>24&255),kt(s,255&r.total_in),kt(s,r.total_in>>8&255),kt(s,r.total_in>>16&255),kt(s,r.total_in>>24&255)):(gh(s,r.adler>>>16),gh(s,65535&r.adler)),Za(r),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?eo:CL)},_h_deflateEnd=r=>{if(!r||!r.state)return ci;const e=r.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&103!==e&&113!==e&&666!==e?ja(r,ci):(r.state=null,113===e?ja(r,v6e):eo)},_h_deflateSetDictionary=(r,e)=>{let t=e.length;if(!r||!r.state)return ci;const n=r.state,s=n.wrap;if(2===s||1===s&&42!==n.status||n.lookahead)return ci;if(1===s&&(r.adler=hh(r.adler,e,t,0)),n.wrap=0,t>=n.w_size){0===s&&($a(n.head),n.strstart=0,n.block_start=0,n.insert=0);let c=new Uint8Array(n.w_size);c.set(e.subarray(t-n.w_size,t),0),e=c,t=n.w_size}const i=r.avail_in,o=r.next_in,a=r.input;for(r.avail_in=t,r.next_in=0,r.input=e,Vc(n);n.lookahead>=3;){let c=n.strstart,u=n.lookahead-2;do{n.ins_h=Ka(n,n.ins_h,n.window[c+3-1]),n.prev[c&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=c,c++}while(--u);n.strstart=c,n.lookahead=2,Vc(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,r.next_in=o,r.input=a,r.avail_in=i,n.wrap=s,eo};const n5e=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);var by_assign=function(r){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if("object"!=typeof t)throw new TypeError(t+"must be non-object");for(const n in t)n5e(t,n)&&(r[n]=t[n])}}return r},by_flattenChunks=r=>{let e=0;for(let n=0,s=r.length;n<s;n++)e+=r[n].length;const t=new Uint8Array(e);for(let n=0,s=0,i=r.length;n<i;n++){let o=r[n];t.set(o,s),s+=o.length}return t};let NL=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{NL=!1}const mh=new Uint8Array(256);for(let r=0;r<256;r++)mh[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;mh[254]=mh[254]=1;var vh_string2buf=r=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(r);let e,t,n,s,i,o=r.length,a=0;for(s=0;s<o;s++)t=r.charCodeAt(s),55296==(64512&t)&&s+1<o&&(n=r.charCodeAt(s+1),56320==(64512&n)&&(t=65536+(t-55296<<10)+(n-56320),s++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(a),i=0,s=0;i<a;s++)t=r.charCodeAt(s),55296==(64512&t)&&s+1<o&&(n=r.charCodeAt(s+1),56320==(64512&n)&&(t=65536+(t-55296<<10)+(n-56320),s++)),t<128?e[i++]=t:t<2048?(e[i++]=192|t>>>6,e[i++]=128|63&t):t<65536?(e[i++]=224|t>>>12,e[i++]=128|t>>>6&63,e[i++]=128|63&t):(e[i++]=240|t>>>18,e[i++]=128|t>>>12&63,e[i++]=128|t>>>6&63,e[i++]=128|63&t);return e},vh_buf2string=(r,e)=>{const t=e||r.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(r.subarray(0,e));let n,s;const i=new Array(2*t);for(s=0,n=0;n<t;){let o=r[n++];if(o<128){i[s++]=o;continue}let a=mh[o];if(a>4)i[s++]=65533,n+=a-1;else{for(o&=2===a?31:3===a?15:7;a>1&&n<t;)o=o<<6|63&r[n++],a--;a>1?i[s++]=65533:o<65536?i[s++]=o:(o-=65536,i[s++]=55296|o>>10&1023,i[s++]=56320|1023&o)}}return((r,e)=>{if(e<65534&&r.subarray&&NL)return String.fromCharCode.apply(null,r.length===e?r:r.subarray(0,e));let t="";for(let n=0;n<e;n++)t+=String.fromCharCode(r[n]);return t})(i,s)},vh_utf8border=(r,e)=>{(e=e||r.length)>r.length&&(e=r.length);let t=e-1;for(;t>=0&&128==(192&r[t]);)t--;return t<0||0===t?e:t+mh[r[t]]>e?t:e},BL=function u5e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const LL=Object.prototype.toString,{Z_NO_FLUSH:d5e,Z_SYNC_FLUSH:f5e,Z_FULL_FLUSH:h5e,Z_FINISH:p5e,Z_OK:_y,Z_STREAM_END:y5e,Z_DEFAULT_COMPRESSION:g5e,Z_DEFAULT_STRATEGY:b5e,Z_DEFLATED:_5e}=Uc;function wh(r){this.options=by_assign({level:g5e,method:_5e,chunkSize:16384,windowBits:15,memLevel:8,strategy:b5e},r||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new BL,this.strm.avail_out=0;let t=_h_deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==_y)throw new Error(kc[t]);if(e.header&&_h_deflateSetHeader(this.strm,e.header),e.dictionary){let n;if(n="string"==typeof e.dictionary?vh_string2buf(e.dictionary):"[object ArrayBuffer]"===LL.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,t=_h_deflateSetDictionary(this.strm,n),t!==_y)throw new Error(kc[t]);this._dict_set=!0}}function Xw(r,e){const t=new wh(e);if(t.push(r,!0),t.err)throw t.msg||kc[t.err];return t.result}wh.prototype.push=function(r,e){const t=this.strm,n=this.options.chunkSize;let s,i;if(this.ended)return!1;for(i=e===~~e?e:!0===e?p5e:d5e,t.input="string"==typeof r?vh_string2buf(r):"[object ArrayBuffer]"===LL.call(r)?new Uint8Array(r):r,t.next_in=0,t.avail_in=t.input.length;;)if(0===t.avail_out&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),(i===f5e||i===h5e)&&t.avail_out<=6)this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;else{if(s=_h_deflate(t,i),s===y5e)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),s=_h_deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===_y;if(0!==t.avail_out){if(i>0&&t.next_out>0)this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;else if(0===t.avail_in)break}else this.onData(t.output)}return!0},wh.prototype.onData=function(r){this.chunks.push(r)},wh.prototype.onEnd=function(r){r===_y&&(this.result=by_flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};var T5e={Deflate:wh,deflate:Xw,deflateRaw:function m5e(r,e){return(e=e||{}).raw=!0,Xw(r,e)},gzip:function v5e(r,e){return(e=e||{}).gzip=!0,Xw(r,e)},constants:Uc},I5e=function(e,t){let n,s,i,o,a,c,u,f,E,T,U,b,P,F,M,H,$,V,W,ne,Y,q,ge,Ce;const De=e.state;n=e.next_in,ge=e.input,s=n+(e.avail_in-5),i=e.next_out,Ce=e.output,o=i-(t-e.avail_out),a=i+(e.avail_out-257),c=De.dmax,u=De.wsize,f=De.whave,E=De.wnext,T=De.window,U=De.hold,b=De.bits,P=De.lencode,F=De.distcode,M=(1<<De.lenbits)-1,H=(1<<De.distbits)-1;e:do{b<15&&(U+=ge[n++]<<b,b+=8,U+=ge[n++]<<b,b+=8),$=P[U&M];t:for(;;){if(V=$>>>24,U>>>=V,b-=V,V=$>>>16&255,0===V)Ce[i++]=65535&$;else{if(!(16&V)){if(0==(64&V)){$=P[(65535&$)+(U&(1<<V)-1)];continue t}if(32&V){De.mode=12;break e}e.msg="invalid literal/length code",De.mode=30;break e}W=65535&$,V&=15,V&&(b<V&&(U+=ge[n++]<<b,b+=8),W+=U&(1<<V)-1,U>>>=V,b-=V),b<15&&(U+=ge[n++]<<b,b+=8,U+=ge[n++]<<b,b+=8),$=F[U&H];r:for(;;){if(V=$>>>24,U>>>=V,b-=V,V=$>>>16&255,!(16&V)){if(0==(64&V)){$=F[(65535&$)+(U&(1<<V)-1)];continue r}e.msg="invalid distance code",De.mode=30;break e}if(ne=65535&$,V&=15,b<V&&(U+=ge[n++]<<b,b+=8,b<V&&(U+=ge[n++]<<b,b+=8)),ne+=U&(1<<V)-1,ne>c){e.msg="invalid distance too far back",De.mode=30;break e}if(U>>>=V,b-=V,V=i-o,ne>V){if(V=ne-V,V>f&&De.sane){e.msg="invalid distance too far back",De.mode=30;break e}if(Y=0,q=T,0===E){if(Y+=u-V,V<W){W-=V;do{Ce[i++]=T[Y++]}while(--V);Y=i-ne,q=Ce}}else if(E<V){if(Y+=u+E-V,V-=E,V<W){W-=V;do{Ce[i++]=T[Y++]}while(--V);if(Y=0,E<W){V=E,W-=V;do{Ce[i++]=T[Y++]}while(--V);Y=i-ne,q=Ce}}}else if(Y+=E-V,V<W){W-=V;do{Ce[i++]=T[Y++]}while(--V);Y=i-ne,q=Ce}for(;W>2;)Ce[i++]=q[Y++],Ce[i++]=q[Y++],Ce[i++]=q[Y++],W-=3;W&&(Ce[i++]=q[Y++],W>1&&(Ce[i++]=q[Y++]))}else{Y=i-ne;do{Ce[i++]=Ce[Y++],Ce[i++]=Ce[Y++],Ce[i++]=Ce[Y++],W-=3}while(W>2);W&&(Ce[i++]=Ce[Y++],W>1&&(Ce[i++]=Ce[Y++]))}break}}break}}while(n<s&&i<a);W=b>>3,n-=W,b-=W<<3,U&=(1<<b)-1,e.next_in=n,e.next_out=i,e.avail_in=n<s?s-n+5:5-(n-s),e.avail_out=i<a?a-i+257:257-(i-a),De.hold=U,De.bits=b};const R5e=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),D5e=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),O5e=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),P5e=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Eh=(r,e,t,n,s,i,o,a)=>{const c=a.bits;let $,V,W,ne,Y,Ce,u=0,f=0,E=0,T=0,U=0,b=0,P=0,F=0,M=0,H=0,q=null,ge=0;const De=new Uint16Array(16),Je=new Uint16Array(16);let Pr,ti,cl,Xe=null,gt=0;for(u=0;u<=15;u++)De[u]=0;for(f=0;f<n;f++)De[e[t+f]]++;for(U=c,T=15;T>=1&&0===De[T];T--);if(U>T&&(U=T),0===T)return s[i++]=20971520,s[i++]=20971520,a.bits=1,0;for(E=1;E<T&&0===De[E];E++);for(U<E&&(U=E),F=1,u=1;u<=15;u++)if(F<<=1,F-=De[u],F<0)return-1;if(F>0&&(0===r||1!==T))return-1;for(Je[1]=0,u=1;u<15;u++)Je[u+1]=Je[u]+De[u];for(f=0;f<n;f++)0!==e[t+f]&&(o[Je[e[t+f]]++]=f);if(0===r?(q=Xe=o,Ce=19):1===r?(q=R5e,ge-=257,Xe=D5e,gt-=257,Ce=256):(q=O5e,Xe=P5e,Ce=-1),H=0,f=0,u=E,Y=i,b=U,P=0,W=-1,M=1<<U,ne=M-1,1===r&&M>852||2===r&&M>592)return 1;for(;;){Pr=u-P,o[f]<Ce?(ti=0,cl=o[f]):o[f]>Ce?(ti=Xe[gt+o[f]],cl=q[ge+o[f]]):(ti=96,cl=0),$=1<<u-P,V=1<<b,E=V;do{V-=$,s[Y+(H>>P)+V]=Pr<<24|ti<<16|cl|0}while(0!==V);for($=1<<u-1;H&$;)$>>=1;if(0!==$?(H&=$-1,H+=$):H=0,f++,0==--De[u]){if(u===T)break;u=e[t+o[f]]}if(u>U&&(H&ne)!==W){for(0===P&&(P=U),Y+=E,b=u-P,F=1<<b;b+P<T&&(F-=De[b+P],!(F<=0));)b++,F<<=1;if(M+=1<<b,1===r&&M>852||2===r&&M>592)return 1;W=H&ne,s[W]=U<<24|b<<16|Y-i|0}}return 0!==H&&(s[Y+H]=u-P<<24|64<<16|0),a.bits=U,0};const{Z_FINISH:jL,Z_BLOCK:B5e,Z_TREES:vy,Z_OK:jc,Z_STREAM_END:L5e,Z_NEED_DICT:k5e,Z_STREAM_ERROR:li,Z_DATA_ERROR:$L,Z_MEM_ERROR:KL,Z_BUF_ERROR:U5e,Z_DEFLATED:ZL}=Uc,yk=r=>(r>>>24&255)+(r>>>8&65280)+((65280&r)<<8)+((255&r)<<24);function j5e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const gk=r=>{if(!r||!r.state)return li;const e=r.state;return r.total_in=r.total_out=e.total=0,r.msg="",e.wrap&&(r.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,jc},bk=r=>{if(!r||!r.state)return li;const e=r.state;return e.wsize=0,e.whave=0,e.wnext=0,gk(r)},_k=(r,e)=>{let t;if(!r||!r.state)return li;const n=r.state;return e<0?(t=0,e=-e):(t=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?li:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=t,n.wbits=e,bk(r))},mk=(r,e)=>{if(!r)return li;const t=new j5e;r.state=t,t.window=null;const n=_k(r,e);return n!==jc&&(r.state=null),n};let nE,sE,vk=!0;const K5e=r=>{if(vk){nE=new Int32Array(512),sE=new Int32Array(32);let e=0;for(;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(Eh(1,r.lens,0,288,nE,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;Eh(2,r.lens,0,32,sE,0,r.work,{bits:5}),vk=!1}r.lencode=nE,r.lenbits=9,r.distcode=sE,r.distbits=5},wk=(r,e,t,n)=>{let s;const i=r.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(e.subarray(t-i.wsize,t),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>n&&(s=n),i.window.set(e.subarray(t-n,t-n+s),i.wnext),(n-=s)?(i.window.set(e.subarray(t-n,t),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0};var Mo_inflateReset=bk,Mo_inflateInit2=mk,Mo_inflate=(r,e)=>{let t,n,s,i,o,a,c,u,f,E,T,U,b,P,M,H,$,V,W,ne,Y,q,F=0;const ge=new Uint8Array(4);let Ce,De;const Je=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!r||!r.state||!r.output||!r.input&&0!==r.avail_in)return li;t=r.state,12===t.mode&&(t.mode=13),o=r.next_out,s=r.output,c=r.avail_out,i=r.next_in,n=r.input,a=r.avail_in,u=t.hold,f=t.bits,E=a,T=c,q=jc;e:for(;;)switch(t.mode){case 1:if(0===t.wrap){t.mode=13;break}for(;f<16;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}if(2&t.wrap&&35615===u){t.check=0,ge[0]=255&u,ge[1]=u>>>8&255,t.check=ln(t.check,ge,2,0),u=0,f=0,t.mode=2;break}if(t.flags=0,t.head&&(t.head.done=!1),!(1&t.wrap)||(((255&u)<<8)+(u>>8))%31){r.msg="incorrect header check",t.mode=30;break}if((15&u)!==ZL){r.msg="unknown compression method",t.mode=30;break}if(u>>>=4,f-=4,Y=8+(15&u),0===t.wbits)t.wbits=Y;else if(Y>t.wbits){r.msg="invalid window size",t.mode=30;break}t.dmax=1<<t.wbits,r.adler=t.check=1,t.mode=512&u?10:12,u=0,f=0;break;case 2:for(;f<16;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}if(t.flags=u,(255&t.flags)!==ZL){r.msg="unknown compression method",t.mode=30;break}if(57344&t.flags){r.msg="unknown header flags set",t.mode=30;break}t.head&&(t.head.text=u>>8&1),512&t.flags&&(ge[0]=255&u,ge[1]=u>>>8&255,t.check=ln(t.check,ge,2,0)),u=0,f=0,t.mode=3;case 3:for(;f<32;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}t.head&&(t.head.time=u),512&t.flags&&(ge[0]=255&u,ge[1]=u>>>8&255,ge[2]=u>>>16&255,ge[3]=u>>>24&255,t.check=ln(t.check,ge,4,0)),u=0,f=0,t.mode=4;case 4:for(;f<16;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}t.head&&(t.head.xflags=255&u,t.head.os=u>>8),512&t.flags&&(ge[0]=255&u,ge[1]=u>>>8&255,t.check=ln(t.check,ge,2,0)),u=0,f=0,t.mode=5;case 5:if(1024&t.flags){for(;f<16;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}t.length=u,t.head&&(t.head.extra_len=u),512&t.flags&&(ge[0]=255&u,ge[1]=u>>>8&255,t.check=ln(t.check,ge,2,0)),u=0,f=0}else t.head&&(t.head.extra=null);t.mode=6;case 6:if(1024&t.flags&&(U=t.length,U>a&&(U=a),U&&(t.head&&(Y=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(i,i+U),Y)),512&t.flags&&(t.check=ln(t.check,n,U,i)),a-=U,i+=U,t.length-=U),t.length))break e;t.length=0,t.mode=7;case 7:if(2048&t.flags){if(0===a)break e;U=0;do{Y=n[i+U++],t.head&&Y&&t.length<65536&&(t.head.name+=String.fromCharCode(Y))}while(Y&&U<a);if(512&t.flags&&(t.check=ln(t.check,n,U,i)),a-=U,i+=U,Y)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=8;case 8:if(4096&t.flags){if(0===a)break e;U=0;do{Y=n[i+U++],t.head&&Y&&t.length<65536&&(t.head.comment+=String.fromCharCode(Y))}while(Y&&U<a);if(512&t.flags&&(t.check=ln(t.check,n,U,i)),a-=U,i+=U,Y)break e}else t.head&&(t.head.comment=null);t.mode=9;case 9:if(512&t.flags){for(;f<16;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}if(u!==(65535&t.check)){r.msg="header crc mismatch",t.mode=30;break}u=0,f=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=12;break;case 10:for(;f<32;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}r.adler=t.check=yk(u),u=0,f=0,t.mode=11;case 11:if(0===t.havedict)return r.next_out=o,r.avail_out=c,r.next_in=i,r.avail_in=a,t.hold=u,t.bits=f,k5e;r.adler=t.check=1,t.mode=12;case 12:if(e===B5e||e===vy)break e;case 13:if(t.last){u>>>=7&f,f-=7&f,t.mode=27;break}for(;f<3;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}switch(t.last=1&u,u>>>=1,f-=1,3&u){case 0:t.mode=14;break;case 1:if(K5e(t),t.mode=20,e===vy){u>>>=2,f-=2;break e}break;case 2:t.mode=17;break;case 3:r.msg="invalid block type",t.mode=30}u>>>=2,f-=2;break;case 14:for(u>>>=7&f,f-=7&f;f<32;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}if((65535&u)!=(u>>>16^65535)){r.msg="invalid stored block lengths",t.mode=30;break}if(t.length=65535&u,u=0,f=0,t.mode=15,e===vy)break e;case 15:t.mode=16;case 16:if(U=t.length,U){if(U>a&&(U=a),U>c&&(U=c),0===U)break e;s.set(n.subarray(i,i+U),o),a-=U,i+=U,c-=U,o+=U,t.length-=U;break}t.mode=12;break;case 17:for(;f<14;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}if(t.nlen=257+(31&u),u>>>=5,f-=5,t.ndist=1+(31&u),u>>>=5,f-=5,t.ncode=4+(15&u),u>>>=4,f-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=30;break}t.have=0,t.mode=18;case 18:for(;t.have<t.ncode;){for(;f<3;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}t.lens[Je[t.have++]]=7&u,u>>>=3,f-=3}for(;t.have<19;)t.lens[Je[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,Ce={bits:t.lenbits},q=Eh(0,t.lens,0,19,t.lencode,0,t.work,Ce),t.lenbits=Ce.bits,q){r.msg="invalid code lengths set",t.mode=30;break}t.have=0,t.mode=19;case 19:for(;t.have<t.nlen+t.ndist;){for(;F=t.lencode[u&(1<<t.lenbits)-1],M=F>>>24,H=F>>>16&255,$=65535&F,!(M<=f);){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}if($<16)u>>>=M,f-=M,t.lens[t.have++]=$;else{if(16===$){for(De=M+2;f<De;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}if(u>>>=M,f-=M,0===t.have){r.msg="invalid bit length repeat",t.mode=30;break}Y=t.lens[t.have-1],U=3+(3&u),u>>>=2,f-=2}else if(17===$){for(De=M+3;f<De;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}u>>>=M,f-=M,Y=0,U=3+(7&u),u>>>=3,f-=3}else{for(De=M+7;f<De;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}u>>>=M,f-=M,Y=0,U=11+(127&u),u>>>=7,f-=7}if(t.have+U>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=30;break}for(;U--;)t.lens[t.have++]=Y}}if(30===t.mode)break;if(0===t.lens[256]){r.msg="invalid code -- missing end-of-block",t.mode=30;break}if(t.lenbits=9,Ce={bits:t.lenbits},q=Eh(1,t.lens,0,t.nlen,t.lencode,0,t.work,Ce),t.lenbits=Ce.bits,q){r.msg="invalid literal/lengths set",t.mode=30;break}if(t.distbits=6,t.distcode=t.distdyn,Ce={bits:t.distbits},q=Eh(2,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,Ce),t.distbits=Ce.bits,q){r.msg="invalid distances set",t.mode=30;break}if(t.mode=20,e===vy)break e;case 20:t.mode=21;case 21:if(a>=6&&c>=258){r.next_out=o,r.avail_out=c,r.next_in=i,r.avail_in=a,t.hold=u,t.bits=f,I5e(r,T),o=r.next_out,s=r.output,c=r.avail_out,i=r.next_in,n=r.input,a=r.avail_in,u=t.hold,f=t.bits,12===t.mode&&(t.back=-1);break}for(t.back=0;F=t.lencode[u&(1<<t.lenbits)-1],M=F>>>24,H=F>>>16&255,$=65535&F,!(M<=f);){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}if(H&&0==(240&H)){for(V=M,W=H,ne=$;F=t.lencode[ne+((u&(1<<V+W)-1)>>V)],M=F>>>24,H=F>>>16&255,$=65535&F,!(V+M<=f);){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}u>>>=V,f-=V,t.back+=V}if(u>>>=M,f-=M,t.back+=M,t.length=$,0===H){t.mode=26;break}if(32&H){t.back=-1,t.mode=12;break}if(64&H){r.msg="invalid literal/length code",t.mode=30;break}t.extra=15&H,t.mode=22;case 22:if(t.extra){for(De=t.extra;f<De;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}t.length+=u&(1<<t.extra)-1,u>>>=t.extra,f-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=23;case 23:for(;F=t.distcode[u&(1<<t.distbits)-1],M=F>>>24,H=F>>>16&255,$=65535&F,!(M<=f);){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}if(0==(240&H)){for(V=M,W=H,ne=$;F=t.distcode[ne+((u&(1<<V+W)-1)>>V)],M=F>>>24,H=F>>>16&255,$=65535&F,!(V+M<=f);){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}u>>>=V,f-=V,t.back+=V}if(u>>>=M,f-=M,t.back+=M,64&H){r.msg="invalid distance code",t.mode=30;break}t.offset=$,t.extra=15&H,t.mode=24;case 24:if(t.extra){for(De=t.extra;f<De;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}t.offset+=u&(1<<t.extra)-1,u>>>=t.extra,f-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=30;break}t.mode=25;case 25:if(0===c)break e;if(U=T-c,t.offset>U){if(U=t.offset-U,U>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=30;break}U>t.wnext?(U-=t.wnext,b=t.wsize-U):b=t.wnext-U,U>t.length&&(U=t.length),P=t.window}else P=s,b=o-t.offset,U=t.length;U>c&&(U=c),c-=U,t.length-=U;do{s[o++]=P[b++]}while(--U);0===t.length&&(t.mode=21);break;case 26:if(0===c)break e;s[o++]=t.length,c--,t.mode=21;break;case 27:if(t.wrap){for(;f<32;){if(0===a)break e;a--,u|=n[i++]<<f,f+=8}if(T-=c,r.total_out+=T,t.total+=T,T&&(r.adler=t.check=t.flags?ln(t.check,s,T,o-T):hh(t.check,s,T,o-T)),T=c,(t.flags?u:yk(u))!==t.check){r.msg="incorrect data check",t.mode=30;break}u=0,f=0}t.mode=28;case 28:if(t.wrap&&t.flags){for(;f<32;){if(0===a)break e;a--,u+=n[i++]<<f,f+=8}if(u!==(4294967295&t.total)){r.msg="incorrect length check",t.mode=30;break}u=0,f=0}t.mode=29;case 29:q=L5e;break e;case 30:q=$L;break e;case 31:return KL;default:return li}return r.next_out=o,r.avail_out=c,r.next_in=i,r.avail_in=a,t.hold=u,t.bits=f,(t.wsize||T!==r.avail_out&&t.mode<30&&(t.mode<27||e!==jL))&&wk(r,r.output,r.next_out,T-r.avail_out),E-=r.avail_in,T-=r.avail_out,r.total_in+=E,r.total_out+=T,t.total+=T,t.wrap&&T&&(r.adler=t.check=t.flags?ln(t.check,s,T,r.next_out-T):hh(t.check,s,T,r.next_out-T)),r.data_type=t.bits+(t.last?64:0)+(12===t.mode?128:0)+(20===t.mode||15===t.mode?256:0),(0===E&&0===T||e===jL)&&q===jc&&(q=U5e),q},Mo_inflateEnd=r=>{if(!r||!r.state)return li;let e=r.state;return e.window&&(e.window=null),r.state=null,jc},Mo_inflateGetHeader=(r,e)=>{if(!r||!r.state)return li;const t=r.state;return 0==(2&t.wrap)?li:(t.head=e,e.done=!1,jc)},Mo_inflateSetDictionary=(r,e)=>{const t=e.length;let n,s,i;return r&&r.state&&(n=r.state,0===n.wrap||11===n.mode)?11===n.mode&&(s=1,s=hh(s,e,t,0),s!==n.check)?$L:(i=wk(r,e,t,t),i?(n.mode=31,KL):(n.havedict=1,jc)):li},o8e=function i8e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Ek=Object.prototype.toString,{Z_NO_FLUSH:a8e,Z_FINISH:c8e,Z_OK:xh,Z_STREAM_END:iE,Z_NEED_DICT:oE,Z_STREAM_ERROR:l8e,Z_DATA_ERROR:xk,Z_MEM_ERROR:u8e}=Uc;function Sh(r){this.options=by_assign({chunkSize:65536,windowBits:15,to:""},r||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(r&&r.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new BL,this.strm.avail_out=0;let t=Mo_inflateInit2(this.strm,e.windowBits);if(t!==xh)throw new Error(kc[t]);if(this.header=new o8e,Mo_inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=vh_string2buf(e.dictionary):"[object ArrayBuffer]"===Ek.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=Mo_inflateSetDictionary(this.strm,e.dictionary),t!==xh)))throw new Error(kc[t])}function aE(r,e){const t=new Sh(e);if(t.push(r),t.err)throw t.msg||kc[t.err];return t.result}Sh.prototype.push=function(r,e){const t=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let i,o,a;if(this.ended)return!1;for(o=e===~~e?e:!0===e?c8e:a8e,t.input="[object ArrayBuffer]"===Ek.call(r)?new Uint8Array(r):r,t.next_in=0,t.avail_in=t.input.length;;){for(0===t.avail_out&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),i=Mo_inflate(t,o),i===oE&&s&&(i=Mo_inflateSetDictionary(t,s),i===xh?i=Mo_inflate(t,o):i===xk&&(i=oE));t.avail_in>0&&i===iE&&t.state.wrap>0&&0!==r[t.next_in];)Mo_inflateReset(t),i=Mo_inflate(t,o);switch(i){case l8e:case xk:case oE:case u8e:return this.onEnd(i),this.ended=!0,!1}if(a=t.avail_out,t.next_out&&(0===t.avail_out||i===iE))if("string"===this.options.to){let c=vh_utf8border(t.output,t.next_out),u=t.next_out-c,f=vh_buf2string(t.output,c);t.next_out=u,t.avail_out=n-u,u&&t.output.set(t.output.subarray(c,c+u),0),this.onData(f)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(i!==xh||0!==a){if(i===iE)return i=Mo_inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===t.avail_in)break}}return!0},Sh.prototype.onData=function(r){this.chunks.push(r)},Sh.prototype.onEnd=function(r){r===xh&&(this.result="string"===this.options.to?this.chunks.join(""):by_flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};var b8e={Inflate:Sh,inflate:aE,inflateRaw:function d8e(r,e){return(e=e||{}).raw=!0,aE(r,e)},ungzip:aE,constants:Uc};const{Deflate:_8e,deflate:m8e,deflateRaw:v8e,gzip:w8e}=T5e,{Inflate:E8e,inflate:x8e,inflateRaw:S8e,ungzip:A8e}=b8e;var Sk={Deflate:_8e,deflate:m8e,deflateRaw:v8e,gzip:w8e,Inflate:E8e,inflate:x8e,inflateRaw:S8e,ungzip:A8e,constants:Uc};function Ak(r){return cE.apply(this,arguments)}function cE(){return cE=(0,B.Z)(function*(r){let e=new Uint8Array(0);var s,t=!1,n=!1;try{for(var o,i=be(r);t=!(o=yield i.next()).done;t=!1){const a=o.value;e=zf([e,a],e.length+a.length)}}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield i.return())}finally{if(n)throw s}}return e}),cE.apply(this,arguments)}class U8e{constructor({preload:e,repo:t,hashers:n,options:s}){const i=function x_e({repo:r,preload:e,hashers:t,options:n}){const s=n&&n.sharding;function o(){return(o=Ee(function*(a,c={}){const u=E_e({shardSplitThreshold:s?1e3:1/0,strategy:"balanced"},c,{...v_e(c.chunker)});u.hashAlg&&"sha2-256"!==u.hashAlg&&1!==u.cidVersion&&(u.cidVersion=1),u.trickle&&(u.strategy="trickle"),"trickle"===u.strategy&&(u.leafType="raw",u.reduceSingleLeafToSelf=!1),u.cidVersion>0&&void 0===u.rawLeaves&&(u.rawLeaves=!0),void 0!==u.hashAlg&&void 0===u.rawLeaves&&(u.rawLeaves=!0),delete u.trickle;const f={};if(u.progress){const V=u.progress;u.progress=(W,ne)=>{f[ne]||(f[ne]=0),f[ne]+=W,V(f[ne],ne)}}let E;null!=u.hashAlg&&(E=yield X(t.getHasher(u.hashAlg)));const T=_t(m_e(a),V=>yw(V,r.blocks,{...u,hasher:E,pin:!1}),S_e(u),A_e(e,u),T_e(r,u)),U=yield X(r.gcLock.readLock());try{var F,b=!1,P=!1;try{for(var H,M=be(T);b=!(H=yield X(M.next())).done;b=!1){var $;const V=H.value,W=null!==($=V.path)&&void 0!==$?$:V.cid.toString();delete f[W],yield{...V,path:W}}}catch(V){P=!0,F=V}finally{try{b&&null!=M.return&&(yield X(M.return()))}finally{if(P)throw F}}}finally{U()}})).apply(this,arguments)}return ze(function i(a){return o.apply(this,arguments)})}({preload:e,repo:t,options:s,hashers:n});this.addAll=i,this.add=function N1e({addAll:r}){function t(){return(t=(0,B.Z)(function*(n,s={}){const i=yield Ys(r(oN(n),s));if(null==i)throw Error("Failed to add a file, if you see this please report a bug");return i})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}({addAll:i}),this.cat=function Pme({repo:r,preload:e}){function n(){return(n=Ee(function*(s,i={}){if(s=p5(s),!1!==i.preload){const a=s.split("/");e(qe.parse(a[0]))}const o=yield X(Lo(s,r.blocks,i));if("directory"===o.type)throw new Error("this dag node is a directory");if(!o.content)throw new Error("this dag node has no content");yield*Fe(be(o.content(i)),X)})).apply(this,arguments)}return ze(function t(s){return n.apply(this,arguments)})}({repo:t,preload:e}),this.get=function L8e({repo:r,preload:e}){function n(){return n=Ee(function*(s,i={}){if(null!=i.compressionLevel&&(i.compressionLevel<-1||i.compressionLevel>9))throw ee(new Error("Compression level must be between -1 and 9"),"ERR_INVALID_PARAMS");if(!1!==i.preload){let c;try{c=p5(s).split("/")}catch(u){throw ee(u,"ERR_INVALID_PATH")}e(qe.parse(c[0]))}const o=qe.asCID(s)||s,a=yield X(Lo(o,r.blocks,i));if("file"===a.type||"raw"===a.type){const c=[];return i.compress&&!0!==i.archive?c.push(a.content):c.push([{header:{name:a.path,mode:"file"===a.type&&a.unixfs.mode,mtime:"file"===a.type&&a.unixfs.mtime?new Date(1e3*a.unixfs.mtime.secs):void 0,size:a.size,type:"file"},body:a.content()}],nL()),i.compress&&c.push(function(){var u=Ee(function*(f){const E=yield X(Ak(f));yield Sk.gzip(E,{level:i.compressionLevel||6})});return function(f){return u.apply(this,arguments)}}()),void(yield*Fe(be(_t(...c)),X))}if("directory"!==a.type)throw ee(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");{const c=[NB(o,r.blocks,i),function(){var u=Ee(function*(f){var U,E=!1,T=!1;try{for(var P,b=be(f);E=!(P=yield X(b.next())).done;E=!1){const F=P.value,M={header:{name:F.path,size:F.size}};if("file"===F.type)M.header.type="file",M.header.mode=null!=F.unixfs.mode?F.unixfs.mode:void 0,M.header.mtime=F.unixfs.mtime?new Date(1e3*F.unixfs.mtime.secs):void 0,M.body=F.content();else if("raw"===F.type)M.header.type="file",M.body=F.content();else{if("directory"!==F.type)throw ee(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");M.header.type="directory",M.header.mode=null!=F.unixfs.mode?F.unixfs.mode:void 0,M.header.mtime=F.unixfs.mtime?new Date(1e3*F.unixfs.mtime.secs):void 0}yield M}}catch(F){T=!0,U=F}finally{try{E&&null!=b.return&&(yield X(b.return()))}finally{if(T)throw U}}});return function(f){return u.apply(this,arguments)}}(),nL()];if(i.compress){if(!i.archive)throw ee(new Error("file is not regular"),"ERR_INVALID_PATH");i.compress&&c.push(function(){var u=Ee(function*(f){const E=yield X(Ak(f));yield Sk.gzip(E,{level:i.compressionLevel||6})});return function(f){return u.apply(this,arguments)}}())}yield*Fe(be(_t(...c)),X)}}),n.apply(this,arguments)}return ze(function t(s){return n.apply(this,arguments)})}({repo:t,preload:e}),this.ls=function k8e({repo:r,preload:e}){function n(){return(n=Ee(function*(s,i={}){const o=p5(s),a=o.split("/");!1!==i.preload&&e(qe.parse(a[0]));const c=qe.asCID(o)||o,u=yield X(Lo(c,r.blocks,i));if("file"!==u.type){if("directory"!==u.type)throw ee(new Error(`Unknown UnixFS type ${u.type}`),"ERR_UNKNOWN_UNIXFS_TYPE");var T,f=!1,E=!1;try{for(var b,U=be(u.content());f=!(b=yield X(U.next())).done;f=!1){const P=b.value;yield $R(P)}}catch(P){E=!0,T=P}finally{try{f&&null!=U.return&&(yield X(U.return()))}finally{if(E)throw T}}}else yield $R(u)})).apply(this,arguments)}return ze(function t(s){return n.apply(this,arguments)})}({repo:t,preload:e})}}const Sy="0.17.0",M8e="e8b7b66bfa98c2a1c0d0bfc19f698d7d00b6c888",V8e=Be("ipfs:components:id");function $8e(r,e,t){return lE.apply(this,arguments)}function lE(){return lE=(0,B.Z)(function*(r,e,t){let n=yield e.peerStore.get(r);n||(n=yield K8e(r,e,t));let s=r.publicKey?r.publicKey:yield e.peerStore.keyBook.get(r);if(null==s)try{s=yield e.getPublicKey(r,t)}catch(i){V8e.error("Could not load public key for",r.toString(),i)}return{...n,publicKey:s,metadata:n.metadata||new Map,addresses:n.addresses.map(i=>i.multiaddr)}}),lE.apply(this,arguments)}function K8e(r,e,t){return uE.apply(this,arguments)}function uE(){return uE=(0,B.Z)(function*(r,e,t){if(null==e.dht)throw ee(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");var i,n=!1,s=!1;try{for(var a,o=be(e.dht.findPeer(r,t));(n=!(a=yield o.next()).done)&&"FINAL_PEER"!==a.value.name;n=!1);}catch(u){s=!0,i=u}finally{try{n&&null!=o.return&&(yield o.return())}finally{if(s)throw i}}const c=yield e.peerStore.get(r);if(!c)throw ee(new Error("Could not find peer"),"ERR_NOT_FOUND");return c}),uE.apply(this,arguments)}var Mr=function Z8e(r,e,t){var n,s,i;if(Array.isArray(e)&&(n=e.slice(0)),"string"==typeof e&&(n=e.split(".")),"symbol"==typeof e&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");if(!(s=n.pop()))return!1;for(Ck(s);i=n.shift();)if(Ck(i),typeof r[i]>"u"&&(r[i]={}),!(r=r[i])||"object"!=typeof r)return!1;return r[s]=t,!0};function Ck(r){if("__proto__"==r||"constructor"==r||"prototype"==r)throw new Error("setting of prototype values not supported")}const Ay={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:r=>(Mr(r,"Discovery.MDNS.Enabled",!1),Mr(r,"Discovery.webRTCStar.Enabled",!1),r.Swarm={...r.Swarm||{},DisableNatPortMap:!0},r)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:r=>(Mr(r,"Discovery.MDNS.Enabled",!0),Mr(r,"Discovery.webRTCStar.Enabled",!0),Mr(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!1}),r)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:r=>{const e_Addresses={Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]};return Mr(r,"Addresses.API",e_Addresses.API?"/ip4/127.0.0.1/tcp/0":""),Mr(r,"Addresses.Gateway",e_Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),Mr(r,"Addresses.Swarm",e_Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),Mr(r,"Addresses.Delegates",[]),Mr(r,"Bootstrap",[]),Mr(r,"Discovery.MDNS.Enabled",!1),Mr(r,"Discovery.webRTCStar.Enabled",!1),Mr(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!0}),r}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:r=>{const e_Addresses={Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},e_Discovery={MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},e_Bootstrap=["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"];return Mr(r,"Addresses.API",e_Addresses.API),Mr(r,"Addresses.Gateway",e_Addresses.Gateway),Mr(r,"Addresses.Swarm",e_Addresses.Swarm),Mr(r,"Addresses.Delegates",e_Addresses.Delegates),Mr(r,"Bootstrap",e_Bootstrap),Mr(r,"Discovery.MDNS.Enabled",e_Discovery.MDNS.Enabled),Mr(r,"Discovery.webRTCStar.Enabled",e_Discovery.webRTCStar.Enabled),Mr(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!1}),r}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:r=>{const e=r.Swarm||{},t=e.ConnMgr||{};return t.LowWater=20,t.HighWater=40,e.ConnMgr=t,r.Swarm=e,r}},"default-power":{description:'Inverse of "lowpower" profile.',transform:r=>(r.Swarm={ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},r)}},H8e=Be("ipfs:core:config");function W8e(r){return dE.apply(this,arguments)}function dE(){return(dE=(0,B.Z)(function*(r){return Object.keys(Ay).map(e=>({name:e,description:Ay[e].description}))})).apply(this,arguments)}function Ty({enumerable:r=!0,configurable:e=!1}={}){return{enumerable:r,configurable:e,writable:!1}}function*Y8e(r,e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))for(const[t,n]of e.entries()){const s=[...r,t],i=qe.asCID(n);i?yield[s.join("/"),i]:"object"==typeof n&&(yield*fE(n,s))}else{const t=qe.asCID(e);t?yield[r.join("/"),t]:yield*fE(e,r)}}function*fE(r,e){if(!(null==r||r instanceof Uint8Array))for(const[t,n]of Object.entries(r)){const s=[...e,t];yield*Y8e(s,n)}}function*Q8e(r,e){if(Array.isArray(e))for(const[t,n]of e.entries()){const s=[...r,t];yield s.join("/"),"object"==typeof n&&!qe.asCID(n)&&(yield*hE(n,s))}else yield*hE(e,r)}function*hE(r,e){if(null!=r&&"object"==typeof r)for(const[t,n]of Object.entries(r)){const s=[...e,t];yield s.join("/"),null!=n&&!(n instanceof Uint8Array)&&"object"==typeof n&&!qe.asCID(n)&&(yield*Q8e(s,n))}}class pE{constructor({cid:e,bytes:t,value:n}){if(!e||!t||typeof n>"u")throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=n,this.asBlock=this,Object.defineProperties(this,{cid:Ty(),bytes:Ty(),value:Ty(),asBlock:Ty()})}links(){return fE(this.value,[])}tree(){return hE(this.value,[])}get(e="/"){return function J8e(r,e){let t=r;for(const[n,s]of e.entries()){if(t=t[s],null==t)throw new Error(`Object has no property at ${e.slice(0,n+1).map(o=>`[${JSON.stringify(o)}]`).join("")}`);const i=qe.asCID(t);if(i)return{value:i,remaining:e.slice(n+1).join("/")}}return{value:t}}(this.value,e.split("/").filter(Boolean))}}var t4e=Math.pow(2,31),s4e=Math.pow(2,7),i4e=Math.pow(2,14),o4e=Math.pow(2,21),a4e=Math.pow(2,28),c4e=Math.pow(2,35),l4e=Math.pow(2,42),u4e=Math.pow(2,49),d4e=Math.pow(2,56),f4e=Math.pow(2,63),p4e={encode:function Dk(r,e,t){e=e||[];for(var n=t=t||0;r>=t4e;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,Dk.bytes=t-n+1,e},decode:function _E(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw _E.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return _E.bytes=i-n,t},encodingLength:function(r){return r<s4e?1:r<i4e?2:r<o4e?3:r<a4e?4:r<c4e?5:r<l4e?6:r<u4e?7:r<d4e?8:r<f4e?9:10}};const Cy=p4e,mE=(r,e=0)=>[Cy.decode(r,e),Cy.decode.bytes],Iy=(r,e,t=0)=>(Cy.encode(r,e,t),e),Ry=r=>Cy.encodingLength(r),vE=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}),wE=r=>{const e=vE(r),[t,n]=mE(e),[s,i]=mE(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new EE(t,s,o,e)};class EE{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const x4e=function v4e(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class S4e{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class A4e{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Pk(this,e)}}class T4e{constructor(e){this.decoders=e}or(e){return Pk(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Pk=(r,e)=>new T4e({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class C4e{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new S4e(e,t,n),this.decoder=new A4e(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Nk=({name:r,prefix:e,encode:t,decode:n})=>new C4e(r,e,t,n),Bk=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=x4e(t,e);return Nk({prefix:r,name:e,encode:n,decode:i=>vE(s(i))})},Fo=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Nk({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),Ha=Bk({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Dy=(Bk({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Fo({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),Lk=(Fo({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Fo({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Fo({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Fo({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Fo({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Fo({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Fo({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Fo({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),xE=r=>{const e=Lk.get(r);if(null==e){const t=new Map;return Lk.set(r,t),t}return e};class Zr{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Ah)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==B4e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Zr.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=((r,e)=>{const t=e.byteLength,n=Ry(r),s=n+Ry(t),i=new Uint8Array(s+t);return Iy(r,i,0),Iy(t,i,n),i.set(e,s),new EE(r,t,e,i)})(e,t);return Zr.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Zr.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?P4e(t,xE(r),e||Ha.encoder):N4e(t,xE(r),e||Dy.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Zr)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new Zr(n,s,i,o||kk(n,s,i.bytes))}if(!0===t[L4e]){const{version:n,multihash:s,code:i}=t,o=wE(s);return Zr.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Ah)throw new Error(`Version 0 CID must use dag-pb (code: ${Ah}) block encoding`);return new Zr(e,t,n,n.bytes);case 1:{const s=kk(e,t,n.bytes);return new Zr(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return Zr.create(0,Ah,e)}static createV1(e,t){return Zr.create(1,e,t)}static decode(e){const[t,n]=Zr.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Zr.inspectBytes(e),n=t.size-t.multihashSize,s=vE(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new EE(t.multihashCode,t.digestSize,i,s);return[0===t.version?Zr.createV0(o):Zr.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=mE(e.subarray(t));return t+=T,E};let s=n(),i=Ah;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=O4e(e,t),i=Zr.decode(s);return xE(i).set(n,e),i}}const O4e=(r,e)=>{switch(r[0]){case"Q":return[Ha.prefix,(e||Ha).decode(`${Ha.prefix}${r}`)];case Ha.prefix:return[Ha.prefix,(e||Ha).decode(r)];case Dy.prefix:return[Dy.prefix,(e||Dy).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},P4e=(r,e,t)=>{const{prefix:n}=t;if(n!==Ha.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},N4e=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},Ah=112,B4e=18,kk=(r,e,t)=>{const n=Ry(r),s=n+Ry(e),i=new Uint8Array(s+t.byteLength);return Iy(r,i,0),Iy(e,i,n),i.set(t,s),i},L4e=Symbol.for("@ipld/js-cid/CID");function Uk(r){const e=u6({version:1,roots:r}),t=vt.encode(e.length),n=new Uint8Array(t.length+e.length);return n.set(t,0),n.set(e,t.length),n}function k4e(r){return{setRoots:e=>(0,B.Z)(function*(){const t=Uk(e);yield r.write(t)})(),writeBlock:e=>(0,B.Z)(function*(){const{cid:t,bytes:n}=e;yield r.write(new Uint8Array(vt.encode(t.bytes.length+n.length))),yield r.write(t.bytes),n.length&&(yield r.write(n))})(),close:()=>(0,B.Z)(function*(){yield r.end()})()}}function Oy(){}const Ga={Null:r=>null===r,Int:r=>Number.isInteger(r),Float:r=>"number"==typeof r&&Number.isFinite(r),String:r=>"string"==typeof r,Bool:r=>"boolean"==typeof r,Bytes:r=>r instanceof Uint8Array,Link:r=>!Ga.Null(r)&&"object"==typeof r&&r.asCID===r,List:r=>Array.isArray(r),Map:r=>!Ga.Null(r)&&"object"==typeof r&&r.asCID!==r&&!Ga.List(r)&&!Ga.Bytes(r)},iu={Int:Ga.Int,"CarHeader > version":r=>iu.Int(r),"CarHeader > roots (anon) > valueType (anon)":Ga.Link,"CarHeader > roots (anon)":r=>Ga.List(r)&&Array.prototype.every.call(r,iu["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":r=>iu["CarHeader > roots (anon)"](r),CarHeader:r=>{const e=r&&Object.keys(r);return Ga.Map(r)&&["version"].every(t=>e.includes(t))&&Object.entries(r).every(([t,n])=>iu["CarHeader > "+t]&&iu["CarHeader > "+t](n))}},M4e=iu.CarHeader;function Py(r){return AE.apply(this,arguments)}function AE(){return AE=(0,B.Z)(function*(r){const e=yield r.upTo(8);if(!e.length)throw new Error("Unexpected end of data");const t=vt.decode(e);return r.seek(vt.decode.bytes),t}),AE.apply(this,arguments)}function F4e(r){return TE.apply(this,arguments)}function TE(){return TE=(0,B.Z)(function*(r){const e=yield r.exactly(40),t=new DataView(e.buffer,e.byteOffset,e.byteLength);let n=0;const s={version:2,characteristics:[t.getBigUint64(n,!0),t.getBigUint64(n+=8,!0)],dataOffset:Number(t.getBigUint64(n+=8,!0)),dataSize:Number(t.getBigUint64(n+=8,!0)),indexOffset:Number(t.getBigUint64(n+=8,!0))};return r.seek(40),s}),TE.apply(this,arguments)}function CE(r,e){return IE.apply(this,arguments)}function IE(){return IE=(0,B.Z)(function*(r,e){const t=yield Py(r);if(0===t)throw new Error("Invalid CAR header (zero length)");const n=yield r.exactly(t);r.seek(t);const s=ip(n);if(!M4e(s))throw new Error("Invalid CAR header format");if(1!==s.version&&2!==s.version||void 0!==e&&s.version!==e)throw new Error(`Invalid CAR version: ${s.version}${void 0!==e?` (expected ${e})`:""}`);const i=Array.isArray(s.roots);if(1===s.version&&!i||2===s.version&&i)throw new Error("Invalid CAR header format");if(1===s.version)return s;const o=yield F4e(r);r.seek(o.dataOffset-r.pos);const a=yield CE(r,1);return Object.assign(a,o)}),IE.apply(this,arguments)}function z4e(r){return RE.apply(this,arguments)}function RE(){return RE=(0,B.Z)(function*(r){const e=yield r.upTo(8);vt.decode(e);const t=vt.decode.bytes,n=vt.decode(e.subarray(vt.decode.bytes)),i=t+vt.decode.bytes+n,o=yield r.exactly(i);return r.seek(i),o}),RE.apply(this,arguments)}function V4e(r){return DE.apply(this,arguments)}function DE(){return DE=(0,B.Z)(function*(r){const e=yield r.exactly(2);if(18===e[0]&&32===e[1]){const o=yield r.exactly(34);r.seek(34);const a=wE(o);return Zr.create(0,112,a)}const t=yield Py(r);if(1!==t)throw new Error(`Unexpected CID version (${t})`);const n=yield Py(r),s=yield z4e(r),i=wE(s);return Zr.create(t,n,i)}),DE.apply(this,arguments)}function Fk(r){return OE.apply(this,arguments)}function OE(){return OE=(0,B.Z)(function*(r){const e=r.pos;let t=yield Py(r);if(0===t)throw new Error("Invalid CAR section (zero length)");return t+=r.pos-e,{cid:yield V4e(r),length:t,blockLength:t-Number(r.pos-e)}}),OE.apply(this,arguments)}function j4e(r){return PE.apply(this,arguments)}function PE(){return PE=(0,B.Z)(function*(r){const{cid:e,blockLength:t}=yield Fk(r),n=yield r.exactly(t);return r.seek(t),{bytes:n,cid:e}}),PE.apply(this,arguments)}function $4e(r){return NE.apply(this,arguments)}function NE(){return NE=(0,B.Z)(function*(r){const e=r.pos,{cid:t,length:n,blockLength:s}=yield Fk(r),i={cid:t,length:n,blockLength:s,offset:e,blockOffset:r.pos};return r.seek(i.blockLength),i}),NE.apply(this,arguments)}function K4e(r){const e=(0,B.Z)(function*(){const t=yield CE(r);return 2===t.version&&(r=function G4e(r,e){let t=0;return{upTo:n=>(0,B.Z)(function*(){let s=yield r.upTo(n);return s.length+t>e&&(s=s.subarray(0,e-t)),s})(),exactly:n=>(0,B.Z)(function*(){const s=yield r.exactly(n);if(s.length+t>e)throw new Error("Unexpected end of data");return s})(),seek(n){t+=n,r.seek(n)},get pos(){return r.pos}}}(r,t.dataSize-(r.pos-t.dataOffset))),t})();return{header:()=>e,blocks:()=>Ee(function*(){for(yield X(e);(yield X(r.upTo(8))).length>0;)yield yield X(j4e(r))})(),blocksIndex:()=>Ee(function*(){for(yield X(e);(yield X(r.upTo(8))).length>0;)yield yield X($4e(r))})()}}function zk(r){let e=0;return{upTo:t=>(0,B.Z)(function*(){return r.subarray(e,e+Math.min(t,r.length-e))})(),exactly:t=>(0,B.Z)(function*(){if(t>r.length-e)throw new Error("Unexpected end of data");return r.subarray(e,e+t)})(),seek(t){e+=t},get pos(){return e}}}function H4e(r){const e=r[Symbol.asyncIterator]();function n(){return(n=(0,B.Z)(function*(){const s=yield e.next();return s.done?null:s.value})).apply(this,arguments)}return function Z4e(r){let e=0,t=0,n=0,s=new Uint8Array(0);const i=function(){var o=(0,B.Z)(function*(a){t=s.length-n;const c=[s.subarray(n)];for(;t<a;){const f=yield r();if(null==f)break;t<0?f.length>t&&c.push(f.subarray(-t)):c.push(f),t+=f.length}s=new Uint8Array(c.reduce((f,E)=>f+E.length,0));let u=0;for(const f of c)s.set(f,u),u+=f.length;n=0});return function(c){return o.apply(this,arguments)}}();return{upTo:o=>(0,B.Z)(function*(){return s.length-n<o&&(yield i(o)),s.subarray(n,n+Math.min(s.length-n,o))})(),exactly:o=>(0,B.Z)(function*(){if(s.length-n<o&&(yield i(o)),s.length-n<o)throw new Error("Unexpected end of data");return s.subarray(n,n+o)})(),seek(o){e+=o,n+=o},get pos(){return e}}}(function t(){return n.apply(this,arguments)})}class Ny{constructor(e,t){this._encoder=t,this._mutex=t.setRoots(e),this._ended=!1}put(e){var t=this;return(0,B.Z)(function*(){if(!(e.bytes instanceof Uint8Array&&e.cid))throw new TypeError("Can only write {cid, bytes} objects");if(t._ended)throw new Error("Already closed");const n=Zr.asCID(e.cid);if(!n)throw new TypeError("Can only write {cid, bytes} objects");return t._mutex=t._mutex.then(()=>t._encoder.writeBlock({cid:n,bytes:e.bytes})),t._mutex})()}close(){var e=this;return(0,B.Z)(function*(){if(e._ended)throw new Error("Already closed");return yield e._mutex,e._ended=!0,e._encoder.close()})()}static create(e){e=function W4e(r){if(void 0===r)return[];if(!Array.isArray(r)){const t=Zr.asCID(r);if(!t)throw new TypeError("roots must be a single CID or an array of CIDs");return[t]}const e=[];for(const t of r){const n=Zr.asCID(t);if(!n)throw new TypeError("roots must be a single CID or an array of CIDs");e.push(n)}return e}(e);const{encoder:t,iterator:n}=jk();return{writer:new Ny(e,t),out:new Vk(n)}}static createAppender(){const{encoder:e,iterator:t}=jk();return e.setRoots=()=>Promise.resolve(),{writer:new Ny([],e),out:new Vk(t)}}static updateRootsInBytes(e,t){return(0,B.Z)(function*(){const n=zk(e);yield CE(n);const s=Uk(t);if(Number(n.pos)!==s.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${n.pos} bytes, new header is ${s.length} bytes)`);return e.set(s,0),e})()}}class Vk{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}}function jk(){const r=function U4e(){const r=[];let e=null,t=Oy,n=!1,s=null,i=Oy;const o=()=>(e||(e=new Promise(u=>{t=()=>{e=null,t=Oy,u()}})),e),c={next:()=>(0,B.Z)(function*(){const u=r.shift();return u?(0===r.length&&t(),{done:!1,value:u}):n?(t(),{done:!0,value:void 0}):(s||(s=new Promise(f=>{i=()=>(s=null,i=Oy,f(c.next()))})),s)})()};return{writer:{write(u){r.push(u);const f=o();return i(),f},end:()=>(0,B.Z)(function*(){n=!0;const u=o();i(),yield u})()},iterator:c}}(),{writer:e,iterator:t}=r;return{encoder:k4e(e),iterator:t}}const $k=function(){var r=(0,B.Z)(function*({cid:e,load:t,seen:n}){n=n||new Set;const s=e.toString(Hs);if(n.has(s))return;const i=yield t(e);if(n.add(s),null!==i)for(const[,o]of i.links())yield $k({cid:o,load:t,seen:n})});return function(t){return r.apply(this,arguments)}}(),Kk=Be("ipfs:components:dag:import"),Y4e=[T6,ZC];function J4e(r,e,t,n){return function(){var s=(0,B.Z)(function*(i){const o=yield n.getCodec(i.code);if(!o)throw new Error(`Can't decode links in block with codec 0x${i.code.toString(16)} to form complete DAG`);const a=yield r.blocks.get(i,t);return Kk(`Adding block ${i} to car`),yield e.put({cid:i,bytes:a}),Y4e.includes(i.code)?null:function Ik({bytes:r,cid:e,value:t,codec:n}){const s=void 0!==t?t:n&&n.decode(r);if(void 0===s)throw new Error('Missing required argument, must either provide "value" or "codec"');return new pE({cid:e,bytes:r,value:s})}({bytes:a,cid:i,codec:o})});return function(i){return s.apply(this,arguments)}}()}function Ni(r){return BE.apply(this,arguments)}function BE(){return BE=(0,B.Z)(function*(r){var n,e=!1,t=!1;try{for(var i,s=be(r);e=!(i=yield s.next()).done;e=!1)return i.value}catch(o){t=!0,n=o}finally{try{e&&null!=s.return&&(yield s.return())}finally{if(t)throw n}}}),BE.apply(this,arguments)}class By extends class q4e{constructor(e,t,n){this._version=e,this._roots=t,this._iterable=n,this._decoded=!1}get version(){return this._version}getRoots(){var e=this;return(0,B.Z)(function*(){return e._roots})()}}{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static fromBytes(e){return(0,B.Z)(function*(){const{version:t,roots:n,iterator:s}=yield function Zk(r){return kE.apply(this,arguments)}(e);return new By(t,n,s)})()}static fromIterable(e){return(0,B.Z)(function*(){const{version:t,roots:n,iterator:s}=yield function Hk(r){return UE.apply(this,arguments)}(e);return new By(t,n,s)})()}}function kE(){return kE=(0,B.Z)(function*(r){if(!(r instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return Gk(zk(r))}),kE.apply(this,arguments)}function UE(){return UE=(0,B.Z)(function*(r){if(!r||"function"!=typeof r[Symbol.asyncIterator])throw new TypeError("fromIterable() requires an async iterable");return Gk(H4e(r))}),UE.apply(this,arguments)}function Gk(r){return ME.apply(this,arguments)}function ME(){return ME=(0,B.Z)(function*(r){const e=K4e(r),{version:t,roots:n}=yield e.header();return{version:t,roots:n,iterator:e.blocks()}}),ME.apply(this,arguments)}Symbol;const Wk=Be("ipfs:components:dag:import");function twe(r,e,t){return FE.apply(this,arguments)}function FE(){return FE=(0,B.Z)(function*(r,e,t){const n=yield By.fromIterable(t),s=yield n.getRoots();return yield Oi(r.blocks.putMany(os(n,({cid:i,bytes:o})=>(Wk(`Import block ${i}`),{key:i,value:o})),{signal:e.signal})),s}),FE.apply(this,arguments)}class swe{constructor({repo:e,codecs:t,hashers:n,preload:s}){this.export=function Q4e({repo:r,preload:e,codecs:t}){function s(){return(s=Ee(function*(i,o={}){!1!==o.preload&&e(i);const a=qe.asCID(i);if(!a)throw new Error(`Unexpected error converting CID type: ${i}`);Kk(`Exporting ${a} as car`);const{writer:c,out:u}=yield X(Ny.create([a]));let f=null;(0,B.Z)(function*(){try{const F=J4e(r,c,{signal:o.signal,timeout:o.timeout},t);yield $k({cid:a,load:F})}catch(F){f=F}finally{c.close()}})();var U,E=!1,T=!1;try{for(var P,b=be(u);E=!(P=yield X(b.next())).done;E=!1){const F=P.value;if(f)break;yield F}}catch(F){T=!0,U=F}finally{try{E&&null!=b.return&&(yield X(b.return()))}finally{if(T)throw U}}if(f)throw f})).apply(this,arguments)}return ze(function n(i){return s.apply(this,arguments)})}({repo:e,preload:s,codecs:t}),this.get=function X4e({codecs:r,repo:e,preload:t}){return ze(function(){var s=(0,B.Z)(function*(o,a={}){if(!1!==a.preload&&t(o),a.path){const T=a.localResolve?yield Ni(af(o,a.path,r,e,a)):yield Ys(af(o,a.path,r,e,a));if(!T)throw ee(new Error("Not found"),"ERR_NOT_FOUND");return T}const c=yield r.getCodec(o.code),u=yield e.blocks.get(o,a);return{value:c.decode(u),remainderPath:""}});return function i(o){return s.apply(this,arguments)}}())}({codecs:t,repo:e,preload:s}),this.import=function ewe({repo:r}){function t(){return(t=Ee(function*(n,s={}){const i=yield X(r.gcLock.readLock());try{const E={signal:s.signal,timeout:s.timeout},T=Gf(n),{value:U,done:b}=yield X(T.peek());if(b)return;let P;U&&T.push(U),P=U instanceof Uint8Array?[T]:T;var c,o=!1,a=!1;try{for(var f,u=be(P);o=!(f=yield X(u.next())).done;o=!1){const F=f.value,M=yield X(twe(r,E,F));if(!1!==s.pinRoots)for(const H of M){let $="";try{(yield X(r.blocks.has(H)))?(Wk(`Pinning root ${H}`),yield X(r.pins.pinRecursively(H))):$="blockstore: block not found"}catch(V){$=V.message}yield{root:{cid:H,pinErrorMsg:$}}}}}catch(F){a=!0,c=F}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}}finally{i()}})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}({repo:e}),this.resolve=function nwe({repo:r,codecs:e,preload:t}){function s(){return(s=(0,B.Z)(function*(i,o={}){const{cid:a}=of(i);return!1!==o.preload&&t(a),Gp(r,e,i,o)})).apply(this,arguments)}return ze(function n(i){return s.apply(this,arguments)})}({repo:e,codecs:t,preload:s}),this.put=function rwe({repo:r,codecs:e,hashers:t,preload:n}){function i(){return(i=(0,B.Z)(function*(o,a={}){const c=a.pin?yield r.gcLock.readLock():null;try{const u=yield e.getCodec(a.storeCodec||"dag-cbor");if(!u)throw new Error(`Unknown storeCodec ${a.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(a.inputCodec){if(!(o instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");const P=yield e.getCodec(a.inputCodec);if(!P)throw new Error(`Unknown inputCodec ${a.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);o=P.decode(o)}const f=null!=a.version?a.version:1,E=yield t.getHasher(a.hashAlg||"sha2-256");if(!E)throw new Error(`Unknown hash algorithm ${a.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);const T=u.encode(o),U=yield E.digest(T),b=qe.create(f,u.code,U);return yield r.blocks.put(b,T,{signal:a.signal}),a.pin&&(yield r.pins.pinRecursively(b)),!1!==a.preload&&n(b),b}finally{c&&c()}})).apply(this,arguments)}return ze(function s(o){return i.apply(this,arguments)})}({repo:e,codecs:t,hashers:n,preload:s})}}const Ly=(r,e)=>e,owe={ip4:Ly,ip6:(r,e,t,n)=>1===n.length&&"ip6"===n[0].protocol?e:`[${e}]`,tcp:(r,e,t,n,s)=>n.some(i=>["http","https","ws","wss"].includes(i.protocol))?`${r}:${e}`:((r,e,t,n)=>{if(null!=n&&!1===n.assumeHttp)return`tcp://${r}:${e}`;let s="tcp",i=`:${e}`;return"tcp"===t[t.length-1].protocol&&(s="443"===e?"https":"http",i="443"===e||"80"===e?"":i),`${s}://${r}${i}`})(r,e,n,s),udp:(r,e)=>`udp://${r}:${e}`,dnsaddr:Ly,dns4:Ly,dns6:Ly,ipfs:(r,e)=>`${r}/ipfs/${e}`,p2p:(r,e)=>`${r}/p2p/${e}`,http:r=>`http://${r}`,https:r=>`https://${r}`,ws:r=>`ws://${r}`,wss:r=>`wss://${r}`,"p2p-websocket-star":r=>`${r}/p2p-websocket-star`,"p2p-webrtc-star":r=>`${r}/p2p-webrtc-star`,"p2p-webrtc-direct":r=>`${r}/p2p-webrtc-direct`};function zE(r,e){const t=at(r),n=t.toString().split("/").slice(1);return t.tuples().map(s=>{var i,o;return{protocol:null!==(i=n.shift())&&void 0!==i?i:"",content:null!=s[1]&&null!==(o=n.shift())&&void 0!==o?o:""}}).reduce((s,i,o,a)=>{const c=owe[i.protocol];if(null==c)throw new Error(`Unsupported protocol ${i.protocol}`);return c(s,i.content,o,a,e)},"")}const cwe=Be("ipfs:preload"),uwe=new(an.default?an.default:an)({concurrency:4});function dwe(r,e={}){return cwe(r),uwe.add((0,B.Z)(function*(){const n=(yield Io.post(r,{signal:e.signal})).body.getReader();try{for(;;){const{done:s}=yield n.read();if(s)return}}finally{n.releaseLock()}}))}const Th=Be("ipfs:preload");const ky=Be("ipfs:mfs-preload");class pwe extends Error{constructor(e){super(e),this.name="TimeoutError"}}class ywe extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const Yk=r=>void 0===globalThis.DOMException?new ywe(r):new DOMException(r),Qk=r=>{const e=void 0===r.reason?Yk("This operation was aborted."):r.reason;return e instanceof Error?e:Yk(e)};function Jk(r,e){const{milliseconds:t,fallback:n,message:s,customTimers:i={setTimeout,clearTimeout}}=e;let o;const a=new Promise((c,u)=>{if("number"!=typeof t||1!==Math.sign(t))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t!==Number.POSITIVE_INFINITY){if(e.signal){const{signal:f}=e;f.aborted&&u(Qk(f)),f.addEventListener("abort",()=>{u(Qk(f))})}o=i.setTimeout.call(void 0,()=>{if(n){try{c(n())}catch(T){u(T)}return}const E=s instanceof Error?s:new pwe("string"==typeof s?s:`Promise timed out after ${t} milliseconds`);"function"==typeof r.cancel&&r.cancel(),u(E)},t),(0,B.Z)(function*(){try{c(yield r)}catch(f){u(f)}finally{i.clearTimeout.call(void 0,o)}})()}else c(r)});return a.clear=()=>{i.clearTimeout.call(void 0,o),o=void 0},a}const Xk="lock:worker:request-read",qk="lock:worker:release-read",eU="lock:master:grant-read",tU="lock:worker:request-write",rU="lock:worker:release-write",nU="lock:master:grant-write",Wa={},ou=r=>{r.addEventListener("message",e=>{ou.dispatchEvent("message",r,e)}),null!=r.port&&r.port.addEventListener("message",e=>{ou.dispatchEvent("message",r,e)})};ou.addEventListener=(r,e)=>{null==Wa[r]&&(Wa[r]=[]),Wa[r].push(e)},ou.removeEventListener=(r,e)=>{null!=Wa[r]&&(Wa[r]=Wa[r].filter(t=>t===e))},ou.dispatchEvent=function(r,e,t){null!=Wa[r]&&Wa[r].forEach(n=>n(e,t))};const sU=ou,iU=(r,e,t,n,s)=>(i,o)=>{if(o.data.type!==t)return;const a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};var c;r.dispatchEvent(new MessageEvent(e,{data:{name:a.name,handler:(c=(0,B.Z)(function*(){return i.postMessage({type:s,name:a.name,identifier:a.identifier}),yield new Promise(u=>{const f=E=>{null!=E&&null!=E.data&&E.data.type===n&&E.data.identifier===a.identifier&&(i.removeEventListener("message",f),u())};i.addEventListener("message",f)})}),function(){return c.apply(this,arguments)})}}))},oU=(r,e,t,n)=>(0,B.Z)(function*(){const s=((r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),""))();return globalThis.postMessage({type:e,identifier:s,name:r}),yield new Promise(i=>{const o=a=>{null!=a&&null!=a.data&&a.data.type===t&&a.data.identifier===s&&(globalThis.removeEventListener("message",o),i(()=>{globalThis.postMessage({type:n,identifier:s,name:r})}))};globalThis.addEventListener("message",o)})}),mwe={singleProcess:!1},$c={};let Ya;function VE(r,e){return jE.apply(this,arguments)}function jE(){return jE=(0,B.Z)(function*(r,e){let t;const n=new Promise(s=>{t=s});return r.add((0,B.Z)(function*(){return yield Jk((0,B.Z)(function*(){return yield new Promise(s=>{t(()=>{s()})})})(),{milliseconds:e.timeout})})),yield n}),jE.apply(this,arguments)}const Ewe={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function $E(r){const e=Object.assign({},Ewe,r);return null==Ya&&(Ya=(r=>{if(r=Object.assign({},mwe,r),Boolean(globalThis.document)||r.singleProcess){const t=new EventTarget;return sU.addEventListener("message",iU(t,"requestReadLock",Xk,qk,eU)),sU.addEventListener("message",iU(t,"requestWriteLock",tU,rU,nU)),t}return{isWorker:!0,readLock:t=>oU(t,Xk,eU,qk),writeLock:t=>oU(t,tU,nU,rU)}})(e),!0!==Ya.isWorker&&(Ya.addEventListener("requestReadLock",t=>{null!=$c[t.data.name]&&$c[t.data.name].readLock().then(function(){var n=(0,B.Z)(function*(s){return yield t.data.handler().finally(()=>s())});return function(s){return n.apply(this,arguments)}}())}),Ya.addEventListener("requestWriteLock",function(){var t=(0,B.Z)(function*(n){null!=$c[n.data.name]&&$c[n.data.name].writeLock().then(function(){var s=(0,B.Z)(function*(i){return yield n.data.handler().finally(()=>i())});return function(i){return s.apply(this,arguments)}}())});return function(n){return t.apply(this,arguments)}}()))),null==$c[e.name]&&($c[e.name]=((r,e)=>{if(!0===Ya.isWorker)return{readLock:Ya.readLock(r,e),writeLock:Ya.writeLock(r,e)};const t=new an({concurrency:1});let n;return{readLock:()=>(0,B.Z)(function*(){if(null!=n)return yield VE(n,e);n=new an({concurrency:e.concurrency,autoStart:!1});const s=n,i=VE(n,e);return t.add((0,B.Z)(function*(){return s.start(),yield s.onIdle().then(()=>{n===s&&(n=null)})})),yield i})(),writeLock:()=>(0,B.Z)(function*(){return n=null,yield VE(t,e)})()}})(e.name,e)),$c[e.name]}let Uy;function KE(r=!1){if(Uy)return Uy;const e=$E({singleProcess:r});return Uy={readLock:t=>(0,B.Z)(function*(...n){const s=yield e.readLock();try{return yield t.apply(null,n)}finally{s()}}),writeLock:t=>(0,B.Z)(function*(...n){const s=yield e.writeLock();try{return yield t.apply(null,n)}finally{s()}})},Uy}const aU=Be("ipfs:mfs:utils:with-mfs-root");function ZE(r,e){return HE.apply(this,arguments)}function HE(){return HE=(0,B.Z)(function*(r,e){if(e&&e.signal&&e.signal.aborted)throw ee(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});let t;yield r.repo.datastore.open();try{const n=yield r.repo.datastore.get(f5);t=qe.decode(n)}catch(n){if("ERR_NOT_FOUND"!==n.code)throw n;aU("Creating new MFS root");const s=ir({Data:new ur({type:"directory"}).marshal(),Links:[]}),i=yield ml.digest(s);if(t=qe.createV0(i),yield r.repo.blocks.put(t,s),e&&e.signal&&e.signal.aborted)throw ee(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});yield r.repo.datastore.put(f5,t.bytes)}return aU(`Loaded MFS root /ipfs/${t}`),t}),HE.apply(this,arguments)}function GE(r=""){return(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}const Ls=function(){var r=(0,B.Z)(function*(e,t,n){const s=yield ZE(e,n);let i={entryType:"file"},o="";if(o=qe.asCID(t)?`/ipfs/${t}`:t.toString(),o=o.trim(),o=o.replace(/(\/\/+)/g,"/"),o.endsWith("/")&&o.length>1&&(o=o.substring(0,o.length-1)),!o)throw ee(new Error("paths must not be empty"),"ERR_NO_PATH");if("/"!==o.substring(0,1))throw ee(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");"/"===o.substring(o.length-1)&&(o=o.substring(0,o.length-1));const a=GE(o);if("ipfs"===a[0]){let u;u=2===a.length?`/${a.join("/")}`:`/${a.slice(0,a.length-1).join("/")}`,i={type:"ipfs",depth:a.length-2,entryType:"file",mfsPath:`/${a.join("/")}`,mfsDirectory:u,parts:a,path:`/${a.join("/")}`,name:a[a.length-1]}}else{const u=`/ipfs/${s}${a.length?"/"+a.join("/"):""}`,f=`/ipfs/${s}/${a.slice(0,a.length-1).join("/")}`;i={type:"mfs",depth:a.length,entryType:"file",mfsDirectory:f,mfsPath:u,parts:a,path:`/${a.join("/")}`,name:a[a.length-1]}}const c="mfs"===i.type?i.mfsPath:i.path;try{const u=yield Lo(c,e.repo.blocks,n);i.cid=u.cid,i.mfsPath=`/ipfs/${u.path}`,i.entryType=u.type,i.content=u.content,("file"===i.entryType||"directory"===i.entryType)&&("file"===u.type||"directory"===u.type)&&(i.unixfs=u.unixfs)}catch(u){if("ERR_NOT_FOUND"!==u.code)throw u}return i.exists=Boolean(i.cid),i});return function(t,n,s){return r.apply(this,arguments)}}(),xwe=Sr.bind({ignoreUndefined:!0}),Swe=Be("ipfs:mfs:stat"),Awe={withLocal:!1};function My(r){function t(){return(t=(0,B.Z)(function*(n,s={}){s=xwe(Awe,s),Swe(`Fetching stats for ${n}`);const{type:i,cid:o,mfsPath:a}=yield Ls(r,n,s),c="ipfs"===i&&o?o:a;let u;try{u=yield Lo(c,r.repo.blocks)}catch(f){throw"ERR_NOT_FOUND"===f.code?ee(new Error(`${n} does not exist`),"ERR_NOT_FOUND"):f}if(!cU[u.type])throw new Error(`Cannot stat codec ${u.cid.code}`);return cU[u.type](u)})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}const cU={raw:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:r=>{const e={cid:r.cid,type:"file",size:r.unixfs.fileSize(),cumulativeSize:ir(r.node).length+(r.node.Links||[]).reduce((t,n)=>t+(n.Tsize||0),0),blocks:r.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:r.unixfs.mode};return r.unixfs.mtime&&(e.mtime=r.unixfs.mtime),e},directory:r=>{const e={cid:r.cid,type:"directory",size:0,cumulativeSize:ir(r.node).length+(r.node.Links||[]).reduce((t,n)=>t+(n.Tsize||0),0),blocks:r.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:r.unixfs.mode};return r.unixfs.mtime&&(e.mtime=r.unixfs.mtime),e},object:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})},Twe=Be("ipfs:mfs:utils:to-trail");function Ch(r,e){return YE.apply(this,arguments)}function YE(){return YE=(0,B.Z)(function*(r,e){Twe(`Creating trail for path ${e}`);const t=[];var i,n=!1,s=!1;try{for(var a,o=be(PB(e,r.repo.blocks));n=!(a=yield o.next()).done;n=!1){const c=a.value;t.push({name:c.name,cid:c.cid,size:c.size,type:c.type})}}catch(c){s=!0,i=c}finally{try{n&&null!=o.return&&(yield o.return())}finally{if(s)throw i}}return t}),YE.apply(this,arguments)}const lU=function(){var r=(0,B.Z)(function*(e,t,n){n.codec||(n.codec=w),n.hasher||(n.hasher=ml),void 0===n.cidVersion&&(n.cidVersion=1),n.codec===w&&n.hasher!==ml&&(n.cidVersion=1);const s=yield n.hasher.digest(e),i=qe.create(n.cidVersion,n.codec.code,s);return n.onlyHash||(yield t.put(i,e,{signal:n.signal})),i});return function(t,n,s){return r.apply(this,arguments)}}(),uU=Z1.code;function fU(r){return QE.apply(this,arguments)}function QE(){return QE=(0,B.Z)(function*(r){return(yield Z1.encode(r)).subarray(0,8).reverse()}),QE.apply(this,arguments)}class hU extends class Cwe{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}put(e,t){return(0,B.Z)(function*(){})()}get(e){return Promise.resolve(this)}eachChildSeries(){return Ee(function*(){})()}flush(e){return Ee(function*(){})()}}{constructor(e,t){super(e,t),this._bucket=Y1({hashFn:fU,bits:8})}put(e,t){var n=this;return(0,B.Z)(function*(){yield n._bucket.put(e,t)})()}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}eachChildSeries(){var e=this;return Ee(function*(){var s,t=!1,n=!1;try{for(var o,i=be(e._bucket.eachLeafSeries());t=!(o=yield X(i.next())).done;t=!1){const{key:a,value:c}=o.value;yield{key:a,child:c}}}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield X(i.return()))}finally{if(n)throw s}}})()}flush(e){var t=this;return Ee(function*(){yield*Fe(be(pU(t._bucket,e,t,t.options)),X)})()}}function pU(r,e,t,n){return JE.apply(this,arguments)}function JE(){return JE=Ee(function*(r,e,t,n){const s=r._children,i=[];let o=0;for(let Y=0;Y<s.length;Y++){const q=s.get(Y);if(!q)continue;const ge=Y.toString(16).toUpperCase().padStart(2,"0");if(q instanceof ls){let Ce;var u,a=!1,c=!1;try{for(var E,f=be(yield X(pU(q,e,null,n)));a=!(E=yield X(f.next())).done;a=!1)Ce=E.value}catch(De){c=!0,u=De}finally{try{a&&null!=f.return&&(yield X(f.return()))}finally{if(c)throw u}}if(!Ce)throw new Error("Could not flush sharded directory, no subshard found");i.push({Name:ge,Tsize:Ce.size,Hash:Ce.cid}),o+=Ce.size}else if("function"==typeof q.value.flush){const Ce=q.value;let De;var b,T=!1,U=!1;try{for(var F,P=be(Ce.flush(e));T=!(F=yield X(P.next())).done;T=!1)De=F.value,yield De}catch(Xe){U=!0,b=Xe}finally{try{T&&null!=P.return&&(yield X(P.return()))}finally{if(U)throw b}}i.push({Name:ge+q.key,Tsize:De.size,Hash:De.cid}),o+=De.size}else{const Ce=q.value;if(!Ce.cid)continue;const Je=Ce.size;i.push({Name:ge+q.key,Tsize:Je,Hash:Ce.cid}),o+=Je}}const M=Uint8Array.from(s.bitField().reverse()),$={Data:new ur({type:"hamt-sharded-directory",data:M,fanout:r.tableSize(),hashType:uU,mtime:t&&t.mtime,mode:t&&t.mode}).marshal(),Links:i},V=ir(Ki($)),W=yield X(lU(V,e,n)),ne=V.length+o;yield{cid:W,node:$,size:ne}}),JE.apply(this,arguments)}const Ih=Be("ipfs:mfs:core:utils:hamt-utils"),Fy=function(){var r=(0,B.Z)(function*(e,t,n,s){if(!s.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");const i=Uint8Array.from(n._children.bitField().reverse()),o=ur.unmarshal(s.parent.Data),a=new ur({type:"hamt-sharded-directory",data:i,fanout:n.tableSize(),hashType:uU,mode:o.mode,mtime:o.mtime}),c=yield e.hashers.getHasher(s.hashAlg),u={Data:a.marshal(),Links:t.sort((U,b)=>(U.Name||"").localeCompare(b.Name||""))},f=ir(u),E=yield c.digest(f),T=qe.create(s.cidVersion,gr,E);return s.flush&&(yield e.repo.blocks.put(T,f)),{node:u,cid:T,size:t.reduce((U,b)=>U+(b.Tsize||0),f.length)}});return function(t,n,s,i){return r.apply(this,arguments)}}(),yU=function(){var r=(0,B.Z)(function*(e,t,n,s,i){const o=new ls({hash:n._options.hash,bits:n._options.bits},s,i);return s._putObjectAt(i,o),yield zy(e,t,o,n),o});return function(t,n,s,i,o){return r.apply(this,arguments)}}(),gU=function(){var r=(0,B.Z)(function*(e){const t=Y1({hashFn:fU,bits:8});return yield Promise.all(e.map(function(){var n=(0,B.Z)(function*(s){const i=s.Name||"";if(2===i.length){const o=parseInt(i,16),a=new ls({hash:t._options.hash,bits:t._options.bits},t,o);return t._putObjectAt(o,a),Promise.resolve()}return t.put(i.substring(2),{size:s.Tsize,cid:s.Hash})});return function(s){return n.apply(this,arguments)}}())),t});return function(t){return r.apply(this,arguments)}}(),zy=function(){var r=(0,B.Z)(function*(e,t,n,s){yield Promise.all(t.map(function(){var i=(0,B.Z)(function*(o){const a=o.Name||"";if(2===a.length){Ih("Populating sub bucket",a);const c=parseInt(a,16),f=Vr(yield e.repo.blocks.get(o.Hash)),E=new ls({hash:s._options.hash,bits:s._options.bits},n,c);return n._putObjectAt(c,E),yield zy(e,f.Links,E,s),Promise.resolve()}return s.put(a.substring(2),{size:o.Tsize,cid:o.Hash})});return function(o){return i.apply(this,arguments)}}()))});return function(t,n,s,i){return r.apply(this,arguments)}}(),au=r=>r.toString(16).toUpperCase().padStart(2,"0").substring(0,2),Iwe=function(){var r=(0,B.Z)(function*(e,t,n){const s=yield gU(n.Links),i=yield s._findNewBucketAndPos(t),o=[{bucket:i.bucket,prefix:au(i.pos)}];let a=i.bucket;for(;a!==s;)o.push({bucket:a,prefix:au(a._posAtParent)}),a=a._parent;o.reverse(),o[0].node=n;for(let c=0;c<o.length;c++){const u=o[c];if(!u.node)throw new Error("Could not generate HAMT path");const f=u.node.Links.filter(b=>(b.Name||"").substring(0,2)===u.prefix).pop();if(!f){Ih(`Link ${u.prefix}${t} will be added`);continue}if(f.Name===`${u.prefix}${t}`){Ih(`Link ${u.prefix}${t} will be replaced`);continue}Ih(`Found subshard ${u.prefix}`);const T=Vr(yield e.repo.blocks.get(f.Hash));if(!o[c+1]){Ih(`Loaded new subshard ${u.prefix}`),yield yU(e,T.Links,s,u.bucket,parseInt(u.prefix,16));const b=yield s._findNewBucketAndPos(t);o.push({bucket:b.bucket,prefix:au(b.pos),node:T});continue}const U=o[c+1];yield zy(e,T.Links,U.bucket,s),U.node=T}return yield s.put(t,!0),o.reverse(),{rootBucket:s,path:o}});return function(t,n,s){return r.apply(this,arguments)}}(),Rwe=function(){var r=(0,B.Z)(function*(e,t,n={}){const s=new hU({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:n.mtime,mode:n.mode},n);for(let o=0;o<t.length;o++)yield s._bucket.put(t[o].name,{size:t[o].size,cid:t[o].cid});const i=yield Ys(s.flush(e.repo.blocks));if(!i)throw new Error("Flushing shard yielded no result");return i});return function(t,n){return r.apply(this,arguments)}}(),ro=Be("ipfs:mfs:core:utils:add-link");function cu(r,e){return XE.apply(this,arguments)}function XE(){return XE=(0,B.Z)(function*(r,e){let t=e.parent;if(e.parentCid){const s=qe.asCID(e.parentCid);if(null===s)throw ee(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(s.code!==gr)throw ee(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");ro(`Loading parent node ${s}`),t=Vr(yield r.repo.blocks.get(s))}if(!t)throw ee(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!e.cid)throw ee(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!e.name)throw ee(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!e.size&&0!==e.size)throw ee(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!t.Data)throw ee(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");const n=ur.unmarshal(t.Data);return"hamt-sharded-directory"===n.type?(ro("Adding link to sharded directory"),Pwe(r,{...e,parent:t})):t.Links.length>=e.shardSplitThreshold?(ro("Converting directory to sharded directory"),Dwe(r,{...e,parent:t,mtime:n.mtime,mode:n.mode})):(ro(`Adding ${e.name} (${e.cid}) to regular directory`),Owe(r,{...e,parent:t}))}),XE.apply(this,arguments)}const Dwe=function(){var r=(0,B.Z)(function*(e,t){const n=yield Rwe(e,t.parent.Links.map(s=>({name:s.Name||"",size:s.Tsize||0,cid:s.Hash})).concat({name:t.name,size:t.size,cid:t.cid}),t);return ro(`Converted directory to sharded directory ${n.cid}`),n});return function(t,n){return r.apply(this,arguments)}}(),Owe=function(){var r=(0,B.Z)(function*(e,t){const n=t.parent.Links.filter(f=>f.Name!==t.name);if(n.push({Name:t.name,Tsize:t.size,Hash:t.cid}),!t.parent.Data)throw ee(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");const s=ur.unmarshal(t.parent.Data);let i;if(s.mtime){const f=Date.now(),E=Math.floor(f/1e3);s.mtime={secs:E,nsecs:1e3*(f-1e3*E)},i=s.marshal()}else i=t.parent.Data;t.parent=Ki({Data:i,Links:n});const o=yield e.hashers.getHasher(t.hashAlg),a=ir(t.parent),c=yield o.digest(a),u=qe.create(t.cidVersion,gr,c);return t.flush&&(yield e.repo.blocks.put(u,a)),{node:t.parent,cid:u,size:a.length}});return function(t,n){return r.apply(this,arguments)}}(),Pwe=function(){var r=(0,B.Z)(function*(e,t){const{shard:n,path:s}=yield Nwe(e,t),i=yield Ys(n.flush(e.repo.blocks));if(!i)throw new Error("No result from flushing shard");const a=Vr(yield e.repo.blocks.get(i.cid)),c=t.parent.Links.filter(f=>(f.Name||"").substring(0,2)!==s[0].prefix),u=a.Links.find(f=>(f.Name||"").substring(0,2)===s[0].prefix);if(!u)throw new Error(`No link found with prefix ${s[0].prefix}`);return c.push(u),Fy(e,c,s[0].bucket,t)});return function(t,n){return r.apply(this,arguments)}}(),Nwe=function(){var r=(0,B.Z)(function*(e,t){const n={name:t.name,cid:t.cid,size:t.size};if(!t.parent.Data)throw ee(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");const s=yield gU(t.parent.Links),i=ur.unmarshal(t.parent.Data),o=new hU({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:i.mode},t);o._bucket=s,i.mtime&&(o.mtime={secs:Math.round(Date.now()/1e3)});const a=yield s._findNewBucketAndPos(n.name),c=Bwe(a);c[0].node=t.parent;let u=0;for(;u<c.length;){const f=c[u];u++;const E=f.node;if(!E)throw new Error("Segment had no node");const T=E.Links.find(F=>(F.Name||"").substring(0,2)===f.prefix);if(!T){ro(`Link ${f.prefix}${n.name} will be added`),u=c.length;break}if(T.Name===`${f.prefix}${n.name}`){ro(`Link ${f.prefix}${n.name} will be replaced`),u=c.length;break}if((T.Name||"").length>2){ro(`Link ${T.Name} ${T.Hash} will be replaced with a subshard`),u=c.length;break}ro(`Found subshard ${f.prefix}`);const b=Vr(yield e.repo.blocks.get(T.Hash));if(!c[u]){ro(`Loaded new subshard ${f.prefix}`),yield yU(e,b.Links,s,f.bucket,parseInt(f.prefix,16));const F=yield s._findNewBucketAndPos(n.name);c.push({bucket:F.bucket,prefix:au(F.pos),node:b});break}const P=c[u];yield zy(e,b.Links,P.bucket,s),P.node=b}return yield o._bucket.put(n.name,{size:n.size,cid:n.cid}),{shard:o,path:c}});return function(t,n){return r.apply(this,arguments)}}(),Bwe=r=>{const e=[{bucket:r.bucket,prefix:au(r.pos)}];let t=r.bucket._parent,n=r.bucket._posAtParent;for(;t;)e.push({bucket:t,prefix:au(n)}),n=t._posAtParent,t=t._parent;return e.reverse(),e},bU=Be("ipfs:mfs:utils:update-tree"),Lwe={shardSplitThreshold:1e3};function Kc(r,e,t){return qE.apply(this,arguments)}function qE(){return qE=(0,B.Z)(function*(r,e,t){t=Object.assign({},Lwe,t),bU("Trail",e),e=e.slice().reverse();let s,n=0;var a,i=!1,o=!1;try{for(var u,c=be(r.repo.blocks.getMany(e.map(E=>E.cid)));i=!(u=yield c.next()).done;i=!1){const E=u.value,T=Vr(E),U=e[n].cid,b=e[n].name;if(n++,!s){s={cid:U,name:b,size:E.length};continue}const P=yield cu(r,{parent:T,name:s.name,cid:s.cid,size:s.size,flush:t.flush,shardSplitThreshold:t.shardSplitThreshold,hashAlg:t.hashAlg,cidVersion:t.cidVersion});s={cid:P.cid,name:b,size:P.size}}}catch(E){o=!0,a=E}finally{try{i&&null!=c.return&&(yield c.return())}finally{if(o)throw a}}const{cid:f}=s;return bU(`Final CID ${f}`),f}),qE.apply(this,arguments)}const kwe=Be("ipfs:mfs:utils:update-mfs-root");function Zc(r,e,t){return e7.apply(this,arguments)}function e7(){return e7=(0,B.Z)(function*(r,e,t){if(t&&t.signal&&t.signal.aborted)throw ee(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return kwe(`New MFS root will be ${e}`),yield r.repo.datastore.put(f5,e.bytes),e}),e7.apply(this,arguments)}function Uwe(r,e,t){return t7.apply(this,arguments)}function t7(){return t7=(0,B.Z)(function*(r,e,t){const n=new ur({type:e,mode:t.mode,mtime:t.mtime}),s=yield r.hashers.getHasher(t.hashAlg),i={Data:n.marshal(),Links:[]},o=ir(i),a=yield s.digest(o),c=qe.create(t.cidVersion,gr,a);return t.flush&&(yield r.repo.blocks.put(c,o)),{cid:c,node:i}}),t7.apply(this,arguments)}const Mwe=Sr.bind({ignoreUndefined:!0}),_U=Be("ipfs:mfs:mkdir"),Fwe={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};function Vy(r){function t(){return(t=(0,B.Z)(function*(n,s={}){const i=Mwe(Fwe,s);if(!n)throw new Error("no path given to Mkdir");if("/"===(n=n.trim())){if(i.parents)return;throw ee(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if("/"!==n.substring(0,1))throw ee(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");_U(`Creating ${n}`);const o=GE(n);if("ipfs"===o[0])throw ee(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");const a=yield ZE(r,i);let c;const u=[],f=yield Uwe(r,"directory",i);for(let T=0;T<=o.length;T++){const U=o.slice(0,T),b=`/ipfs/${a}/${U.join("/")}`;try{if(c=yield Lo(b,r.repo.blocks),"file"!==c.type&&"directory"!==c.type)throw ee(new Error(`${n} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(T===o.length){if(i.parents)return;throw ee(new Error("file already exists"),"ERR_ALREADY_EXISTS")}u.push({name:c.name,cid:c.cid})}catch(P){if("ERR_NOT_FOUND"!==P.code)throw P;if(T<o.length&&!i.parents)throw ee(new Error(`Intermediate directory path ${b} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");yield zwe(r,U[U.length-1],f,u[u.length-1],u,i)}}const E=yield Kc(r,u,i);yield Zc(r,E,i)})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}const zwe=function(){var r=(0,B.Z)(function*(e,t,n,s,i,o){_U(`Adding empty dir called ${t} to ${s.cid}`);const a=yield cu(e,{parent:s.node,parentCid:s.cid,size:0,cid:n.cid,name:t,hashAlg:o.hashAlg,cidVersion:o.cidVersion,flush:o.flush,shardSplitThreshold:o.shardSplitThreshold});i[i.length-1].cid=a.cid,i.push({name:t,cid:n.cid})});return function(t,n,s,i,o,a){return r.apply(this,arguments)}}(),Vwe=Sr.bind({ignoreUndefined:!0}),jy=Be("ipfs:mfs:cp"),jwe={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};function r7(r){function t(){return(t=(0,B.Z)(function*(n,s,i={}){const o=Vwe(jwe,i);Array.isArray(n)||(n=[n]);const a=yield Promise.all(n.map(U=>Ls(r,U,o)));let c=yield Ls(r,s,o);if(!a.length||!c)throw ee(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");const u=a.find(U=>!U.exists);if(u)throw ee(new Error(`${u.path} does not exist`),"ERR_INVALID_PARAMS");const f=mU(c);if(c.exists){if(jy("Destination exists"),1===a.length&&!f)throw ee(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(jy("Destination does not exist"),a.length>1){if(!o.parents)throw ee(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");yield Vy(r)(c.path,o),c=yield Ls(r,c.path,o)}else if(c.parts.length>1){const U=`/${c.parts.slice(0,-1).join("/")}`;try{yield My(r)(U,o)}catch(b){if("ERR_NOT_FOUND"!==b.code)throw b;if(!o.parents)throw ee(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");yield Vy(r)(U,o),c=yield Ls(r,c.path,o)}}const E=mU(c)?c.mfsPath:c.mfsDirectory,T=yield Ch(r,E);if(1===a.length){const U=a.pop();if(!U)throw ee(new Error("could not find source"),"ERR_INVALID_PARAMS");const b=f?U.name:c.name;return jy(`Only one source, copying to destination ${f?"directory":"file"} ${b}`),$we(r,U,b,T,o)}return jy("Multiple sources, wrapping in a directory"),Kwe(r,a,c,T,o)})).apply(this,arguments)}return ze(function e(n,s){return t.apply(this,arguments)})}const mU=r=>r.unixfs&&r.unixfs.type&&r.unixfs.type.includes("directory"),$we=function(){var r=(0,B.Z)(function*(e,t,n,s,i){let o=s.pop();if(!o)throw ee(new Error("destination had no parent"),"ERR_INVALID_PARAMS");o=yield vU(e,t,n,o,i),s.push(o);const a=yield Kc(e,s,i);yield Zc(e,a,i)});return function(t,n,s,i,o){return r.apply(this,arguments)}}(),Kwe=function(){var r=(0,B.Z)(function*(e,t,n,s,i){for(let a=0;a<t.length;a++){const c=t[a];n=yield vU(e,c,c.name,n,i)}s[s.length-1]=n;const o=yield Kc(e,s,i);yield Zc(e,o,i)});return function(t,n,s,i,o){return r.apply(this,arguments)}}(),vU=function(){var r=(0,B.Z)(function*(e,t,n,s,i){const o=yield e.repo.blocks.get(t.cid),{node:a,cid:c,size:u}=yield cu(e,{parentCid:s.cid,size:o.length,cid:t.cid,name:n,hashAlg:i.hashAlg,cidVersion:i.cidVersion,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold});return s.node=a,s.cid=c,s.size=u,s});return function(t,n,s,i,o){return r.apply(this,arguments)}}(),Qa=Be("ipfs:mfs:core:utils:remove-link");function n7(){return n7=(0,B.Z)(function*(r,e){let t=e.parent;if(e.parentCid){const s=qe.asCID(e.parentCid);if(null===s)throw ee(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");Qa(`Loading parent node ${s}`),t=Vr(yield r.repo.blocks.get(s))}if(!t)throw ee(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!e.name)throw ee(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!t.Data)throw ee(new Error("Parent node had no data"),"ERR_INVALID_NODE");return"hamt-sharded-directory"===ur.unmarshal(t.Data).type?(Qa(`Removing ${e.name} from sharded directory`),Gwe(r,{...e,parent:t})):(Qa(`Removing link ${e.name} regular directory`),Hwe(r,{...e,parent:t}))}),n7.apply(this,arguments)}const Hwe=function(){var r=(0,B.Z)(function*(e,t){t.parent.Links=t.parent.Links.filter(a=>a.Name!==t.name);const n=yield ir(t.parent),i=yield(yield e.hashers.getHasher(t.hashAlg)).digest(n),o=qe.create(t.cidVersion,gr,i);return yield e.repo.blocks.put(o,n),Qa(`Updated regular directory ${o}`),{node:t.parent,cid:o}});return function(t,n){return r.apply(this,arguments)}}(),Gwe=function(){var r=(0,B.Z)(function*(e,t){const{rootBucket:n,path:s}=yield Iwe(e,t.name,t.parent);yield n.del(t.name);const{node:i}=yield wU(e,s,t.name,t);return Fy(e,i.Links,n,t)});return function(t,n){return r.apply(this,arguments)}}(),wU=function(){var r=(0,B.Z)(function*(e,t,n,s){const i=t.pop();if(!i)throw ee(new Error("Could not find parent"),"EINVALIDPARENT");const{bucket:o,prefix:a,node:c}=i;if(!c)throw ee(new Error("Could not find parent"),"EINVALIDPARENT");const u=c.Links.find(b=>(b.Name||"").substring(0,2)===a);if(!u)throw ee(new Error(`No link found with prefix ${a} for file ${n}`),"ERR_NOT_FOUND");if(u.Name===`${a}${n}`){Qa(`Removing existing link ${u.Name}`);const b=c.Links.filter(P=>P.Name!==u.Name);return yield o.del(n),Fy(e,b,o,s)}Qa(`Descending into sub-shard ${u.Name} for ${a}${n}`);const f=yield wU(e,t,n,s);let E=f.cid,T=f.size,U=a;if(1===f.node.Links.length){Qa(`Removing subshard for ${a}`);const b=f.node.Links[0];U=`${a}${(b.Name||"").substring(2)}`,E=b.Hash,T=b.Tsize||0}return Qa(`Updating shard ${a} with name ${U}`),Wwe(e,o,c,a,U,T,E,s)});return function(t,n,s,i){return r.apply(this,arguments)}}(),Wwe=(r,e,t,n,s,i,o,a)=>{const c=t.Links.filter(u=>u.Name!==n);return c.push({Name:s,Tsize:i,Hash:o}),Fy(r,c,e,a)},Ywe=Sr.bind({ignoreUndefined:!0}),Qwe={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};function s7(r){function t(){return(t=(0,B.Z)(function*(n,s={}){const i=Ywe(Qwe,s);Array.isArray(n)||(n=[n]);const o=yield Promise.all(n.map(a=>Ls(r,a,i)));if(!o.length)throw ee(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");o.forEach(a=>{if("/"===a.path)throw ee(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(const a of o)yield Jwe(r,a.path,i)})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}const Jwe=function(){var r=(0,B.Z)(function*(e,t,n){const s=yield Ls(e,t,n),i=yield Ch(e,s.mfsPath),o=i[i.length-1];i.pop();const a=i[i.length-1];if(!a)throw ee(new Error(`${t} does not exist`),"ERR_NOT_FOUND");if("directory"===o.type&&!n.recursive)throw ee(new Error(`${t} is a directory, use -r to remove directories`),"ERR_WAS_DIR");const{cid:c}=yield function Zwe(r,e){return n7.apply(this,arguments)}(e,{parentCid:a.cid,name:o.name,hashAlg:n.hashAlg,cidVersion:n.cidVersion,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold});a.cid=c;const u=yield Kc(e,i,n);yield Zc(e,u,n)});return function(t,n,s){return r.apply(this,arguments)}}(),Xwe=Sr.bind({ignoreUndefined:!0}),qwe=Be("ipfs:mfs:touch"),EU={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function xU(r,e){if(r instanceof String||"string"==typeof r){const t=`${r}`;r=t.match(/^\d+$/g)?parseInt(t,8):0+t.split(",").reduce((n,s)=>function nEe(r,e,t){e||(e=0);const n=r.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!n)throw new Error(`Invalid file mode: ${r}`);let[,s,i,o]=n;("a"===s||!s)&&(s="ugo");let a=function eEe(r,e,t){let n=0;return(r.includes("x")||r.includes("X")&&(t||1&e||8&e||64&e))&&(n+=1),r.includes("w")&&(n+=2),r.includes("r")&&(n+=4),n}(o,e,t);return a=function tEe(r,e){let t=0;return r.includes("u")&&(t+=e<<6),r.includes("g")&&(t+=e<<3),r.includes("o")&&(t+=e),t}(s,a),a=function rEe(r,e,t){return e.includes("t")&&(t+=parseInt("1000",8)),e.includes("s")&&(r.includes("u")&&(t+=parseInt("4000",8)),r.includes("g")&&(t+=parseInt("2000",8))),t}(s,o,a),"="===i?(s.includes("u")&&(e&=parseInt("7077",8),e|=a),s.includes("g")&&(e&=parseInt("7707",8),e|=a),s.includes("o")&&(e&=parseInt("7770",8),e|=a),e):"+"===i?a|e:"-"===i?a^e:e}(s,n,e.isDirectory()),e.mode||0)}return r}const iEe=Sr.bind({ignoreUndefined:!0}),oEe={},cEe=Sr.bind({ignoreUndefined:!0}),lEe={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3},dEe=Sr.bind({ignoreUndefined:!0}),fEe=Be("ipfs:mfs:touch"),SU={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"},pEe=Sr.bind({ignoreUndefined:!0}),yEe={offset:0,length:1/0};var i7=p(40146);const Rh=Be("ipfs:mfs:utils:to-async-iterator");function bEe(r){if(!r)throw ee(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if(("string"==typeof r||r instanceof String)&&(Rh("Content was a string"),r=va(r.toString())),r.length)return Rh("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield r}};if(r[Symbol.asyncIterator])return Rh("Content was an async iterator"),r;if(r[Symbol.iterator])return Rh("Content was an iterator"),r;if(i7.Blob&&r instanceof i7.Blob){Rh("Content was an HTML5 Blob");let e=0;const t={next:()=>e>r.size?{done:!0}:new Promise((n,s)=>{const i=r.slice(e,h5);e+=h5;const o=new i7.FileReader,a=c=>{if(o.removeEventListener("loadend",a,!1),c.error)return s(c.error);n({done:!1,value:new Uint8Array(o.result)})};o.addEventListener("loadend",a),o.readAsArrayBuffer(i)})};return{[Symbol.asyncIterator]:()=>t}}throw ee(new Error(`Don't know how to convert ${r} into an async iterator`),"ERR_INVALID_PARAMS")}const _Ee=Sr.bind({ignoreUndefined:!0}),no=Be("ipfs:mfs:write"),mEe={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(r,e)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3},wEe=function(){var r=(0,B.Z)(function*(e,t,n,s,i){const o=yield EEe(e,n,s,i);yield KE().writeLock((0,B.Z)(function*(){const a=GE(t),c=a.pop();if(null==c)throw ee(new Error("source does not exist"),"ERR_NO_EXIST");let u=!1;try{yield My(e)(`/${a.join("/")}`,i),u=!0}catch(M){if("ERR_NOT_FOUND"!==M.code)throw M}u||(yield Vy(e)(`/${a.join("/")}`,i));const f=yield Ls(e,t,i),E=yield Ch(e,f.mfsDirectory),T=E[E.length-1];if(!T)throw ee(new Error("directory does not exist"),"ERR_NO_EXIST");if(!T.type||!T.type.includes("directory"))throw ee(new Error(`cannot write to ${T.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");const b=Vr(yield e.repo.blocks.get(T.cid)),P=yield cu(e,{parent:b,name:c,cid:o.cid,size:o.size,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold,hashAlg:i.hashAlg,cidVersion:i.cidVersion});T.cid=P.cid;const F=yield Kc(e,E,i);yield Zc(e,F,i)}))()});return function(t,n,s,i,o){return r.apply(this,arguments)}}(),EEe=function(){var r=(0,B.Z)(function*(e,t,n,s){no(n.exists?`Overwriting file ${n.cid} offset ${s.offset} length ${s.length}`:`Writing file offset ${s.offset} length ${s.length}`);const i=[];if(s.offset>0)if(n.unixfs){if(no(`Writing first ${s.offset} bytes of original file`),i.push(()=>n.content({offset:0,length:s.offset})),n.unixfs.fileSize()<s.offset){const E=s.offset-n.unixfs.fileSize();no(`Writing zeros for extra ${E} bytes`),i.push(TU(E))}}else no(`Writing zeros for first ${s.offset} bytes`),i.push(TU(s.offset));i.push(AU(t,s.length));const o=SEe(xEe(i),E=>{if(n.unixfs&&!s.truncate){const T=n.unixfs.fileSize();if(T>E)return no(`Writing last ${T-E} of ${T} bytes from original file starting at offset ${E}`),n.content({offset:E});no("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:Ee(function*(){})}});let a,c;null!=s.mode?a=dl(s.mode):n&&n.unixfs&&(a=n.unixfs.mode),null!=s.mtime?c=Cd(s.mtime):n&&n.unixfs&&(c=n.unixfs.mtime);const u=yield e.hashers.getHasher(s.hashAlg),f=yield Ys(yw([{content:o,mode:a,mtime:c}],e.repo.blocks,{progress:s.progress,hasher:u,cidVersion:s.cidVersion,strategy:s.strategy,rawLeaves:s.rawLeaves,reduceSingleLeafToSelf:s.reduceSingleLeafToSelf,leafType:s.leafType}));if(!f)throw ee(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return no(`Wrote ${f.cid}`),{cid:f.cid,size:f.size}});return function(t,n,s,i){return r.apply(this,arguments)}}(),AU=(r,e)=>function(){var t=Ee(function*(){let s=0;var a,i=!1,o=!1;try{for(var u,c=be(r);i=!(u=yield X(c.next())).done;i=!1){const f=u.value;if(s+=f.length,s>e)return void(yield f.subarray(0,e-s));yield f}}catch(f){o=!0,a=f}finally{try{i&&null!=c.return&&(yield X(c.return()))}finally{if(o)throw a}}});return function n(){return t.apply(this,arguments)}}(),TU=(r,e=h5)=>{const t=new Uint8Array(e);function s(){return(s=Ee(function*(){for(;;)yield t})).apply(this,arguments)}return AU(function n(){return s.apply(this,arguments)}(),r)},xEe=function(){var r=Ee(function*(e){for(let t=0;t<e.length;t++)yield*Fe(be(e[t]()),X)});return function(t){return r.apply(this,arguments)}}(),SEe=function(){var r=Ee(function*(e,t){let n=0;var o,s=!1,i=!1;try{for(var c,a=be(e);s=!(c=yield X(a.next())).done;s=!1){const b=c.value;n+=b.length,yield b}}catch(b){i=!0,o=b}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}var E,u=!1,f=!1;try{for(var U,T=be(t(n));u=!(U=yield X(T.next())).done;u=!1){const b=U.value;n+=b.length,yield b}}catch(b){f=!0,E=b}finally{try{u&&null!=T.return&&(yield X(T.return()))}finally{if(f)throw E}}});return function(t,n){return r.apply(this,arguments)}}(),CU=r=>{const e={cid:r.cid,name:r.name,type:"directory"===r.type?"directory":"file",size:r.size};return("file"===r.type||"directory"===r.type)&&(e.mode=r.unixfs.mode,e.mtime=r.unixfs.mtime),e},TEe={stat:My},CEe={chmod:function sEe(r){function t(){return t=(0,B.Z)(function*(n,s,i={}){const o=Xwe(EU,i);qwe(`Fetching stats for ${n}`);const{cid:a,mfsDirectory:c,name:u}=yield Ls(r,n,o);if(a.code!==gr)throw ee(new Error(`${n} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(o.recursive){const ge=yield _t(Ee(function*(){var Je,Ce=!1,De=!1;try{for(var gt,Xe=be(NB(a,r.repo.blocks));Ce=!(gt=yield X(Xe.next())).done;Ce=!1){const Pr=gt.value;if("file"!==Pr.type&&"directory"!==Pr.type)throw ee(new Error(`${n} was not a UnixFS node`),"ERR_NOT_UNIXFS");Pr.unixfs.mode=xU(s,Pr.unixfs);const ti=Ki({Data:Pr.unixfs.marshal(),Links:Pr.node.Links});yield{path:Pr.path,content:ti}}}catch(Pr){De=!0,Je=Pr}finally{try{Ce&&null!=Xe.return&&(yield X(Xe.return()))}finally{if(De)throw Je}}}),Ce=>{return yw(Ce,r.repo.blocks,{...o,pin:!1,dagBuilder:(De=Ee(function*(Je,Xe,gt){var cl,Pr=!1,ti=!1;try{for(var nG,bT=be(Je);Pr=!(nG=yield X(bT.next())).done;Pr=!1){const tb=nG.value;yield(0,B.Z)(function*(){const _T=tb.content,sG=ir(_T),iG=yield lU(sG,Xe,gt);if(!_T.Data)throw ee(new Error(`${iG} had no data`),"ERR_INVALID_NODE");const Yit=ur.unmarshal(_T.Data);return{cid:iG,size:sG.length,path:tb.path,unixfs:Yit}})}}catch(tb){ti=!0,cl=tb}finally{try{Pr&&null!=bT.return&&(yield X(bT.return()))}finally{if(ti)throw cl}}}),function(Xe,gt,Pr){return De.apply(this,arguments)})});var De},Ce=>Ys(Ce));if(!ge)throw ee(new Error(`Could not chmod ${n}`),"ERR_COULD_NOT_CHMOD");return yield s7(r)(n,o),void(yield r7(r)(`/ipfs/${ge.cid}`,n,o))}const E=Vr(yield r.repo.blocks.get(a));if(!E.Data)throw ee(new Error(`${a} had no data`),"ERR_INVALID_NODE");const T=ur.unmarshal(E.Data);T.mode=xU(s,T);const U=ir({Data:T.marshal(),Links:E.Links}),b=o.hashAlg||EU.hashAlg,F=yield(yield r.hashers.getHasher(b)).digest(U),M=qe.create(o.cidVersion,gr,F);o.flush&&(yield r.repo.blocks.put(M,U));const H=yield Ch(r,c),$=H[H.length-1],V=qe.decode($.cid.bytes),ne=Vr(yield r.repo.blocks.get(V)),Y=yield cu(r,{parent:ne,name:u,cid:M,size:U.length,flush:o.flush,hashAlg:b,cidVersion:a.version,shardSplitThreshold:1/0});$.cid=Y.cid;const q=yield Kc(r,H,o);yield Zc(r,q,o)}),t.apply(this,arguments)}return ze(function e(n,s){return t.apply(this,arguments)})},cp:r7,flush:function aEe(r){function t(){return(t=(0,B.Z)(function*(n,s={}){s=iEe(oEe,s);const{cid:i}=yield My(r)(n,s);return i})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})},mkdir:Vy,mv:function uEe(r){function t(){return(t=(0,B.Z)(function*(n,s,i={}){const o=cEe(lEe,i);yield r7(r)(n,s,o),yield s7(r)(n,{...o,recursive:!0})})).apply(this,arguments)}return ze(function e(n,s){return t.apply(this,arguments)})},rm:s7,touch:function hEe(r){function t(){return(t=(0,B.Z)(function*(n,s={}){const i=dEe(SU,s);i.mtime=i.mtime||new Date,fEe(`Touching ${n} mtime: ${i.mtime}`);const{cid:o,mfsDirectory:a,name:c,exists:u}=yield Ls(r,n,i),f=s.hashAlg||SU.hashAlg,E=yield r.hashers.getHasher(f);let T,U,b=i.cidVersion;if(u){if(o.code!==gr)throw ee(new Error(`${n} was not a UnixFS node`),"ERR_NOT_UNIXFS");b=o.version;const Y=Vr(yield r.repo.blocks.get(o));if(!Y.Data)throw ee(new Error(`${n} had no data`),"ERR_INVALID_NODE");const q=ur.unmarshal(Y.Data);q.mtime=i.mtime,T=ir({Data:q.marshal(),Links:Y.Links});const ge=yield E.digest(T);U=qe.create(i.cidVersion,gr,ge),i.flush&&(yield r.repo.blocks.put(U,T))}else{T=ir({Data:new ur({type:"file",mtime:i.mtime}).marshal(),Links:[]});const Y=yield E.digest(T);U=qe.create(i.cidVersion,gr,Y),i.flush&&(yield r.repo.blocks.put(U,T))}const P=yield Ch(r,a),F=P[P.length-1],M=F.cid,$=Vr(yield r.repo.blocks.get(M)),V=yield cu(r,{parent:$,name:c,cid:U,size:T.length,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold,hashAlg:i.hashAlg,cidVersion:b});F.cid=V.cid;const W=yield Kc(r,P,i);yield Zc(r,W,i)})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}},IU={write:function vEe(r){function t(){return(t=(0,B.Z)(function*(n,s,i={}){const o=_Ee(mEe,i);let a,c,u;if(no("Reading source, destination and parent"),yield KE().readLock((0,B.Z)(function*(){a=yield bEe(s),c=yield Ls(r,n,o),u=yield Ls(r,c.mfsDirectory,o)}))(),no("Read source, destination and parent"),!o.parents&&!u.exists)throw ee(new Error("directory does not exist"),"ERR_NO_EXIST");if(null==a)throw ee(new Error("could not create source"),"ERR_NO_SOURCE");if(null==c)throw ee(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!o.create&&!c.exists)throw ee(new Error("file does not exist"),"ERR_NO_EXIST");if("file"!==c.entryType)throw ee(new Error("not a file"),"ERR_NOT_A_FILE");return wEe(r,n,a,c,o)})).apply(this,arguments)}return ze(function e(n,s){return t.apply(this,arguments)})},read:function gEe(r){return ze(function e(t,n={}){return n=pEe(yEe,n),{[Symbol.asyncIterator]:(s=Ee(function*(){const o=yield X(Ls(r,t,n)),a=yield X(Lo(o.mfsPath,r.repo.blocks));if("file"!==a.type)throw ee(new Error(`${t} was not a file`),"ERR_NOT_FILE");if(!a.content)throw ee(new Error(`Could not load content stream from ${t}`),"ERR_NO_CONTENT");var f,c=!1,u=!1;try{for(var T,E=be(a.content({offset:n.offset,length:n.length}));c=!(T=yield X(E.next())).done;c=!1)yield T.value}catch(U){u=!0,f=U}finally{try{c&&null!=E.return&&(yield X(E.return()))}finally{if(u)throw f}}}),function i(){return s.apply(this,arguments)})};var s})},ls:function AEe(r){function t(){return(t=Ee(function*(n,s={}){const i=yield X(Ls(r,n,s)),o=yield X(Lo(i.mfsPath,r.repo.blocks));"directory"!==o.type?yield CU(o):yield*Fe(be(os(o.content(s),CU)),X)})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}},RU=({options:r,mfs:e,operations:t,lock:n})=>{Object.keys(t).forEach(s=>{e[s]=n(t[s](r))})},IEe={repoOwner:!0,repo:null};const DU="Ed25519";class MEe{constructor({keychain:e}){this.gen=function PEe({keychain:r}){return ze((t,n={type:DU,size:2048})=>r.createKey(t,n.type||DU,n.size||2048))}({keychain:e}),this.list=function LEe({keychain:r}){return ze(()=>r.listKeys())}({keychain:e}),this.rm=function UEe({keychain:r}){return ze(t=>r.removeKey(t))}({keychain:e}),this.rename=function kEe({keychain:r}){return ze(function(){var t=(0,B.Z)(function*(n,s){const i=yield r.renameKey(n,s);return{was:n,now:i.name,id:i.id,overwrite:!1}});return function(s,i){return t.apply(this,arguments)}}())}({keychain:e}),this.export=function OEe({keychain:r}){return ze((t,n)=>r.exportKey(t,n))}({keychain:e}),this.import=function NEe({keychain:r}){return ze((t,n,s)=>r.importKey(t,n,s))}({keychain:e}),this.info=function BEe({keychain:r}){return ze(t=>r.findKeyByName(t))}({keychain:e})}}function Hc({repo:r,preload:e}){function n(){return(n=(0,B.Z)(function*(s,i={}){return!1!==i.preload&&e(s),Vr(yield r.blocks.get(s,i))})).apply(this,arguments)}return ze(function t(s){return n.apply(this,arguments)})}function o7(r,e=[]){for(const t in r){const n=r[t];if("/"===t&&1===Object.keys(r).length)try{e.push({Name:"",Tsize:0,Hash:qe.parse(n)});continue}catch{}const s=qe.asCID(n);s?e.push({Name:"",Tsize:0,Hash:s}):(Array.isArray(n)&&o7(n,e),n&&"object"==typeof n&&o7(n,e))}return e}function Dh({repo:r,preload:e}){function n(){return(n=(0,B.Z)(function*(s,i={}){const o=yield r.gcLock.readLock();try{const a=ir(s),c=yield ml.digest(a),u=qe.createV1(gr,c);return yield r.blocks.put(u,a,{signal:i.signal}),!1!==i.preload&&e(u),i.pin&&(yield r.pins.pinRecursively(u,{signal:i.signal})),u}finally{o()}})).apply(this,arguments)}return ze(function t(s){return n.apply(this,arguments)})}class GEe{constructor({repo:e,preload:t}){this.addLink=function $Ee({repo:r,preload:e}){const t=Hc({repo:r,preload:e}),n=Dh({repo:r,preload:e});function i(){return(i=(0,B.Z)(function*(o,a,c={}){const u=yield t(o,c);return n({...u,Links:u.Links.concat([a])},c)})).apply(this,arguments)}return ze(function s(o,a){return i.apply(this,arguments)})}({repo:e,preload:t}),this.appendData=function KEe({repo:r,preload:e}){const t=Hc({repo:r,preload:e}),n=Dh({repo:r,preload:e});function i(){return(i=(0,B.Z)(function*(o,a,c={}){const u=yield t(o,c),f=zf([u.Data||[],a]);return n({...u,Data:f},c)})).apply(this,arguments)}return ze(function s(o,a){return i.apply(this,arguments)})}({repo:e,preload:t}),this.rmLink=function ZEe({repo:r,preload:e}){const t=Hc({repo:r,preload:e}),n=Dh({repo:r,preload:e});function i(){return(i=(0,B.Z)(function*(o,a,c={}){const u=yield t(o,c),f=("string"==typeof a?a:a.Name)||"";return u.Links=u.Links.filter(E=>E.Name!==f),n(u,c)})).apply(this,arguments)}return ze(function s(o,a){return i.apply(this,arguments)})}({repo:e,preload:t}),this.setData=function HEe({repo:r,preload:e}){const t=Hc({repo:r,preload:e}),n=Dh({repo:r,preload:e});function i(){return(i=(0,B.Z)(function*(o,a,c={}){const u=yield t(o,c);return n({...u,Data:a},c)})).apply(this,arguments)}return ze(function s(o,a){return i.apply(this,arguments)})}({repo:e,preload:t})}}class WEe{constructor({repo:e,codecs:t,preload:n}){this.data=function FEe({repo:r,preload:e}){const t=Hc({repo:r,preload:e});function s(){return(s=(0,B.Z)(function*(i,o={}){return(yield t(i,o)).Data||new Uint8Array(0)})).apply(this,arguments)}return ze(function n(i){return s.apply(this,arguments)})}({repo:e,preload:n}),this.get=Hc({repo:e,preload:n}),this.links=function zEe({repo:r,codecs:e}){function n(){return(n=(0,B.Z)(function*(s,i={}){const o=yield e.getCodec(s.code),a=yield r.blocks.get(s,i),c=o.decode(a);switch(s.code){case T6:return[];case gr:return c.Links;case l6:case EC:return o7(c);default:throw new Error(`Cannot resolve links from codec ${s.code}`)}})).apply(this,arguments)}return ze(function t(s){return n.apply(this,arguments)})}({repo:e,codecs:t}),this.new=function VEe({repo:r,preload:e}){function n(){return(n=(0,B.Z)(function*(s={}){let i;if(s.template){if("unixfs-dir"!==s.template)throw new Error("unknown template");i=new ur({type:"directory"}).marshal()}const o=ir({Data:i,Links:[]}),a=yield ml.digest(o),c=qe.createV0(a);return yield r.blocks.put(c,o,{signal:s.signal}),!1!==s.preload&&e(c),c})).apply(this,arguments)}return ze(function t(){return n.apply(this,arguments)})}({repo:e,preload:n}),this.put=Dh({repo:e,preload:n}),this.stat=function jEe({repo:r,preload:e}){const t=Hc({repo:r,preload:e});function s(){return(s=(0,B.Z)(function*(i,o={}){const a=yield t(i,o),u=ir(a).length,f=a.Links.reduce((E,T)=>E+(T.Tsize||0),0);return{Hash:i,NumLinks:a.Links.length,BlockSize:u,LinksSize:u-(a.Data||[]).length,DataSize:(a.Data||[]).length,CumulativeSize:u+f}})).apply(this,arguments)}return ze(function n(i){return s.apply(this,arguments)})}({repo:e,preload:n}),this.patch=new GEe({repo:e,preload:n})}}const YEe=Be("ipfs:repo:gc");function PU({repo:r}){function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.stat();return{numObjects:BigInt(s.numObjects.toString()),repoSize:BigInt(s.repoSize.toString()),repoPath:s.repoPath,version:`${s.version}`,storageMax:BigInt(s.storageMax.toString())}})).apply(this,arguments)}return ze(function e(){return t.apply(this,arguments)})}class XEe{constructor({repo:e,hashers:t}){this.gc=function QEe({repo:r,hashers:e}){function n(){return(n=Ee(function*(s={}){const i=Date.now();let o;try{o=yield X(ZE({repo:r,hashers:e},s)),yield X(r.pins.pinRecursively(o)),yield*Fe(be(r.gc()),X)}finally{o&&(yield X(r.pins.unpin(o)))}YEe(`Complete (${Date.now()-i}ms)`)})).apply(this,arguments)}return ze(function t(){return n.apply(this,arguments)})}({repo:e,hashers:t}),this.stat=PU({repo:e}),this.version=function JEe({repo:r}){function t(){return(t=(0,B.Z)(function*(n={}){try{yield r._checkInitialized(n)}catch(s){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(o=>o.test(s.message)))return 12;throw s}return r.version.get()})).apply(this,arguments)}return ze(function e(){return t.apply(this,arguments)})}({repo:e}),this.setApiAddr=n=>e.apiAddr.set(n)}}function NU(r,e){let t;if(t=r.metrics?e.peer?r.metrics.forPeer(e.peer):e.proto?r.metrics.forProtocol(e.proto):r.metrics.getGlobal():void 0,!t)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0};const n=t.getMovingAverages(),s=t.getSnapshot();return{totalIn:s.dataReceived,totalOut:s.dataSent,rateIn:n.dataReceived[6e4].movingAverage/60,rateOut:n.dataSent[6e4].movingAverage/60}}class e7e{constructor({repo:e,network:t}){this.repo=PU({repo:e}),this.bw=function qEe({network:r}){return ze(function(){var t=Ee(function*(n={}){const{libp2p:s}=yield X(r.use(n));if(!n.poll)return void(yield NU(s,n));const i=n.interval||1e3;let a,o=-1;try{if(o="string"==typeof i?Vp(i)||-1:i,!o||o<0)throw new Error("invalid duration")}catch(c){throw ee(c,"ERR_INVALID_POLL_INTERVAL")}try{for(;;)yield NU(s,n),yield X(new Promise(c=>{a=setTimeout(c,o)}))}finally{clearTimeout(a)}});return function(){return t.apply(this,arguments)}}())}({network:t}),this.bitswap=GP({network:t})}}var a7=function t7e(r,e,t){if(!r)return t;var n,s;if(Array.isArray(e)&&(n=e.slice(0)),"string"==typeof e&&(n=e.split(".")),"symbol"==typeof e&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");for(;n.length;)if(s=n.shift(),!r||void 0===(r=r[s]))return t;return r},i7e=Math.pow(2,31),c7e=Math.pow(2,7),l7e=Math.pow(2,14),u7e=Math.pow(2,21),d7e=Math.pow(2,28),f7e=Math.pow(2,35),h7e=Math.pow(2,42),p7e=Math.pow(2,49),y7e=Math.pow(2,56),g7e=Math.pow(2,63),_7e={encode:function LU(r,e,t){e=e||[];for(var n=t=t||0;r>=i7e;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,LU.bytes=t-n+1,e},decode:function c7(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw c7.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return c7.bytes=i-n,t},encodingLength:function(r){return r<c7e?1:r<l7e?2:r<u7e?3:r<d7e?4:r<f7e?5:r<h7e?6:r<p7e?7:r<y7e?8:r<g7e?9:10}};const Ky=_7e,l7=(r,e=0)=>[Ky.decode(r,e),Ky.decode.bytes],Zy=(r,e,t=0)=>(Ky.encode(r,e,t),e),Hy=r=>Ky.encodingLength(r),lu=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}),Gy=(r,e)=>{const t=e.byteLength,n=Hy(r),s=n+Hy(t),i=new Uint8Array(s+t);return Zy(r,i,0),Zy(t,i,n),i.set(e,s),new d7(r,t,e,i)},u7=r=>{const e=lu(r),[t,n]=l7(e),[s,i]=l7(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new d7(t,s,o,e)};class d7{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const I7e=function A7e(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class R7e{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class D7e{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return UU(this,e)}}class O7e{constructor(e){this.decoders=e}or(e){return UU(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const UU=(r,e)=>new O7e({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class P7e{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new R7e(e,t,n),this.decoder=new D7e(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Wy=({name:r,prefix:e,encode:t,decode:n})=>new P7e(r,e,t,n),Oh=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=I7e(t,e);return Wy({prefix:r,name:e,encode:n,decode:i=>lu(s(i))})},Ln=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Wy({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),zo=Oh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),L7e=Oh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Bi=Ln({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),k7e=Ln({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),U7e=Ln({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),M7e=Ln({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),F7e=Ln({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),z7e=Ln({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),V7e=Ln({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),j7e=Ln({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$7e=Ln({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),MU=new WeakMap,f7=r=>{const e=MU.get(r);if(null==e){const t=new Map;return MU.set(r,t),t}return e};class _r{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Ph)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==W7e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return _r.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=Gy(e,t);return _r.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return _r.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?H7e(t,f7(r),e||zo.encoder):G7e(t,f7(r),e||Bi.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof _r)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new _r(n,s,i,o||FU(n,s,i.bytes))}if(!0===t[Y7e]){const{version:n,multihash:s,code:i}=t,o=u7(s);return _r.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Ph)throw new Error(`Version 0 CID must use dag-pb (code: ${Ph}) block encoding`);return new _r(e,t,n,n.bytes);case 1:{const s=FU(e,t,n.bytes);return new _r(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return _r.create(0,Ph,e)}static createV1(e,t){return _r.create(1,e,t)}static decode(e){const[t,n]=_r.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=_r.inspectBytes(e),n=t.size-t.multihashSize,s=lu(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new d7(t.multihashCode,t.digestSize,i,s);return[0===t.version?_r.createV0(o):_r.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=l7(e.subarray(t));return t+=T,E};let s=n(),i=Ph;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=Z7e(e,t),i=_r.decode(s);return f7(i).set(n,e),i}}const Z7e=(r,e)=>{switch(r[0]){case"Q":return[zo.prefix,(e||zo).decode(`${zo.prefix}${r}`)];case zo.prefix:return[zo.prefix,(e||zo).decode(r)];case Bi.prefix:return[Bi.prefix,(e||Bi).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},H7e=(r,e,t)=>{const{prefix:n}=t;if(n!==zo.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},G7e=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},Ph=112,W7e=18,FU=(r,e,t)=>{const n=Hy(r),s=n+Hy(e),i=new Uint8Array(s+t.byteLength);return Zy(r,i,0),Zy(e,i,n),i.set(t,s),i},Y7e=Symbol.for("@ipld/js-cid/CID");function uu(r){return h7.apply(this,arguments)}function h7(){return h7=(0,B.Z)(function*(r){let e=0;var s,t=!1,n=!1;try{for(var i=be(r);t=!(yield i.next()).done;t=!1)e++}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield i.return())}finally{if(n)throw s}}return e}),h7.apply(this,arguments)}const Q7e="raw",zU=85,J7e=r=>lu(r),X7e=r=>lu(r),q7e=Br("ipfs:repo:migrator:migration-8");function VU(r){return r.child?VU(r.child):r}function e9e(r){try{const e=Bi.decode(`b${r.toString().toLowerCase().slice(1)}`),t=_r.decode(e).multihash.bytes,n=Bi.encode(t).slice(1).toUpperCase();return new ft(`/${n}`,!1)}catch{return r}}function t9e(r){try{const e=Bi.decode(`b${r.toString().toLowerCase().slice(1)}`),t=u7(e),n=Bi.encode(_r.createV1(zU,t).bytes).slice(1);return new ft(`/${n.toUpperCase()}`,!1)}catch{return r}}function jU(r,e,t){return p7.apply(this,arguments)}function p7(){return p7=(0,B.Z)(function*(r,e,t){const n=r.blocks;yield n.open();const s=VU(n),i=yield uu(s.queryKeys({filters:[E=>t(E).toString()!==E.toString()]}));try{let E=0;var c,o=!1,a=!1;try{for(var f,u=be(s.query({}));o=!(f=yield u.next()).done;o=!1){const T=f.value,U=t(T.key);U.toString()!==T.key.toString()&&(E+=1,q7e(`Migrating Block from ${T.key} to ${U}`,yield s.has(T.key)),yield s.delete(T.key),yield s.put(U,T.value),e(E/i*100,`Migrated Block from ${T.key} to ${U}`))}}catch(T){a=!0,c=T}finally{try{o&&null!=u.return&&(yield u.return())}finally{if(a)throw c}}}finally{yield n.close()}}),p7.apply(this,arguments)}const r9e={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(r,e=(()=>{}))=>jU(r,e,e9e),revert:(r,e=(()=>{}))=>jU(r,e,t9e)};var yt=p(35004);const $U=yt.Reader,n9e=yt.Writer,Yy=yt.roots.default||(yt.roots.default={}),s9e=Yy.ipfs=(()=>{const r={};return r.pin=function(){const e={};return e.Set=function(){function t(n){if(n)for(var s=Object.keys(n),i=0;i<s.length;++i)null!=n[s[i]]&&(this[s[i]]=n[s[i]])}return t.prototype.version=0,t.prototype.fanout=0,t.prototype.seed=0,t.encode=function(s,i){return i||(i=n9e.create()),null!=s.version&&Object.hasOwnProperty.call(s,"version")&&i.uint32(8).uint32(s.version),null!=s.fanout&&Object.hasOwnProperty.call(s,"fanout")&&i.uint32(16).uint32(s.fanout),null!=s.seed&&Object.hasOwnProperty.call(s,"seed")&&i.uint32(29).fixed32(s.seed),i},t.decode=function(s,i){s instanceof $U||(s=$U.create(s));for(var o=void 0===i?s.len:s.pos+i,a=new Yy.ipfs.pin.Set;s.pos<o;){var c=s.uint32();switch(c>>>3){case 1:a.version=s.uint32();break;case 2:a.fanout=s.uint32();break;case 3:a.seed=s.fixed32();break;default:s.skipType(7&c)}}return a},t.fromObject=function(s){if(s instanceof Yy.ipfs.pin.Set)return s;var i=new Yy.ipfs.pin.Set;return null!=s.version&&(i.version=s.version>>>0),null!=s.fanout&&(i.fanout=s.fanout>>>0),null!=s.seed&&(i.seed=s.seed>>>0),i},t.toObject=function(s,i){i||(i={});var o={};return i.defaults&&(o.version=0,o.fanout=0,o.seed=0),null!=s.version&&s.hasOwnProperty("version")&&(o.version=s.version),null!=s.fanout&&s.hasOwnProperty("fanout")&&(o.fanout=s.fanout),null!=s.seed&&s.hasOwnProperty("seed")&&(o.seed=s.seed),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,yt.util.toJSONOptions)},t}(),e}(),r})();var i9e=p(81828);const Qy=new ft("/local/pins"),KU=_r.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n");function ZU(r){return new ft(`/${Bi.encode(r.multihash.bytes).toUpperCase().substring(1)}`)}function g7(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function HU(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?g7(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function b7(r,e){null==e&&(e=r.reduce((s,i)=>s+i.length,0));const t=HU(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return g7(t)}function a9e(r,e){for(let t=0;t<r.byteLength;t++){if(r[t]<e[t])return-1;if(r[t]>e[t])return 1}return r.byteLength>e.byteLength?1:r.byteLength<e.byteLength?-1:0}const c9e=Wy({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),l9e=Ln({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),u9e=Ln({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),d9e=Oh({prefix:"9",name:"base10",alphabet:"0123456789"}),f9e=Ln({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),h9e=Ln({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),p9e=Oh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),y9e=Oh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),g9e=Ln({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),b9e=Ln({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),_9e=Ln({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),m9e=Ln({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),GU=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),v9e=GU.reduce((r,e,t)=>(r[t]=e,r),[]),w9e=GU.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),S9e=Wy({prefix:"\u{1f680}",name:"base256emoji",encode:function E9e(r){return r.reduce((e,t)=>e+v9e[t],"")},decode:function x9e(r){const e=[];for(const t of r){const n=w9e[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}}),WU=({name:r,code:e,encode:t})=>new A9e(r,e,t);class A9e{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Gy(this.code,t):t.then(n=>Gy(this.code,n))}throw Error("Unknown type, must be binary type")}}const YU=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),Jy=WU({name:"sha2-256",code:18,encode:YU("SHA-256")}),T9e=WU({name:"sha2-512",code:19,encode:YU("SHA-512")}),JU=lu,I9e={code:0,name:"identity",encode:JU,digest:r=>Gy(0,JU(r))},R9e=new TextEncoder,D9e=new TextDecoder,O9e="json",P9e=512,N9e=r=>R9e.encode(JSON.stringify(r)),B9e=r=>JSON.parse(D9e.decode(r)),XU={...$b,...Kb,...Zb,...Hb,...Gb,...Vb,...Wb,...zb,...Yb,...Qb};function qU(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const eM=qU("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),_7=qU("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=HU((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),tM={utf8:eM,"utf-8":eM,hex:XU.base16,latin1:_7,ascii:_7,binary:_7,...XU};function m7(r,e="utf8"){const t=tM[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}function v7(r,e="utf8"){const t=tM[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):g7(globalThis.Buffer.from(r,"utf-8"))}const w7=s9e.pin.Set;function L9e(r){const e=r.Data;if(!e)throw new Error("No data present");const t=vt.decode(e),n=vt.decode.bytes;if(n<=0)throw new Error("Invalid Set header length");if(n+t>e.length)throw new Error("Impossibly large set header length");const s=e.slice(n,t+n),i=w7.toObject(w7.decode(s),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(1!==i.version)throw new Error(`Unsupported Set version: ${i.version}`);if(i.fanout>r.Links.length)throw new Error("Impossibly large fanout");return{header:i,data:e.slice(t+n)}}function k9e(r,e){const t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,r,!0);const s=v7(e.toString()),i=b7([t,s],t.byteLength+s.byteLength);return i9e(m7(i))}function rM(r,e){return E7.apply(this,arguments)}function E7(){return E7=Ee(function*(r,e){const t=L9e(e);let n=0;for(const s of e.Links){if(n<t.header.fanout){const i=s.Hash;if(!KU.equals(i)){const a=Vr(yield X(r.get(i)));yield*Fe(be(rM(r,a)),X)}}else yield s.Hash;n++}}),E7.apply(this,arguments)}function Xy(r,e,t){return x7.apply(this,arguments)}function x7(){return x7=Ee(function*(r,e,t){const n=e.Links.find(o=>o.Name===t);if(!n)throw new Error("No link found with name "+t);const i=Vr(yield X(r.get(n.Hash)));yield*Fe(be(rM(r,i)),X)}),x7.apply(this,arguments)}function U9e(r,e){return t(e,0);function t(s,i){return n.apply(this,arguments)}function n(){return n=(0,B.Z)(function*(s,i){const o=w7.encode({version:1,fanout:256,seed:i}).finish(),c=b7([vt.encode(o.length),o]),u=[];for(let T=0;T<256;T++)u.push({Name:"",Tsize:1,Hash:KU});if(s.length<=8192){const T=s.map(P=>({link:{Name:"",Tsize:1,Hash:P.key},data:P.data||new Uint8Array})).sort((P,F)=>a9e(P.link.Hash.bytes,F.link.Hash.bytes)),U=u.concat(T.map(P=>P.link));return{Data:b7([c,...T.map(P=>P.data)]),Links:U}}{const T=s.reduce((b,P)=>{const F=k9e(i,P.key)%256;return b[F]=F in b?b[F].concat([P]):[P],b},[]);let U=0;for(const b of T){const P=yield t(b,i+1);yield f(P,U),U++}return{Data:c,Links:u}}function f(T,U){return E.apply(this,arguments)}function E(){return(E=(0,B.Z)(function*(T,U){const b=ir(T),P=yield Jy.digest(b),F=_r.createV0(P);yield r.put(F,b);const M=T.Links.reduce((H,$)=>H+($.Tsize||0),0)+b.length;u[U]={Name:"",Tsize:M,Hash:F}})).apply(this,arguments)}}),n.apply(this,arguments)}}function nM(r,e,t){return S7.apply(this,arguments)}function S7(){return S7=(0,B.Z)(function*(r,e,t){const n=yield U9e(r,t.map(c=>({key:c}))),s=ir(n),i=yield Jy.digest(s),o=_r.createV0(i);return yield r.put(o,s),{Name:e,Tsize:n.Links.reduce((c,u)=>c+u.Tsize,0)+s.length,Hash:o}}),S7.apply(this,arguments)}function M9e(r,e,t,n){return A7.apply(this,arguments)}function A7(){return A7=(0,B.Z)(function*(r,e,t,n){if(!(yield e.has(Qy)))return;const s=yield e.get(Qy),i=_r.decode(s),a=Vr(yield r.get(i));let c=0;const u=(yield uu(Xy(r,a,"recursive")))+(yield uu(Xy(r,a,"direct")));var T,f=!1,E=!1;try{for(var b,U=be(Xy(r,a,"recursive"));f=!(b=yield U.next()).done;f=!1){const V=b.value;c++;const W={depth:1/0};0!==V.version&&(W.version=V.version),V.code!==gr&&(W.codec=V.code),yield t.put(ZU(V),bl(W)),n(c/u*100,`Migrated recursive pin ${V}`)}}catch(V){E=!0,T=V}finally{try{f&&null!=U.return&&(yield U.return())}finally{if(E)throw T}}var M,P=!1,F=!1;try{for(var $,H=be(Xy(r,a,"direct"));P=!($=yield H.next()).done;P=!1){const V=$.value;c++;const W={depth:0};0!==V.version&&(W.version=V.version),V.code!==gr&&(W.codec=V.code),yield t.put(ZU(V),bl(W)),n(c/u*100,`Migrated direct pin ${V}`)}}catch(V){F=!0,M=V}finally{try{P&&null!=H.return&&(yield H.return())}finally{if(F)throw M}}yield r.delete(i),yield e.delete(Qy)}),A7.apply(this,arguments)}function F9e(r,e,t,n){return T7.apply(this,arguments)}function T7(){return T7=(0,B.Z)(function*(r,e,t,n){const s=[],i=[];let o=0;const a=yield uu(t.queryKeys({}));var f,c=!1,u=!1;try{for(var T,E=be(t.query({}));c=!(T=yield E.next()).done;c=!1){const{key:M,value:H}=T.value;o++;const $=Hi(H),V=_r.create($.version||0,$.codec||gr,u7(Bi.decode("b"+M.toString().toLowerCase().split("/").pop())));0===$.depth?(n(o/a*100,`Reverted direct pin ${V}`),i.push(V)):(n(o/a*100,`Reverted recursive pin ${V}`),s.push(V))}}catch(M){u=!0,f=M}finally{try{c&&null!=E.return&&(yield E.return())}finally{if(u)throw f}}n(100,"Updating pin root");const b=ir({Links:[yield nM(r,"direct",i),yield nM(r,"recursive",s)]}),P=yield Jy.digest(b),F=_r.createV0(P);yield r.put(F,b),yield e.put(Qy,F.bytes)}),T7.apply(this,arguments)}function sM(r,e,t){return C7.apply(this,arguments)}function C7(){return C7=(0,B.Z)(function*(r,e,t){const n=r.blocks,s=r.datastore,i=r.pins;yield n.open(),yield s.open(),yield i.open();try{yield t(n,s,i,e)}finally{yield i.close(),yield s.close(),yield n.close()}}),C7.apply(this,arguments)}const z9e={version:9,description:"Migrates pins to datastore",migrate:(r,e=(()=>{}))=>sM(r,e,M9e),revert:(r,e=(()=>{}))=>sM(r,e,F9e)},V9e=new ft("/config"),I7=new ft("/version");function qy(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,"level-js"===e.type||"Level"===e.constructor.name)return e}function R7(){return R7=(0,B.Z)(function*(r,e,t){const n=yield e(r);if(n)return n;const s=qy(t);return!!s&&new Promise((i,o)=>{const a=s.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{i(Boolean(a.result))}})}),R7.apply(this,arguments)}function D7(){return D7=(0,B.Z)(function*(r,e,t,n){if(yield t(r))return e(r);const s=qy(n);if(!s)throw Wi();return new Promise((i,o)=>{const a=s.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return i(a.result);o(Wi())}})}),D7.apply(this,arguments)}function e2(r){const e=r.get.bind(r),t=r.has.bind(r);return r.get=n=>function $9e(r,e,t,n){return D7.apply(this,arguments)}(n,e,t,r),r.has=n=>function j9e(r,e,t){return R7.apply(this,arguments)}(n,t,r),r}function iM(r){return{...r,root:e2(r.root),datastore:e2(r.datastore),pins:e2(r.pins),keys:e2(r.keys)}}function K9e(r,e){return O7.apply(this,arguments)}function O7(){return O7=(0,B.Z)(function*(r,e,t=(()=>{})){const n=qy(e);n?(t(`Upgrading ${r}`),yield cM(n,(i,o)=>[{type:"del",key:i},{type:"put",key:v7(i),value:o}])):t(`${r} did not need an upgrade`)}),O7.apply(this,arguments)}function Z9e(r,e){return P7.apply(this,arguments)}function P7(){return P7=(0,B.Z)(function*(r,e,t=(()=>{})){const n=qy(e);n?(t(`Downgrading ${r}`),yield cM(n,(i,o)=>[{type:"del",key:i},{type:"put",key:m7(i),value:o}])):t(`${r} did not need a downgrade`)}),P7.apply(this,arguments)}function oM(r){return r.child?oM(r.child):r}function aM(r,e,t){return N7.apply(this,arguments)}function N7(){return N7=(0,B.Z)(function*(r,e,t){const n=Object.entries(r).map(([o,a])=>({key:o,backend:oM(a)})).filter(({backend:a})=>"LevelDatastore"===a.constructor.name).map(({key:o,backend:a})=>({name:o,store:a}));e(0,`Migrating ${n.length} dbs`);let s=0;const i=o=>{e(Math.round(s/n.length*100),o)};for(const{name:o,store:a}of n){yield a.open();try{yield t(o,a,i)}finally{s++,yield a.close()}}e(100,`Migrated ${n.length} dbs`)}),N7.apply(this,arguments)}const H9e={version:10,description:"Migrates datastore-level keys to binary",migrate:(r,e=(()=>{}))=>aM(r,e,K9e),revert:(r,e=(()=>{}))=>aM(r,e,Z9e)};function cM(r,e){return new Promise((n,s)=>{const i=r.iterator();i._deserializeKey=i._deserializeValue=c=>c,function a(){i.next((u,f,E)=>{u||void 0===f?i.end(U=>{U?s(U):n()}):function t(n,s){const i=r.store("readwrite"),o=i.transaction;let c,a=0;o.onabort=()=>s(c||o.error||new Error("aborted by user")),o.oncomplete=()=>s(),function u(){const f=n[a++],E=f.key;let T;try{T="del"===f.type?i.delete(E):i.put(f.value,E)}catch(U){return c=U,void o.abort()}a<n.length&&(T.onsuccess=u)}()}(e(f,E),a)})}()})}const Ja=new ft("/local/filesroot");function B7(){return B7=(0,B.Z)(function*(r,e=(()=>{})){if(e(100,"Migrating MFS root to repo datastore"),yield r.root.open(),yield r.datastore.open(),yield r.root.has(Ja)){const t=yield r.root.get(Ja);yield r.datastore.put(Ja,t),yield r.root.delete(Ja)}yield r.datastore.close(),yield r.root.close(),e(100,"Stored MFS root in repo datastore")}),B7.apply(this,arguments)}function L7(){return L7=(0,B.Z)(function*(r,e=(()=>{})){if(e(100,"Migrating MFS root to repo root datastore"),yield r.root.open(),yield r.datastore.open(),yield r.datastore.has(Ja)){const t=yield r.datastore.get(Ja);yield r.root.put(Ja,t),yield r.datastore.delete(Ja)}yield r.datastore.close(),yield r.root.close(),e(100,"Stored MFS root in repo root datastore")}),L7.apply(this,arguments)}const Y9e={version:11,description:"Store mfs root in the datastore",migrate:function G9e(r){return B7.apply(this,arguments)},revert:function W9e(r){return L7.apply(this,arguments)}},lM=yt.Reader,Q9e=yt.Writer,J9e=yt.util,t2=yt.roots.default||(yt.roots.default={}),uM=t2.Protocols=(()=>{function r(e){if(this.protocols=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.protocols=J9e.emptyArray,r.encode=function(t,n){if(n||(n=Q9e.create()),null!=t.protocols&&t.protocols.length)for(var s=0;s<t.protocols.length;++s)n.uint32(10).string(t.protocols[s]);return n},r.decode=function(t,n){t instanceof lM||(t=lM.create(t));for(var s=void 0===n?t.len:t.pos+n,i=new t2.Protocols;t.pos<s;){var o=t.uint32();o>>>3==1?(i.protocols&&i.protocols.length||(i.protocols=[]),i.protocols.push(t.string())):t.skipType(7&o)}return i},r.fromObject=function(t){if(t instanceof t2.Protocols)return t;var n=new t2.Protocols;if(t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Protocols.protocols: array expected");n.protocols=[];for(var s=0;s<t.protocols.length;++s)n.protocols[s]=String(t.protocols[s])}return n},r.toObject=function(t,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.protocols=[]),t.protocols&&t.protocols.length){s.protocols=[];for(var i=0;i<t.protocols.length;++i)s.protocols[i]=t.protocols[i]}return s},r.prototype.toJSON=function(){return this.constructor.toObject(this,yt.util.toJSONOptions)},r})(),fu=yt.Reader,k7=yt.Writer,mr=yt.util,un=yt.roots.default||(yt.roots.default={}),dM=un.Addresses=(()=>{function r(e){if(this.addrs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.addrs=mr.emptyArray,r.prototype.certifiedRecord=null,r.encode=function(t,n){if(n||(n=k7.create()),null!=t.addrs&&t.addrs.length)for(var s=0;s<t.addrs.length;++s)un.Addresses.Address.encode(t.addrs[s],n.uint32(10).fork()).ldelim();return null!=t.certifiedRecord&&Object.hasOwnProperty.call(t,"certifiedRecord")&&un.Addresses.CertifiedRecord.encode(t.certifiedRecord,n.uint32(18).fork()).ldelim(),n},r.decode=function(t,n){t instanceof fu||(t=fu.create(t));for(var s=void 0===n?t.len:t.pos+n,i=new un.Addresses;t.pos<s;){var o=t.uint32();switch(o>>>3){case 1:i.addrs&&i.addrs.length||(i.addrs=[]),i.addrs.push(un.Addresses.Address.decode(t,t.uint32()));break;case 2:i.certifiedRecord=un.Addresses.CertifiedRecord.decode(t,t.uint32());break;default:t.skipType(7&o)}}return i},r.fromObject=function(t){if(t instanceof un.Addresses)return t;var n=new un.Addresses;if(t.addrs){if(!Array.isArray(t.addrs))throw TypeError(".Addresses.addrs: array expected");n.addrs=[];for(var s=0;s<t.addrs.length;++s){if("object"!=typeof t.addrs[s])throw TypeError(".Addresses.addrs: object expected");n.addrs[s]=un.Addresses.Address.fromObject(t.addrs[s])}}if(null!=t.certifiedRecord){if("object"!=typeof t.certifiedRecord)throw TypeError(".Addresses.certifiedRecord: object expected");n.certifiedRecord=un.Addresses.CertifiedRecord.fromObject(t.certifiedRecord)}return n},r.toObject=function(t,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addrs=[]),n.defaults&&(s.certifiedRecord=null),t.addrs&&t.addrs.length){s.addrs=[];for(var i=0;i<t.addrs.length;++i)s.addrs[i]=un.Addresses.Address.toObject(t.addrs[i],n)}return null!=t.certifiedRecord&&t.hasOwnProperty("certifiedRecord")&&(s.certifiedRecord=un.Addresses.CertifiedRecord.toObject(t.certifiedRecord,n)),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,yt.util.toJSONOptions)},r.Address=function(){function e(n){if(n)for(var s=Object.keys(n),i=0;i<s.length;++i)null!=n[s[i]]&&(this[s[i]]=n[s[i]])}let t;return e.prototype.multiaddr=mr.newBuffer([]),e.prototype.isCertified=null,Object.defineProperty(e.prototype,"_isCertified",{get:mr.oneOfGetter(t=["isCertified"]),set:mr.oneOfSetter(t)}),e.encode=function(s,i){return i||(i=k7.create()),null!=s.multiaddr&&Object.hasOwnProperty.call(s,"multiaddr")&&i.uint32(10).bytes(s.multiaddr),null!=s.isCertified&&Object.hasOwnProperty.call(s,"isCertified")&&i.uint32(16).bool(s.isCertified),i},e.decode=function(s,i){s instanceof fu||(s=fu.create(s));for(var o=void 0===i?s.len:s.pos+i,a=new un.Addresses.Address;s.pos<o;){var c=s.uint32();switch(c>>>3){case 1:a.multiaddr=s.bytes();break;case 2:a.isCertified=s.bool();break;default:s.skipType(7&c)}}return a},e.fromObject=function(s){if(s instanceof un.Addresses.Address)return s;var i=new un.Addresses.Address;return null!=s.multiaddr&&("string"==typeof s.multiaddr?mr.base64.decode(s.multiaddr,i.multiaddr=mr.newBuffer(mr.base64.length(s.multiaddr)),0):s.multiaddr.length&&(i.multiaddr=s.multiaddr)),null!=s.isCertified&&(i.isCertified=Boolean(s.isCertified)),i},e.toObject=function(s,i){i||(i={});var o={};return i.defaults&&(i.bytes===String?o.multiaddr="":(o.multiaddr=[],i.bytes!==Array&&(o.multiaddr=mr.newBuffer(o.multiaddr)))),null!=s.multiaddr&&s.hasOwnProperty("multiaddr")&&(o.multiaddr=i.bytes===String?mr.base64.encode(s.multiaddr,0,s.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(s.multiaddr):s.multiaddr),null!=s.isCertified&&s.hasOwnProperty("isCertified")&&(o.isCertified=s.isCertified,i.oneofs&&(o._isCertified="isCertified")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,yt.util.toJSONOptions)},e}(),r.CertifiedRecord=function(){function e(t){if(t)for(var n=Object.keys(t),s=0;s<n.length;++s)null!=t[n[s]]&&(this[n[s]]=t[n[s]])}return e.prototype.seq=mr.Long?mr.Long.fromBits(0,0,!0):0,e.prototype.raw=mr.newBuffer([]),e.encode=function(n,s){return s||(s=k7.create()),null!=n.seq&&Object.hasOwnProperty.call(n,"seq")&&s.uint32(8).uint64(n.seq),null!=n.raw&&Object.hasOwnProperty.call(n,"raw")&&s.uint32(18).bytes(n.raw),s},e.decode=function(n,s){n instanceof fu||(n=fu.create(n));for(var i=void 0===s?n.len:n.pos+s,o=new un.Addresses.CertifiedRecord;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:o.seq=n.uint64();break;case 2:o.raw=n.bytes();break;default:n.skipType(7&a)}}return o},e.fromObject=function(n){if(n instanceof un.Addresses.CertifiedRecord)return n;var s=new un.Addresses.CertifiedRecord;return null!=n.seq&&(mr.Long?(s.seq=mr.Long.fromValue(n.seq)).unsigned=!0:"string"==typeof n.seq?s.seq=parseInt(n.seq,10):"number"==typeof n.seq?s.seq=n.seq:"object"==typeof n.seq&&(s.seq=new mr.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0))),null!=n.raw&&("string"==typeof n.raw?mr.base64.decode(n.raw,s.raw=mr.newBuffer(mr.base64.length(n.raw)),0):n.raw.length&&(s.raw=n.raw)),s},e.toObject=function(n,s){s||(s={});var i={};if(s.defaults){if(mr.Long){var o=new mr.Long(0,0,!0);i.seq=s.longs===String?o.toString():s.longs===Number?o.toNumber():o}else i.seq=s.longs===String?"0":0;s.bytes===String?i.raw="":(i.raw=[],s.bytes!==Array&&(i.raw=mr.newBuffer(i.raw)))}return null!=n.seq&&n.hasOwnProperty("seq")&&(i.seq="number"==typeof n.seq?s.longs===String?String(n.seq):n.seq:s.longs===String?mr.Long.prototype.toString.call(n.seq):s.longs===Number?new mr.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0):n.seq),null!=n.raw&&n.hasOwnProperty("raw")&&(i.raw=s.bytes===String?mr.base64.encode(n.raw,0,n.raw.length):s.bytes===Array?Array.prototype.slice.call(n.raw):n.raw),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,yt.util.toJSONOptions)},e}(),r})(),hu=yt.Reader,U7=yt.Writer,Yt=yt.util,Gr=yt.roots.default||(yt.roots.default={}),fM=Gr.Peer=(()=>{function r(t){if(this.addresses=[],this.protocols=[],this.metadata=[],t)for(var n=Object.keys(t),s=0;s<n.length;++s)null!=t[n[s]]&&(this[n[s]]=t[n[s]])}let e;return r.prototype.addresses=Yt.emptyArray,r.prototype.protocols=Yt.emptyArray,r.prototype.metadata=Yt.emptyArray,r.prototype.pubKey=null,r.prototype.peerRecordEnvelope=null,Object.defineProperty(r.prototype,"_pubKey",{get:Yt.oneOfGetter(e=["pubKey"]),set:Yt.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_peerRecordEnvelope",{get:Yt.oneOfGetter(e=["peerRecordEnvelope"]),set:Yt.oneOfSetter(e)}),r.encode=function(n,s){if(s||(s=U7.create()),null!=n.addresses&&n.addresses.length)for(var i=0;i<n.addresses.length;++i)Gr.Address.encode(n.addresses[i],s.uint32(10).fork()).ldelim();if(null!=n.protocols&&n.protocols.length)for(i=0;i<n.protocols.length;++i)s.uint32(18).string(n.protocols[i]);if(null!=n.metadata&&n.metadata.length)for(i=0;i<n.metadata.length;++i)Gr.Metadata.encode(n.metadata[i],s.uint32(26).fork()).ldelim();return null!=n.pubKey&&Object.hasOwnProperty.call(n,"pubKey")&&s.uint32(34).bytes(n.pubKey),null!=n.peerRecordEnvelope&&Object.hasOwnProperty.call(n,"peerRecordEnvelope")&&s.uint32(42).bytes(n.peerRecordEnvelope),s},r.decode=function(n,s){n instanceof hu||(n=hu.create(n));for(var i=void 0===s?n.len:n.pos+s,o=new Gr.Peer;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:o.addresses&&o.addresses.length||(o.addresses=[]),o.addresses.push(Gr.Address.decode(n,n.uint32()));break;case 2:o.protocols&&o.protocols.length||(o.protocols=[]),o.protocols.push(n.string());break;case 3:o.metadata&&o.metadata.length||(o.metadata=[]),o.metadata.push(Gr.Metadata.decode(n,n.uint32()));break;case 4:o.pubKey=n.bytes();break;case 5:o.peerRecordEnvelope=n.bytes();break;default:n.skipType(7&a)}}return o},r.fromObject=function(n){if(n instanceof Gr.Peer)return n;var s=new Gr.Peer;if(n.addresses){if(!Array.isArray(n.addresses))throw TypeError(".Peer.addresses: array expected");s.addresses=[];for(var i=0;i<n.addresses.length;++i){if("object"!=typeof n.addresses[i])throw TypeError(".Peer.addresses: object expected");s.addresses[i]=Gr.Address.fromObject(n.addresses[i])}}if(n.protocols){if(!Array.isArray(n.protocols))throw TypeError(".Peer.protocols: array expected");for(s.protocols=[],i=0;i<n.protocols.length;++i)s.protocols[i]=String(n.protocols[i])}if(n.metadata){if(!Array.isArray(n.metadata))throw TypeError(".Peer.metadata: array expected");for(s.metadata=[],i=0;i<n.metadata.length;++i){if("object"!=typeof n.metadata[i])throw TypeError(".Peer.metadata: object expected");s.metadata[i]=Gr.Metadata.fromObject(n.metadata[i])}}return null!=n.pubKey&&("string"==typeof n.pubKey?Yt.base64.decode(n.pubKey,s.pubKey=Yt.newBuffer(Yt.base64.length(n.pubKey)),0):n.pubKey.length&&(s.pubKey=n.pubKey)),null!=n.peerRecordEnvelope&&("string"==typeof n.peerRecordEnvelope?Yt.base64.decode(n.peerRecordEnvelope,s.peerRecordEnvelope=Yt.newBuffer(Yt.base64.length(n.peerRecordEnvelope)),0):n.peerRecordEnvelope.length&&(s.peerRecordEnvelope=n.peerRecordEnvelope)),s},r.toObject=function(n,s){s||(s={});var i={};if((s.arrays||s.defaults)&&(i.addresses=[],i.protocols=[],i.metadata=[]),n.addresses&&n.addresses.length){i.addresses=[];for(var o=0;o<n.addresses.length;++o)i.addresses[o]=Gr.Address.toObject(n.addresses[o],s)}if(n.protocols&&n.protocols.length)for(i.protocols=[],o=0;o<n.protocols.length;++o)i.protocols[o]=n.protocols[o];if(n.metadata&&n.metadata.length)for(i.metadata=[],o=0;o<n.metadata.length;++o)i.metadata[o]=Gr.Metadata.toObject(n.metadata[o],s);return null!=n.pubKey&&n.hasOwnProperty("pubKey")&&(i.pubKey=s.bytes===String?Yt.base64.encode(n.pubKey,0,n.pubKey.length):s.bytes===Array?Array.prototype.slice.call(n.pubKey):n.pubKey,s.oneofs&&(i._pubKey="pubKey")),null!=n.peerRecordEnvelope&&n.hasOwnProperty("peerRecordEnvelope")&&(i.peerRecordEnvelope=s.bytes===String?Yt.base64.encode(n.peerRecordEnvelope,0,n.peerRecordEnvelope.length):s.bytes===Array?Array.prototype.slice.call(n.peerRecordEnvelope):n.peerRecordEnvelope,s.oneofs&&(i._peerRecordEnvelope="peerRecordEnvelope")),i},r.prototype.toJSON=function(){return this.constructor.toObject(this,yt.util.toJSONOptions)},r})(),hM=(Gr.Address=(()=>{function r(t){if(t)for(var n=Object.keys(t),s=0;s<n.length;++s)null!=t[n[s]]&&(this[n[s]]=t[n[s]])}let e;return r.prototype.multiaddr=Yt.newBuffer([]),r.prototype.isCertified=null,Object.defineProperty(r.prototype,"_isCertified",{get:Yt.oneOfGetter(e=["isCertified"]),set:Yt.oneOfSetter(e)}),r.encode=function(n,s){return s||(s=U7.create()),null!=n.multiaddr&&Object.hasOwnProperty.call(n,"multiaddr")&&s.uint32(10).bytes(n.multiaddr),null!=n.isCertified&&Object.hasOwnProperty.call(n,"isCertified")&&s.uint32(16).bool(n.isCertified),s},r.decode=function(n,s){n instanceof hu||(n=hu.create(n));for(var i=void 0===s?n.len:n.pos+s,o=new Gr.Address;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:o.multiaddr=n.bytes();break;case 2:o.isCertified=n.bool();break;default:n.skipType(7&a)}}return o},r.fromObject=function(n){if(n instanceof Gr.Address)return n;var s=new Gr.Address;return null!=n.multiaddr&&("string"==typeof n.multiaddr?Yt.base64.decode(n.multiaddr,s.multiaddr=Yt.newBuffer(Yt.base64.length(n.multiaddr)),0):n.multiaddr.length&&(s.multiaddr=n.multiaddr)),null!=n.isCertified&&(s.isCertified=Boolean(n.isCertified)),s},r.toObject=function(n,s){s||(s={});var i={};return s.defaults&&(s.bytes===String?i.multiaddr="":(i.multiaddr=[],s.bytes!==Array&&(i.multiaddr=Yt.newBuffer(i.multiaddr)))),null!=n.multiaddr&&n.hasOwnProperty("multiaddr")&&(i.multiaddr=s.bytes===String?Yt.base64.encode(n.multiaddr,0,n.multiaddr.length):s.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),null!=n.isCertified&&n.hasOwnProperty("isCertified")&&(i.isCertified=n.isCertified,s.oneofs&&(i._isCertified="isCertified")),i},r.prototype.toJSON=function(){return this.constructor.toObject(this,yt.util.toJSONOptions)},r})(),Gr.Metadata=(()=>{function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.key="",r.prototype.value=Yt.newBuffer([]),r.encode=function(t,n){return n||(n=U7.create()),null!=t.key&&Object.hasOwnProperty.call(t,"key")&&n.uint32(10).string(t.key),null!=t.value&&Object.hasOwnProperty.call(t,"value")&&n.uint32(18).bytes(t.value),n},r.decode=function(t,n){t instanceof hu||(t=hu.create(t));for(var s=void 0===n?t.len:t.pos+n,i=new Gr.Metadata;t.pos<s;){var o=t.uint32();switch(o>>>3){case 1:i.key=t.string();break;case 2:i.value=t.bytes();break;default:t.skipType(7&o)}}return i},r.fromObject=function(t){if(t instanceof Gr.Metadata)return t;var n=new Gr.Metadata;return null!=t.key&&(n.key=String(t.key)),null!=t.value&&("string"==typeof t.value?Yt.base64.decode(t.value,n.value=Yt.newBuffer(Yt.base64.length(t.value)),0):t.value.length&&(n.value=t.value)),n},r.toObject=function(t,n){n||(n={});var s={};return n.defaults&&(s.key="",n.bytes===String?s.value="":(s.value=[],n.bytes!==Array&&(s.value=Yt.newBuffer(s.value)))),null!=t.key&&t.hasOwnProperty("key")&&(s.key=t.key),null!=t.value&&t.hasOwnProperty("value")&&(s.value=n.bytes===String?Yt.base64.encode(t.value,0,t.value.length):n.bytes===Array?Array.prototype.slice.call(t.value):t.value),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,yt.util.toJSONOptions)},r})(),yt.Reader),X9e=yt.Writer,vr=yt.util,r2=yt.roots.default||(yt.roots.default={}),q9e=r2.Envelope=(()=>{function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.publicKey=vr.newBuffer([]),r.prototype.payloadType=vr.newBuffer([]),r.prototype.payload=vr.newBuffer([]),r.prototype.signature=vr.newBuffer([]),r.encode=function(t,n){return n||(n=X9e.create()),null!=t.publicKey&&Object.hasOwnProperty.call(t,"publicKey")&&n.uint32(10).bytes(t.publicKey),null!=t.payloadType&&Object.hasOwnProperty.call(t,"payloadType")&&n.uint32(18).bytes(t.payloadType),null!=t.payload&&Object.hasOwnProperty.call(t,"payload")&&n.uint32(26).bytes(t.payload),null!=t.signature&&Object.hasOwnProperty.call(t,"signature")&&n.uint32(42).bytes(t.signature),n},r.decode=function(t,n){t instanceof hM||(t=hM.create(t));for(var s=void 0===n?t.len:t.pos+n,i=new r2.Envelope;t.pos<s;){var o=t.uint32();switch(o>>>3){case 1:i.publicKey=t.bytes();break;case 2:i.payloadType=t.bytes();break;case 3:i.payload=t.bytes();break;case 5:i.signature=t.bytes();break;default:t.skipType(7&o)}}return i},r.fromObject=function(t){if(t instanceof r2.Envelope)return t;var n=new r2.Envelope;return null!=t.publicKey&&("string"==typeof t.publicKey?vr.base64.decode(t.publicKey,n.publicKey=vr.newBuffer(vr.base64.length(t.publicKey)),0):t.publicKey.length&&(n.publicKey=t.publicKey)),null!=t.payloadType&&("string"==typeof t.payloadType?vr.base64.decode(t.payloadType,n.payloadType=vr.newBuffer(vr.base64.length(t.payloadType)),0):t.payloadType.length&&(n.payloadType=t.payloadType)),null!=t.payload&&("string"==typeof t.payload?vr.base64.decode(t.payload,n.payload=vr.newBuffer(vr.base64.length(t.payload)),0):t.payload.length&&(n.payload=t.payload)),null!=t.signature&&("string"==typeof t.signature?vr.base64.decode(t.signature,n.signature=vr.newBuffer(vr.base64.length(t.signature)),0):t.signature.length&&(n.signature=t.signature)),n},r.toObject=function(t,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.publicKey="":(s.publicKey=[],n.bytes!==Array&&(s.publicKey=vr.newBuffer(s.publicKey))),n.bytes===String?s.payloadType="":(s.payloadType=[],n.bytes!==Array&&(s.payloadType=vr.newBuffer(s.payloadType))),n.bytes===String?s.payload="":(s.payload=[],n.bytes!==Array&&(s.payload=vr.newBuffer(s.payload))),n.bytes===String?s.signature="":(s.signature=[],n.bytes!==Array&&(s.signature=vr.newBuffer(s.signature)))),null!=t.publicKey&&t.hasOwnProperty("publicKey")&&(s.publicKey=n.bytes===String?vr.base64.encode(t.publicKey,0,t.publicKey.length):n.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),null!=t.payloadType&&t.hasOwnProperty("payloadType")&&(s.payloadType=n.bytes===String?vr.base64.encode(t.payloadType,0,t.payloadType.length):n.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),null!=t.payload&&t.hasOwnProperty("payload")&&(s.payload=n.bytes===String?vr.base64.encode(t.payload,0,t.payload.length):n.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),null!=t.signature&&t.hasOwnProperty("signature")&&(s.signature=n.bytes===String?vr.base64.encode(t.signature,0,t.signature.length):n.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,yt.util.toJSONOptions)},r})(),n2=yt.Reader,pM=yt.Writer,Fr=yt.util,Li=yt.roots.default||(yt.roots.default={}),exe=Li.PeerRecord=(()=>{function r(e){if(this.addresses=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.peerId=Fr.newBuffer([]),r.prototype.seq=Fr.Long?Fr.Long.fromBits(0,0,!0):0,r.prototype.addresses=Fr.emptyArray,r.encode=function(t,n){if(n||(n=pM.create()),null!=t.peerId&&Object.hasOwnProperty.call(t,"peerId")&&n.uint32(10).bytes(t.peerId),null!=t.seq&&Object.hasOwnProperty.call(t,"seq")&&n.uint32(16).uint64(t.seq),null!=t.addresses&&t.addresses.length)for(var s=0;s<t.addresses.length;++s)Li.PeerRecord.AddressInfo.encode(t.addresses[s],n.uint32(26).fork()).ldelim();return n},r.decode=function(t,n){t instanceof n2||(t=n2.create(t));for(var s=void 0===n?t.len:t.pos+n,i=new Li.PeerRecord;t.pos<s;){var o=t.uint32();switch(o>>>3){case 1:i.peerId=t.bytes();break;case 2:i.seq=t.uint64();break;case 3:i.addresses&&i.addresses.length||(i.addresses=[]),i.addresses.push(Li.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(7&o)}}return i},r.fromObject=function(t){if(t instanceof Li.PeerRecord)return t;var n=new Li.PeerRecord;if(null!=t.peerId&&("string"==typeof t.peerId?Fr.base64.decode(t.peerId,n.peerId=Fr.newBuffer(Fr.base64.length(t.peerId)),0):t.peerId.length&&(n.peerId=t.peerId)),null!=t.seq&&(Fr.Long?(n.seq=Fr.Long.fromValue(t.seq)).unsigned=!0:"string"==typeof t.seq?n.seq=parseInt(t.seq,10):"number"==typeof t.seq?n.seq=t.seq:"object"==typeof t.seq&&(n.seq=new Fr.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");n.addresses=[];for(var s=0;s<t.addresses.length;++s){if("object"!=typeof t.addresses[s])throw TypeError(".PeerRecord.addresses: object expected");n.addresses[s]=Li.PeerRecord.AddressInfo.fromObject(t.addresses[s])}}return n},r.toObject=function(t,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addresses=[]),n.defaults)if(n.bytes===String?s.peerId="":(s.peerId=[],n.bytes!==Array&&(s.peerId=Fr.newBuffer(s.peerId))),Fr.Long){var i=new Fr.Long(0,0,!0);s.seq=n.longs===String?i.toString():n.longs===Number?i.toNumber():i}else s.seq=n.longs===String?"0":0;if(null!=t.peerId&&t.hasOwnProperty("peerId")&&(s.peerId=n.bytes===String?Fr.base64.encode(t.peerId,0,t.peerId.length):n.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),null!=t.seq&&t.hasOwnProperty("seq")&&(s.seq="number"==typeof t.seq?n.longs===String?String(t.seq):t.seq:n.longs===String?Fr.Long.prototype.toString.call(t.seq):n.longs===Number?new Fr.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){s.addresses=[];for(var o=0;o<t.addresses.length;++o)s.addresses[o]=Li.PeerRecord.AddressInfo.toObject(t.addresses[o],n)}return s},r.prototype.toJSON=function(){return this.constructor.toObject(this,yt.util.toJSONOptions)},r.AddressInfo=function(){function e(t){if(t)for(var n=Object.keys(t),s=0;s<n.length;++s)null!=t[n[s]]&&(this[n[s]]=t[n[s]])}return e.prototype.multiaddr=Fr.newBuffer([]),e.encode=function(n,s){return s||(s=pM.create()),null!=n.multiaddr&&Object.hasOwnProperty.call(n,"multiaddr")&&s.uint32(10).bytes(n.multiaddr),s},e.decode=function(n,s){n instanceof n2||(n=n2.create(n));for(var i=void 0===s?n.len:n.pos+s,o=new Li.PeerRecord.AddressInfo;n.pos<i;){var a=n.uint32();a>>>3==1?o.multiaddr=n.bytes():n.skipType(7&a)}return o},e.fromObject=function(n){if(n instanceof Li.PeerRecord.AddressInfo)return n;var s=new Li.PeerRecord.AddressInfo;return null!=n.multiaddr&&("string"==typeof n.multiaddr?Fr.base64.decode(n.multiaddr,s.multiaddr=Fr.newBuffer(Fr.base64.length(n.multiaddr)),0):n.multiaddr.length&&(s.multiaddr=n.multiaddr)),s},e.toObject=function(n,s){s||(s={});var i={};return s.defaults&&(s.bytes===String?i.multiaddr="":(i.multiaddr=[],s.bytes!==Array&&(i.multiaddr=Fr.newBuffer(i.multiaddr)))),null!=n.multiaddr&&n.hasOwnProperty("multiaddr")&&(i.multiaddr=s.bytes===String?Fr.base64.encode(n.multiaddr,0,n.multiaddr.length):s.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,yt.util.toJSONOptions)},e}(),r})();function M7(){return M7=(0,B.Z)(function*(r,e=(()=>{})){e(0,"Storing each peerstore key under a single datastore key"),yield r.datastore.open();const t={},n=[];var o,s=!1,i=!1;try{for(var c,a=be(r.datastore.query({prefix:"/peers"}));s=!(c=yield a.next()).done;s=!1){const{key:u,value:f}=c.value;n.push(u);const E=u.toString(),[,T,U,b,P]=E.split("/");if("peers"===T&&["protos","addrs","metadata","keys"].includes(U)&&b)if(t[b]=t[b]||{addresses:[],protocols:[],metadata:[]},"protos"===U){const F=uM.decode(f);t[b].protocols=F.protocols.sort()}else if("addrs"===U){const F=dM.decode(f);t[b].addresses=F.addrs.sort((M,H)=>at(M.multiaddr).toString().localeCompare(at(H.multiaddr).toString())),F.certifiedRecord&&F.certifiedRecord.raw&&(t[b].peerRecordEnvelope=F.certifiedRecord.raw)}else"metadata"===U?t[b].metadata.push({key:P,value:f}):"keys"===U&&(t[b].pubKey=f)}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield a.return())}finally{if(i)throw o}}e(33,"Read peer data from store");for(const u of n)yield r.datastore.delete(u);e(66,"Removed existing peer data from store");for(const u of Object.keys(t)){const f=t[u];f.metadata=f.metadata.sort((T,U)=>T.key.localeCompare(U.key));const E=fM.encode(f).finish();yield r.datastore.put(new ft(`/peers/${u}`),E)}yield r.datastore.close(),e(100,"Stored each peerstore key under a single datastore key")}),M7.apply(this,arguments)}function F7(){return F7=(0,B.Z)(function*(r,e=(()=>{})){e(0,"Storing each peerstore key under a multiple datastore keys"),yield r.datastore.open();const t={},n=[];var o,s=!1,i=!1;try{for(var c,a=be(r.datastore.query({prefix:"/peers"}));s=!(c=yield a.next()).done;s=!1){const{key:u,value:f}=c.value;n.push(u);const E=u.toString(),[,,T]=E.split("/");t[T]=fM.decode(f)}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield a.return())}finally{if(i)throw o}}e(33,"Read peer data from store");for(const u of n)yield r.datastore.delete(u);e(66,"Removed existing peer data from store");for(const[u,f]of Object.entries(t)){if(f.protocols&&f.protocols.length>0&&(yield r.datastore.put(new ft(`/peers/protos/${u}`),uM.encode({protocols:f.protocols}).finish())),f.addresses&&f.addresses.length>0){const E=f.peerRecordEnvelope;let T;if(E){const U=q9e.decode(E);T={raw:E,seq:exe.decode(U.payload).seq}}yield r.datastore.put(new ft(`/peers/addrs/${u}`),dM.encode({addrs:f.addresses,certifiedRecord:T}).finish())}if(f.metadata&&f.metadata.length>0)for(const{key:E,value:T}of f.metadata)yield r.datastore.put(new ft(`/peers/metadata/${u}/${E}`),T);f.pubKey&&(yield r.datastore.put(new ft(`/peers/keys/${u}`),f.pubKey))}yield r.datastore.close(),e(100,"Stored each peerstore key under multiple datastore keys")}),F7.apply(this,arguments)}yt.util.Long=void 0,yt.configure();const nxe={version:12,description:"Store each peerstore peer under a single datastore key",migrate:function txe(r){return M7.apply(this,arguments)},revert:function rxe(r){return F7.apply(this,arguments)}},Gc={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},z7=[Object.assign({version:1},Gc),Object.assign({version:2},Gc),Object.assign({version:3},Gc),Object.assign({version:4},Gc),Object.assign({version:5},Gc),Object.assign({version:6},Gc),Object.assign({version:7},Gc),r9e,z9e,H9e,Y9e,nxe];let sxe=(()=>{class r extends Error{constructor(t){super(t),this.name="NonReversibleMigrationError",this.code=r.code,this.message=t}}return r.code="ERR_NON_REVERSIBLE_MIGRATION",r})(),yM=(()=>{class r extends Error{constructor(t){super(t),this.name="NotInitializedRepoError",this.code=r.code,this.message=t}}return r.code="ERR_NOT_INITIALIZED_REPO",r})(),ixe=(()=>{class r extends Error{constructor(t){super(t),this.name="RequiredParameterError",this.code=r.code,this.message=t}}return r.code="ERR_REQUIRED_PARAMETER",r})(),oxe=(()=>{class r extends Error{constructor(t){super(t),this.name="InvalidValueError",this.code=r.code,this.message=t}}return r.code="ERR_INVALID_VALUE",r})(),V7=(()=>{class r extends Error{constructor(t){super(t),this.name="MissingRepoOptionsError",this.code=r.code,this.message=t}}return r.code="ERR_MISSING_REPO_OPTIONS",r})();const j7=Br("ipfs:repo:migrator:repo:init");function axe(r){return $7.apply(this,arguments)}function $7(){return $7=(0,B.Z)(function*(r){if(!r)throw new V7("Please pass repo options when trying to open a repo");const e=r.root;try{yield e.open();const t=yield e.has(I7),n=yield e.has(V9e);return!(!t||!n)||(j7(`Version entry present: ${t}`),j7(`Config entry present: ${n}`),!1)}catch(t){return j7("While checking if repo is initialized error was thrown: "+t.message),!1}finally{if(void 0!==e)try{yield e.close()}catch{}}}),$7.apply(this,arguments)}function K7(r){return Z7.apply(this,arguments)}function Z7(){return Z7=(0,B.Z)(function*(r){if(!(yield axe(r)))throw new yM("Repo is not initialized!");const e=r.root;yield e.open();try{return parseInt(m7(yield e.get(I7)))}finally{yield e.close()}}),Z7.apply(this,arguments)}function s2(r,e){return H7.apply(this,arguments)}function H7(){return H7=(0,B.Z)(function*(r,e){if(!e)throw new V7("Please pass repo options when trying to open a repo");const t=e.root;yield t.open(),yield t.put(I7,v7(String(r))),yield t.close()}),H7.apply(this,arguments)}const ki=Br("ipfs:repo:migrator");function cxe(r){return r=r||z7,Array.isArray(r)&&0!==r.length?r[r.length-1].version:0}function G7(){return G7=(0,B.Z)(function*(r,e,t,n,s={}){var i,o,a;const c=null!==(i=s.ignoreLock)&&void 0!==i&&i,u=s.onProgress,f=null!==(o=s.isDryRun)&&void 0!==o&&o,E=null!==(a=s.migrations)&&void 0!==a?a:z7;if(!r)throw new ui.RequiredParameterError("Path argument is required!");if(!t)throw new ui.RequiredParameterError("repoOptions argument is required!");if(!n)throw new ui.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(n)||n<=0)throw new ui.InvalidValueError("Version has to be positive integer!");e=iM(e);const T=yield K7(e);if(T===n)return void ki("Nothing to migrate.");if(T>n)throw new ui.InvalidValueError(`Current repo's version (${T}) is higher then toVersion (${n}), you probably wanted to revert it?`);let U;gM(E,T,n),!f&&!c&&(U=yield t.repoLock.lock(r));try{for(const b of E){if(void 0!==n&&b.version>n)break;if(!(b.version<=T)){ki(`Migrating version ${b.version}`);try{if(!f){let P=()=>{};u&&(P=(F,M)=>u(b.version,F.toFixed(2),M)),yield b.migrate(e,P)}}catch(P){const F=b.version-1;throw ki(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${F}`),yield s2(F,e),new Error(`During migration to version ${b.version} exception was raised: ${P.stack||P.message||P}`)}ki(`Migrating to version ${b.version} finished`)}}f||(yield s2(n||cxe(E),e)),ki("Repo successfully migrated",void 0!==n?`to version ${n}!`:"to latest version!")}finally{!f&&!c&&U&&(yield U.close())}}),G7.apply(this,arguments)}function W7(){return W7=(0,B.Z)(function*(r,e,t,n,s={}){var i,o,a;const c=null!==(i=s.ignoreLock)&&void 0!==i&&i,u=s.onProgress,f=null!==(o=s.isDryRun)&&void 0!==o&&o,E=null!==(a=s.migrations)&&void 0!==a?a:z7;if(!r)throw new ui.RequiredParameterError("Path argument is required!");if(!t)throw new ui.RequiredParameterError("repoOptions argument is required!");if(!n)throw new ui.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(n)||n<=0)throw new ui.InvalidValueError("Version has to be positive integer!");e=iM(e);const T=yield K7(e);if(T===n)return void ki("Nothing to revert.");if(T<n)throw new ui.InvalidValueError(`Current repo's version (${T}) is lower then toVersion (${n}), you probably wanted to migrate it?`);let U;gM(E,n,T,!0),!f&&!c&&(U=yield t.repoLock.lock(r)),ki(`Reverting from version ${T} to ${n}`);try{const b=E.slice().reverse();for(const P of b){if(P.version<=n)break;if(!(P.version>T)){ki(`Reverting migration version ${P.version}`);try{if(!f){let F=()=>{};u&&(F=(M,H)=>u(P.version,M.toFixed(2),H)),yield P.revert(e,F)}}catch(F){const M=P.version;throw ki(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${M}`),yield s2(M,e),F.message=`During reversion to version ${P.version} exception was raised: ${F.message}`,F}ki(`Reverting to version ${P.version} finished`)}}f||(yield s2(n,e)),ki(`All migrations successfully reverted to version ${n}!`)}finally{!f&&!c&&U&&(yield U.close())}}),W7.apply(this,arguments)}function gM(r,e,t,n=!1){let s=0;for(const i of r){if(i.version>t)break;if(i.version>e){if(n&&!i.revert)throw new ui.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${i.version} is not reversible. Cancelling reversion.`);s++}}if(s!==t-e)throw new ui.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${t}`)}const ui=e_;var dxe=p(80300);const yxe=function fxe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},pu=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class vxe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class wxe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return bM(this,e)}}class Exe{constructor(e){this.decoders=e}or(e){return bM(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const bM=(r,e)=>new Exe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class xxe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new vxe(e,t,n),this.decoder=new wxe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const i2=({name:r,prefix:e,encode:t,decode:n})=>new xxe(r,e,t,n),Nh=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=yxe(t,e);return i2({prefix:r,name:e,encode:n,decode:i=>pu(s(i))})},kn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>i2({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),Txe=i2({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),Cxe=kn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Ixe=kn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Rxe=Nh({prefix:"9",name:"base10",alphabet:"0123456789"}),Dxe=kn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Oxe=kn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Vo=kn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Pxe=kn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Nxe=kn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Bxe=kn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Lxe=kn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),kxe=kn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Uxe=kn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Mxe=kn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Fxe=kn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),zxe=Nh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Vxe=Nh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),jo=Nh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),jxe=Nh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),$xe=kn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Kxe=kn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Zxe=kn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Hxe=kn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),_M=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),Gxe=_M.reduce((r,e,t)=>(r[t]=e,r),[]),Wxe=_M.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),Jxe=i2({prefix:"\u{1f680}",name:"base256emoji",encode:function Yxe(r){return r.reduce((e,t)=>e+Gxe[t],"")},decode:function Qxe(r){const e=[];for(const t of r){const n=Wxe[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var tSe=Math.pow(2,31),sSe=Math.pow(2,7),iSe=Math.pow(2,14),oSe=Math.pow(2,21),aSe=Math.pow(2,28),cSe=Math.pow(2,35),lSe=Math.pow(2,42),uSe=Math.pow(2,49),dSe=Math.pow(2,56),fSe=Math.pow(2,63),pSe={encode:function vM(r,e,t){e=e||[];for(var n=t=t||0;r>=tSe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,vM.bytes=t-n+1,e},decode:function Y7(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw Y7.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return Y7.bytes=i-n,t},encodingLength:function(r){return r<sSe?1:r<iSe?2:r<oSe?3:r<aSe?4:r<cSe?5:r<lSe?6:r<uSe?7:r<dSe?8:r<fSe?9:10}};const o2=pSe,Q7=(r,e=0)=>[o2.decode(r,e),o2.decode.bytes],a2=(r,e,t=0)=>(o2.encode(r,e,t),e),c2=r=>o2.encodingLength(r),l2=(r,e)=>{const t=e.byteLength,n=c2(r),s=n+c2(t),i=new Uint8Array(s+t);return a2(r,i,0),a2(t,i,n),i.set(e,s),new J7(r,t,e,i)},EM=r=>{const e=pu(r),[t,n]=Q7(e),[s,i]=Q7(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new J7(t,s,o,e)};class J7{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const xM=({name:r,code:e,encode:t})=>new bSe(r,e,t);class bSe{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?l2(this.code,t):t.then(n=>l2(this.code,n))}throw Error("Unknown type, must be binary type")}}const SM=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),_Se=xM({name:"sha2-256",code:18,encode:SM("SHA-256")}),mSe=xM({name:"sha2-512",code:19,encode:SM("SHA-512")}),TM=pu,CM={code:0,name:"identity",encode:TM,digest:r=>l2(0,TM(r))},wSe="raw",ESe=85,xSe=r=>pu(r),SSe=r=>pu(r),ASe=new TextEncoder,TSe=new TextDecoder,CSe="json",ISe=512,RSe=r=>ASe.encode(JSON.stringify(r)),DSe=r=>JSON.parse(TSe.decode(r)),IM=new WeakMap,X7=r=>{const e=IM.get(r);if(null==e){const t=new Map;return IM.set(r,t),t}return e};class or{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Bh)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==LSe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return or.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=l2(e,t);return or.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return or.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?NSe(t,X7(r),e||jo.encoder):BSe(t,X7(r),e||Vo.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof or)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new or(n,s,i,o||RM(n,s,i.bytes))}if(!0===t[kSe]){const{version:n,multihash:s,code:i}=t,o=EM(s);return or.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Bh)throw new Error(`Version 0 CID must use dag-pb (code: ${Bh}) block encoding`);return new or(e,t,n,n.bytes);case 1:{const s=RM(e,t,n.bytes);return new or(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return or.create(0,Bh,e)}static createV1(e,t){return or.create(1,e,t)}static decode(e){const[t,n]=or.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=or.inspectBytes(e),n=t.size-t.multihashSize,s=pu(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new J7(t.multihashCode,t.digestSize,i,s);return[0===t.version?or.createV0(o):or.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=Q7(e.subarray(t));return t+=T,E};let s=n(),i=Bh;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=PSe(e,t),i=or.decode(s);return X7(i).set(n,e),i}}const PSe=(r,e)=>{switch(r[0]){case"Q":return[jo.prefix,(e||jo).decode(`${jo.prefix}${r}`)];case jo.prefix:return[jo.prefix,(e||jo).decode(r)];case Vo.prefix:return[Vo.prefix,(e||Vo).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},NSe=(r,e,t)=>{const{prefix:n}=t;if(n!==jo.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},BSe=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},Bh=112,LSe=18,RM=(r,e,t)=>{const n=c2(r),s=n+c2(e),i=new Uint8Array(s+t.byteLength);return a2(r,i,0),a2(e,i,n),i.set(t,s),i},kSe=Symbol.for("@ipld/js-cid/CID"),DM={...t_,...r_,...n_,...s_,...i_,...o_,...a_,...c_,...l_,...u_};function OM(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function PM(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const NM=PM("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),q7=PM("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function USe(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?OM(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),BM={utf8:NM,"utf-8":NM,hex:DM.base16,latin1:q7,ascii:q7,binary:q7,...DM};function e9(r,e="utf8"){const t=BM[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}function u2(r,e="utf8"){const t=BM[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):OM(globalThis.Buffer.from(r,"utf-8"))}let MSe=(()=>{class r extends Error{constructor(t){super(t),this.name="LockExistsError",this.code=r.code}}return r.code="ERR_LOCK_EXISTS",r})(),Lh=(()=>{class r extends Error{constructor(t){super(t),this.name="NotFoundError",this.code=r.code}}return r.code="ERR_NOT_FOUND",r})(),FSe=(()=>{class r extends Error{constructor(t){super(t),this.name="InvalidRepoVersionError",this.code=r.code}}return r.code="ERR_INVALID_REPO_VERSION",r})();const kh="ERR_REPO_NOT_INITIALIZED";function LM(r,e,t){return t9.apply(this,arguments)}function t9(){return t9=(0,B.Z)(function*(r,e,t){const n=yield e(r);if(n)return n;const s=UM(t);return!!s&&new Promise((i,o)=>{const a=s.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{i(Boolean(a.result))}})}),t9.apply(this,arguments)}function kM(r,e,t,n){return r9.apply(this,arguments)}function r9(){return r9=(0,B.Z)(function*(r,e,t,n){if(yield t(r))return e(r);const s=UM(n);if(!s)throw new Lh;return new Promise((i,o)=>{const a=s.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return i(a.result);o(new Lh)}})}),r9.apply(this,arguments)}function UM(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,"level-js"===e.type||"Level"===e.constructor.name)return e}const jSe=Br("ipfs:repo:version"),n9=new ft("version"),KSe=an.default?an.default:an,s9=new ft("config");function i9(r){if("object"!=typeof r||null===r)return!1;const e=Object.getPrototypeOf(r);return!(null!==e&&e!==Object.prototype&&null!==Object.getPrototypeOf(e)||Symbol.toStringTag in r||Symbol.iterator in r)}const o9=new ft("datastore_spec");const a9=new ft("api");function Xa(r){const e=or.asCID(r);if(null==e)throw ee(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==CM.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}const MM=Br("ipfs:repo:lock:memory"),FM="repo.lock",Uh={};function c9(){return c9=(0,B.Z)(function*(r){const e=r+"/"+FM;if(MM("locking %s",e),!0===Uh[e])throw new MSe(`Lock already being held for file: ${e}`);return Uh[e]=!0,{close:()=>(0,B.Z)(function*(){Uh[e]&&delete Uh[e]})()}}),c9.apply(this,arguments)}function l9(){return l9=(0,B.Z)(function*(r){const e=r+"/"+FM;return MM(`checking lock: ${e}`),Boolean(Uh[e])}),l9.apply(this,arguments)}const zM={lock:function QSe(r){return c9.apply(this,arguments)},locked:function JSe(r){return l9.apply(this,arguments)}},XSe={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:zM},VM={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};function d2({enumerable:r=!0,configurable:e=!1}={}){return{enumerable:r,configurable:e,writable:!1}}function*qSe(r,e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))for(const[t,n]of e.entries()){const s=[...r,t],i=or.asCID(n);i?yield[s.join("/"),i]:"object"==typeof n&&(yield*u9(n,s))}else{const t=or.asCID(e);t?yield[r.join("/"),t]:yield*u9(e,r)}}function*u9(r,e){if(!(null==r||r instanceof Uint8Array))for(const[t,n]of Object.entries(r)){const s=[...e,t];yield*qSe(s,n)}}function*eAe(r,e){if(Array.isArray(e))for(const[t,n]of e.entries()){const s=[...r,t];yield s.join("/"),"object"==typeof n&&!or.asCID(n)&&(yield*d9(n,s))}else yield*d9(e,r)}function*d9(r,e){if(null!=r&&"object"==typeof r)for(const[t,n]of Object.entries(r)){const s=[...e,t];yield s.join("/"),null!=n&&!(n instanceof Uint8Array)&&"object"==typeof n&&!or.asCID(n)&&(yield*eAe(s,n))}}class f9{constructor({cid:e,bytes:t,value:n}){if(!e||!t||typeof n>"u")throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=n,this.asBlock=this,Object.defineProperties(this,{cid:d2(),bytes:d2(),value:d2(),asBlock:d2()})}links(){return u9(this.value,[])}tree(){return d9(this.value,[])}get(e="/"){return function tAe(r,e){let t=r;for(const[n,s]of e.entries()){if(t=t[s],null==t)throw new Error(`Object has no property at ${e.slice(0,n+1).map(o=>`[${JSON.stringify(o)}]`).join("")}`);const i=or.asCID(t);if(i)return{value:i,remaining:e.slice(n+1).join("/")}}return{value:t}}(this.value,e.split("/").filter(Boolean))}}function y9({bytes:r,cid:e,value:t,codec:n}){const s=void 0!==t?t:n&&n.decode(r);if(void 0===s)throw new Error('Missing required argument, must either provide "value" or "codec"');return new f9({cid:e,bytes:r,value:s})}function f2(r){const e=or.asCID(r);if(null==e)throw ee(new Error("Not a valid cid"),"ERR_INVALID_CID");const t=Vo.encode(e.multihash.bytes);return new ft("/"+t.slice(1).toUpperCase(),!1)}function b9(r){return EM(Vo.decode(`b${r.toString().toLowerCase().substring(1)}`))}const rAe=Br("ipfs:repo:utils:walk-dag");function h2(r,e,t,n){return _9.apply(this,arguments)}function _9(){return _9=Ee(function*(r,e,t,n){try{const o=y9({bytes:yield X(e.get(r,n)),cid:r,codec:yield X(t(r.code))});for(const[,a]of o.links())yield a,yield*Fe(be(h2(a,e,t,n)),X)}catch(s){throw rAe("Could not walk DAG for CID",r.toString(),s),s}}),_9.apply(this,arguments)}class nAe extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof e.maxAge&&0===e.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if("function"==typeof this.onEviction)for(const[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return"number"==typeof t.expiry&&t.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}_getOrDeleteIfExpired(e,t){if(!1===this._deleteIfExpired(e,t))return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||!1===this._deleteIfExpired(t,n)&&(yield e)}for(const e of this.cache){const[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:n=this.maxAge}={}){const s="number"==typeof n&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:s}):this._set(e,{value:t,expiry:s})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}peek(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const n=e[t],[s,i]=n;!1===this._deleteIfExpired(s,i)&&(yield[s,i.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const n=e[t],[s,i]=n;this.cache.has(s)||!1===this._deleteIfExpired(s,i)&&(yield[s,i.value])}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[n,s]of this.entriesAscending())e.call(t,s,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}class oAe{constructor({pinstore:e,blockstore:t,loadCodec:n}){this.pinstore=e,this.blockstore=t,this.loadCodec=n,this.log=Br("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}pinDirectly(e,t={}){var n=this;return(0,B.Z)(function*(){yield n.blockstore.get(e,t);const s={depth:0};return 0!==e.version&&(s.version=e.version),e.code!==gr&&(s.codec=e.code),t.metadata&&(s.metadata=t.metadata),n.pinstore.put(f2(e),bl(s))})()}unpin(e,t){return this.pinstore.delete(f2(e),t)}pinRecursively(e,t={}){var n=this;return(0,B.Z)(function*(){yield n.fetchCompleteDag(e,t);const s={depth:1/0};0!==e.version&&(s.version=e.version),e.code!==gr&&(s.codec=e.code),t.metadata&&(s.metadata=t.metadata),yield n.pinstore.put(f2(e),bl(s))})()}directKeys(e){var t=this;return Ee(function*(){var i,n=!1,s=!1;try{for(var a,o=be(t.pinstore.query({filters:[c=>0===Hi(c.value).depth]}));n=!(a=yield X(o.next())).done;n=!1){const c=a.value,u=Hi(c.value),f=u.version||0,E=null!=u.codec?u.codec:gr,T=b9(c.key);yield{cid:or.create(f,E,T),metadata:u.metadata}}}catch(c){s=!0,i=c}finally{try{n&&null!=o.return&&(yield X(o.return()))}finally{if(s)throw i}}})()}recursiveKeys(e){var t=this;return Ee(function*(){var i,n=!1,s=!1;try{for(var a,o=be(t.pinstore.query({filters:[c=>Hi(c.value).depth===1/0]}));n=!(a=yield X(o.next())).done;n=!1){const c=a.value,u=Hi(c.value),f=u.version||0,E=null!=u.codec?u.codec:gr,T=b9(c.key);yield{cid:or.create(f,E,T),metadata:u.metadata}}}catch(c){s=!0,i=c}finally{try{n&&null!=o.return&&(yield X(o.return()))}finally{if(s)throw i}}})()}indirectKeys(e){var t=this;return Ee(function*(){var i,n=!1,s=!1;try{for(var a,o=be(t.recursiveKeys());n=!(a=yield X(o.next())).done;n=!1){const{cid:U}=a.value;var f,c=!1,u=!1;try{for(var T,E=be(h2(U,t.blockstore,t.loadCodec,e));c=!(T=yield X(E.next())).done;c=!1){const b=T.value,P=[jt.recursive];(yield X(t.isPinnedWithType(b,P))).pinned||(yield b)}}catch(b){u=!0,f=b}finally{try{c&&null!=E.return&&(yield X(E.return()))}finally{if(u)throw f}}}}catch(U){s=!0,i=U}finally{try{n&&null!=o.return&&(yield X(o.return()))}finally{if(s)throw i}}})()}isPinnedWithType(e,t,n){var s=this;return(0,B.Z)(function*(){Array.isArray(t)||(t=[t]);const i=t.includes(jt.all),o=t.includes(jt.direct),a=t.includes(jt.recursive),c=t.includes(jt.indirect);if(a||o||i){const T=yield Ni(s.pinstore.query({prefix:f2(e).toString(),filters:[U=>{if(i)return!0;const b=Hi(U.value);return t.includes(0===b.depth?jt.direct:jt.recursive)}],limit:1}));if(T){const U=Hi(T.value);return{cid:e,pinned:!0,reason:0===U.depth?jt.direct:jt.recursive,metadata:U.metadata}}}const u=s;function E(){return(E=Ee(function*(T,U){var F,b=!1,P=!1;try{for(var H,M=be(U);b=!(H=yield X(M.next())).done;b=!1){const{cid:q}=H.value;var W,$=!1,V=!1;try{for(var Y,ne=be(h2(q,u.blockstore,u.loadCodec));$=!(Y=yield X(ne.next())).done;$=!1)if(Y.value.equals(T))return void(yield q)}catch(ge){V=!0,W=ge}finally{try{$&&null!=ne.return&&(yield X(ne.return()))}finally{if(V)throw W}}}}catch(q){P=!0,F=q}finally{try{b&&null!=M.return&&(yield X(M.return()))}finally{if(P)throw F}}})).apply(this,arguments)}if(i||c){const T=yield Ni(function f(T,U){return E.apply(this,arguments)}(e,s.recursiveKeys()));if(T)return{cid:e,pinned:!0,reason:jt.indirect,parent:T}}return{cid:e,pinned:!1}})()}fetchCompleteDag(e,t={}){var n=this;return(0,B.Z)(function*(){var s;const i=new nAe({maxSize:null!==(s=t.cidCacheMaxSize)&&void 0!==s?s:2048}),o=function(){var a=(0,B.Z)(function*(c,u){if(i.has(c.toString()))return;i.set(c.toString(),!0);const T=y9({bytes:yield n.blockstore.get(c,u),cid:c,codec:yield n.loadCodec(c.code)});yield Promise.all([...T.links()].map(([,U])=>o(U,u)))});return function(u,f){return a.apply(this,arguments)}}();yield o(e,t)})()}static checkPinType(e){if("string"!=typeof e||!Object.keys(jt).includes(e))throw function iAe(r){return ee(new Error(`Invalid type '${r}', must be one of {direct, indirect, recursive, all}`),"ERR_INVALID_PIN_TYPE")}(e);return!0}}function jM(r,e){return m9.apply(this,arguments)}function m9(){return m9=(0,B.Z)(function*(r,e){const{pinned:t,reason:n}=yield e.isPinnedWithType(r,jt.all);if(t)throw ee(new Error(`pinned: ${n}`),"ERR_BLOCK_PINNED")}),m9.apply(this,arguments)}function cAe(r){return v9.apply(this,arguments)}function v9(){return v9=Ee(function*(r,e=1){var s,t=!1,n=!1;try{for(var o,i=be(F1(r,e));t=!(o=yield X(i.next())).done;t=!1){const c=o.value.map(function(){var u=(0,B.Z)(function*(f){return yield f().then(E=>({ok:!0,value:E}),E=>({ok:!1,err:E}))});return function(f){return u.apply(this,arguments)}}());for(let u=0;u<c.length;u++){const f=yield X(c[u]);if(!f.ok)throw f.err;yield f.value}}}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield X(i.return()))}finally{if(n)throw s}}}),v9.apply(this,arguments)}function Xs(){return w9.apply(this,arguments)}function w9(){return w9=Ee(function*(...r){const e=ss({objectMode:!0});Promise.resolve().then((0,B.Z)(function*(){try{yield Promise.all(r.map(function(){var t=(0,B.Z)(function*(n){var o,s=!1,i=!1;try{for(var c,a=be(n);s=!(c=yield a.next()).done;s=!1)e.push(c.value)}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield a.return())}finally{if(i)throw o}}});return function(n){return t.apply(this,arguments)}}())),e.end()}catch(t){e.end(t)}})),yield*Fe(be(e),X)}),w9.apply(this,arguments)}const Mh=Br("ipfs:repo:gc"),lAe=Wi().code,dAe=new ft("/local/filesroot");function hAe(r){return E9.apply(this,arguments)}function E9(){return E9=(0,B.Z)(function*({pins:r,blockstore:e,loadCodec:t,root:n}){const s=Ee(function*(){let T;try{T=yield X(n.get(dAe))}catch(b){if(b.code===lAe)return void Mh("No blocks in MFS");throw b}const U=or.decode(T);yield U,yield*Fe(be(h2(U,e,t)),X)})(),i=Xs(os(r.recursiveKeys(),({cid:T})=>T),r.indirectKeys(),os(r.directKeys(),({cid:T})=>T),s),o=new Set;var u,a=!1,c=!1;try{for(var E,f=be(Xs(i,s));a=!(E=yield f.next()).done;a=!1)o.add(Vo.encode(E.value.multihash.bytes))}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield f.return())}finally{if(c)throw u}}return o}),E9.apply(this,arguments)}function pAe(r,e,t){return x9.apply(this,arguments)}function x9(){return x9=Ee(function*({blockstore:r},e,t){let n=0,s=0;yield*Fe(be(_t(cAe(os(t,function(){var o=(0,B.Z)(function*(a){return function(){var c=(0,B.Z)(function*(){n++;try{const f=Vo.encode(a.multihash.bytes);if(e.has(f))return null;try{yield r.delete(a),s++}catch(E){return{err:new Error(`Could not delete block with CID ${a}: ${E.message}`)}}return{cid:a}}catch(f){const E=`Could delete block with CID ${a}`;return Mh(E,f),{err:new Error(E+`: ${f.message}`)}}});return function u(){return c.apply(this,arguments)}}()});return function(c){return o.apply(this,arguments)}}()),256),o=>Js(o,Boolean))),X),Mh(`Marked set has ${e.size} unique blocks. Blockstore has ${n} blocks. Deleted ${s} blocks.`)}),x9.apply(this,arguments)}const ks=Br("ipfs:repo"),yAe=Number.MAX_SAFE_INTEGER;class bAe{constructor(e,t,n,s){if("string"!=typeof e)throw new Error("missing repo path");if("function"!=typeof t)throw new Error("missing codec loader");this.options=Sr(XSe,s),this.closed=!0,this.path=e,this.root=n.root,this.datastore=n.datastore,this.keys=n.keys;const i=n.blocks;this.pins=new oAe({pinstore:n.pins,blockstore:i,loadCodec:t});const a=function aAe(r,e){return{open:()=>e.open(),close:()=>e.close(),query:(t,n)=>e.query(t,n),queryKeys:(t,n)=>e.queryKeys(t,n),get:(t,n)=>(0,B.Z)(function*(){return e.get(t,n)})(),getMany:(t,n)=>Ee(function*(){yield*Fe(be(e.getMany(t,n)),X)})(),put:(t,n,s)=>(0,B.Z)(function*(){yield e.put(t,n,s)})(),putMany:(t,n)=>Ee(function*(){yield*Fe(be(e.putMany(t,n)),X)})(),has:(t,n)=>e.has(t,n),delete:(t,n)=>(0,B.Z)(function*(){return yield jM(t,r),e.delete(t,n)})(),deleteMany:(t,n)=>e.deleteMany(os(t,function(){var s=(0,B.Z)(function*(i){return yield jM(i,r),i});return function(i){return s.apply(this,arguments)}}()),n),batch:()=>e.batch()}}(this.pins,i);this.blocks=function YSe(r){return{open:()=>r.open(),close:()=>r.close(),query:(e,t)=>r.query(e,t),queryKeys:(e,t)=>r.queryKeys(e,t),get:(e,t)=>(0,B.Z)(function*(){const n=Xa(e);return n.isIdentity?Promise.resolve(n.digest):r.get(e,t)})(),getMany(e,t){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(e);s=!(c=yield X(a.next())).done;s=!1){const u=c.value;yield n.get(u,t)}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()},put:(e,t,n)=>(0,B.Z)(function*(){const{isIdentity:s}=Xa(e);s||(yield r.put(e,t,n))})(),putMany:(e,t)=>Ee(function*(){const n=ss({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)((0,B.Z)(function*(){try{yield Oi(r.putMany(Ee(function*(){var a,i=!1,o=!1;try{for(var u,c=be(e);i=!(u=yield X(c.next())).done;i=!1){const{key:f,value:E}=u.value;Xa(f).isIdentity||(yield{key:f,value:E}),n.push({key:f,value:E})}}catch(f){o=!0,a=f}finally{try{i&&null!=c.return&&(yield X(c.return()))}finally{if(o)throw a}}})())),n.end()}catch(i){n.end(i)}})),yield*Fe(be(n),X)})(),has(e,t){const{isIdentity:n}=Xa(e);return n?Promise.resolve(!0):r.has(e,t)},delete(e,t){const{isIdentity:n}=Xa(e);return n?Promise.resolve():r.delete(e,t)},deleteMany:(e,t)=>r.deleteMany(Js(e,n=>!Xa(n).isIdentity),t),batch(){const e=r.batch();return{put(t,n){const{isIdentity:s}=Xa(t);s||e.put(t,n)},delete(t){const{isIdentity:n}=Xa(t);n||e.delete(t)},commit:t=>e.commit(t)}}}}(a),this.version=function $Se(r){return{exists:()=>(0,B.Z)(function*(){return LM(n9,r.has.bind(r),r)})(),get:()=>(0,B.Z)(function*(){const e=yield kM(n9,r.get.bind(r),r.has.bind(r),r);return parseInt(e9(e),10)})(),set:e=>r.put(n9,u2(String(e))),check(e){var t=this;return(0,B.Z)(function*(){const n=yield t.get();return jSe("comparing version: %s and %s",n,e),n===e||6===n&&7===e||6===e&&7===n})()}}}(this.root),this.config=function ZSe(r){const e=new KSe({concurrency:1}),t={getAll:(o={})=>(0,B.Z)(function*(){const a=yield kM(s9,r.get.bind(r),r.has.bind(r),r);return JSON.parse(e9(a))})(),get(o,a={}){var c=this;return(0,B.Z)(function*(){if(null==o)throw new Lh(`Key ${o} does not exist in config`);const u=yield c.getAll(a),f=a7(u,o);if(void 0===f)throw new Lh(`Key ${o} does not exist in config`);return f})()},set(o,a,c={}){if("string"!=typeof o&&!(o instanceof String))throw ee(new Error("Invalid key type: "+typeof o),"ERR_INVALID_KEY");if(void 0===a||a instanceof Uint8Array)throw ee(new Error("Invalid value type: "+typeof a),"ERR_INVALID_VALUE");return e.add(()=>n({key:o,value:a},c.signal))},replace(o,a={}){if(!o||o instanceof Uint8Array)throw ee(new Error("Invalid value type: "+typeof o),"ERR_INVALID_VALUE");return e.add(()=>n({key:void 0,value:o},a.signal))},exists:()=>(0,B.Z)(function*(){return LM(s9,r.has.bind(r),r)})()};return t;function n(o,a){return s.apply(this,arguments)}function s(){return(s=(0,B.Z)(function*(o,a){if(a&&a.aborted)return;const c=o.key,u=o.value;if(c){const f=yield t.getAll();return"object"==typeof f&&null!==f&&Mr(f,c,u),i(f)}return i(u)})).apply(this,arguments)}function i(o){const a=u2(JSON.stringify(o,null,2));return r.put(s9,a)}}(this.root),this.spec=function GSe(r){return{exists:()=>r.has(o9),get:()=>(0,B.Z)(function*(){const e=yield r.get(o9);return JSON.parse(e9(e))})(),set:e=>(0,B.Z)(function*(){return r.put(o9,u2(JSON.stringify(function HSe(r,e={}){if(!i9(r)&&!Array.isArray(r))throw new TypeError("Expected a plain object or array");const{deep:t,compare:n}=e,s=[],i=[],o=c=>{const u=s.indexOf(c);if(-1!==u)return i[u];const f=[];return s.push(c),i.push(f),f.push(...c.map(E=>Array.isArray(E)?o(E):i9(E)?a(E):E)),f},a=c=>{const u=s.indexOf(c);if(-1!==u)return i[u];const f={},E=Object.keys(c).sort(n);s.push(c),i.push(f);for(const T of E){const U=c[T];let b;b=t&&Array.isArray(U)?o(U):t&&i9(U)?a(U):U,Object.defineProperty(f,T,{...Object.getOwnPropertyDescriptor(c,T),value:b})}return f};return Array.isArray(r)?t?o(r):r.slice():a(r)}(e,{deep:!0}))))})()}}(this.root),this.apiAddr=function WSe(r){return{get:()=>(0,B.Z)(function*(){const e=yield r.get(a9);return e&&e.toString()})(),set:e=>r.put(a9,u2(e.toString())),delete:()=>r.delete(a9)}}(this.root),this.gcLock=$E({name:e,singleProcess:!1!==this.options.repoOwner}),this.gc=function fAe({gcLock:r,pins:e,blockstore:t,root:n,loadCodec:s}){function o(){return(o=Ee(function*(){const a=Date.now();Mh("Creating set of marked blocks");const c=yield X(r.writeLock());try{const u=yield X(hAe({pins:e,blockstore:t,root:n,loadCodec:s})),f=t.queryKeys({});yield*Fe(be(pAe({blockstore:t},u,f)),X),Mh(`Complete (${Date.now()-a}ms)`)}finally{c()}})).apply(this,arguments)}return function i(){return o.apply(this,arguments)}}({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}init(e){var t=this;return(0,B.Z)(function*(){ks("initializing at: %s",t.path),yield t._openRoot(),yield t.config.replace(function mAe(r){return r.Datastore=Object.assign({},VM,a7(r,"datastore")),r}(e)),yield t.spec.set(function vAe(r){const e={...VM.Spec,...a7(r,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(t=>({mountpoint:t.mountpoint,type:t.child.type,path:t.child.path,shardFunc:t.child.shardFunc}))}}(e)),yield t.version.set(12)})()}isInitialized(){var e=this;return(0,B.Z)(function*(){if(!e.closed)return!0;try{return yield e._openRoot(),yield e._checkInitialized(),yield e.root.close(),!0}catch{return!1}})()}open(){var e=this;return(0,B.Z)(function*(){if(!e.closed)throw ee(new Error("repo is already open"),"ERR_REPO_ALREADY_OPEN");ks("opening at: %s",e.path);try{if(yield e._openRoot(),yield e._checkInitialized(),e._lockfile=yield e._openLock(),ks("acquired repo.lock"),!(yield e.version.check(12))){if(!(yield e._isAutoMigrationEnabled()))throw new FSe("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");yield e._migrate(12,{root:e.root,datastore:e.datastore,pins:e.pins.pinstore,blocks:e.pins.blockstore,keys:e.keys})}ks("creating datastore"),yield e.datastore.open(),ks("creating blocks"),yield e.blocks.open(),ks("creating keystore"),yield e.keys.open(),ks("creating pins"),yield e.pins.pinstore.open(),e.closed=!1,ks("all opened")}catch(t){if(e._lockfile)try{yield e._closeLock(),e._lockfile=null}catch(n){ks("error removing lock",n)}throw t}})()}_openRoot(){var e=this;return(0,B.Z)(function*(){try{yield e.root.open()}catch(t){if("Already open"!==t.message)throw t}})()}_openLock(){var e=this;return(0,B.Z)(function*(){const t=yield e.options.repoLock.lock(e.path);if("function"!=typeof t.close)throw ee(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return t})()}_closeLock(){return this._lockfile&&this._lockfile.close()}_checkInitialized(){var e=this;return(0,B.Z)(function*(){let t;ks("init check");try{[t]=yield Promise.all([e.config.exists(),e.spec.exists(),e.version.exists()])}catch(n){throw"ERR_NOT_FOUND"===n.code?ee(new Error("repo is not initialized yet"),kh,{path:e.path}):n}if(!t)throw ee(new Error("repo is not initialized yet"),kh,{path:e.path})})()}close(){var e=this;return(0,B.Z)(function*(){if(e.closed)throw ee(new Error("repo is already closed"),"ERR_REPO_ALREADY_CLOSED");ks("closing at: %s",e.path);try{yield e.apiAddr.delete()}catch(t){if(t.code!==kh&&!t.message.startsWith("ENOENT"))throw t}yield Promise.all([e.root,e.blocks,e.keys,e.datastore,e.pins.pinstore].map(t=>t&&t.close())),ks("unlocking"),e.closed=!0,yield e._closeLock()})()}exists(){return this.version.exists()}stat(){var e=this;return(0,B.Z)(function*(){if(e.datastore&&e.keys){const[t,n,s,i,o]=yield Promise.all([e._storageMaxStat(),e._blockStat(),e.version.get(),$M(e.datastore),$M(e.keys)]);return{repoPath:e.path,storageMax:t,version:s,numObjects:n.count,repoSize:n.size+i+o}}throw ee(new Error("repo is not initialized yet"),kh,{path:e.path})})()}_isAutoMigrationEnabled(){var e=this;return(0,B.Z)(function*(){if(void 0!==e.options.autoMigrate)return e.options.autoMigrate;let t;try{t=yield e.config.get("repoAutoMigrate")}catch(n){if(n.code!==Lh.code)throw n;t=!0}return t})()}_migrate(e,t){var n=this;return(0,B.Z)(function*(){return(yield n.version.get())>e?(ks(`reverting to version ${e}`),function uxe(r,e,t,n){return W7.apply(this,arguments)}(n.path,t,n.options,e,{ignoreLock:!0,onProgress:n.options.onMigrationProgress})):(ks(`migrating to version ${e}`),function lxe(r,e,t,n){return G7.apply(this,arguments)}(n.path,t,n.options,e,{ignoreLock:!0,onProgress:n.options.onMigrationProgress}))})()}_storageMaxStat(){var e=this;return(0,B.Z)(function*(){try{const t=yield e.config.get("Datastore.StorageMax");return BigInt(dxe(t))}catch{return BigInt(yAe)}})()}_blockStat(){var e=this;return(0,B.Z)(function*(){let t=BigInt(0),n=BigInt(0);if(e.blocks){var o,s=!1,i=!1;try{for(var c,a=be(e.blocks.query({}));s=!(c=yield a.next()).done;s=!1){const{key:u,value:f}=c.value;t+=BigInt(1),n+=BigInt(f.byteLength),n+=BigInt(u.bytes.byteLength)}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield a.return())}finally{if(i)throw o}}}return{count:t,size:n}})()}}function $M(r){return S9.apply(this,arguments)}function S9(){return S9=(0,B.Z)(function*(r){let e=BigInt(0);var s,t=!1,n=!1;try{for(var o,i=be(r.query({}));t=!(o=yield i.next()).done;t=!1){const a=o.value;e+=BigInt(a.value.byteLength),e+=BigInt(a.key.uint8Array().byteLength)}}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield i.return())}finally{if(n)throw s}}return e}),S9.apply(this,arguments)}function A9(r,e){return T9.apply(this,arguments)}function T9(){return T9=Ee(function*(r,e){let t=0;if(!(e<1)){var i,n=!1,s=!1;try{for(var a,o=be(r);n=!(a=yield X(o.next())).done;n=!1)if(yield a.value,t++,t===e)return}catch(c){s=!0,i=c}finally{try{n&&null!=o.return&&(yield X(o.return()))}finally{if(s)throw i}}}}),T9.apply(this,arguments)}function Fh(r,e){return C9.apply(this,arguments)}function C9(){return C9=Ee(function*(r,e){const t=yield X(Bc(r));yield*Fe(be(t.sort(e)),X)}),C9.apply(this,arguments)}var wAe=p(24466);class zh extends I1{constructor(e,t={}){super(),this.db="string"==typeof e?new wAe.Level(e,{...t,keyEncoding:"utf8",valueEncoding:"view"}):e,this.opts={createIfMissing:!0,compression:!1,...t}}open(){var e=this;return(0,B.Z)(function*(){try{yield e.db.open(e.opts)}catch(t){throw gD(t)}})()}put(e,t){var n=this;return(0,B.Z)(function*(){try{yield n.db.put(e.toString(),t)}catch(s){throw R5(s)}})()}get(e){var t=this;return(0,B.Z)(function*(){let n;try{n=yield t.db.get(e.toString())}catch(s){throw s.notFound?Wi(s):R5(s)}return n})()}has(e){var t=this;return(0,B.Z)(function*(){try{yield t.db.get(e.toString())}catch(n){if(n.notFound)return!1;throw n}return!0})()}delete(e){var t=this;return(0,B.Z)(function*(){try{yield t.db.del(e.toString())}catch(n){throw bD(n)}})()}close(){return this.db&&this.db.close()}batch(){const e=[];return{put:(t,n)=>{e.push({type:"put",key:t.toString(),value:n})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce((i,o)=>Js(i,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((i,o)=>Fh(i,o),t));const{offset:n,limit:s}=e;if(n){let i=0;t=Js(t,()=>i++>=n)}return s&&(t=A9(t,s)),t}queryKeys(e){let t=os(this._query({values:!1,prefix:e.prefix}),({key:i})=>i);Array.isArray(e.filters)&&(t=e.filters.reduce((i,o)=>Js(i,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((i,o)=>Fh(i,o),t));const{offset:n,limit:s}=e;if(n){let i=0;t=Js(t,()=>i++>=n)}return s&&(t=A9(t,s)),t}_query(e){const t={keys:!0,keyEncoding:"buffer",values:e.values};if(null!=e.prefix){const s=e.prefix.toString();t.gte=s,t.lt=s+"\xff"}const n=this.db.iterator(t);if(n[Symbol.asyncIterator])return function EAe(r){return I9.apply(this,arguments)}(n);if(null!=n.next&&null!=n.end)return function xAe(r){return{[Symbol.asyncIterator]:()=>({next:()=>new Promise((e,t)=>{r.next((n,s,i)=>n?t(n):null==s?r.end(o=>{if(o)return t(o);e({done:!0,value:void 0})}):void e({done:!1,value:{key:new ft(s,!1),value:i}}))}),return:()=>new Promise((e,t)=>{r.end(n=>{if(n)return t(n);e({done:!0,value:void 0})})})})}}(n);throw new Error("Level returned incompatible iterator")}}function I9(){return I9=Ee(function*(r){var n,e=!1,t=!1;try{for(var i,s=be(r);e=!(i=yield X(s.next())).done;e=!1){const[o,a]=i.value;yield{key:new ft(o,!1),value:a}}}catch(o){t=!0,n=o}finally{try{e&&null!=s.return&&(yield X(s.return()))}finally{if(t)throw n}}yield X(r.close())}),I9.apply(this,arguments)}var CAe=Math.pow(2,31),DAe=Math.pow(2,7),OAe=Math.pow(2,14),PAe=Math.pow(2,21),NAe=Math.pow(2,28),BAe=Math.pow(2,35),LAe=Math.pow(2,42),kAe=Math.pow(2,49),UAe=Math.pow(2,56),MAe=Math.pow(2,63),zAe={encode:function ZM(r,e,t){e=e||[];for(var n=t=t||0;r>=CAe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,ZM.bytes=t-n+1,e},decode:function R9(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw R9.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return R9.bytes=i-n,t},encodingLength:function(r){return r<DAe?1:r<OAe?2:r<PAe?3:r<NAe?4:r<BAe?5:r<LAe?6:r<kAe?7:r<UAe?8:r<MAe?9:10}};const p2=zAe,D9=(r,e=0)=>[p2.decode(r,e),p2.decode.bytes],y2=(r,e,t=0)=>(p2.encode(r,e,t),e),g2=r=>p2.encodingLength(r),O9=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}),GM=r=>{const e=O9(r),[t,n]=D9(e),[s,i]=D9(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new P9(t,s,o,e)};class P9{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const YAe=function HAe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class QAe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class JAe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return WM(this,e)}}class XAe{constructor(e){this.decoders=e}or(e){return WM(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const WM=(r,e)=>new XAe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class qAe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new QAe(e,t,n),this.decoder=new JAe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const YM=({name:r,prefix:e,encode:t,decode:n})=>new qAe(r,e,t,n),QM=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=YAe(t,e);return YM({prefix:r,name:e,encode:n,decode:i=>O9(s(i))})},$o=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>YM({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),so=QM({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ko=(QM({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),$o({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),rTe=($o({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),$o({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5})),JM=($o({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),$o({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$o({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$o({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$o({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$o({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),N9=r=>{const e=JM.get(r);if(null==e){const t=new Map;return JM.set(r,t),t}return e};class dn{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Vh)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==aTe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return dn.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=((r,e)=>{const t=e.byteLength,n=g2(r),s=n+g2(t),i=new Uint8Array(s+t);return y2(r,i,0),y2(t,i,n),i.set(e,s),new P9(r,t,e,i)})(e,t);return dn.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return dn.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?iTe(t,N9(r),e||so.encoder):oTe(t,N9(r),e||Ko.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof dn)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new dn(n,s,i,o||XM(n,s,i.bytes))}if(!0===t[cTe]){const{version:n,multihash:s,code:i}=t,o=GM(s);return dn.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Vh)throw new Error(`Version 0 CID must use dag-pb (code: ${Vh}) block encoding`);return new dn(e,t,n,n.bytes);case 1:{const s=XM(e,t,n.bytes);return new dn(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return dn.create(0,Vh,e)}static createV1(e,t){return dn.create(1,e,t)}static decode(e){const[t,n]=dn.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=dn.inspectBytes(e),n=t.size-t.multihashSize,s=O9(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new P9(t.multihashCode,t.digestSize,i,s);return[0===t.version?dn.createV0(o):dn.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=D9(e.subarray(t));return t+=T,E};let s=n(),i=Vh;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=sTe(e,t),i=dn.decode(s);return N9(i).set(n,e),i}}const sTe=(r,e)=>{switch(r[0]){case"Q":return[so.prefix,(e||so).decode(`${so.prefix}${r}`)];case so.prefix:return[so.prefix,(e||so).decode(r)];case Ko.prefix:return[Ko.prefix,(e||Ko).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},iTe=(r,e,t)=>{const{prefix:n}=t;if(n!==so.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},oTe=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},Vh=112,aTe=18,XM=(r,e,t)=>{const n=g2(r),s=n+g2(e),i=new Uint8Array(s+t.byteLength);return y2(r,i,0),y2(e,i,n),i.set(t,s),i},cTe=Symbol.for("@ipld/js-cid/CID");var qM=p(73921),yu=p(53036),eF=p(23974),uTe=p(64972);const tF=(r,e)=>Ee(function*(){const t=yield X(uTe(r));yield*Fe(be(t.sort(e)),X)})();class B9{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}putMany(e,t={}){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(e);s=!(c=yield X(a.next())).done;s=!1){const{key:u,value:f}=c.value;yield X(n.put(u,f,t)),yield{key:u,value:f}}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()}getMany(e,t={}){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(e);s=!(c=yield X(a.next())).done;s=!1){const u=c.value;yield n.get(u,t)}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()}deleteMany(e,t={}){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(e);s=!(c=yield X(a.next())).done;s=!1){const u=c.value;yield X(n.delete(u,t)),yield u}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()}batch(){var e=this;let t=[],n=[];return{put(s,i){t.push({key:s,value:i})},delete(s){n.push(s)},commit:(s=(0,B.Z)(function*(i){yield qM(e.putMany(t,i)),t=[],yield qM(e.deleteMany(n,i)),n=[]}),function(o){return s.apply(this,arguments)})};var s}_all(e,t){return Ee(function*(){throw new Error("._all is not implemented")})()}_allKeys(e,t){return Ee(function*(){throw new Error("._allKeys is not implemented")})()}query(e,t){let n=this._all(e,t);if(null!=e.prefix&&(n=yu(n,s=>s.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(n=e.filters.reduce((s,i)=>yu(s,i),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((s,i)=>tF(s,i),n)),null!=e.offset){let s=0;n=yu(n,()=>s++>=(e.offset||0))}return null!=e.limit&&(n=eF(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(null!=e.prefix&&(n=yu(n,s=>s.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(n=e.filters.reduce((s,i)=>yu(s,i),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((s,i)=>tF(s,i),n)),null!=e.offset){let s=0;n=yu(n,()=>s++>=e.offset)}return null!=e.limit&&(n=eF(n,e.limit)),n}}function gu(r){const e=dn.asCID(r);if(!e)throw ee(new Error("Not a valid cid"),"ERR_INVALID_CID");return new ft("/"+Ko.encode(e.multihash.bytes).slice(1).toUpperCase(),!1)}function qa(r){return dn.createV1(85,GM(Ko.decode("b"+r.toString().slice(1).toLowerCase())))}function L9(r){const e=r.substring(0,1);if("/"===e)return L9(r.substring(1));let t,n;t="b"===e.toLowerCase()?i=>Ko.decode(i.toLowerCase()).subarray(2):"c"===e.toLowerCase()?i=>rTe.decode(i.toLowerCase()).subarray(2):"z"===e?i=>so.decode(i).subarray(2):"Q"===e?i=>so.decode("z"+i):i=>Ko.decode("b"+i.toLowerCase()).subarray(2);for(let i=1;i<r.length;i++)try{n=t(r.substring(0,i))}catch(o){if("Unexpected end of data"!==o.message)throw o}let s="/C";return n&&(s=`/${Ko.encode(n).slice(1,-1).toUpperCase()||"C"}`),s}class hTe extends B9{constructor(e){super(),this.child=e}open(){return this.child.open()}close(){return this.child.close()}query(e,t){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(n.child.query(function dTe(r){return{...r,prefix:r.prefix?L9(r.prefix):void 0,filters:r.filters?r.filters.map(e=>t=>e({key:qa(t.key),value:t.value})):void 0,orders:r.orders?r.orders.map(e=>(t,n)=>e({key:qa(t.key),value:t.value},{key:qa(n.key),value:n.value})):void 0}}(e),t));s=!(c=yield X(a.next())).done;s=!1){const{key:u,value:f}=c.value;yield{key:qa(u),value:f}}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()}queryKeys(e,t){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(n.child.queryKeys(function fTe(r){return{...r,prefix:r.prefix?L9(r.prefix):void 0,filters:r.filters?r.filters.map(e=>t=>e(qa(t))):void 0,orders:r.orders?r.orders.map(e=>(t,n)=>e(qa(t),qa(n))):void 0}}(e),t));s=!(c=yield X(a.next())).done;s=!1){const u=c.value;yield qa(u)}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()}get(e,t){var n=this;return(0,B.Z)(function*(){return n.child.get(gu(e),t)})()}getMany(e,t){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(e);s=!(c=yield X(a.next())).done;s=!1){const u=c.value;yield n.get(u,t)}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()}put(e,t,n){var s=this;return(0,B.Z)(function*(){yield s.child.put(gu(e),t,n)})()}putMany(e,t){var n=this;return Ee(function*(){const s=ss({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)((0,B.Z)(function*(){try{const o=n.child;yield Oi(n.child.putMany(Ee(function*(){var u,a=!1,c=!1;try{for(var E,f=be(e);a=!(E=yield X(f.next())).done;a=!1){const T=E.value,U=gu(T.key);(yield X(o.has(U,t)))||(yield{key:U,value:T.value}),s.push(T)}}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield X(f.return()))}finally{if(c)throw u}}})())),s.end()}catch(o){s.end(o)}})),yield*Fe(be(s),X)})()}has(e,t){return this.child.has(gu(e),t)}delete(e,t){return this.child.delete(gu(e),t)}deleteMany(e,t){const n=ss({objectMode:!0});return Oi(this.child.deleteMany(Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(e);s=!(c=yield X(a.next())).done;s=!1){const u=c.value;yield gu(u),n.push(u)}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}n.end()})(),t)).catch(s=>{n.end(s)}),n}}const _Te=function yTe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},b2=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class ETe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class xTe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return rF(this,e)}}class STe{constructor(e){this.decoders=e}or(e){return rF(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const rF=(r,e)=>new STe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class ATe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new ETe(e,t,n),this.decoder=new xTe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const _2=({name:r,prefix:e,encode:t,decode:n})=>new ATe(r,e,t,n),jh=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=_Te(t,e);return _2({prefix:r,name:e,encode:n,decode:i=>b2(s(i))})},Un=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>_2({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),ITe=_2({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),RTe=Un({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),DTe=Un({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),OTe=jh({prefix:"9",name:"base10",alphabet:"0123456789"}),PTe=Un({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),NTe=Un({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),BTe=Un({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),LTe=Un({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),kTe=Un({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),UTe=Un({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),MTe=Un({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),FTe=Un({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),zTe=Un({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),VTe=Un({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),jTe=Un({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),$Te=jh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),KTe=jh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),ZTe=jh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),HTe=jh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),GTe=Un({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),WTe=Un({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),YTe=Un({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),QTe=Un({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),nF=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),JTe=nF.reduce((r,e,t)=>(r[t]=e,r),[]),XTe=nF.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),tCe=_2({prefix:"\u{1f680}",name:"base256emoji",encode:function qTe(r){return r.reduce((e,t)=>e+JTe[t],"")},decode:function eCe(r){const e=[];for(const t of r){const n=XTe[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var iCe=Math.pow(2,31),cCe=Math.pow(2,7),lCe=Math.pow(2,14),uCe=Math.pow(2,21),dCe=Math.pow(2,28),fCe=Math.pow(2,35),hCe=Math.pow(2,42),pCe=Math.pow(2,49),yCe=Math.pow(2,56),gCe=Math.pow(2,63),_Ce={encode:function iF(r,e,t){e=e||[];for(var n=t=t||0;r>=iCe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,iF.bytes=t-n+1,e},decode:function k9(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw k9.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return k9.bytes=i-n,t},encodingLength:function(r){return r<cCe?1:r<lCe?2:r<uCe?3:r<dCe?4:r<fCe?5:r<hCe?6:r<pCe?7:r<yCe?8:r<gCe?9:10}};const aF=_Ce,cF=(r,e,t=0)=>(aF.encode(r,e,t),e),lF=r=>aF.encodingLength(r),U9=(r,e)=>{const t=e.byteLength,n=lF(r),s=n+lF(t),i=new Uint8Array(s+t);return cF(r,i,0),cF(t,i,n),i.set(e,s),new uF(r,t,e,i)};class uF{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const dF=({name:r,code:e,encode:t})=>new vCe(r,e,t);class vCe{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?U9(this.code,t):t.then(n=>U9(this.code,n))}throw Error("Unknown type, must be binary type")}}const fF=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),wCe=dF({name:"sha2-256",code:18,encode:fF("SHA-256")}),ECe=dF({name:"sha2-512",code:19,encode:fF("SHA-512")}),pF=b2,SCe={code:0,name:"identity",encode:pF,digest:r=>U9(0,pF(r))},ACe="raw",TCe=85,CCe=r=>b2(r),ICe=r=>b2(r),RCe=new TextEncoder,DCe=new TextDecoder,OCe="json",PCe=512,NCe=r=>RCe.encode(JSON.stringify(r)),BCe=r=>JSON.parse(DCe.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const bF={...y_,...g_,...b_,...__,...m_,...v_,...w_,...E_,...x_,...S_};function _F(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function mF(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const vF=mF("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),F9=mF("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function VCe(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?_F(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),jCe={utf8:vF,"utf-8":vF,hex:bF.base16,latin1:F9,ascii:F9,binary:F9,...bF};var m2;function wF(r){return r instanceof Uint8Array?{get:e=>r[e],set(e,t){r[e]=t}}:{get:e=>r.get(e),set(e,t){r.set(e,t)}}}!function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{!1!==s.lengthDelimited&&n.fork(),(!0===s.writeDefaults||null!=t.publicKey&&t.publicKey.byteLength>0)&&(n.uint32(10),n.bytes(t.publicKey)),(!0===s.writeDefaults||null!=t.payloadType&&t.payloadType.byteLength>0)&&(n.uint32(18),n.bytes(t.payloadType)),(!0===s.writeDefaults||null!=t.payload&&t.payload.byteLength>0)&&(n.uint32(26),n.bytes(t.payload)),(!0===s.writeDefaults||null!=t.signature&&t.signature.byteLength>0)&&(n.uint32(42),n.bytes(t.signature)),!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();switch(o>>>3){case 1:s.publicKey=t.bytes();break;case 2:s.payloadType=t.bytes();break;case 3:s.payload=t.bytes();break;case 5:s.signature=t.bytes();break;default:t.skipType(7&o)}}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(m2||(m2={}));const EF=4294967296;class di{constructor(e=0,t=0){this.hi=e,this.lo=t}toBigInt(e){if(!0===e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!=0){const t=1+~this.lo>>>0;let n=~this.hi>>>0;return 0===t&&(n=n+1>>>0),-(BigInt(t)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){const e=-(1&this.lo);return new di((this.hi>>>1^e)>>>0,((this.lo>>>1|this.hi<<31)^e)>>>0)}zzEncode(){const e=this.hi>>31;return new di(((this.hi<<1|this.lo>>>31)^e)>>>0,(this.lo<<1^e)>>>0)}toBytes(e,t=0){const n=wF(e);for(;this.hi>0;)n.set(t++,127&this.lo|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(t++,127&this.lo|128),this.lo=this.lo>>>7;n.set(t++,this.lo)}static fromBigInt(e){if(0n===e)return new di;const t=e<0;t&&(e=-e);let n=0|Number(e>>32n),s=0|Number(e-(BigInt(n)<<32n));return t&&(n=~n>>>0,s=~s>>>0,++s>EF&&(s=0,++n>EF&&(n=0))),new di(n,s)}static fromNumber(e){if(0===e)return new di;const t=e<0;t&&(e=-e);let n=e>>>0,s=(e-n)/4294967296>>>0;return t&&(s=~s>>>0,n=~n>>>0,++n>4294967295&&(n=0,++s>4294967295&&(s=0))),new di(s,n)}static fromBytes(e,t=0){const n=wF(e),s=new di;let i=0;if(e.length-t>4){for(;i<4;++i)if(s.lo=(s.lo|(127&n.get(t))<<7*i)>>>0,n.get(t++)<128)return s;if(s.lo=(s.lo|(127&n.get(t))<<28)>>>0,s.hi=(s.hi|(127&n.get(t))>>4)>>>0,n.get(t++)<128)return s;i=0}else for(;i<4;++i){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(s.lo=(s.lo|(127&n.get(t))<<7*i)>>>0,n.get(t++)<128)return s}if(e.length-t>4){for(;i<5;++i)if(s.hi=(s.hi|(127&n.get(t))<<7*i+3)>>>0,n.get(t++)<128)return s}else if(t<e.byteLength)for(;i<5;++i){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(s.hi=(s.hi|(127&n.get(t))<<7*i+3)>>>0,n.get(t++)<128)return s}throw RangeError("invalid varint encoding")}}const GCe=Math.pow(2,7),WCe=Math.pow(2,14),YCe=Math.pow(2,21),QCe=Math.pow(2,28),JCe=Math.pow(2,35),XCe=Math.pow(2,42),qCe=Math.pow(2,49),eIe=Math.pow(2,56),tIe=Math.pow(2,63),qs={encodingLength:r=>r<GCe?1:r<WCe?2:r<YCe?3:r<QCe?4:r<JCe?5:r<XCe?6:r<qCe?7:r<eIe?8:r<tIe?9:10,encode(r,e,t=0){if(null!=Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return null==e&&(e=function xF(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?function HCe(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}(qs.encodingLength(r))),di.fromNumber(r).toBytes(e,t),e},decode:(r,e=0)=>di.fromBytes(r,e).toNumber(!0)};class Us{constructor(e){const{peerId:t,payloadType:n,payload:s,signature:i}=e;this.peerId=t,this.payloadType=n,this.payload=s,this.signature=i}marshal(){if(null==this.peerId.publicKey)throw new Error("Missing public key");return null==this.marshaled&&(this.marshaled=m2.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return function KCe(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}(this.marshal(),e.marshal())}validate(e){var t=this;return(0,B.Z)(function*(){const n=SF(e,t.payloadType,t.payload);if(null==t.peerId.publicKey)throw new Error("Missing public key");return yield Pc(t.peerId.publicKey).verify(n.subarray(),t.signature)})()}}Us.createFromProtobuf=function(){var r=(0,B.Z)(function*(e){const t=m2.decode(e),n=yield Ti(t.publicKey);return new Us({peerId:n,payloadType:t.payloadType,payload:t.payload,signature:t.signature})});return function(e){return r.apply(this,arguments)}}(),Us.seal=function(){var r=(0,B.Z)(function*(e,t){if(null==t.privateKey)throw new Error("Missing private key");const n=e.domain,s=e.codec,i=e.marshal(),o=SF(n,s,i),c=yield(yield Oo(t.privateKey)).sign(o.subarray());return new Us({peerId:t,payloadType:s,payload:i,signature:c})});return function(e,t){return r.apply(this,arguments)}}(),Us.openAndCertify=function(){var r=(0,B.Z)(function*(e,t){const n=yield Us.createFromProtobuf(e);if(!(yield n.validate(t)))throw ee(new Error("envelope signature is not valid for the given domain"),"ERR_SIGNATURE_NOT_VALID");return n});return function(e,t){return r.apply(this,arguments)}}();const SF=(r,e,t)=>{const n=function $Ce(r,e="utf8"){const t=jCe[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):_F(globalThis.Buffer.from(r,"utf-8"))}(r),s=qs.encode(n.byteLength),i=qs.encode(e.length),o=qs.encode(t.length);return new Or(s,n,i,e,o,t)};var v2;!function(r){let e,t;!function(n){let s;n.codec=()=>(null==s&&(s=Rr((i,o,a={})=>{!1!==a.lengthDelimited&&o.fork(),(!0===a.writeDefaults||null!=i.multiaddr&&i.multiaddr.byteLength>0)&&(o.uint32(10),o.bytes(i.multiaddr)),!1!==a.lengthDelimited&&o.ldelim()},(i,o)=>{const a={multiaddr:new Uint8Array(0)},c=null==o?i.len:i.pos+o;for(;i.pos<c;){const u=i.uint32();u>>>3==1?a.multiaddr=i.bytes():i.skipType(7&u)}return a})),s),n.encode=i=>Ir(i,n.codec()),n.decode=i=>Cr(i,n.codec())}(e=r.AddressInfo||(r.AddressInfo={})),r.codec=()=>(null==t&&(t=Rr((n,s,i={})=>{if(!1!==i.lengthDelimited&&s.fork(),(!0===i.writeDefaults||null!=n.peerId&&n.peerId.byteLength>0)&&(s.uint32(10),s.bytes(n.peerId)),(!0===i.writeDefaults||0n!==n.seq)&&(s.uint32(16),s.uint64(n.seq)),null!=n.addresses)for(const o of n.addresses)s.uint32(26),r.AddressInfo.codec().encode(o,s,{writeDefaults:!0});!1!==i.lengthDelimited&&s.ldelim()},(n,s)=>{const i={peerId:new Uint8Array(0),seq:0n,addresses:[]},o=null==s?n.len:n.pos+s;for(;n.pos<o;){const a=n.uint32();switch(a>>>3){case 1:i.peerId=n.bytes();break;case 2:i.seq=n.uint64();break;case 3:i.addresses.push(r.AddressInfo.codec().decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i})),t),r.encode=n=>Ir(n,r.codec()),r.decode=n=>Cr(n,r.codec())}(v2||(v2={}));const oIe=Uint8Array.from([3,1]);let bu=(()=>{class r{constructor(t){this.domain=r.DOMAIN,this.codec=r.CODEC;const{peerId:n,multiaddrs:s,seqNumber:i}=t;this.peerId=n,this.multiaddrs=s??[],this.seqNumber=i??BigInt(Date.now())}marshal(){return null==this.marshaled&&(this.marshaled=v2.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(t=>({multiaddr:t.bytes}))})),this.marshaled}equals(t){return!!(t instanceof r&&this.peerId.equals(t.peerId)&&this.seqNumber===t.seqNumber&&function sIe(r,e){const t=(n,s)=>n.toString().localeCompare(s.toString());return r.length===e.length&&(e.sort(t),r.sort(t).every((n,s)=>e[s].equals(n)))}(this.multiaddrs,t.multiaddrs))}}return r.createFromProtobuf=e=>{var t;const n=v2.decode(e),s=Ai(n.peerId),i=(null!==(t=n.addresses)&&void 0!==t?t:[]).map(a=>at(a.multiaddr));return new r({peerId:s,multiaddrs:i,seqNumber:n.seq})},r.DOMAIN="libp2p-peer-record",r.CODEC=oIe,r})();const z9=Symbol.for("@libp2p/topology"),AF=()=>{};class cIe{constructor(e){var t,n,s,i;this.min=null!==(t=e.min)&&void 0!==t?t:0,this.max=null!==(n=e.max)&&void 0!==n?n:1/0,this.peers=new Set,this.onConnect=null!==(s=e.onConnect)&&void 0!==s?s:AF,this.onDisconnect=null!==(i=e.onDisconnect)&&void 0!==i?i:AF}get[Symbol.toStringTag](){return z9.toString()}get[z9](){return!0}setRegistrar(e){var t=this;return(0,B.Z)(function*(){t.registrar=e})()}disconnect(e){this.onDisconnect(e)}}function V9(r){return new cIe(r)}var j9,Zo,Wc=function(r,e,t,n){if("a"===t&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?n:"a"===t?n.call(r):n?n.value:e.get(r)};class wr extends EventTarget{constructor(){super(...arguments),Zo.set(this,new Map)}listenerCount(e){const t=Wc(this,Zo,"f").get(e);return null==t?0:t.length}addEventListener(e,t,n){var s;super.addEventListener(e,t,n);let i=Wc(this,Zo,"f").get(e);null==i&&(i=[],Wc(this,Zo,"f").set(e,i)),i.push({callback:t,once:null!==(s=!0!==n&&!1!==n&&n?.once)&&void 0!==s&&s})}removeEventListener(e,t,n){super.removeEventListener(e.toString(),t??null,n);let s=Wc(this,Zo,"f").get(e);null!=s&&(s=s.filter(({callback:i})=>i!==t),Wc(this,Zo,"f").set(e,s))}dispatchEvent(e){const t=super.dispatchEvent(e);let n=Wc(this,Zo,"f").get(e.type);return null==n||(n=n.filter(({once:s})=>!s),Wc(this,Zo,"f").set(e.type,n)),t}}Zo=new WeakMap;class lIe extends Event{constructor(e,t){super(e,t),this.detail=t?.detail}}const Qe=null!==(j9=globalThis.CustomEvent)&&void 0!==j9?j9:lIe;class uIe{constructor(e,t,n){this.gossip=e,this.msgs=new Map,this.history=[],this.msgIdToStrFn=n;for(let s=0;s<t;s++)this.history[s]=[]}get size(){return this.msgs.size}put(e,t,n=!1){const{msgIdStr:s}=e;return!this.msgs.has(s)&&(this.msgs.set(s,{message:t,validated:n,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...e,topic:t.topic}),!0)}observeDuplicate(e,t){const n=this.msgs.get(e);n&&!n.validated&&n.originatingPeers.add(t)}get(e){var t;return null===(t=this.msgs.get(this.msgIdToStrFn(e)))||void 0===t?void 0:t.message}getWithIWantCount(e,t){var n;const s=this.msgs.get(e);if(!s)return null;const i=(null!==(n=s.iwantCounts.get(t))&&void 0!==n?n:0)+1;return s.iwantCounts.set(t,i),{msg:s.message,count:i}}getGossipIDs(e){const t=new Map;for(let n=0;n<this.gossip;n++)this.history[n].forEach(s=>{const i=this.msgs.get(s.msgIdStr);if(i&&i.validated&&e.has(s.topic)){let o=t.get(s.topic);o||(o=[],t.set(s.topic,o)),o.push(s.msgId)}});return t}validate(e){const t=this.msgs.get(e);if(!t)return null;const{message:n,originatingPeers:s}=t;return t.validated=!0,t.originatingPeers=new Set,{message:n,originatingPeers:s}}shift(){this.history[this.history.length-1].forEach(t=>{this.msgs.delete(t.msgIdStr)}),this.history.pop(),this.history.unshift([])}remove(e){const t=this.msgs.get(e);return t?(this.msgs.delete(e),t):null}}var dIe=p(6321);const{RPC:w2}=dIe,TF="/floodsub/1.0.0",CF="/meshsub/1.0.0",K9="/meshsub/1.1.0",mu=5e3;function Ho(r=[],e){return{subscriptions:[],messages:r,control:e?{graft:e.graft||[],prune:e.prune||[],ihave:e.ihave||[],iwant:e.iwant||[]}:void 0}}function Go(r){if(r.length<=1)return r;for(let t=0;t<r.length;t++){const n=Math.floor(Math.random()*Math.floor(r.length)),s=r[t];r[t]=r[n],r[n]=s}return r}function jIe(r){return ay(r,"base64")}const E2="StrictSign",Z9="StrictNoSign";var Yc=(()=>(function(r){r[r.Signing=0]="Signing",r[r.Anonymous=1]="Anonymous"}(Yc||(Yc={})),Yc))(),io=(()=>(function(r){r.Accept="accept",r.Ignore="ignore",r.Reject="reject"}(io||(io={})),io))(),fi=(()=>(function(r){r.Error="error",r.Ignore="ignore",r.Reject="reject",r.Blacklisted="blacklisted"}(fi||(fi={})),fi))(),Is=(()=>(function(r){r.InvalidSignature="invalid_signature",r.InvalidSeqno="invalid_seqno",r.InvalidPeerId="invalid_peerid",r.SignaturePresent="signature_present",r.SeqnoPresent="seqno_present",r.FromPresent="from_present",r.TransformFailed="transform_failed"}(Is||(Is={})),Is))(),hi=(()=>(function(r){r.duplicate="duplicate",r.invalid="invalid",r.valid="valid"}(hi||(hi={})),hi))();function RF(r){switch(r){case io.Ignore:return fi.Ignore;case io.Reject:return fi.Reject}}function H9(){return H9=(0,B.Z)(function*(r,e){switch(r){case E2:{if(!e)throw Error("Must provide PeerId");if(null==e.privateKey)throw Error("Cannot sign message, no private key present");if(null==e.publicKey)throw Error("Cannot sign message, no public key present");const t=yield Oo(e.privateKey);return{type:Yc.Signing,author:e,key:e.publicKey,privateKey:t}}case Z9:return{type:Yc.Anonymous};default:throw new Error(`Unknown signature policy "${r}"`)}}),H9.apply(this,arguments)}const nr="ERR_INVALID_PEER_SCORE_PARAMS",KIe={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:36e5},ZIe={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function HIe(r={}){return{...KIe,...r,topics:r.topics?Object.entries(r.topics).reduce((e,[t,n])=>(e[t]=function GIe(r={}){return{...ZIe,...r}}(n),e),{}):{}}}function YIe(r){if(r.topicWeight<0)throw ee(new Error("invalid topic weight; must be >= 0"),nr);if(0===r.timeInMeshQuantum)throw ee(new Error("invalid TimeInMeshQuantum; must be non zero"),nr);if(r.timeInMeshWeight<0)throw ee(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),nr);if(0!==r.timeInMeshWeight&&r.timeInMeshQuantum<=0)throw ee(new Error("invalid TimeInMeshQuantum; must be positive"),nr);if(0!==r.timeInMeshWeight&&r.timeInMeshCap<=0)throw ee(new Error("invalid TimeInMeshCap; must be positive"),nr);if(r.firstMessageDeliveriesWeight<0)throw ee(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),nr);if(0!==r.firstMessageDeliveriesWeight&&(r.firstMessageDeliveriesDecay<=0||r.firstMessageDeliveriesDecay>=1))throw ee(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),nr);if(0!==r.firstMessageDeliveriesWeight&&r.firstMessageDeliveriesCap<=0)throw ee(new Error("invalid FirstMessageDeliveriesCap; must be positive"),nr);if(r.meshMessageDeliveriesWeight>0)throw ee(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),nr);if(0!==r.meshMessageDeliveriesWeight&&(r.meshMessageDeliveriesDecay<=0||r.meshMessageDeliveriesDecay>=1))throw ee(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),nr);if(0!==r.meshMessageDeliveriesWeight&&r.meshMessageDeliveriesCap<=0)throw ee(new Error("invalid MeshMessageDeliveriesCap; must be positive"),nr);if(0!==r.meshMessageDeliveriesWeight&&r.meshMessageDeliveriesThreshold<=0)throw ee(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),nr);if(r.meshMessageDeliveriesWindow<0)throw ee(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),nr);if(0!==r.meshMessageDeliveriesWeight&&r.meshMessageDeliveriesActivation<1e3)throw ee(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),nr);if(r.meshFailurePenaltyWeight>0)throw ee(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),nr);if(0!==r.meshFailurePenaltyWeight&&(r.meshFailurePenaltyDecay<=0||r.meshFailurePenaltyDecay>=1))throw ee(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),nr);if(r.invalidMessageDeliveriesWeight>0)throw ee(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),nr);if(r.invalidMessageDeliveriesDecay<=0||r.invalidMessageDeliveriesDecay>=1)throw ee(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),nr)}const QIe={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function JIe(r={}){return{...QIe,...r}}function XIe(r,e,t,n){let s=0;if(Object.entries(e.topics).forEach(([o,a])=>{const c=t.topics[o];if(void 0===c)return;let u=0;if(a.inMesh){let U=a.meshTime/c.timeInMeshQuantum;U>c.timeInMeshCap&&(U=c.timeInMeshCap),u+=U*c.timeInMeshWeight}let f=a.firstMessageDeliveries;if(f>c.firstMessageDeliveriesCap&&(f=c.firstMessageDeliveriesCap),u+=f*c.firstMessageDeliveriesWeight,a.meshMessageDeliveriesActive&&a.meshMessageDeliveries<c.meshMessageDeliveriesThreshold){const U=c.meshMessageDeliveriesThreshold-a.meshMessageDeliveries;u+=U*U*c.meshMessageDeliveriesWeight}u+=a.meshFailurePenalty*c.meshFailurePenaltyWeight,u+=a.invalidMessageDeliveries*a.invalidMessageDeliveries*c.invalidMessageDeliveriesWeight,s+=u*c.topicWeight}),t.topicScoreCap>0&&s>t.topicScoreCap&&(s=t.topicScoreCap),s+=t.appSpecificScore(r)*t.appSpecificWeight,e.ips.forEach(o=>{if(t.IPColocationFactorWhitelist.has(o))return;const a=n.get(o),c=a?a.size:0;if(c>t.IPColocationFactorThreshold){const u=c-t.IPColocationFactorThreshold;s+=u*u*t.IPColocationFactorWeight}}),e.behaviourPenalty>t.behaviourPenaltyThreshold){const o=e.behaviourPenalty-t.behaviourPenaltyThreshold;s+=o*o*t.behaviourPenaltyWeight}return s}var qIe=p(39755),Rs=(()=>(function(r){r[r.unknown=0]="unknown",r[r.valid=1]="valid",r[r.invalid=2]="invalid",r[r.ignored=3]="ignored"}(Rs||(Rs={})),Rs))();class eRe{constructor(){this.records=new Map,this.queue=new qIe}ensureRecord(e){let t=this.records.get(e);if(t)return t;t={status:Rs.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,t);const n={msgId:e,expire:Date.now()+12e4};return this.queue.push(n),t}gc(){const e=Date.now();let t=this.queue.peekFront();for(;t&&t.expire<e;)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}}function Ds(r){return null!=r&&"function"==typeof r.start&&"function"==typeof r.stop}function Os(r){return null!=r&&"function"==typeof r.init}class DF{constructor(e={}){this.started=!1,null!=e.peerId&&this.setPeerId(e.peerId),null!=e.addressManager&&this.setAddressManager(e.addressManager),null!=e.peerStore&&this.setPeerStore(e.peerStore),null!=e.upgrader&&this.setUpgrader(e.upgrader),null!=e.metrics&&this.setMetrics(e.metrics),null!=e.registrar&&this.setRegistrar(e.registrar),null!=e.connectionManager&&this.setConnectionManager(e.connectionManager),null!=e.transportManager&&this.setTransportManager(e.transportManager),null!=e.connectionGater&&this.setConnectionGater(e.connectionGater),null!=e.contentRouting&&this.setContentRouting(e.contentRouting),null!=e.peerRouting&&this.setPeerRouting(e.peerRouting),null!=e.datastore&&this.setDatastore(e.datastore),null!=e.connectionProtector&&this.setConnectionProtector(e.connectionProtector),null!=e.dht&&this.setDHT(e.dht),null!=e.pubsub&&this.setPubSub(e.pubsub),null!=e.dialer&&this.setDialer(e.dialer)}isStarted(){return this.started}beforeStart(){var e=this;return(0,B.Z)(function*(){yield Promise.all(Object.values(e).filter(t=>Ds(t)).map(function(){var t=(0,B.Z)(function*(n){null!=n.beforeStart&&(yield n.beforeStart())});return function(n){return t.apply(this,arguments)}}()))})()}start(){var e=this;return(0,B.Z)(function*(){yield Promise.all(Object.values(e).filter(t=>Ds(t)).map(function(){var t=(0,B.Z)(function*(n){yield n.start()});return function(n){return t.apply(this,arguments)}}())),e.started=!0})()}afterStart(){var e=this;return(0,B.Z)(function*(){yield Promise.all(Object.values(e).filter(t=>Ds(t)).map(function(){var t=(0,B.Z)(function*(n){null!=n.afterStart&&(yield n.afterStart())});return function(n){return t.apply(this,arguments)}}()))})()}beforeStop(){var e=this;return(0,B.Z)(function*(){yield Promise.all(Object.values(e).filter(t=>Ds(t)).map(function(){var t=(0,B.Z)(function*(n){null!=n.beforeStop&&(yield n.beforeStop())});return function(n){return t.apply(this,arguments)}}()))})()}stop(){var e=this;return(0,B.Z)(function*(){yield Promise.all(Object.values(e).filter(t=>Ds(t)).map(function(){var t=(0,B.Z)(function*(n){yield n.stop()});return function(n){return t.apply(this,arguments)}}())),e.started=!1})()}afterStop(){var e=this;return(0,B.Z)(function*(){yield Promise.all(Object.values(e).filter(t=>Ds(t)).map(function(){var t=(0,B.Z)(function*(n){null!=n.afterStop&&(yield n.afterStop())});return function(n){return t.apply(this,arguments)}}()))})()}setPeerId(e){return this.peerId=e,e}getPeerId(){if(null==this.peerId)throw ee(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this.peerId}setMetrics(e){return this.metrics=e,Os(e)&&e.init(this),e}getMetrics(){return this.metrics}setAddressManager(e){return this.addressManager=e,Os(e)&&e.init(this),e}getAddressManager(){if(null==this.addressManager)throw ee(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this.addressManager}setPeerStore(e){return this.peerStore=e,Os(e)&&e.init(this),e}getPeerStore(){if(null==this.peerStore)throw ee(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this.peerStore}setUpgrader(e){return this.upgrader=e,Os(e)&&e.init(this),e}getUpgrader(){if(null==this.upgrader)throw ee(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this.upgrader}setRegistrar(e){return this.registrar=e,Os(e)&&e.init(this),e}getRegistrar(){if(null==this.registrar)throw ee(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this.registrar}setConnectionManager(e){return this.connectionManager=e,Os(e)&&e.init(this),e}getConnectionManager(){if(null==this.connectionManager)throw ee(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this.connectionManager}setTransportManager(e){return this.transportManager=e,Os(e)&&e.init(this),e}getTransportManager(){if(null==this.transportManager)throw ee(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this.transportManager}setConnectionGater(e){return this.connectionGater=e,Os(e)&&e.init(this),e}getConnectionGater(){if(null==this.connectionGater)throw ee(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this.connectionGater}setContentRouting(e){return this.contentRouting=e,Os(e)&&e.init(this),e}getContentRouting(){if(null==this.contentRouting)throw ee(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this.contentRouting}setPeerRouting(e){return this.peerRouting=e,Os(e)&&e.init(this),e}getPeerRouting(){if(null==this.peerRouting)throw ee(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this.peerRouting}setDatastore(e){return this.datastore=e,Os(e)&&e.init(this),e}getDatastore(){if(null==this.datastore)throw ee(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this.datastore}setConnectionProtector(e){return this.connectionProtector=e,Os(e)&&e.init(this),e}getConnectionProtector(){return this.connectionProtector}setDHT(e){return this.dht=e,Os(e)&&e.init(this),e}getDHT(){if(null==this.dht)throw ee(new Error("dht not set"),"ERR_SERVICE_MISSING");return this.dht}setPubSub(e){return this.pubsub=e,Os(e)&&e.init(this),e}getPubSub(){if(null==this.pubsub)throw ee(new Error("pubsub not set"),"ERR_SERVICE_MISSING");return this.pubsub}setDialer(e){return this.dialer=e,Os(e)&&e.init(this),e}getDialer(){if(null==this.dialer)throw ee(new Error("dialer not set"),"ERR_SERVICE_MISSING");return this.dialer}}const vu=Be("libp2p:gossipsub:score");class tRe{constructor(e,t,n){var s;this.params=e,this.metrics=t,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new eRe,this.components=new DF,function WIe(r){for(const[e,t]of Object.entries(r.topics))try{YIe(t)}catch(n){throw ee(new Error(`invalid score parameters for topic ${e}: ${n.message}`),nr)}if(r.topicScoreCap<0)throw ee(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),nr);if(null==r.appSpecificScore)throw ee(new Error("missing application specific score function"),nr);if(r.IPColocationFactorWeight>0)throw ee(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),nr);if(0!==r.IPColocationFactorWeight&&r.IPColocationFactorThreshold<1)throw ee(new Error("invalid IPColocationFactorThreshold; must be at least 1"),nr);if(r.behaviourPenaltyWeight>0)throw ee(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),nr);if(0!==r.behaviourPenaltyWeight&&(r.behaviourPenaltyDecay<=0||r.behaviourPenaltyDecay>=1))throw ee(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),nr);if(r.decayInterval<1e3)throw ee(new Error("invalid DecayInterval; must be at least 1s"),nr);if(r.decayToZero<=0||r.decayToZero>=1)throw ee(new Error("invalid DecayToZero; must be between 0 and 1"),nr)}(e),this.scoreCacheValidityMs=n.scoreCacheValidityMs,this.computeScore=null!==(s=n.computeScore)&&void 0!==s?s:XIe}init(e){this.components=e}get size(){return this.peerStats.size}start(){this._backgroundInterval?vu("Peer score already running"):(this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),vu("started"))}stop(){this._backgroundInterval?(clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),vu("stopped")):vu("Peer score already stopped")}background(){this.refreshScores(),this.updateIPs(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([e,t])=>[e,t]))}refreshScores(){const e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach((n,s)=>{n.connected?(Object.entries(n.topics).forEach(([i,o])=>{const a=this.params.topics[i];void 0!==a&&(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<t&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<t&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<t&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<t&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),n.behaviourPenalty*=this.params.behaviourPenaltyDecay,n.behaviourPenalty<t&&(n.behaviourPenalty=0)):e>n.expire&&(this.removeIPs(s,n.ips),this.peerStats.delete(s),this.scoreCache.delete(s))})}score(e){var t,n;null===(t=this.metrics)||void 0===t||t.scoreFnCalls.inc();const s=this.peerStats.get(e);if(!s)return 0;const i=Date.now(),o=this.scoreCache.get(e);if(o&&o.cacheUntil>i)return o.score;null===(n=this.metrics)||void 0===n||n.scoreFnRuns.inc();const a=this.computeScore(e,s,this.params,this.peerIPs),c=i+this.scoreCacheValidityMs;var u;return o?(null===(u=this.metrics)||void 0===u||u.scoreCachedDelta.observe(Math.abs(a-o.score)),o.score=a,o.cacheUntil=c):this.scoreCache.set(e,{score:a,cacheUntil:c}),a}addPenalty(e,t,n){const s=this.peerStats.get(e);var i;s&&(s.behaviourPenalty+=t,null===(i=this.metrics)||void 0===i||i.onScorePenalty(n))}addPeer(e){const t={connected:!0,expire:0,topics:{},ips:[],behaviourPenalty:0};this.peerStats.set(e,t);const n=this.getIPs(e);this.setIPs(e,n,t.ips),t.ips=n}removePeer(e){const t=this.peerStats.get(e);if(t){if(this.score(e)>0)return this.removeIPs(e,t.ips),void this.peerStats.delete(e);Object.entries(t.topics).forEach(([n,s])=>{s.firstMessageDeliveries=0;const i=this.params.topics[n].meshMessageDeliveriesThreshold;if(s.inMesh&&s.meshMessageDeliveriesActive&&s.meshMessageDeliveries<i){const o=i-s.meshMessageDeliveries;s.meshFailurePenalty+=o*o}s.inMesh=!1,s.meshMessageDeliveriesActive=!1}),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){const n=this.peerStats.get(e);if(n){const s=this.getPtopicStats(n,t);s&&(s.inMesh=!0,s.graftTime=Date.now(),s.meshTime=0,s.meshMessageDeliveriesActive=!1)}}prune(e,t){const n=this.peerStats.get(e);if(n){const s=this.getPtopicStats(n,t);if(s){const i=this.params.topics[t].meshMessageDeliveriesThreshold;if(s.meshMessageDeliveriesActive&&s.meshMessageDeliveries<i){const o=i-s.meshMessageDeliveries;s.meshFailurePenalty+=o*o}s.meshMessageDeliveriesActive=!1,s.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,t,n){this.markFirstMessageDelivery(e,n);const s=this.deliveryRecords.ensureRecord(t),i=Date.now();s.status===Rs.unknown?(s.status=Rs.valid,s.validated=i,s.peers.forEach(o=>{o!==e.toString()&&this.markDuplicateMessageDelivery(o,n)})):vu("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",e,i-s.firstSeen,Rs[s.status])}rejectInvalidMessage(e,t){this.markInvalidMessageDelivery(e,t)}rejectMessage(e,t,n,s){switch(s){case fi.Error:return void this.markInvalidMessageDelivery(e,n);case fi.Blacklisted:return}const i=this.deliveryRecords.ensureRecord(t);if(i.status===Rs.unknown)return s===fi.Ignore?(i.status=Rs.ignored,void i.peers.clear()):(i.status=Rs.invalid,this.markInvalidMessageDelivery(e,n),i.peers.forEach(o=>{this.markInvalidMessageDelivery(o,n)}),void i.peers.clear());vu("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-i.firstSeen,Rs[i.status])}duplicateMessage(e,t,n){const s=this.deliveryRecords.ensureRecord(t);if(!s.peers.has(e))switch(s.status){case Rs.unknown:s.peers.add(e);break;case Rs.valid:s.peers.add(e),this.markDuplicateMessageDelivery(e,n,s.validated);break;case Rs.invalid:this.markInvalidMessageDelivery(e,n)}}markInvalidMessageDelivery(e,t){const n=this.peerStats.get(e);if(n){const s=this.getPtopicStats(n,t);s&&(s.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,t){const n=this.peerStats.get(e);if(n){const s=this.getPtopicStats(n,t);if(s){let i=this.params.topics[t].firstMessageDeliveriesCap;s.firstMessageDeliveries=Math.min(i,s.firstMessageDeliveries+1),s.inMesh&&(i=this.params.topics[t].meshMessageDeliveriesCap,s.meshMessageDeliveries=Math.min(i,s.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,t,n){const s=this.peerStats.get(e);if(s){const o=void 0!==n?Date.now():0,a=this.getPtopicStats(s,t);if(a&&a.inMesh){const c=this.params.topics[t];if(void 0!==n){var i;const f=o-n,E=f>c.meshMessageDeliveriesWindow;if(null===(i=this.metrics)||void 0===i||i.onDuplicateMsgDelivery(t,f,E),E)return}a.meshMessageDeliveries=Math.min(c.meshMessageDeliveriesCap,a.meshMessageDeliveries+1)}}}getIPs(e){return this.components.getConnectionManager().getConnections(bt(e)).map(t=>t.remoteAddr.toOptions().host)}setIPs(e,t,n){e:for(const s of t){for(const o of n)if(s===o)continue e;let i=this.peerIPs.get(s);i||(i=new Set,this.peerIPs.set(s,i)),i.add(e)}e:for(const s of n){for(const o of t)if(s===o)continue e;const i=this.peerIPs.get(s);!i||(i.delete(e),i.size||this.peerIPs.delete(s))}}removeIPs(e,t){t.forEach(n=>{const s=this.peerIPs.get(n);!s||(s.delete(e),s.size||this.peerIPs.delete(n))})}updateIPs(){this.peerStats.forEach((e,t)=>{const n=this.getIPs(t);this.setIPs(t,n,e.ips),e.ips=n})}getPtopicStats(e,t){let n=e.topics[t];return void 0!==n?n:void 0!==this.params.topics[t]?(n={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[t]=n,n):null}}class rRe{constructor(e,t,n){this.gossipsubIWantFollowupMs=e,this.msgIdToStrFn=t,this.metrics=n,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,t){const n=Math.floor(Math.random()*t.length),i=this.msgIdToStrFn(t[n]);let o=this.promises.get(i);o||(o=new Map,this.promises.set(i,o));const a=Date.now();o.has(e)||(o.set(e,a+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(i)||this.requestMsByMsg.set(i,a)))}getBrokenPromises(){var e;const t=Date.now(),n=new Map;let s=0;return this.promises.forEach((i,o)=>{i.forEach((a,c)=>{var u;a<t&&(n.set(c,(null!==(u=n.get(c))&&void 0!==u?u:0)+1),i.delete(c),s++)}),i.size||this.promises.delete(o)}),null===(e=this.metrics)||void 0===e||e.iwantPromiseBroken.inc(s),n}deliverMessage(e){this.trackMessage(e);const t=this.promises.get(e);t&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(t.size)))}rejectMessage(e,t){this.trackMessage(e),t!==fi.Error&&this.promises.delete(e)}clear(){this.promises.clear()}prune(){const e=Date.now()-this.requestMsByMsgExpire;for(const[t,n]of this.requestMsByMsg.entries()){if(!(n<e))break;this.requestMsByMsg.delete(t)}}trackMessage(e){if(this.metrics){const t=this.requestMsByMsg.get(e);void 0!==t&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-t)/1e3),this.requestMsByMsg.delete(e))}}}class Y9{constructor(e){this.entries=new Map,this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,t){this.entries.set(e,{value:t,validUntilMs:Date.now()+this.validityMs})}prune(){const e=Date.now();for(const[t,n]of this.entries.entries()){if(!(n.validUntilMs<e))break;this.entries.delete(t)}}has(e){return this.entries.has(e)}get(e){const t=this.entries.get(e);return t&&t.validUntilMs>=Date.now()?t.value:void 0}clear(){this.entries.clear()}}var Wo=(()=>(function(r){r.Fanout="fanout",r.Random="random",r.Subscribed="subscribed",r.Outbound="outbound",r.NotEnough="not_enough",r.Opportunistic="opportunistic"}(Wo||(Wo={})),Wo))(),Qc=(()=>(function(r){r.Dc="disconnected",r.BadScore="bad_score",r.Prune="prune",r.Unsub="unsubscribed",r.Excess="excess"}(Qc||(Qc={})),Qc))(),wu=(()=>(function(r){r.GraftBackoff="graft_backoff",r.BrokenPromise="broken_promise",r.MessageDeficit="message_deficit",r.IPColocation="IP_colocation"}(wu||(wu={})),wu))(),Eu=(()=>(function(r){r.LowScore="low_score",r.MaxIhave="max_ihave",r.MaxIasked="max_iasked"}(Eu||(Eu={})),Eu))(),Jc=(()=>(function(r){r.graylist="graylist",r.publish="publish",r.gossip="gossip",r.mesh="mesh"}(Jc||(Jc={})),Jc))(),OF=p(49330);p(89690);var sRe=p(91950);const NF={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function BF(r,e,t,n,s){if("sha1"!==s&&"sha2-256"!==s&&"sha2-512"!==s){const a=Object.keys(NF).join(" / ");throw ee(new Error(`Hash '${s}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}const o=sRe(r,e,t,n,NF[s]);return sue.encode64(o,null)}function iRe(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}const LF=Ur("libp2p-pubsub:");function J9(){return J9=(0,B.Z)(function*(r,e,t,n){switch(r.type){case Yc.Signing:{const s={from:r.author.toBytes(),data:n,seqno:Rf(8),topic:e,signature:void 0,key:void 0},i=(0,OF.concat)([LF,w2.Message.encode(s).finish()]);return s.signature=yield r.privateKey.sign(i),s.key=r.key,{raw:s,msg:{type:"signed",from:r.author,data:t,sequenceNumber:BigInt(`0x${ay(s.seqno,"base16")}`),topic:e,signature:s.signature,key:s.key}}}case Yc.Anonymous:return{raw:{from:void 0,data:n,seqno:void 0,topic:e,signature:void 0,key:void 0},msg:{type:"unsigned",data:t,topic:e}}}}),J9.apply(this,arguments)}function X9(){return X9=(0,B.Z)(function*(r,e){var t;switch(r){case Z9:return null!=e.signature?{valid:!1,error:Is.SignaturePresent}:null!=e.seqno?{valid:!1,error:Is.SeqnoPresent}:null!=e.key?{valid:!1,error:Is.FromPresent}:{valid:!0,message:{type:"unsigned",topic:e.topic,data:null!==(t=e.data)&&void 0!==t?t:new Uint8Array(0)}};case E2:{var n,s;if(null==e.seqno)return{valid:!1,error:Is.InvalidSeqno};if(8!==e.seqno.length)return{valid:!1,error:Is.InvalidSeqno};if(null==e.signature)return{valid:!1,error:Is.InvalidSignature};if(null==e.from)return{valid:!1,error:Is.InvalidPeerId};let i,o;try{i=Ai(e.from)}catch{return{valid:!1,error:Is.InvalidPeerId}}if(e.key){if(o=Pc(e.key),void 0!==i.publicKey&&!iRe(o.bytes,i.publicKey))return{valid:!1,error:Is.InvalidPeerId}}else{if(null==i.publicKey)return{valid:!1,error:Is.InvalidPeerId};o=Pc(i.publicKey)}const c=(0,OF.concat)([LF,w2.Message.encode({from:e.from,data:e.data,seqno:e.seqno,topic:e.topic,signature:void 0,key:void 0}).finish()]);return(yield o.verify(c,e.signature))?{valid:!0,message:{type:"signed",from:i,data:null!==(n=e.data)&&void 0!==n?n:new Uint8Array(0),sequenceNumber:BigInt(`0x${ay(e.seqno,"base16")}`),topic:e.topic,signature:e.signature,key:null!==(s=e.key)&&void 0!==s?s:k8(o)}}:{valid:!1,error:Is.InvalidSignature}}}}),X9.apply(this,arguments)}function dRe(r){if("signed"!==r.type)throw new Error("expected signed message type");if(null==r.sequenceNumber)throw Error("missing seqno field");return((r,e)=>{const t=Ur(e.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(r.length+t.length);return n.set(r,0),n.set(t,r.length),n})(r.from.toBytes(),r.sequenceNumber)}function fRe(r){return q9.apply(this,arguments)}function q9(){return q9=(0,B.Z)(function*(r){return yield ZB.encode(r.data)}),q9.apply(this,arguments)}function hRe(r,e,t,n,s){let i=0;const o=new Map;if(Object.entries(e.topics).forEach(([T,U])=>{var b;const P=null!==(b=s.get(T))&&void 0!==b?b:"unknown",F=t.topics[T];if(void 0===F)return;let M=o.get(P);M||(M={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},o.set(P,M));let H=0,$=0,V=0,W=0,ne=0;U.inMesh&&(H+=Math.max(U.meshTime/F.timeInMeshQuantum,F.timeInMeshCap)*F.timeInMeshWeight);let Y=U.firstMessageDeliveries;if(Y>F.firstMessageDeliveriesCap&&(Y=F.firstMessageDeliveriesCap),$+=Y*F.firstMessageDeliveriesWeight,U.meshMessageDeliveriesActive&&U.meshMessageDeliveries<F.meshMessageDeliveriesThreshold){const Ce=F.meshMessageDeliveriesThreshold-U.meshMessageDeliveries;V+=Ce*Ce*F.meshMessageDeliveriesWeight}W+=U.meshFailurePenalty*F.meshFailurePenaltyWeight,ne+=U.invalidMessageDeliveries*U.invalidMessageDeliveries*F.invalidMessageDeliveriesWeight,i+=(H+$+V+W+ne)*F.topicWeight,M.p1w+=H,M.p2w+=$,M.p3w+=V,M.p3bw+=W,M.p4w+=ne}),t.topicScoreCap>0&&i>t.topicScoreCap){i=t.topicScoreCap;const T=t.topicScoreCap/i;for(const U of o.values())U.p1w*=T,U.p2w*=T,U.p3w*=T,U.p3bw*=T,U.p4w*=T}let a=0,c=0,u=0;return a+=t.appSpecificScore(r)*t.appSpecificWeight,e.ips.forEach(T=>{if(t.IPColocationFactorWhitelist.has(T))return;const U=n.get(T),b=U?U.size:0;if(b>t.IPColocationFactorThreshold){const P=b-t.IPColocationFactorThreshold;c+=P*P*t.IPColocationFactorWeight}}),u+=e.behaviourPenalty*e.behaviourPenalty*t.behaviourPenaltyWeight,i+=a+c+u,{byTopic:o,p5w:a,p6w:c,p7w:u,score:i}}function ex(r,e,t=(()=>!0)){const n=new Set;if(e<=0)return n;for(const s of r){if(n.size>=e)break;t(s)&&(n.add(s),r.delete(s))}return n}class x2 extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function Ms(r,e,t){const n=t??{},s=function gRe(r){if(null!=r){if("function"==typeof r[Symbol.iterator])return r[Symbol.iterator]();if("function"==typeof r[Symbol.asyncIterator])return r[Symbol.asyncIterator]();if("function"==typeof r.next)return r}throw new Error("argument is not an iterator or iterable")}(r);function o(){return(o=Ee(function*(){let a;const c=()=>{a?.()};for(e.addEventListener("abort",c);;){let u;try{if(e.aborted){const{abortMessage:E,abortCode:T}=n;throw new x2(E,T)}const f=new Promise((E,T)=>{a=()=>{const{abortMessage:U,abortCode:b}=n;T(new x2(U,b))}});u=yield X(Promise.race([f,s.next()])),a=null}catch(f){e.removeEventListener("abort",c);const E="aborted"===f.type&&e.aborted;if(E&&null!=n.onAbort&&(yield X(n.onAbort(r))),"function"==typeof s.return)try{const T=s.return();T instanceof Promise&&T.catch(U=>{null!=n.onReturnError&&n.onReturnError(U)})}catch(T){null!=n.onReturnError&&n.onReturnError(T)}if(E&&!0===n.returnOnAbort)return;throw f}if(!0===u.done)break;yield u.value}e.removeEventListener("abort",c)})).apply(this,arguments)}return function i(){return o.apply(this,arguments)}()}function bRe(r,e,t){return n=>r(Ms(n,e,t))}function oo(r,e,t){return{sink:bRe(r.sink,e,{...t,onAbort:void 0}),source:Ms(r.source,e,t)}}const S2=r=>{const e=qs.encodingLength(r),t=function _Re(r){var e;return null!=(null==globalThis||null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}(e);return qs.encode(r,t),S2.bytes=e,t};function ei(r){var e,t;const n=null!==(t=(r=null!==(e=r)&&void 0!==e?e:{}).lengthEncoder)&&void 0!==t?t:S2;return function(){var i=Ee(function*(o){var u,a=!1,c=!1;try{for(var E,f=be(o);a=!(E=yield X(f.next())).done;a=!1){const T=E.value,U=n(T.byteLength);U instanceof Uint8Array?yield U:yield*Fe(be(U),X),T instanceof Uint8Array?yield T:yield*Fe(be(T),X)}}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield X(f.return()))}finally{if(c)throw u}}});return function(a){return i.apply(this,arguments)}}()}S2.bytes=0,ei.single=(r,e)=>{var t,n;const s=null!==(n=(e=null!==(t=e)&&void 0!==t?t:{}).lengthEncoder)&&void 0!==n?n:S2;return new Or(s(r.byteLength),r)};var ec=(()=>(function(r){r[r.LENGTH=0]="LENGTH",r[r.DATA=1]="DATA"}(ec||(ec={})),ec))();const tx=r=>{const e=qs.decode(r);return tx.bytes=qs.encodingLength(e),e};function Fs(r){return function(){var t=Ee(function*(n){var s,i,o;const a=new Or;let c=ec.LENGTH,u=-1;const f=null!==(s=r?.lengthDecoder)&&void 0!==s?s:tx,E=null!==(i=r?.maxLengthLength)&&void 0!==i?i:8,T=null!==(o=r?.maxDataLength)&&void 0!==o?o:4194304;var P,U=!1,b=!1;try{for(var M,F=be(n);U=!(M=yield X(F.next())).done;U=!1)for(a.append(M.value);a.byteLength>0;){if(c===ec.LENGTH)try{if(u=f(a),u<0)throw ee(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(u>T)throw ee(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");a.consume(f.bytes),null!=r?.onLength&&r.onLength(u),c=ec.DATA}catch($){if($ instanceof RangeError){if(a.byteLength>E)throw ee(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw $}if(c===ec.DATA){if(a.byteLength<u)break;const $=a.sublist(0,u);a.consume(u),null!=r?.onData&&r.onData($),yield $,c=ec.LENGTH}}}catch(H){b=!0,P=H}finally{try{U&&null!=F.return&&(yield X(F.return()))}finally{if(b)throw P}}if(a.byteLength>0)throw ee(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")});return function(s){return t.apply(this,arguments)}}()}tx.bytes=0,Fs.fromReader=(r,e)=>{let t=1;const n=Ee(function*(){for(;;)try{const{done:i,value:o}=yield X(r.next(t));if(!0===i)return;null!=o&&(yield o)}catch(i){if("ERR_UNDER_READ"===i.code)return{done:!0,value:null};throw i}finally{t=1}})();return Fs({...e??{},onLength:i=>{t=i}})(n)};class wRe{constructor(e,t,n){var s;this.rawStream=e,this.pushable=ss({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=null!==(s=n.maxBufferSize)&&void 0!==s?s:1/0,_t(Ms(this.pushable,this.closeController.signal,{returnOnAbort:!0}),ei(),this.rawStream).catch(t)}get protocol(){return this.rawStream.stat.protocol}push(e){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(e)}close(){this.closeController.abort(),this.pushable.return(),this.rawStream.close()}}class ERe{constructor(e){this.rawStream=e,this.closeController=new AbortController,this.source=Ms(_t(this.rawStream,Fs()),this.closeController.signal,{returnOnAbort:!0})}close(){this.closeController.abort(),this.rawStream.close()}}var zs=(()=>(function(r){r[r.started=0]="started",r[r.stopped=1]="stopped"}(zs||(zs={})),zs))();class kF extends wr{constructor(e={}){var t,n,s;super(),this.multicodecs=[K9,CF],this.peers=new Set,this.streamsInbound=new Map,this.streamsOutbound=new Map,this.outboundInflightQueue=ss({objectMode:!0}),this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.components=new DF,this.directPeerInitial=null,this.status={code:zs.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{var o;const a=null===(o=this.metrics)||void 0===o?void 0:o.heartbeatDuration.startTimer();this.heartbeat().catch(c=>{this.log("Error running heartbeat",c)}).finally(()=>{if(a?.(),this.status.code===zs.started){clearTimeout(this.status.heartbeatTimeout);let u=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;var c;u<.25*this.opts.heartbeatInterval&&(u+=this.opts.heartbeatInterval,null===(c=this.metrics)||void 0===c||c.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,u)}})};const i={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300,...e,scoreParams:HIe(e.scoreParams),scoreThresholds:JIe(e.scoreThresholds)};if(this.globalSignaturePolicy=null!==(t=i.globalSignaturePolicy)&&void 0!==t?t:E2,i.fallbackToFloodsub&&this.multicodecs.push(TF),this.log=Be(null!==(n=i.debugName)&&void 0!==n?n:"libp2p:gossipsub"),this.opts=i,this.direct=new Set(i.directPeers.map(o=>o.id.toString())),this.seenCache=new Y9({validityMs:i.seenTTL}),this.publishedMessageIds=new Y9({validityMs:i.seenTTL}),e.msgIdFn)this.msgIdFn=e.msgIdFn;else switch(this.globalSignaturePolicy){case E2:this.msgIdFn=dRe;break;case Z9:this.msgIdFn=fRe}if(e.fastMsgIdFn&&(this.fastMsgIdFn=e.fastMsgIdFn,this.fastMsgIdCache=new Y9({validityMs:i.seenTTL})),this.msgIdToStrFn=null!==(s=e.msgIdToStrFn)&&void 0!==s?s:jIe,this.mcache=e.messageCache||new uIe(i.mcacheGossip,i.mcacheLength,this.msgIdToStrFn),e.dataTransform&&(this.dataTransform=e.dataTransform),e.metricsRegister){if(!e.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");const o=Math.max(...Object.values(i.scoreParams.topics).map(c=>c.meshMessageDeliveriesWindow),1e3),a=function nRe(r,e,t){return{protocolsEnabled:r.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:r.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:r.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:r.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:r.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:r.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:r.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:r.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:r.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:r.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:r.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:r.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:r.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:r.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:r.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:r.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:r.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:r.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:r.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:r.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:r.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:r.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:r.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:r.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:r.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:r.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:r.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:r.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:r.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:r.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:r.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:r.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:r.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:r.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:r.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:r.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:r.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:r.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:r.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:r.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*t.maxMeshMessageDeliveriesWindowSec,.5*t.maxMeshMessageDeliveriesWindowSec,1*t.maxMeshMessageDeliveriesWindowSec,2*t.maxMeshMessageDeliveriesWindowSec,4*t.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:r.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),scoreFnCalls:r.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:r.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:r.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:r.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:r.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:r.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:r.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:r.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:r.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*t.behaviourPenaltyThreshold,.5*t.behaviourPenaltyThreshold,1*t.behaviourPenaltyThreshold,2*t.behaviourPenaltyThreshold,4*t.behaviourPenaltyThreshold]}),ihaveRcvIgnored:r.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:r.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:r.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:r.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:r.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:r.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:r.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedPeers:r.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:r.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantPromiseDeliveryTime:r.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*t.gossipPromiseExpireSec,1*t.gossipPromiseExpireSec,2*t.gossipPromiseExpireSec,4*t.gossipPromiseExpireSec]}),cacheSize:r.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:r.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),topicStrToLabel:e,toTopic(n){var s;return null!==(s=this.topicStrToLabel.get(n))&&void 0!==s?s:n},onJoin(n){this.topicSubscriptionStatus.set({topicStr:n},1),this.meshPeerCounts.set({topicStr:n},0)},onLeave(n){this.topicSubscriptionStatus.set({topicStr:n},0),this.meshPeerCounts.set({topicStr:n},0)},onAddToMesh(n,s,i){const o=this.toTopic(n);this.meshPeerInclusionEvents.inc({topic:o,reason:s},i)},onRemoveFromMesh(n,s,i){const o=this.toTopic(n);this.meshPeerChurnEvents.inc({topic:o,reason:s},i)},onReportValidationMcacheHit(n){this.asyncValidationMcacheHit.inc({hit:n?"hit":"miss"})},onReportValidation(n,s){const i=this.toTopic(n);this.asyncValidationResult.inc({topic:i,acceptance:s})},onScorePenalty(n){this.scoringPenalties.inc({penalty:n},1)},onIhaveRcv(n,s,i){const o=this.toTopic(n);this.ihaveRcvMsgids.inc({topic:o},s),this.ihaveRcvNotSeenMsgids.inc({topic:o},i)},onIwantRcv(n,s){for(const[i,o]of n){const a=this.toTopic(i);this.iwantRcvMsgids.inc({topic:a},o)}this.iwantRcvDonthaveMsgids.inc(s)},onForwardMsg(n,s){const i=this.toTopic(n);this.msgForwardCount.inc({topic:i},1),this.msgForwardPeers.inc({topic:i},s)},onPublishMsg(n,s,i,o){const a=this.toTopic(n);this.msgPublishCount.inc({topic:a},1),this.msgPublishBytes.inc({topic:a},i*o),this.msgPublishPeers.inc({topic:a},i),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"direct"},s.direct),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"floodsub"},s.floodsub),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"mesh"},s.mesh),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"fanout"},s.fanout)},onMsgRecvPreValidation(n){const s=this.toTopic(n);this.msgReceivedPreValidation.inc({topic:s},1)},onMsgRecvResult(n,s){const i=this.toTopic(n);this.msgReceivedStatus.inc({topic:i,status:s})},onMsgRecvInvalid(n,s){const i=this.toTopic(n);this.msgReceivedInvalid.inc({topic:i,error:s.reason===fi.Error?s.error:s.reason},1)},onDuplicateMsgDelivery(n,s,i){if(this.duplicateMsgDeliveryDelay.observe(s/1e3),i){const o=this.toTopic(n);this.duplicateMsgLateDelivery.inc({topic:o},1)}},onRpcRecv(n,s){this.rpcRecvBytes.inc(s),this.rpcRecvCount.inc(1),n.subscriptions&&this.rpcRecvSubscription.inc(n.subscriptions.length),n.messages&&this.rpcRecvMessage.inc(n.messages.length),n.control&&(this.rpcRecvControl.inc(1),n.control.ihave&&this.rpcRecvIHave.inc(n.control.ihave.length),n.control.iwant&&this.rpcRecvIWant.inc(n.control.iwant.length),n.control.graft&&this.rpcRecvGraft.inc(n.control.graft.length),n.control.prune&&this.rpcRecvPrune.inc(n.control.prune.length))},onRpcSent(n,s){if(this.rpcSentBytes.inc(s),this.rpcSentCount.inc(1),n.subscriptions&&this.rpcSentSubscription.inc(n.subscriptions.length),n.messages&&this.rpcSentMessage.inc(n.messages.length),n.control){var i,o,a,c,u,f,E,T;const U=null!==(i=null===(o=n.control.ihave)||void 0===o?void 0:o.length)&&void 0!==i?i:0,b=null!==(a=null===(c=n.control.iwant)||void 0===c?void 0:c.length)&&void 0!==a?a:0,P=null!==(u=null===(f=n.control.graft)||void 0===f?void 0:f.length)&&void 0!==u?u:0,F=null!==(E=null===(T=n.control.prune)||void 0===T?void 0:T.length)&&void 0!==E?E:0;U>0&&this.rpcSentIHave.inc(U),b>0&&this.rpcSentIWant.inc(b),P>0&&this.rpcSentGraft.inc(P),F>0&&this.rpcSentPrune.inc(F),(U>0||b>0||P>0||F>0)&&this.rpcSentControl.inc(1)}},registerScores(n,s){let i=0,o=0,a=0,c=0;for(const u of n)u>=s.graylistThreshold&&i++,u>=s.publishThreshold&&o++,u>=s.gossipThreshold&&a++,u>=0&&c++;this.peersByScoreThreshold.set({threshold:Jc.graylist},i),this.peersByScoreThreshold.set({threshold:Jc.publish},o),this.peersByScoreThreshold.set({threshold:Jc.gossip},a),this.peersByScoreThreshold.set({threshold:Jc.mesh},c),this.score.set(n)},registerScoreWeights(n){for(const[s,i]of n.byTopic)this.scoreWeights.set({topic:s,p:"p1"},i.p1w),this.scoreWeights.set({topic:s,p:"p2"},i.p2w),this.scoreWeights.set({topic:s,p:"p3"},i.p3w),this.scoreWeights.set({topic:s,p:"p3b"},i.p3bw),this.scoreWeights.set({topic:s,p:"p4"},i.p4w);this.scoreWeights.set({p:"p5"},n.p5w),this.scoreWeights.set({p:"p6"},n.p6w),this.scoreWeights.set({p:"p7"},n.p7w)},registerScorePerMesh(n,s){const i=new Map;n.forEach((o,a)=>{var c;const u=null!==(c=this.topicStrToLabel.get(a))&&void 0!==c?c:"unknown";let f=i.get(u);f||(f=new Set,i.set(u,f)),o.forEach(E=>{var T;return null===(T=f)||void 0===T?void 0:T.add(E)})});for(const[o,a]of i){const c=[];a.forEach(u=>{var f;c.push(null!==(f=s.get(u))&&void 0!==f?f:0)}),this.scorePerMesh.set({topic:o},c)}}}}(e.metricsRegister,e.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:i.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:o/1e3});a.mcacheSize.addCollect(()=>this.onScrapeMetrics(a));for(const c of this.multicodecs)a.protocolsEnabled.set({protocol:c},1);this.metrics=a}else this.metrics=null;this.gossipTracer=new rRe(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new tRe(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:i.heartbeatInterval}),this.maxInboundStreams=e.maxInboundStreams,this.maxOutboundStreams=e.maxOutboundStreams}getPeers(){return[...this.peers.keys()].map(e=>bt(e))}isStarted(){return this.status.code===zs.started}init(e){var t=this;return(0,B.Z)(function*(){t.components=e,t.score.init(e)})()}start(){var e=this;return(0,B.Z)(function*(){if(e.isStarted())return;e.log("starting"),e.publishConfig=yield function $Ie(r,e){return H9.apply(this,arguments)}(e.globalSignaturePolicy,e.components.getPeerId()),e.outboundInflightQueue=ss({objectMode:!0}),_t(e.outboundInflightQueue,function(){var o=(0,B.Z)(function*(a){var f,c=!1,u=!1;try{for(var T,E=be(a);c=!(T=yield E.next()).done;c=!1){const{peerId:U,connection:b}=T.value;yield e.createOutboundStream(U,b)}}catch(U){u=!0,f=U}finally{try{c&&null!=E.return&&(yield E.return())}finally{if(u)throw f}}});return function(a){return o.apply(this,arguments)}}()).catch(o=>e.log.error("outbound inflight queue error",o)),yield Promise.all(e.opts.directPeers.map(function(){var o=(0,B.Z)(function*(a){yield e.components.getPeerStore().addressBook.add(a.id,a.addrs)});return function(a){return o.apply(this,arguments)}}()));const t=e.components.getRegistrar();yield Promise.all(e.multicodecs.map(o=>t.handle(o,e.onIncomingStream.bind(e),{maxInboundStreams:e.maxInboundStreams,maxOutboundStreams:e.maxOutboundStreams})));const n=V9({onConnect:e.onPeerConnected.bind(e),onDisconnect:e.onPeerDisconnected.bind(e)}),s=yield Promise.all(e.multicodecs.map(o=>t.register(o,n))),i=setTimeout(e.runHeartbeat,100);e.status={code:zs.started,registrarTopologyIds:s,heartbeatTimeout:i,hearbeatStartMs:Date.now()+100},e.score.start(),e.directPeerInitial=setTimeout(()=>{Promise.resolve().then((0,B.Z)(function*(){yield Promise.all(Array.from(e.direct).map(function(){var o=(0,B.Z)(function*(a){return yield e.connect(a)});return function(a){return o.apply(this,arguments)}}()))})).catch(o=>{e.log(o)})},1e3),e.log("started")})()}stop(){var e=this;return(0,B.Z)(function*(){if(e.log("stopping"),e.status.code!==zs.started)return;const{registrarTopologyIds:t}=e.status;e.status={code:zs.stopped};const n=e.components.getRegistrar();t.forEach(s=>n.unregister(s)),e.outboundInflightQueue.end();for(const s of e.streamsOutbound.values())s.close();e.streamsOutbound.clear();for(const s of e.streamsInbound.values())s.close();e.streamsInbound.clear(),e.peers.clear(),e.subscriptions.clear(),e.heartbeatTimer&&(e.heartbeatTimer.cancel(),e.heartbeatTimer=null),e.score.stop(),e.mesh.clear(),e.fanout.clear(),e.fanoutLastpub.clear(),e.gossip.clear(),e.control.clear(),e.peerhave.clear(),e.iasked.clear(),e.backoff.clear(),e.outbound.clear(),e.gossipTracer.clear(),e.seenCache.clear(),e.fastMsgIdCache&&e.fastMsgIdCache.clear(),e.directPeerInitial&&clearTimeout(e.directPeerInitial),e.log("stopped")})()}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:e,connection:t}){if(!this.isStarted())return;const n=t.remotePeer;this.addPeer(n,t.stat.direction),this.createInboundStream(n,e),this.outboundInflightQueue.push({peerId:n,connection:t})}onPeerConnected(e,t){!this.isStarted()||(this.addPeer(e,t.stat.direction),this.outboundInflightQueue.push({peerId:e,connection:t}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}createOutboundStream(e,t){var n=this;return(0,B.Z)(function*(){if(!n.isStarted())return;const s=e.toString();if(n.peers.has(s)&&!n.streamsOutbound.has(s))try{var i;const o=new wRe(yield t.newStream(n.multicodecs),c=>n.log.error("outbound pipe error",c),{maxBufferSize:n.opts.maxOutboundBufferSize});n.log("create outbound stream %p",e),n.streamsOutbound.set(s,o);const a=o.protocol;a===TF&&n.floodsubPeers.add(s),null===(i=n.metrics)||void 0===i||i.peersPerProtocol.inc({protocol:a},1),n.subscriptions.size>0&&(n.log("send subscriptions to",s),n.sendSubscriptions(s,Array.from(n.subscriptions),!0))}catch(o){n.log.error("createOutboundStream error",o)}})()}createInboundStream(e,t){var n=this;return(0,B.Z)(function*(){if(!n.isStarted())return;const s=e.toString();if(!n.peers.has(s))return;const i=n.streamsInbound.get(s);void 0!==i&&(n.log("replacing existing inbound steam %s",s),i.close()),n.log("create inbound stream %s",s);const o=new ERe(t);n.streamsInbound.set(s,o),n.pipePeerReadStream(e,o.source).catch(a=>n.log(a))})()}addPeer(e,t){const n=e.toString();this.peers.has(n)||(this.log("new peer %p",e),this.peers.add(n),this.score.addPeer(n),this.outbound.has(n)||this.outbound.set(n,"outbound"===t))}removePeer(e){const t=e.toString();if(!this.peers.has(t))return;this.log("delete peer %p",e),this.peers.delete(t);const n=this.streamsOutbound.get(t),s=this.streamsInbound.get(t);var i;n&&(null===(i=this.metrics)||void 0===i||i.peersPerProtocol.inc({protocol:n.protocol},-1)),n?.close(),s?.close(),this.streamsOutbound.delete(t),this.streamsInbound.delete(t);for(const a of this.topics.values())a.delete(t);for(const[a,c]of this.mesh)if(!0===c.delete(t)){var o;null===(o=this.metrics)||void 0===o||o.onRemoveFromMesh(a,Qc.Dc,1)}for(const a of this.fanout.values())a.delete(t);this.floodsubPeers.delete(t),this.gossip.delete(t),this.control.delete(t),this.outbound.delete(t),this.score.removePeer(t),this.acceptFromWhitelist.delete(t)}get started(){return this.status.code===zs.started}getMeshPeers(e){const t=this.mesh.get(e);return t?Array.from(t):[]}getSubscribers(e){const t=this.topics.get(e);return(t?Array.from(t):[]).map(n=>bt(n))}getTopics(){return Array.from(this.subscriptions)}pipePeerReadStream(e,t){var n=this;return(0,B.Z)(function*(){try{yield _t(t,function(){var s=(0,B.Z)(function*(i){var c,o=!1,a=!1;try{for(var f,u=be(i);o=!(f=yield u.next()).done;o=!1){const T=f.value;try{var E;const U=T.subarray(),b=w2.decode(U);null===(E=n.metrics)||void 0===E||E.onRpcRecv(b,U.length),n.opts.awaitRpcHandler?yield n.handleReceivedRpc(e,b):n.handleReceivedRpc(e,b).catch(P=>n.log(P))}catch(U){n.log(U)}}}catch(T){a=!0,c=T}finally{try{o&&null!=u.return&&(yield u.return())}finally{if(a)throw c}}});return function(i){return s.apply(this,arguments)}}())}catch(s){n.log.error(s),n.onPeerDisconnected(e)}})()}handleReceivedRpc(e,t){var n=this;return(0,B.Z)(function*(){var s;if(!n.acceptFrom(e.toString()))return n.log("received message from unacceptable peer %p",e),void(null===(s=n.metrics)||void 0===s||s.rpcRecvNotAccepted.inc());if(n.log("rpc from %p",e),t.subscriptions&&t.subscriptions.length>0&&(t.subscriptions.forEach(i=>{n.handleReceivedSubscription(e,i)}),n.dispatchEvent(new Qe("subscription-change",{detail:{peerId:e,subscriptions:t.subscriptions.filter(i=>null!==i.topic).map(i=>{var o;return{topic:null!==(o=i.topic)&&void 0!==o?o:"",subscribe:Boolean(i.subscribe)}})}}))),t.messages)for(const i of t.messages){const o=n.handleReceivedMessage(e,i).catch(a=>n.log(a));n.opts.awaitRpcMessageHandler&&(yield o)}t.control&&(yield n.handleControlMessage(e.toString(),t.control))})()}handleReceivedSubscription(e,t){if(null==t.topic)return;this.log("subscription update from %p topic %s",e,t.topic);let n=this.topics.get(t.topic);null==n&&(n=new Set,this.topics.set(t.topic,n)),t.subscribe?n.add(e.toString()):n.delete(e.toString())}handleReceivedMessage(e,t){var n=()=>super.dispatchEvent,s=this;return(0,B.Z)(function*(){var i,o,a;null===(i=s.metrics)||void 0===i||i.onMsgRecvPreValidation(t.topic);const c=yield s.validateReceivedMessage(e,t);switch(null===(o=s.metrics)||void 0===o||o.onMsgRecvResult(t.topic,c.code),c.code){case hi.duplicate:return s.score.duplicateMessage(e.toString(),c.msgIdStr,t.topic),void s.mcache.observeDuplicate(c.msgIdStr,e.toString());case hi.invalid:if(c.msgIdStr){const u=c.msgIdStr;s.score.rejectMessage(e.toString(),u,t.topic,c.reason),s.gossipTracer.rejectMessage(u,c.reason)}else s.score.rejectInvalidMessage(e.toString(),t.topic);return void(null===(a=s.metrics)||void 0===a||a.onMsgRecvInvalid(t.topic,c));case hi.valid:s.score.validateMessage(c.messageId.msgIdStr),s.gossipTracer.deliverMessage(c.messageId.msgIdStr),s.mcache.put(c.messageId,t,!s.opts.asyncValidation),s.subscriptions.has(t.topic)&&(!s.components.getPeerId().equals(e)||s.opts.emitSelf)&&(n().call(s,new Qe("gossipsub:message",{detail:{propagationSource:e,msgId:c.messageId.msgIdStr,msg:c.msg}})),n().call(s,new Qe("message",{detail:c.msg}))),s.opts.asyncValidation||s.forwardMessage(c.messageId.msgIdStr,t,e.toString())}})()}validateReceivedMessage(e,t){var n=this;return(0,B.Z)(function*(){var s,i,o;const a=null===(s=n.fastMsgIdFn)||void 0===s?void 0:s.call(n,t),c=a?null===(i=n.fastMsgIdCache)||void 0===i?void 0:i.get(a):void 0;if(c)return{code:hi.duplicate,msgIdStr:c};const u=yield function aRe(r,e){return X9.apply(this,arguments)}(n.globalSignaturePolicy,t);if(!u.valid)return{code:hi.invalid,reason:fi.Error,error:u.error};const f=u.message;try{n.dataTransform&&(f.data=n.dataTransform.inboundTransform(t.topic,f.data))}catch(P){return n.log("Invalid message, transform failed",P),{code:hi.invalid,reason:fi.Error,error:Is.TransformFailed}}const E=yield n.msgIdFn(f),T=n.msgIdToStrFn(E),U={msgId:E,msgIdStr:T};if(a&&(null===(o=n.fastMsgIdCache)||void 0===o||o.put(a,T)),n.seenCache.has(T))return{code:hi.duplicate,msgIdStr:T};n.seenCache.put(T);const b=n.topicValidators.get(t.topic);if(null!=b){let P;try{P=yield b(f.topic,f,e)}catch(F){const M=F.code;"ERR_TOPIC_VALIDATOR_IGNORE"===M&&(P=io.Ignore),P="ERR_TOPIC_VALIDATOR_REJECT"===M?io.Reject:io.Ignore}if(P!==io.Accept)return{code:hi.invalid,reason:RF(P),msgIdStr:T}}return{code:hi.valid,messageId:U,msg:f}})()}getScore(e){return this.score.score(e)}sendSubscriptions(e,t,n){this.sendRpc(e,{subscriptions:t.map(s=>({topic:s,subscribe:n})),messages:[]})}handleControlMessage(e,t){var n=this;return(0,B.Z)(function*(){if(void 0===t)return;const s=t.ihave?n.handleIHave(e,t.ihave):[],i=t.iwant?n.handleIWant(e,t.iwant):[],o=t.graft?yield n.handleGraft(e,t.graft):[];t.prune&&(yield n.handlePrune(e,t.prune)),(s.length||i.length||o.length)&&n.sendRpc(e,Ho(i,{iwant:s,prune:o}))})()}acceptFrom(e){if(this.direct.has(e))return!0;const t=Date.now(),n=this.acceptFromWhitelist.get(e);if(n&&n.messagesAccepted<128&&n.acceptUntil>=t)return n.messagesAccepted+=1,!0;const s=this.score.score(e);return s>=0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:t+1e3}):this.acceptFromWhitelist.delete(e),s>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,t){var n,s;if(!t.length)return[];const i=this.score.score(e);var o;if(i<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,i),null===(o=this.metrics)||void 0===o||o.ihaveRcvIgnored.inc({reason:Eu.LowScore}),[];const a=(null!==(n=this.peerhave.get(e))&&void 0!==n?n:0)+1;var c;if(this.peerhave.set(e,a),a>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,a),null===(c=this.metrics)||void 0===c||c.ihaveRcvIgnored.inc({reason:Eu.MaxIhave}),[];const u=null!==(s=this.iasked.get(e))&&void 0!==s?s:0;var f;if(u>=mu)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,u),null===(f=this.metrics)||void 0===f||f.ihaveRcvIgnored.inc({reason:Eu.MaxIasked}),[];const E=new Map;if(t.forEach(({topicID:b,messageIDs:P})=>{var F;if(!b||!P||!this.mesh.has(b))return;let M=0;P.forEach(H=>{const $=this.msgIdToStrFn(H);this.seenCache.has($)||(E.set($,H),M++)}),null===(F=this.metrics)||void 0===F||F.onIhaveRcv(b,P.length,M)}),!E.size)return[];let T=E.size;T+u>mu&&(T=mu-u),this.log("IHAVE: Asking for %d out of %d messages from %s",T,E.size,e);let U=Array.from(E.values());return Go(U),U=U.slice(0,T),this.iasked.set(e,u+T),this.gossipTracer.addPromise(e,U),[{messageIDs:U}]}handleIWant(e,t){var n;if(!t.length)return[];const s=this.score.score(e);if(s<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,s),[];const i=new Map,o=new Map;let a=0;return t.forEach(({messageIDs:c})=>{c&&c.forEach(u=>{var f;const E=this.msgIdToStrFn(u),T=this.mcache.getWithIWantCount(E,e);null!=T?(o.set(T.msg.topic,1+(null!==(f=o.get(T.msg.topic))&&void 0!==f?f:0)),T.count>3?this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,u):i.set(E,T.msg)):a++})}),null===(n=this.metrics)||void 0===n||n.onIwantRcv(o,a),i.size?(this.log("IWANT: Sending %d messages to %s",i.size,e),Array.from(i.values())):(this.log("IWANT: Could not provide any wanted messages to %s",e),[])}handleGraft(e,t){var n=this;return(0,B.Z)(function*(){const s=[],i=n.score.score(e),o=Date.now();let a=n.opts.doPX;return t.forEach(({topicID:c})=>{var u,f;if(!c)return;const E=n.mesh.get(c);if(!E)return void(a=!1);if(E.has(e))return;if(n.direct.has(e))return n.log("GRAFT: ignoring request from direct peer %s",e),s.push(c),void(a=!1);const T=null===(u=n.backoff.get(c))||void 0===u?void 0:u.get(e);return"number"==typeof T&&o<T?(n.log("GRAFT: ignoring backed off peer %s",e),n.score.addPenalty(e,1,wu.GraftBackoff),a=!1,o<T+n.opts.graftFloodThreshold-n.opts.pruneBackoff&&n.score.addPenalty(e,1,wu.GraftBackoff),n.addBackoff(e,c),void s.push(c)):i<0?(n.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,i,c),s.push(c),a=!1,void n.addBackoff(e,c)):E.size>=n.opts.Dhi&&!n.outbound.get(e)?(s.push(c),void n.addBackoff(e,c)):(n.log("GRAFT: Add mesh link from %s in %s",e,c),n.score.graft(e,c),E.add(e),void(null===(f=n.metrics)||void 0===f||f.onAddToMesh(c,Wo.Subscribed,1)))}),s.length?yield Promise.all(s.map(c=>n.makePrune(e,c,a))):[]})()}handlePrune(e,t){var n=this;return(0,B.Z)(function*(){const s=n.score.score(e);for(const{topicID:o,backoff:a,peers:c}of t){if(null==o)continue;const u=n.mesh.get(o);if(!u)return;var i;if(n.log("PRUNE: Remove mesh link to %s in %s",e,o),n.score.prune(e,o),u.has(e)&&(u.delete(e),null===(i=n.metrics)||void 0===i||i.onRemoveFromMesh(o,Qc.Unsub,1)),"number"==typeof a&&a>0?n.doAddBackoff(e,o,1e3*a):n.addBackoff(e,o),c&&c.length){if(s<n.opts.scoreThresholds.acceptPXThreshold){n.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,s,o);continue}yield n.pxConnect(c)}}})()}addBackoff(e,t){this.doAddBackoff(e,t,this.opts.pruneBackoff)}doAddBackoff(e,t,n){var s;let i=this.backoff.get(t);i||(i=new Map,this.backoff.set(t,i));const o=Date.now()+n;(null!==(s=i.get(e))&&void 0!==s?s:0)<o&&i.set(e,o)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e,wu.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%15!=0)return;const e=Date.now();this.backoff.forEach((t,n)=>{t.forEach((s,i)=>{s<e&&t.delete(i)}),0===t.size&&this.backoff.delete(n)})}directConnect(){var e=this;return(0,B.Z)(function*(){const t=[];e.direct.forEach(n=>{e.streamsOutbound.has(n)||t.push(n)}),yield Promise.all(t.map(function(){var n=(0,B.Z)(function*(s){return yield e.connect(s)});return function(s){return n.apply(this,arguments)}}()))})()}pxConnect(e){var t=this;return(0,B.Z)(function*(){e.length>t.opts.prunePeers&&(Go(e),e=e.slice(0,t.opts.prunePeers));const n=[];yield Promise.all(e.map(function(){var s=(0,B.Z)(function*(i){if(!i.peerID)return;const o=Ai(i.peerID).toString();if(!t.peers.has(o)){if(!i.signedPeerRecord)return void n.push(o);try{const a=yield Us.openAndCertify(i.signedPeerRecord,"libp2p-peer-record"),c=a.peerId;if(!a.peerId.equals(o))return void t.log("bogus peer record obtained through px: peer ID %p doesn't match expected peer %p",c,o);if(!(yield t.components.getPeerStore().addressBook.consumePeerRecord(a)))return void t.log("bogus peer record obtained through px: could not add peer record to address book");n.push(o)}catch{t.log("bogus peer record obtained through px: invalid signature or not a peer record")}}});return function(i){return s.apply(this,arguments)}}())),n.length&&(yield Promise.all(n.map(function(){var s=(0,B.Z)(function*(i){return yield t.connect(i)});return function(i){return s.apply(this,arguments)}}())))})()}connect(e){var t=this;return(0,B.Z)(function*(){t.log("Initiating connection with %s",e);const n=bt(e),s=yield t.components.getConnectionManager().openConnection(n);for(const i of t.multicodecs)for(const o of t.components.getRegistrar().getTopologies(i))o.onConnect(n,s)})()}subscribe(e){if(this.status.code!==zs.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(const t of this.peers.keys())this.sendSubscriptions(t,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==zs.started)throw new Error("Pubsub is not started");const t=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,t),t)for(const n of this.peers.keys())this.sendSubscriptions(n,[e],!1);this.leave(e).catch(n=>{this.log(n)})}join(e){var t;if(this.status.code!==zs.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),null===(t=this.metrics)||void 0===t||t.onJoin(e);const n=new Set,s=this.fanout.get(e);var i;if(s&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),s.forEach(a=>{!this.direct.has(a)&&this.score.score(a)>=0&&n.add(a)}),null===(i=this.metrics)||void 0===i||i.onAddToMesh(e,Wo.Fanout,n.size)),n.size<this.opts.D){var o;const a=n.size;this.getRandomGossipPeers(e,this.opts.D,u=>!n.has(u)&&!this.direct.has(u)&&this.score.score(u)>=0).forEach(u=>{n.add(u)}),null===(o=this.metrics)||void 0===o||o.onAddToMesh(e,Wo.Random,n.size-a)}this.mesh.set(e,n),n.forEach(a=>{this.log("JOIN: Add mesh link to %s in %s",a,e),this.sendGraft(a,e)})}leave(e){var t=this;return(0,B.Z)(function*(){var n;if(t.status.code!==zs.started)throw new Error("Gossipsub has not started");t.log("LEAVE %s",e),null===(n=t.metrics)||void 0===n||n.onLeave(e);const s=t.mesh.get(e);s&&(yield Promise.all(Array.from(s).map(function(){var i=(0,B.Z)(function*(o){return t.log("LEAVE: Remove mesh link to %s in %s",o,e),yield t.sendPrune(o,e)});return function(o){return i.apply(this,arguments)}}())),t.mesh.delete(e))})()}selectPeersToForward(e,t,n){const s=new Set,i=this.topics.get(e);i&&(this.direct.forEach(a=>{i.has(a)&&t!==a&&(null==n||!n.has(a))&&s.add(a)}),this.floodsubPeers.forEach(a=>{i.has(a)&&t!==a&&(null==n||!n.has(a))&&this.score.score(a)>=this.opts.scoreThresholds.publishThreshold&&s.add(a)}));const o=this.mesh.get(e);return o&&o.size>0&&o.forEach(a=>{t!==a&&(null==n||!n.has(a))&&s.add(a)}),s}selectPeersToPublish(e){const t=new Set,n={direct:0,floodsub:0,mesh:0,fanout:0},s=this.topics.get(e);if(s)if(this.opts.floodPublish)s.forEach(i=>{this.direct.has(i)?(t.add(i),n.direct++):this.score.score(i)>=this.opts.scoreThresholds.publishThreshold&&(t.add(i),n.floodsub++)});else{this.direct.forEach(o=>{s.has(o)&&(t.add(o),n.direct++)}),this.floodsubPeers.forEach(o=>{s.has(o)&&this.score.score(o)>=this.opts.scoreThresholds.publishThreshold&&(t.add(o),n.floodsub++)});const i=this.mesh.get(e);if(i&&i.size>0)i.forEach(o=>{t.add(o),n.mesh++});else{const o=this.fanout.get(e);if(o&&o.size>0)o.forEach(a=>{t.add(a),n.fanout++});else{const a=this.getRandomGossipPeers(e,this.opts.D,c=>this.score.score(c)>=this.opts.scoreThresholds.publishThreshold);a.size>0&&(this.fanout.set(e,a),a.forEach(c=>{t.add(c),n.fanout++}))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:t,tosendCount:n}}forwardMessage(e,t,n,s){var i;n&&this.score.deliverMessage(n,e,t.topic);const o=this.selectPeersToForward(t.topic,n,s),a=Ho([t]);o.forEach(c=>{this.sendRpc(c,a)}),null===(i=this.metrics)||void 0===i||i.onForwardMsg(t.topic,o.size)}publish(e,t){var n=()=>super.dispatchEvent,s=this;return(0,B.Z)(function*(){var i;const o=s.dataTransform?s.dataTransform.outboundTransform(e,t):t;if(null==s.publishConfig)throw Error("PublishError.Uninitialized");const{raw:a,msg:c}=yield function oRe(r,e,t,n){return J9.apply(this,arguments)}(s.publishConfig,e,t,o),u=yield s.msgIdFn(c),f=s.msgIdToStrFn(u);if(s.seenCache.has(f))throw Error("PublishError.Duplicate");const{tosend:E,tosendCount:T}=s.selectPeersToPublish(e),U=!0===s.opts.emitSelf&&s.subscriptions.has(e);if(0===E.size&&!s.opts.allowPublishToZeroPeers&&!U)throw Error("PublishError.InsufficientPeers");s.seenCache.put(f),s.mcache.put({msgId:u,msgIdStr:f},a,!0),s.publishedMessageIds.put(f);const b=Ho([a]);for(const P of E)s.sendRpc(P,b)||E.delete(P);return null===(i=s.metrics)||void 0===i||i.onPublishMsg(e,T,E.size,null!=a.data?a.data.length:0),U&&(E.add(s.components.getPeerId().toString()),n().call(s,new Qe("gossipsub:message",{detail:{propagationSource:s.components.getPeerId(),msgId:f,msg:c}})),n().call(s,new Qe("message",{detail:c}))),{recipients:Array.from(E.values()).map(P=>bt(P))}})()}reportMessageValidationResult(e,t,n){if(n===io.Accept){var s;const c=this.mcache.validate(e);if(null===(s=this.metrics)||void 0===s||s.onReportValidationMcacheHit(null!==c),null!=c){var i;const{message:u,originatingPeers:f}=c;this.score.deliverMessage(t.toString(),e,u.topic),this.forwardMessage(e,c.message,t.toString(),f),null===(i=this.metrics)||void 0===i||i.onReportValidation(u.topic,n)}}else{var o;const c=this.mcache.remove(e);if(null===(o=this.metrics)||void 0===o||o.onReportValidationMcacheHit(null!==c),c){var a;const u=RF(n),{message:f,originatingPeers:E}=c;this.score.rejectMessage(t.toString(),e,f.topic,u);for(const T of E)this.score.rejectMessage(T,e,f.topic,u);null===(a=this.metrics)||void 0===a||a.onReportValidation(f.topic,n)}}}sendGraft(e,t){const s=Ho([],{graft:[{topicID:t}]});this.sendRpc(e,s)}sendPrune(e,t){var n=this;return(0,B.Z)(function*(){const i=Ho([],{prune:[yield n.makePrune(e,t,n.opts.doPX)]});n.sendRpc(e,i)})()}sendRpc(e,t){var n;const s=this.streamsOutbound.get(e);if(!s)return this.log(`Cannot send RPC to ${e} as there is no open stream to it available`),!1;const i=this.control.get(e);i&&(this.piggybackControl(e,t,i),this.control.delete(e));const o=this.gossip.get(e);o&&(this.piggybackGossip(e,t,o),this.gossip.delete(e));const a=w2.encode(t).finish();try{s.push(a)}catch(c){return this.log.error(`Cannot send rpc to ${e}`,c),i&&this.control.set(e,i),o&&this.gossip.set(e,o),!1}return null===(n=this.metrics)||void 0===n||n.onRpcSent(t,a.length),!0}piggybackControl(e,t,n){const s=(n.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),i=(n.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!s.length&&!i.length||(t.control?(t.control.graft=t.control.graft&&t.control.graft.concat(s),t.control.prune=t.control.prune&&t.control.prune.concat(i)):t.control={graft:s,prune:i,ihave:[],iwant:[]})}piggybackGossip(e,t,n){t.control||(t.control={ihave:[],iwant:[],graft:[],prune:[]}),t.control.ihave=n}sendGraftPrune(e,t,n){var s=this;return(0,B.Z)(function*(){const i=s.opts.doPX;for(const[o,a]of e){const c=a.map(T=>({topicID:T}));let u=[];const f=t.get(o);f&&(u=yield Promise.all(f.map(function(){var T=(0,B.Z)(function*(U){var b;return yield s.makePrune(o,U,i&&!(null!==(b=n.get(o))&&void 0!==b&&b))});return function(U){return T.apply(this,arguments)}}())),t.delete(o));const E=Ho([],{graft:c,prune:u});s.sendRpc(o,E)}for(const[o,a]of t){const c=yield Promise.all(a.map(function(){var f=(0,B.Z)(function*(E){var T;return yield s.makePrune(o,E,i&&!(null!==(T=n.get(o))&&void 0!==T&&T))});return function(E){return f.apply(this,arguments)}}())),u=Ho([],{prune:c});s.sendRpc(o,u)}})()}emitGossip(e){const t=this.mcache.getGossipIDs(new Set(e.keys()));for(const[s,i]of e){var n;this.doEmitGossip(s,i,null!==(n=t.get(s))&&void 0!==n?n:[])}}doEmitGossip(e,t,n){if(!n.length||(Go(n),n.length>mu&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",n.length),!t.size))return;let s=this.opts.Dlazy;const i=.25*t.size;let o=t;i>s&&(s=i),s>o.size?s=o.size:o=Go(Array.from(o)).slice(0,s),o.forEach(a=>{let c=n;n.length>mu&&(c=Go(c.slice()).slice(0,mu)),this.pushGossip(a,{topicID:e,messageIDs:c})})}flush(){for(const[e,t]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,Ho([],{ihave:t}));for(const[e,t]of this.control.entries())this.control.delete(e),this.sendRpc(e,Ho([],{graft:t.graft,prune:t.prune}))}pushGossip(e,t){this.log("Add gossip to %s",e);const n=this.gossip.get(e)||[];this.gossip.set(e,n.concat(t))}makePrune(e,t,n){var s=this;return(0,B.Z)(function*(){if(s.score.prune(e,t),s.streamsOutbound.get(e).protocol===CF)return{topicID:t,peers:[]};const i=s.opts.pruneBackoff/1e3;if(!n)return{topicID:t,peers:[],backoff:i};const o=s.getRandomGossipPeers(t,s.opts.prunePeers,c=>c!==e&&s.score.score(c)>=0),a=yield Promise.all(Array.from(o).map(function(){var c=(0,B.Z)(function*(u){const f=bt(u);return{peerID:f.toBytes(),signedPeerRecord:yield s.components.getPeerStore().addressBook.getRawEnvelope(f)}});return function(u){return c.apply(this,arguments)}}()));return{topicID:t,peers:a,backoff:i}})()}heartbeat(){var e=this;return(0,B.Z)(function*(){var t,n;const{D:s,Dlo:i,Dhi:o,Dscore:a,Dout:c,fanoutTTL:u}=e.opts;e.heartbeatTicks++;const f=new Map,E=M=>{let H=f.get(M);return void 0===H&&(H=e.score.score(M),f.set(M,H)),H},T=new Map,U=new Map,b=new Map;e.clearBackoff(),e.peerhave.clear(),null===(t=e.metrics)||void 0===t||t.cacheSize.set({cache:"iasked"},e.iasked.size),e.iasked.clear(),e.applyIwantPenalties(),e.heartbeatTicks%e.opts.directConnectTicks==0&&(yield e.directConnect()),null===(n=e.fastMsgIdCache)||void 0===n||n.prune(),e.seenCache.prune(),e.gossipTracer.prune(),e.publishedMessageIds.prune();const P=new Map;e.mesh.forEach((M,H)=>{const $=e.topics.get(H),V=new Set,W=new Set;if(P.set(H,W),$){const q=Go(Array.from($)),ge=e.backoff.get(H);for(const Ce of q){const De=e.streamsOutbound.get(Ce);if(De&&e.multicodecs.includes(De.protocol)&&!M.has(Ce)&&!e.direct.has(Ce)){const Je=E(Ce);(!ge||!ge.has(Ce))&&Je>=0&&V.add(Ce),Je>=e.opts.scoreThresholds.gossipThreshold&&W.add(Ce)}}}const ne=(q,ge)=>{var Ce;e.log("HEARTBEAT: Remove mesh link to %s in %s",q,H),e.addBackoff(q,H),M.delete(q),E(q)>=e.opts.scoreThresholds.gossipThreshold&&W.add(q),null===(Ce=e.metrics)||void 0===Ce||Ce.onRemoveFromMesh(H,ge,1);const De=U.get(q);De?De.push(H):U.set(q,[H])},Y=(q,ge)=>{var Ce;e.log("HEARTBEAT: Add mesh link to %s in %s",q,H),e.score.graft(q,H),M.add(q),W.delete(q),null===(Ce=e.metrics)||void 0===Ce||Ce.onAddToMesh(H,ge,1);const De=T.get(q);De?De.push(H):T.set(q,[H])};if(M.forEach(q=>{const ge=E(q);ge<0&&(e.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",q,ge,H),ne(q,Qc.BadScore),b.set(q,!0))}),M.size<i&&function yRe(r,e){return ex(r,e,()=>!0)}(V,s-M.size).forEach(Ce=>{Y(Ce,Wo.NotEnough)}),M.size>o){let q=Array.from(M);q.sort((Ce,De)=>E(De)-E(Ce)),q=q.slice(0,a).concat(Go(q.slice(a)));let ge=0;if(q.slice(0,s).forEach(Ce=>{e.outbound.get(Ce)&&ge++}),ge<c){const Ce=Je=>{const Xe=q[Je];for(let gt=Je;gt>0;gt--)q[gt]=q[gt-1];q[0]=Xe};if(ge>0){let Je=ge;for(let Xe=1;Xe<s&&Je>0;Xe++)e.outbound.get(q[Xe])&&(Ce(Xe),Je--)}let De=s-ge;for(let Je=s;Je<q.length&&De>0;Je++)e.outbound.get(q[Je])&&(Ce(Je),De--)}q.slice(s).forEach(Ce=>{ne(Ce,Qc.Excess)})}if(M.size>=i){let q=0;M.forEach(ge=>{e.outbound.get(ge)&&q++}),q<c&&ex(V,c-q,De=>!0===e.outbound.get(De)).forEach(De=>{Y(De,Wo.Outbound)})}if(e.heartbeatTicks%e.opts.opportunisticGraftTicks==0&&M.size>1){const q=Array.from(M).sort((De,Je)=>E(De)-E(Je)),ge=Math.floor(M.size/2),Ce=E(q[ge]);if(Ce<e.opts.scoreThresholds.opportunisticGraftThreshold){const Je=ex(V,e.opts.opportunisticGraftPeers,Xe=>E(Xe)>Ce);for(const Xe of Je)e.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",Xe,H),Y(Xe,Wo.Opportunistic)}}});const F=Date.now();e.fanoutLastpub.forEach((M,H)=>{M+u<F&&(e.fanout.delete(H),e.fanoutLastpub.delete(H))}),e.fanout.forEach((M,H)=>{const $=e.topics.get(H);M.forEach(Y=>{(!$.has(Y)||E(Y)<e.opts.scoreThresholds.publishThreshold)&&M.delete(Y)});const V=e.topics.get(H),W=[],ne=new Set;if(P.set(H,ne),V){const Y=Go(Array.from(V));for(const q of Y){const ge=e.streamsOutbound.get(q);if(ge&&e.multicodecs.includes(ge.protocol)&&!M.has(q)&&!e.direct.has(q)){const Ce=E(q);Ce>=e.opts.scoreThresholds.publishThreshold&&W.push(q),Ce>=e.opts.scoreThresholds.gossipThreshold&&ne.add(q)}}}M.size<s&&W.slice(0,s-M.size).forEach(q=>{M.add(q),ne?.delete(q)})}),e.emitGossip(P),yield e.sendGraftPrune(T,U,b),e.flush(),e.mcache.shift(),e.dispatchEvent(new Qe("gossipsub:heartbeat"))})()}getRandomGossipPeers(e,t,n=(()=>!0)){const s=this.topics.get(e);if(!s)return new Set;let i=[];return s.forEach(o=>{const a=this.streamsOutbound.get(o);!a||this.multicodecs.includes(a.protocol)&&n(o)&&i.push(o)}),i=Go(i),t>0&&i.length>t&&(i=i.slice(0,t)),new Set(i)}onScrapeMetrics(e){var t,n;e.mcacheSize.set(this.mcache.size),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},null!==(t=null===(n=this.fastMsgIdCache)||void 0===n?void 0:n.size)&&void 0!==t?t:0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),e.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let s=0;for(const f of this.backoff.values())s+=f.size;e.cacheSize.set({cache:"backoff"},s);for(const[f,E]of this.topics)e.topicPeersCount.set({topicStr:f},E.size);for(const[f,E]of this.mesh)e.meshPeerCounts.set({topicStr:f},E.size);const i=[],o=new Map;e.behaviourPenalty.reset();for(const f of this.peers.keys()){var a,c;const E=this.score.score(f);i.push(E),o.set(f,E),e.behaviourPenalty.observe(null!==(a=null===(c=this.score.peerStats.get(f))||void 0===c?void 0:c.behaviourPenalty)&&void 0!==a?a:0)}e.registerScores(i,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,o);const u=function pRe(r,e,t,n,s){const i={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(const o of r){const a=e.get(o);if(a){const c=hRe(o,a,t,n,s);for(const[u,f]of c.byTopic){let E=i.byTopic.get(u);E||(E={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},i.byTopic.set(u,E)),E.p1w.push(f.p1w),E.p2w.push(f.p2w),E.p3w.push(f.p3w),E.p3bw.push(f.p3bw),E.p4w.push(f.p4w)}i.p5w.push(c.p5w),i.p6w.push(c.p6w),i.p7w.push(c.p7w),i.score.push(c.score)}else i.p5w.push(0),i.p6w.push(0),i.p7w.push(0),i.score.push(0)}return i}(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(u)}}kF.multicodec=K9;var CRe=Math.pow(2,31),DRe=Math.pow(2,7),ORe=Math.pow(2,14),PRe=Math.pow(2,21),NRe=Math.pow(2,28),BRe=Math.pow(2,35),LRe=Math.pow(2,42),kRe=Math.pow(2,49),URe=Math.pow(2,56),MRe=Math.pow(2,63),zRe={encode:function MF(r,e,t){e=e||[];for(var n=t=t||0;r>=CRe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,MF.bytes=t-n+1,e},decode:function rx(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw rx.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return rx.bytes=i-n,t},encodingLength:function(r){return r<DRe?1:r<ORe?2:r<PRe?3:r<NRe?4:r<BRe?5:r<LRe?6:r<kRe?7:r<URe?8:r<MRe?9:10}};const A2=zRe,nx=(r,e=0)=>[A2.decode(r,e),A2.decode.bytes],T2=(r,e,t=0)=>(A2.encode(r,e,t),e),C2=r=>A2.encodingLength(r),sx=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class ix{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const QRe=function GRe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class JRe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class XRe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return zF(this,e)}}class qRe{constructor(e){this.decoders=e}or(e){return zF(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const zF=(r,e)=>new qRe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class eDe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new JRe(e,t,n),this.decoder=new XRe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const VF=({name:r,prefix:e,encode:t,decode:n})=>new eDe(r,e,t,n),jF=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=QRe(t,e);return VF({prefix:r,name:e,encode:n,decode:i=>sx(s(i))})},Yo=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>VF({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),tc=jF({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),I2=(jF({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Yo({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),$F=(Yo({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Yo({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Yo({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Yo({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Yo({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Yo({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Yo({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Yo({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),ox=r=>{const e=$F.get(r);if(null==e){const t=new Map;return $F.set(r,t),t}return e};class Mn{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Kh)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==aDe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Mn.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=((r,e)=>{const t=e.byteLength,n=C2(r),s=n+C2(t),i=new Uint8Array(s+t);return T2(r,i,0),T2(t,i,n),i.set(e,s),new ix(r,t,e,i)})(e,t);return Mn.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Mn.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?iDe(t,ox(r),e||tc.encoder):oDe(t,ox(r),e||I2.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Mn)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new Mn(n,s,i,o||KF(n,s,i.bytes))}if(!0===t[cDe]){const{version:n,multihash:s,code:i}=t,o=(r=>{const e=sx(r),[t,n]=nx(e),[s,i]=nx(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new ix(t,s,o,e)})(s);return Mn.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Kh)throw new Error(`Version 0 CID must use dag-pb (code: ${Kh}) block encoding`);return new Mn(e,t,n,n.bytes);case 1:{const s=KF(e,t,n.bytes);return new Mn(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return Mn.create(0,Kh,e)}static createV1(e,t){return Mn.create(1,e,t)}static decode(e){const[t,n]=Mn.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Mn.inspectBytes(e),n=t.size-t.multihashSize,s=sx(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new ix(t.multihashCode,t.digestSize,i,s);return[0===t.version?Mn.createV0(o):Mn.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=nx(e.subarray(t));return t+=T,E};let s=n(),i=Kh;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=sDe(e,t),i=Mn.decode(s);return ox(i).set(n,e),i}}const sDe=(r,e)=>{switch(r[0]){case"Q":return[tc.prefix,(e||tc).decode(`${tc.prefix}${r}`)];case tc.prefix:return[tc.prefix,(e||tc).decode(r)];case I2.prefix:return[I2.prefix,(e||I2).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},iDe=(r,e,t)=>{const{prefix:n}=t;if(n!==tc.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},oDe=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},Kh=112,aDe=18,KF=(r,e,t)=>{const n=C2(r),s=n+C2(e),i=new Uint8Array(s+t.byteLength);return T2(r,i,0),T2(e,i,n),i.set(t,s),i},cDe=Symbol.for("@ipld/js-cid/CID"),Xc=Be("libp2p-delegated-peer-routing");class uDe{constructor(e){if(null==e)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new an({concurrency:4});const{protocol:t,host:n,port:s}=e.getEndpointConfig();Xc(`enabled DelegatedPeerRouting via ${t}://${n}:${s}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}findPeer(e,t={}){var n=this;return(0,B.Z)(function*(){var s;Xc("findPeer starts: %p",e),t.timeout=null!==(s=t.timeout)&&void 0!==s?s:3e4,t.signal=wn([n.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const i=en(),o=en();n.httpQueue.add((0,B.Z)(function*(){return i.resolve(),yield o.promise}));try{yield i.promise;var u,a=!1,c=!1;try{for(var E,f=be(n.client.dht.findPeer(e,t));a=!(E=yield f.next()).done;a=!1){const T=E.value;if("FINAL_PEER"===T.name)return{id:T.peer.id,multiaddrs:T.peer.multiaddrs,protocols:[]}}}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield f.return())}finally{if(c)throw u}}}catch(T){throw Xc.error("findPeer errored: %o",T),T}finally{o.resolve(),Xc("findPeer finished: %p",e)}throw ee(new Error("Not found"),"ERR_NOT_FOUND")})()}getClosestPeers(e,t={}){var n=this;return Ee(function*(){var s;let i;const o=Mn.asCID(e);i=null!=o?o:Ai(e),Xc("getClosestPeers starts: %s",i),t.timeout=null!==(s=t.timeout)&&void 0!==s?s:3e4,t.signal=wn([n.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const a=en(),c=en();n.httpQueue.add((0,B.Z)(function*(){return a.resolve(),yield c.promise}));try{yield X(a.promise);var E,u=!1,f=!1;try{for(var U,T=be(n.client.dht.query(i,t));u=!(U=yield X(T.next())).done;u=!1){const b=U.value;"PEER_RESPONSE"===b.name&&(yield*Fe(be(b.closer.map(P=>({id:P.id,multiaddrs:P.multiaddrs,protocols:[]}))),X))}}catch(b){f=!0,E=b}finally{try{u&&null!=T.return&&(yield X(T.return()))}finally{if(f)throw E}}}catch(b){throw Xc.error("getClosestPeers errored:",b),b}finally{c.resolve(),Xc("getClosestPeers finished: %b",e)}})()}}var HF=p(78753);const ao=Be("libp2p:delegated-content-routing"),R2=3e4;class pDe{constructor(e){if(null==e)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new an({concurrency:4}),this.httpQueueRefs=new an({concurrency:2});const{protocol:t,host:n,port:s}=e.getEndpointConfig();ao(`enabled DelegatedContentRouting via ${t}://${n}:${s}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.httpQueueRefs.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}findProviders(e,t={}){var n=this;return Ee(function*(){var s;ao("findProviders starts: %c",e),t.timeout=null!==(s=t.timeout)&&void 0!==s?s:R2,t.signal=wn([n.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const i=en(),o=en();n.httpQueue.add((0,B.Z)(function*(){return i.resolve(),yield o.promise}));try{yield X(i.promise);var u,a=!1,c=!1;try{for(var E,f=be(n.client.dht.findProvs(e,t));a=!(E=yield X(f.next())).done;a=!1){const T=E.value;"PROVIDER"===T.name&&(yield*Fe(be(T.providers.map(U=>({id:U.id,protocols:[],multiaddrs:U.multiaddrs}))),X))}}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield X(f.return()))}finally{if(c)throw u}}}catch(T){throw ao.error("findProviders errored:",T),T}finally{o.resolve(),ao("findProviders finished: %c",e)}})()}provide(e,t={}){var n=this;return(0,B.Z)(function*(){var s;ao("provide starts: %c",e),t.timeout=null!==(s=t.timeout)&&void 0!==s?s:R2,t.signal=wn([n.abortController.signal].concat(null!=t.signal?[t.signal]:[])),yield n.httpQueueRefs.add((0,B.Z)(function*(){yield n.client.block.stat(e,t),yield HF(n.client.dht.provide(e,t))})),ao("provide finished: %c",e)})()}put(e,t,n={}){var s=this;return(0,B.Z)(function*(){var i;ao("put value start: %b",e),n.timeout=null!==(i=n.timeout)&&void 0!==i?i:R2,n.signal=wn([s.abortController.signal].concat(null!=n.signal?[n.signal]:[])),yield s.httpQueue.add((0,B.Z)(function*(){yield HF(s.client.dht.put(e,t,n))})),ao("put value finished: %b",e)})()}get(e,t={}){var n=this;return(0,B.Z)(function*(){var s;return ao("get value start: %b",e),t.timeout=null!==(s=t.timeout)&&void 0!==s?s:R2,t.signal=wn([n.abortController.signal].concat(null!=t.signal?[t.signal]:[])),yield n.httpQueue.add((0,B.Z)(function*(){var a,i=!1,o=!1;try{for(var u,c=be(n.client.dht.get(e,t));i=!(u=yield c.next()).done;i=!1){const f=u.value;if("VALUE"===f.name)return ao("get value finished: %b",e),f.value}}catch(f){o=!0,a=f}finally{try{i&&null!=c.return&&(yield c.return())}finally{if(o)throw a}}throw ee(new Error("Not found"),"ERR_NOT_FOUND")}))})()}}const gDe=r=>Promise.reject(new Error(`No base found for "${r}"`));class GF{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||gDe;for(const t of e.bases)this.addBase(t)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}getBase(e){var t=this;return(0,B.Z)(function*(){if(t._basesByName[e])return t._basesByName[e];if(t._basesByPrefix[e])return t._basesByPrefix[e];const n=yield t._loadBase(e);return null==t._basesByName[n.name]&&null==t._basesByPrefix[n.prefix]&&t.addBase(n),n})()}listBases(){return Object.values(this._basesByName)}}const bDe=r=>Promise.reject(new Error(`No codec found for "${r}"`));class WF{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||bDe;for(const t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}getCodec(e){var t=this;return(0,B.Z)(function*(){const n="string"==typeof e?t._codecsByName:t._codecsByCode;if(n[e])return n[e];const s=yield t._loadCodec(e);return null==n[e]&&t.addCodec(s),s})()}listCodecs(){return Object.values(this._codecsByName)}}const _De=r=>Promise.reject(new Error(`No hasher found for "${r}"`));class YF{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||_De;for(const t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}getHasher(e){var t=this;return(0,B.Z)(function*(){const n="string"==typeof e?t._hashersByName:t._hashersByCode;if(n[e])return n[e];const s=yield t._loadHasher(e);return null==n[e]&&t.addHasher(s),s})()}listHashers(){return Object.values(this._hashersByName)}}new Uint8Array(0);const xu=r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")};var TDe=Math.pow(2,31),RDe=Math.pow(2,7),DDe=Math.pow(2,14),ODe=Math.pow(2,21),PDe=Math.pow(2,28),NDe=Math.pow(2,35),BDe=Math.pow(2,42),LDe=Math.pow(2,49),kDe=Math.pow(2,56),UDe=Math.pow(2,63),FDe={encode:function JF(r,e,t){e=e||[];for(var n=t=t||0;r>=TDe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,JF.bytes=t-n+1,e},decode:function ax(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw ax.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return ax.bytes=i-n,t},encodingLength:function(r){return r<RDe?1:r<DDe?2:r<ODe?3:r<PDe?4:r<NDe?5:r<BDe?6:r<LDe?7:r<kDe?8:r<UDe?9:10}};const D2=FDe,cx=(r,e=0)=>[D2.decode(r,e),D2.decode.bytes],O2=(r,e,t=0)=>(D2.encode(r,e,t),e),P2=r=>D2.encodingLength(r),N2=(r,e)=>{const t=e.byteLength,n=P2(r),s=n+P2(t),i=new Uint8Array(s+t);return O2(r,i,0),O2(t,i,n),i.set(e,s),new lx(r,t,e,i)};class lx{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const ez=xu,ux={code:0,name:"identity",encode:ez,digest:r=>N2(0,ez(r))};const GDe=function KDe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class WDe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class YDe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return tz(this,e)}}class QDe{constructor(e){this.decoders=e}or(e){return tz(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const tz=(r,e)=>new QDe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class JDe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new WDe(e,t,n),this.decoder=new YDe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const B2=({name:r,prefix:e,encode:t,decode:n})=>new JDe(r,e,t,n),Zh=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=GDe(t,e);return B2({prefix:r,name:e,encode:n,decode:i=>xu(s(i))})},Fn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>B2({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),eOe=B2({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),tOe=Fn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),rOe=Fn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),nOe=Zh({prefix:"9",name:"base10",alphabet:"0123456789"}),sOe=Fn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),iOe=Fn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Hh=Fn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),oOe=Fn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),aOe=Fn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),cOe=Fn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),lOe=Fn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),uOe=Fn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),dOe=Fn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),fOe=Fn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hOe=Fn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),pOe=Zh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),yOe=Zh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Qo=Zh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),gOe=Zh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),bOe=Fn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),_Oe=Fn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),L2=Fn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),mOe=Fn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),rz=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),vOe=rz.reduce((r,e,t)=>(r[t]=e,r),[]),wOe=rz.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),SOe=B2({prefix:"\u{1f680}",name:"base256emoji",encode:function EOe(r){return r.reduce((e,t)=>e+vOe[t],"")},decode:function xOe(r){const e=[];for(const t of r){const n=wOe[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}}),nz=({name:r,code:e,encode:t})=>new AOe(r,e,t);class AOe{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?N2(this.code,t):t.then(n=>N2(this.code,n))}throw Error("Unknown type, must be binary type")}}const sz=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),TOe=nz({name:"sha2-256",code:18,encode:sz("SHA-256")}),COe=nz({name:"sha2-512",code:19,encode:sz("SHA-512")}),IOe="raw",ROe=85,DOe=r=>xu(r),OOe=r=>xu(r),POe=new TextEncoder,NOe=new TextDecoder,BOe="json",LOe=512,kOe=r=>POe.encode(JSON.stringify(r)),UOe=r=>JSON.parse(NOe.decode(r)),iz=new WeakMap,dx=r=>{const e=iz.get(r);if(null==e){const t=new Map;return iz.set(r,t),t}return e};class it{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Gh)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==jOe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return it.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=N2(e,t);return it.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return it.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?zOe(t,dx(r),e||Qo.encoder):VOe(t,dx(r),e||Hh.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof it)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new it(n,s,i,o||oz(n,s,i.bytes))}if(!0===t[$Oe]){const{version:n,multihash:s,code:i}=t,o=(r=>{const e=xu(r),[t,n]=cx(e),[s,i]=cx(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new lx(t,s,o,e)})(s);return it.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Gh)throw new Error(`Version 0 CID must use dag-pb (code: ${Gh}) block encoding`);return new it(e,t,n,n.bytes);case 1:{const s=oz(e,t,n.bytes);return new it(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return it.create(0,Gh,e)}static createV1(e,t){return it.create(1,e,t)}static decode(e){const[t,n]=it.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=it.inspectBytes(e),n=t.size-t.multihashSize,s=xu(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new lx(t.multihashCode,t.digestSize,i,s);return[0===t.version?it.createV0(o):it.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=cx(e.subarray(t));return t+=T,E};let s=n(),i=Gh;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=FOe(e,t),i=it.decode(s);return dx(i).set(n,e),i}}const FOe=(r,e)=>{switch(r[0]){case"Q":return[Qo.prefix,(e||Qo).decode(`${Qo.prefix}${r}`)];case Qo.prefix:return[Qo.prefix,(e||Qo).decode(r)];case Hh.prefix:return[Hh.prefix,(e||Hh).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},zOe=(r,e,t)=>{const{prefix:n}=t;if(n!==Qo.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},VOe=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},Gh=112,jOe=18,oz=(r,e,t)=>{const n=P2(r),s=n+P2(e),i=new Uint8Array(s+t.byteLength);return O2(r,i,0),O2(e,i,n),i.set(t,s),i},$Oe=Symbol.for("@ipld/js-cid/CID"),fx={...D_,...O_,...P_,...N_,...B_,...L_,...k_,...U_,...M_,...F_},KOe={...z_,...R_},ZOe={raw:V_,json:j_};function az(r){try{r=zE(at(r))}catch{}return r.toString()}const cz=Be("ipfs-http-client:lib:error-handler"),GOe=Sr.bind({ignoreUndefined:!0}),WOe=fa.isBrowser||fa.isWebWorker?location.protocol:"http",YOe=fa.isBrowser||fa.isWebWorker?location.hostname:"localhost",QOe=fa.isBrowser||fa.isWebWorker?location.port:"5001",XOe=function(){var r=(0,B.Z)(function*(e){let t;try{if((e.headers.get("Content-Type")||"").startsWith("application/json")){const s=yield e.json();cz(s),t=s.Message||s.message}else t=yield e.text()}catch(s){cz("Failed to parse error response",s),t=s.message}let n=new Io.HTTPError(e);throw t&&(t.includes("deadline has elapsed")&&(n=new Io.TimeoutError),t&&t.includes("context deadline exceeded")&&(n=new Io.TimeoutError)),t&&t.includes("request timed out")&&(n=new Io.TimeoutError),t&&(n.message=t),n});return function(t){return r.apply(this,arguments)}}(),qOe=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,lz=r=>r.replace(qOe,function(e){return"-"+e.toLowerCase()}),ePe=r=>"string"==typeof r?Vp(r):r;class hx extends Io{constructor(e={}){const t=((r={})=>{let e,n,t={};if("string"==typeof r||Sl(r))e=new URL(az(r));else if(r instanceof URL)e=r;else if("string"==typeof r.url||Sl(r.url))e=new URL(az(r.url)),t=r;else if(r.url instanceof URL)e=r.url,t=r;else{t=r||{};const s=(t.protocol||WOe).replace(":",""),i=(t.host||YOe).split(":")[0];e=new URL(`${s}://${i}:${t.port||QOe}`)}if(t.apiPath?e.pathname=t.apiPath:("/"===e.pathname||void 0===e.pathname)&&(e.pathname="api/v0"),fa.isNode){const s=void 0;n=t.agent||new s({keepAlive:!0,maxSockets:6})}return{...t,host:e.host,protocol:e.protocol.replace(":",""),port:Number(e.port),apiPath:e.pathname,url:e,agent:n}})(e);super({timeout:ePe(t.timeout||0)||void 0,headers:t.headers,base:`${t.url}`,handleError:XOe,transformSearchParams:s=>{const i=new URLSearchParams;for(const[o,a]of s)"undefined"!==a&&"null"!==a&&"signal"!==o&&i.append(lz(o),a),"timeout"===o&&!isNaN(a)&&i.append(lz(o),a);return i},agent:t.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;const n=this.fetch;this.fetch=(s,i={})=>("string"==typeof s&&!s.startsWith("/")&&(s=`${t.url}/${s}`),n.call(this,s,GOe(i,{method:"POST"})))}}const ke=r=>e=>r(new hx(e),e);function uz(r){if(null!=r)return"string"==typeof r?r:r.toString(8).padStart(4,"0")}function dz(r){if(null==r)return;let e;if(null!=r.secs&&(e={secs:r.secs,nsecs:r.nsecs}),null!=r.Seconds&&(e={secs:r.Seconds,nsecs:r.FractionalNanoseconds}),Array.isArray(r)&&(e={secs:r[0],nsecs:r[1]}),r instanceof Date){const t=r.getTime(),n=Math.floor(t/1e3);e={secs:n,nsecs:1e3*(t-1e3*n)}}if(Object.prototype.hasOwnProperty.call(e,"secs")){if(null!=e&&null!=e.nsecs&&(e.nsecs<0||e.nsecs>999999999))throw ee(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}function Me({arg:r,searchParams:e,hashAlg:t,mtime:n,mode:s,...i}={}){e&&(i={...i,...e}),t&&(i.hash=t),null!=n&&(n=dz(n),i.mtime=n.secs,i.mtimeNsecs=n.nsecs),null!=s&&(i.mode=uz(s)),i.timeout&&!isNaN(i.timeout)&&(i.timeout=`${i.timeout}ms`),null==r?r=[]:Array.isArray(r)||(r=[r]);const o=new URLSearchParams(i);return r.forEach(a=>o.append("arg",a)),o}const tPe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){return((yield(yield r.post("bitswap/wantlist",{signal:n.signal,searchParams:Me(n),headers:n.headers})).json()).Keys||[]).map(i=>it.parse(i["/"]))})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),rPe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){return((yield(yield r.post("bitswap/wantlist",{signal:s.signal,searchParams:Me({...s,peer:n.toString()}),headers:s.headers})).json()).Keys||[]).map(o=>it.parse(o["/"]))})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),fz=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.post("bitswap/stat",{searchParams:Me(n),signal:n.signal,headers:n.headers});return nPe(yield s.json())})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}});function nPe(r){return{provideBufLen:r.ProvideBufLen,wantlist:(r.Wantlist||[]).map(e=>it.parse(e["/"])),peers:(r.Peers||[]).map(e=>bt(e)),blocksReceived:BigInt(r.BlocksReceived),dataReceived:BigInt(r.DataReceived),blocksSent:BigInt(r.BlocksSent),dataSent:BigInt(r.DataSent),dupBlksReceived:BigInt(r.DupBlksReceived),dupDataReceived:BigInt(r.DupDataReceived)}}const sPe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){return(yield r.post("bitswap/unwant",{signal:s.signal,searchParams:Me({arg:n.toString(),...s}),headers:s.headers})).json()})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function iPe(r){return{wantlist:tPe(r),wantlistForPeer:rPe(r),unwant:sPe(r),stat:fz(r)}}const hz=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const i=yield r.post("block/get",{signal:s.signal,searchParams:Me({arg:n.toString(),...s}),headers:s.headers});return new Uint8Array(yield i.arrayBuffer())})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function oPe(r){return px.apply(this,arguments)}function px(){return px=(0,B.Z)(function*(r){if(Ba(r))return new Blob([r]);if("string"==typeof r||r instanceof String)return new Blob([r.toString()]);if(Wf(r))return r;if(Yf(r)&&(r=Yl(r)),Symbol.iterator in r||Symbol.asyncIterator in r){const e=Gf(r),{value:t,done:n}=yield e.peek();if(n)return pz(e);if(e.push(t),Number.isInteger(t))return new Blob([Uint8Array.from(yield Bc(e))]);if(Ba(t)||"string"==typeof t||t instanceof String)return pz(e)}throw ee(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT")}),px.apply(this,arguments)}function pz(r){return yx.apply(this,arguments)}function yx(){return yx=(0,B.Z)(function*(r){const e=[];var s,t=!1,n=!1;try{for(var o,i=be(r);t=!(o=yield i.next()).done;t=!1)e.push(o.value)}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield i.return())}finally{if(n)throw s}}return new Blob(e)}),yx.apply(this,arguments)}function aPe(r){return fB(r,oPe,!0)}function cPe(r){if(null!=r)return"string"==typeof r?r:r.toString(8).padStart(4,"0")}function co(r,e){return gx.apply(this,arguments)}function gx(){return gx=(0,B.Z)(function*(r,e,t={}){const n=[],s=new FormData;let i=0,o=0;var u,a=!1,c=!1;try{for(var E,f=be(aPe(r));a=!(E=yield f.next()).done;a=!1){const{content:T,path:U,mode:b,mtime:P}=E.value;let F="";i>0&&(F=`-${i}`);let H=(T?"file":"dir")+F;const $=[];if(null!=b&&$.push(`mode=${cPe(b)}`),null!=P){const{secs:V,nsecs:W}=P;$.push(`mtime=${V}`),null!=W&&$.push(`mtime-nsecs=${W}`)}if($.length&&(H=`${H}?${$.join("&")}`),T){s.set(H,T,null!=U?encodeURIComponent(U):void 0);const V=o+T.size;n.push({name:U,start:o,end:V}),o=V}else{if(null==U)throw new Error("path or content or both must be set");s.set(H,new File([""],encodeURIComponent(U),{type:"application/x-directory"}))}i++}}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield f.return())}finally{if(c)throw u}}return{total:o,parts:n,headers:t,body:s}}),gx.apply(this,arguments)}function lo(...r){return(0,wn.anySignal)(function lPe(r){return r.filter(Boolean)}(r))}const uPe=ke(r=>{function e(n){return t.apply(this,arguments)}function t(){return(t=(0,B.Z)(function*(n,s={}){const i=new AbortController,o=lo(i.signal,s.signal);let a;try{a=yield(yield r.post("block/put",{signal:o,searchParams:Me(s),...yield co([n],i,s.headers)})).json()}catch(c){if("dag-pb"===s.format)return e(n,{...s,format:"protobuf"});if("dag-cbor"===s.format)return e(n,{...s,format:"cbor"});throw c}return it.parse(a.Key)})).apply(this,arguments)}return e}),dPe=ke(r=>{function t(){return(t=Ee(function*(n,s={}){Array.isArray(n)||(n=[n]);const i=yield X(r.post("block/rm",{signal:s.signal,searchParams:Me({arg:n.map(E=>E.toString()),"stream-channels":!0,...s}),headers:s.headers}));var c,o=!1,a=!1;try{for(var f,u=be(i.ndjson());o=!(f=yield X(u.next())).done;o=!1){const E=f.value;yield fPe(E)}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function fPe(r){const e={cid:it.parse(r.Hash)};return r.Error&&(e.error=new Error(r.Error)),e}const hPe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const o=yield(yield r.post("block/stat",{signal:s.signal,searchParams:Me({arg:n.toString(),...s}),headers:s.headers})).json();return{cid:it.parse(o.Key),size:o.Size}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function pPe(r){return{get:hz(r),put:uPe(r),rm:dPe(r),stat:hPe(r)}}const yPe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const i=yield r.post("bootstrap/add",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers}),{Peers:o}=yield i.json();return{Peers:o.map(a=>at(a))}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),gPe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.post("bootstrap/rm",{signal:n.signal,searchParams:Me({...n,all:!0}),headers:n.headers}),{Peers:i}=yield s.json();return{Peers:i.map(o=>at(o))}})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),bPe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.post("bootstrap/list",{signal:n.signal,searchParams:Me(n),headers:n.headers}),{Peers:i}=yield s.json();return{Peers:i.map(o=>at(o))}})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),_Pe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.post("bootstrap/add",{signal:n.signal,searchParams:Me({...n,default:!0}),headers:n.headers}),{Peers:i}=yield s.json();return{Peers:i.map(o=>at(o))}})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),mPe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const i=yield r.post("bootstrap/rm",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers}),{Peers:o}=yield i.json();return{Peers:o.map(a=>at(a))}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function vPe(r){return{add:yPe(r),clear:gPe(r),list:bPe(r),reset:_Pe(r),rm:mPe(r)}}const wPe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const o=yield(yield r.post("config/profile/apply",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers})).json();return{original:o.OldCfg,updated:o.NewCfg}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function fn(r){if(null==r)return r;const e=/^[A-Z]+$/;return Object.keys(r).reduce((n,s)=>(e.test(s)?n[s.toLowerCase()]=r[s]:e.test(s[0])?n[s[0].toLowerCase()+s.slice(1)]=r[s]:n[s]=r[s],n),{})}const EPe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){return(yield(yield r.post("config/profile/list",{signal:n.signal,searchParams:Me(n),headers:n.headers})).json()).map(o=>fn(o))})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}});function xPe(r){return{apply:wPe(r),list:EPe(r)}}const SPe=ke(r=>function(){var t=(0,B.Z)(function*(n,s={}){if(!n)throw new Error("key argument is required");return(yield(yield r.post("config",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers})).json()).Value});return function(s){return t.apply(this,arguments)}}()),APe=ke(r=>function(){var t=(0,B.Z)(function*(n={}){return yield(yield r.post("config/show",{signal:n.signal,searchParams:Me({...n}),headers:n.headers})).json()});return function(){return t.apply(this,arguments)}}());function yz(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function gz(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const bz=gz("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),bx=gz("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function TPe(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?yz(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),_z={utf8:bz,"utf-8":bz,hex:fx.base16,latin1:bx,ascii:bx,binary:bx,...fx};function k2(r,e="utf8"){const t=_z[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):yz(globalThis.Buffer.from(r,"utf-8"))}const CPe=ke(r=>function(){var t=(0,B.Z)(function*(n,s={}){const i=new AbortController,o=lo(i.signal,s.signal);yield(yield r.post("config/replace",{signal:o,searchParams:Me(s),...yield co([k2(JSON.stringify(n))],i,s.headers)})).text()});return function(s){return t.apply(this,arguments)}}()),IPe=ke(r=>function(){var t=(0,B.Z)(function*(n,s,i={}){if("string"!=typeof n)throw new Error("Invalid key type");const o={...i,...RPe(n,s)};yield(yield r.post("config",{signal:i.signal,searchParams:Me(o),headers:i.headers})).text()});return function(s,i){return t.apply(this,arguments)}}()),RPe=(r,e)=>{switch(typeof e){case"boolean":return{arg:[r,e.toString()],bool:!0};case"string":return{arg:[r,e]};default:return{arg:[r,JSON.stringify(e)],json:!0}}};function DPe(r){return{getAll:APe(r),get:SPe(r),set:IPe(r),replace:CPe(r),profiles:xPe(r)}}const OPe=ke(r=>{function t(){return(t=Ee(function*(n,s={}){const i=yield X(r.post("dag/export",{signal:s.signal,searchParams:Me({arg:n.toString()}),headers:s.headers}));yield*Fe(be(i.iterator()),X)})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function mz(r,e,t,n,s){return _x.apply(this,arguments)}function _x(){return _x=Ee(function*(r,e,t,n,s){const i=function(){var u=(0,B.Z)(function*(f){const E=yield t.getCodec(f.code),T=yield n(f,s);return E.decode(T)});return function(E){return u.apply(this,arguments)}}(),o=e.split("/").filter(Boolean);let a=yield X(i(r)),c=r;for(;o.length;){const u=o.shift();if(!u)throw ee(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(!Object.prototype.hasOwnProperty.call(a,u))throw ee(new Error(`no link named "${u}" under ${c}`),"ERR_NO_LINK");a=a[u],yield{value:a,remainderPath:o.join("/")};const f=it.asCID(a);f&&(c=f,a=yield X(i(a)))}yield{value:a,remainderPath:""}}),_x.apply(this,arguments)}const PPe=(r,e)=>ke((n,s)=>{const i=hz(s);return function(){var a=(0,B.Z)(function*(c,u={}){if(u.path){const b=u.localResolve?yield Ni(mz(c,u.path,r,i,u)):yield Ys(mz(c,u.path,r,i,u));if(!b)throw ee(new Error("Not found"),"ERR_NOT_FOUND");return b}const f=yield r.getCodec(c.code),E=yield i(c,u);return{value:f.decode(E),remainderPath:""}});return function(u){return a.apply(this,arguments)}}()})(e),NPe=ke(r=>{function t(){return(t=Ee(function*(n,s={}){const i=new AbortController,o=lo(i.signal,s.signal),{headers:a,body:c}=yield X(co(n,i,s.headers)),u=yield X(r.post("dag/import",{signal:o,headers:a,body:c,searchParams:Me({"pin-roots":s.pinRoots})}));var T,f=!1,E=!1;try{for(var b,U=be(u.ndjson());f=!(b=yield X(U.next())).done;f=!1){const{Root:P}=b.value;if(void 0!==P){const{Cid:{"/":F},PinErrorMsg:M}=P;yield{root:{cid:it.parse(F),pinErrorMsg:M}}}}}catch(P){E=!0,T=P}finally{try{f&&null!=U.return&&(yield X(U.return()))}finally{if(E)throw T}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),vz=(r,e)=>ke(n=>function(){var i=(0,B.Z)(function*(o,a={}){const c={storeCodec:"dag-cbor",hashAlg:"sha2-256",...a};let u;if(c.inputCodec){if(!(o instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");u=o}else u=(yield r.getCodec(c.storeCodec)).encode(o),c.inputCodec=c.storeCodec;const f=new AbortController,E=lo(f.signal,c.signal),U=yield(yield n.post("dag/put",{timeout:c.timeout,signal:E,searchParams:Me(c),...yield co([u],f,c.headers)})).json();return it.parse(U.Cid["/"])});return function(a){return i.apply(this,arguments)}}())(e),BPe=ke(r=>function(){var t=(0,B.Z)(function*(n,s={}){const o=yield(yield r.post("dag/resolve",{signal:s.signal,searchParams:Me({arg:`${n}${s.path?`/${s.path}`.replace(/\/[/]+/g,"/"):""}`,...s}),headers:s.headers})).json();return{cid:it.parse(o.Cid["/"]),remainderPath:o.RemPath}});return function(s){return t.apply(this,arguments)}}());function LPe(r,e){return{export:OPe(e),get:PPe(r,e),import:NPe(e),put:vz(r,e),resolve:BPe(e)}}const Su=r=>{if(0===r.Type)return{name:"SENDING_QUERY",type:r.Type};if(1===r.Type)return{from:bt(r.ID),name:"PEER_RESPONSE",type:r.Type,messageType:0,messageName:"PUT_VALUE",closer:(r.Responses||[]).map(({ID:t,Addrs:n})=>({id:bt(t),multiaddrs:n.map(s=>at(s)),protocols:[]})),providers:(r.Responses||[]).map(({ID:t,Addrs:n})=>({id:bt(t),multiaddrs:n.map(s=>at(s)),protocols:[]}))};if(2===r.Type){var e;let t={id:null!==(e=r.ID)&&void 0!==e?e:bt(r.ID),multiaddrs:[],protocols:[]};return r.Responses&&r.Responses.length&&(t={id:bt(r.Responses[0].ID),multiaddrs:r.Responses[0].Addrs.map(n=>at(n)),protocols:[]}),{name:"FINAL_PEER",type:r.Type,peer:t}}if(3===r.Type)return{name:"QUERY_ERROR",type:r.Type,error:new Error(r.Extra)};if(4===r.Type)return{name:"PROVIDER",type:r.Type,providers:r.Responses.map(({ID:t,Addrs:n})=>({id:bt(t),multiaddrs:n.map(s=>at(s)),protocols:[]}))};if(5===r.Type)return{name:"VALUE",type:r.Type,value:k2(r.Extra,"base64pad")};if(6===r.Type){const t=r.Responses.map(({ID:n})=>bt(n));if(!t.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:r.Type,peer:t[0]}}if(7===r.Type)return{name:"DIALING_PEER",type:r.Type,peer:bt(r.ID)};throw new Error("Unknown DHT event type")},KPe=ke(r=>{function t(){return(t=Ee(function*(n,s={}){const i=yield X(r.post("dht/findpeer",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers}));var c,o=!1,a=!1;try{for(var f,u=be(i.ndjson());o=!(f=yield X(u.next())).done;o=!1){const E=f.value;yield Su(E)}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),ZPe=ke(r=>{function t(){return(t=Ee(function*(n,s={}){const i=yield X(r.post("dht/findprovs",{signal:s.signal,searchParams:Me({arg:n.toString(),...s}),headers:s.headers}));var c,o=!1,a=!1;try{for(var f,u=be(i.ndjson());o=!(f=yield X(u.next())).done;o=!1){const E=f.value;yield Su(E)}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function U2(r,e="utf8"){const t=_z[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}const HPe=ke(r=>{function t(){return(t=Ee(function*(n,s={}){const i=yield X(r.post("dht/get",{signal:s.signal,searchParams:Me({arg:n instanceof Uint8Array?U2(n):n.toString(),...s}),headers:s.headers}));var c,o=!1,a=!1;try{for(var f,u=be(i.ndjson());o=!(f=yield X(u.next())).done;o=!1){const E=f.value;yield Su(E)}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),GPe=ke(r=>{function t(){return(t=Ee(function*(n,s={recursive:!1}){const i=Array.isArray(n)?n:[n],o=yield X(r.post("dht/provide",{signal:s.signal,searchParams:Me({arg:i.map(T=>T.toString()),...s}),headers:s.headers}));var u,a=!1,c=!1;try{for(var E,f=be(o.ndjson());a=!(E=yield X(f.next())).done;a=!1){const T=E.value;yield Su(T)}}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield X(f.return()))}finally{if(c)throw u}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),WPe=ke(r=>{function t(){return(t=Ee(function*(n,s,i={}){const o=new AbortController,a=lo(o.signal,i.signal),c=yield X(r.post("dht/put",{signal:a,searchParams:Me({arg:n instanceof Uint8Array?U2(n):n.toString(),...i}),...yield X(co([s],o,i.headers))}));var E,u=!1,f=!1;try{for(var U,T=be(c.ndjson());u=!(U=yield X(T.next())).done;u=!1){const b=U.value;yield Su(b)}}catch(b){f=!0,E=b}finally{try{u&&null!=T.return&&(yield X(T.return()))}finally{if(f)throw E}}})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}}),YPe=ke(r=>{function t(){return(t=Ee(function*(n,s={}){const i=yield X(r.post("dht/query",{signal:s.signal,searchParams:Me({arg:n.toString(),...s}),headers:s.headers}));var c,o=!1,a=!1;try{for(var f,u=be(i.ndjson());o=!(f=yield X(u.next())).done;o=!1){const E=f.value;yield Su(E)}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function QPe(r){return{findPeer:KPe(r),findProvs:ZPe(r),get:HPe(r),provide:GPe(r),put:WPe(r),query:YPe(r)}}const JPe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){return(yield r.post("diag/cmds",{signal:n.signal,searchParams:Me(n),headers:n.headers})).json()})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),XPe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){return(yield r.post("diag/net",{signal:n.signal,searchParams:Me(n),headers:n.headers})).json()})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),qPe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){return(yield r.post("diag/sys",{signal:n.signal,searchParams:Me(n),headers:n.headers})).json()})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}});function eNe(r){return{cmds:JPe(r),net:XPe(r),sys:qPe(r)}}const tNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s,i={}){yield(yield r.post("files/chmod",{signal:i.signal,searchParams:Me({arg:n,mode:s,...i}),headers:i.headers})).text()})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}}),rNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s,i={}){const o=Array.isArray(n)?n:[n];yield(yield r.post("files/cp",{signal:i.signal,searchParams:Me({arg:o.concat(s).map(c=>it.asCID(c)?`/ipfs/${c}`:c),...i}),headers:i.headers})).text()})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}}),nNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){if(!n||"string"!=typeof n)throw new Error("ipfs.files.flush requires a path");const o=yield(yield r.post("files/flush",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers})).json();return it.parse(o.Cid)})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function mx(r){const e=fn(r);return Object.prototype.hasOwnProperty.call(e,"mode")&&(e.mode=parseInt(e.mode,8)),Object.prototype.hasOwnProperty.call(e,"mtime")&&(e.mtime={secs:e.mtime,nsecs:e.mtimeNsecs||0},delete e.mtimeNsecs),e}const sNe=ke(r=>{function t(){return(t=Ee(function*(n,s={}){if(!n)throw new Error("ipfs.files.ls requires a path");const i=yield X(r.post("files/ls",{signal:s.signal,searchParams:Me({arg:it.asCID(n)?`/ipfs/${n}`:n,long:!0,...s,stream:!0}),headers:s.headers}));var c,o=!1,a=!1;try{for(var f,u=be(i.ndjson());o=!(f=yield X(u.next())).done;o=!1){const E=f.value;if("Entries"in E)for(const T of E.Entries||[])yield wz(mx(T));else yield wz(mx(E))}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function wz(r){return r.hash&&(r.cid=it.parse(r.hash)),delete r.hash,r.type=1===r.type?"directory":"file",r}const iNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){yield(yield r.post("files/mkdir",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers})).text()})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),oNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s,i={}){Array.isArray(n)||(n=[n]),yield(yield r.post("files/mv",{signal:i.signal,searchParams:Me({arg:n.concat(s),...i}),headers:i.headers})).text()})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}});var aNe=p(61038);const cNe=ke(r=>{function t(){return(t=Ee(function*(n,s={}){const i=yield X(r.post("files/read",{signal:s.signal,searchParams:Me({arg:n,count:s.length,...s}),headers:s.headers}));yield*Fe(be(aNe(i.body)),X)})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),lNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const i=yield r.post("files/rm",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers}),o=yield i.text();if(""!==o){const a=new Io.HTTPError(i);throw a.message=o,a}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),Ez=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const o=yield(yield r.post("files/stat",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers})).json();return o.WithLocality=o.WithLocality||!1,uNe(mx(o))})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function uNe(r){return r.cid=it.parse(r.hash),delete r.hash,r}const dNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){yield(yield r.post("files/touch",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers})).text()})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),fNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s,i={}){const o=new AbortController,a=lo(o.signal,i.signal);yield(yield r.post("files/write",{signal:a,searchParams:Me({arg:n,streamChannels:!0,count:i.length,...i}),...yield co([{content:s,path:"arg",mode:uz(i.mode),mtime:dz(i.mtime)}],o,i.headers)})).text()})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}});function hNe(r){return{chmod:tNe(r),cp:rNe(r),flush:nNe(r),ls:sNe(r),mkdir:iNe(r),mv:oNe(r),read:cNe(r),rm:lNe(r),stat:Ez(r),touch:dNe(r),write:fNe(r)}}const pNe=ke(r=>function(){var t=(0,B.Z)(function*(n,s,i={}){throw ee(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});return function(s,i){return t.apply(this,arguments)}}()),yNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={type:"Ed25519"}){return fn(yield(yield r.post("key/gen",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers})).json())})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),gNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s,i,o={}){return fn(yield(yield r.post("key/import",{signal:o.signal,searchParams:Me({arg:n,pem:s,password:i,...o}),headers:o.headers})).json())})).apply(this,arguments)}return function e(n,s,i){return t.apply(this,arguments)}}),bNe=ke(r=>function(){var t=(0,B.Z)(function*(n,s={}){throw ee(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});return function(s){return t.apply(this,arguments)}}()),_Ne=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){return((yield(yield r.post("key/list",{signal:n.signal,searchParams:Me(n),headers:n.headers})).json()).Keys||[]).map(o=>fn(o))})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),mNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s,i={}){const o=yield r.post("key/rename",{signal:i.signal,searchParams:Me({arg:[n,s],...i}),headers:i.headers});return fn(yield o.json())})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}}),vNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){return fn((yield(yield r.post("key/rm",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers})).json()).Keys[0])})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function wNe(r){return{export:pNe(r),gen:yNe(r),import:gNe(r),info:bNe(r),list:_Ne(r),rename:mNe(r),rm:vNe(r)}}const ENe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s,i={}){const o=yield r.post("log/level",{signal:i.signal,searchParams:Me({arg:[n,s],...i}),headers:i.headers});return fn(yield o.json())})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}}),xNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){return(yield(yield r.post("log/ls",{signal:n.signal,searchParams:Me(n),headers:n.headers})).json()).Strings})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),SNe=ke(r=>{function t(){return(t=Ee(function*(n={}){const s=yield X(r.post("log/tail",{signal:n.signal,searchParams:Me(n),headers:n.headers}));yield*Fe(be(s.ndjson()),X)})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}});function ANe(r){return{level:ENe(r),ls:xNe(r),tail:SNe(r)}}const TNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const i=yield r.post("name/publish",{signal:s.signal,searchParams:Me({arg:`${n}`,...s}),headers:s.headers});return fn(yield i.json())})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),CNe=ke(r=>{function t(){return(t=Ee(function*(n,s={}){const i=yield X(r.post("name/resolve",{signal:s.signal,searchParams:Me({arg:n,stream:!0,...s}),headers:s.headers}));var c,o=!1,a=!1;try{for(var f,u=be(i.ndjson());o=!(f=yield X(u.next())).done;o=!1)yield f.value.Path}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),INe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const i=yield r.post("name/pubsub/cancel",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers});return fn(yield i.json())})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),RNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.post("name/pubsub/state",{signal:n.signal,searchParams:Me(n),headers:n.headers});return fn(yield s.json())})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),DNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){return(yield(yield r.post("name/pubsub/subs",{signal:n.signal,searchParams:Me(n),headers:n.headers})).json()).Strings||[]})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}});function ONe(r){return{cancel:INe(r),state:RNe(r),subs:DNe(r)}}function PNe(r){return{publish:TNe(r),resolve:CNe(r),pubsub:ONe(r)}}const NNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const o=yield(yield r.post("object/data",{signal:s.signal,searchParams:Me({arg:`${n instanceof Uint8Array?it.decode(n):n}`,...s}),headers:s.headers})).arrayBuffer();return new Uint8Array(o,0,o.byteLength)})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),BNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const o=yield(yield r.post("object/get",{signal:s.signal,searchParams:Me({arg:`${n instanceof Uint8Array?it.decode(n):n}`,dataEncoding:"base64",...s}),headers:s.headers})).json();return{Data:k2(o.Data,"base64pad"),Links:(o.Links||[]).map(a=>({Name:a.Name,Hash:it.parse(a.Hash),Tsize:a.Size}))}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),LNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){return((yield(yield r.post("object/links",{signal:s.signal,searchParams:Me({arg:`${n instanceof Uint8Array?it.decode(n):n}`,...s}),headers:s.headers})).json()).Links||[]).map(a=>({Name:a.Name,Tsize:a.Size,Hash:it.parse(a.Hash)}))})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),kNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.post("object/new",{signal:n.signal,searchParams:Me({arg:n.template,...n}),headers:n.headers}),{Hash:i}=yield s.json();return it.parse(i)})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),UNe=(r,e)=>ke(n=>{const s=vz(r,e);function o(){return(o=(0,B.Z)(function*(a,c={}){return s(a,{...c,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})})).apply(this,arguments)}return function i(a){return o.apply(this,arguments)}})(e),MNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const o=yield(yield r.post("object/stat",{signal:s.signal,searchParams:Me({arg:`${n}`,...s}),headers:s.headers})).json();return{...o,Hash:it.parse(o.Hash)}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),FNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s,i={}){const o=yield r.post("object/patch/add-link",{signal:i.signal,searchParams:Me({arg:[`${n}`,s.Name||s.name||"",(s.Hash||s.cid||"").toString()||null],...i}),headers:i.headers}),{Hash:a}=yield o.json();return it.parse(a)})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}}),zNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s,i={}){const o=new AbortController,a=lo(o.signal,i.signal),c=yield r.post("object/patch/append-data",{signal:a,searchParams:Me({arg:`${n}`,...i}),...yield co([s],o,i.headers)}),{Hash:u}=yield c.json();return it.parse(u)})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}}),VNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s,i={}){const o=yield r.post("object/patch/rm-link",{signal:i.signal,searchParams:Me({arg:[`${n}`,s.Name||s.name||null],...i}),headers:i.headers}),{Hash:a}=yield o.json();return it.parse(a)})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}}),jNe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s,i={}){const o=new AbortController,a=lo(o.signal,i.signal),c=yield r.post("object/patch/set-data",{signal:a,searchParams:Me({arg:[`${n}`],...i}),...yield co([s],o,i.headers)}),{Hash:u}=yield c.json();return it.parse(u)})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}});function $Ne(r){return{addLink:FNe(r),appendData:zNe(r),rmLink:VNe(r),setData:jNe(r)}}function KNe(r,e){return{data:NNe(e),get:BNe(e),links:LNe(e),new:kNe(e),put:UNe(r,e),stat:MNe(e),patch:$Ne(e)}}const xz=ke(r=>{function t(){return(t=Ee(function*(n,s={}){var a,i=!1,o=!1;try{for(var u,c=be(wf(n));i=!(u=yield X(c.next())).done;i=!1){const{path:P,recursive:F,metadata:M}=u.value,H=yield X(r.post("pin/add",{signal:s.signal,searchParams:Me({...s,arg:P,recursive:F,metadata:M?JSON.stringify(M):void 0,stream:!0}),headers:s.headers}));var T,f=!1,E=!1;try{for(var b,U=be(H.ndjson());f=!(b=yield X(U.next())).done;f=!1){const $=b.value;if($.Pins)for(const V of $.Pins)yield it.parse(V);else yield it.parse($)}}catch($){E=!0,T=$}finally{try{f&&null!=U.return&&(yield X(U.return()))}finally{if(E)throw T}}}}catch(P){o=!0,a=P}finally{try{i&&null!=c.return&&(yield X(c.return()))}finally{if(o)throw a}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}});function ZNe(r){const e=xz(r);return ke(()=>{function n(){return(n=(0,B.Z)(function*(s,i={}){return Ys(e([{path:s,...i}],i))})).apply(this,arguments)}return function t(s){return n.apply(this,arguments)}})(r)}function Sz(r,e,t){const n={type:r,cid:it.parse(e)};return t&&(n.metadata=t),n}const HNe=ke(r=>{function t(){return(t=Ee(function*(n={}){let s=[];n.paths&&(s=Array.isArray(n.paths)?n.paths:[n.paths]);const i=yield X(r.post("pin/ls",{signal:n.signal,searchParams:Me({...n,arg:s.map(E=>`${E}`),stream:!0}),headers:n.headers}));var c,o=!1,a=!1;try{for(var f,u=be(i.ndjson());o=!(f=yield X(u.next())).done;o=!1){const E=f.value;if(E.Keys){for(const T of Object.keys(E.Keys))yield Sz(E.Keys[T].Type,T,E.Keys[T].Metadata);return}yield Sz(E.Type,E.Cid,E.Metadata)}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),Az=ke(r=>{function t(){return(t=Ee(function*(n,s={}){var a,i=!1,o=!1;try{for(var u,c=be(wf(n));i=!(u=yield X(c.next())).done;i=!1){const{path:P,recursive:F}=u.value,M=new URLSearchParams(s.searchParams);M.append("arg",`${P}`),null!=F&&M.set("recursive",String(F));const H=yield X(r.post("pin/rm",{signal:s.signal,headers:s.headers,searchParams:Me({...s,arg:`${P}`,recursive:F})}));var T,f=!1,E=!1;try{for(var b,U=be(H.ndjson());f=!(b=yield X(U.next())).done;f=!1){const $=b.value;$.Pins?yield*Fe(be($.Pins.map(V=>it.parse(V))),X):yield it.parse($)}}catch($){E=!0,T=$}finally{try{f&&null!=U.return&&(yield X(U.return()))}finally{if(E)throw T}}}}catch(P){o=!0,a=P}finally{try{i&&null!=c.return&&(yield X(c.return()))}finally{if(o)throw a}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),GNe=r=>{const e=Az(r);return ke(()=>{function n(){return(n=(0,B.Z)(function*(s,i={}){return Ys(e([{path:s,...i}],i))})).apply(this,arguments)}return function t(s){return n.apply(this,arguments)}})(r)},Tz=({Name:r,Status:e,Cid:t})=>({cid:it.parse(t),name:r,status:e}),Cz=r=>{if("string"==typeof r&&""!==r)return r;throw new TypeError("service name must be passed")},Iz=r=>{if(it.asCID(r))return r.toString();throw new TypeError("CID instance expected instead of "+typeof r)},vx=({service:r,cid:e,name:t,status:n,all:s})=>{const i=Me({service:Cz(r),name:t,force:!!s||void 0});if(e)for(const o of e)i.append("cid",Iz(o));if(n)for(const o of n)i.append("status",o);return i},WNe=({cid:r,service:e,background:t,name:n,origins:s})=>{const i=Me({arg:Iz(r),service:Cz(e),name:n,background:!!t||void 0});if(s)for(const o of s)i.append("origin",o.toString());return i};function YNe(r){function t(){return(t=(0,B.Z)(function*(n,{timeout:s,signal:i,headers:o,...a}){const c=yield r.post("pin/remote/add",{timeout:s,signal:i,headers:o,searchParams:WNe({cid:n,...a})});return Tz(yield c.json())})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}}function QNe(r){function t(){return(t=Ee(function*({timeout:n,signal:s,headers:i,...o}){const a=yield X(r.post("pin/remote/ls",{timeout:n,signal:s,headers:i,searchParams:vx(o)}));var f,c=!1,u=!1;try{for(var T,E=be(a.ndjson());c=!(T=yield X(E.next())).done;c=!1){const U=T.value;yield Tz(U)}}catch(U){u=!0,f=U}finally{try{c&&null!=E.return&&(yield X(E.return()))}finally{if(u)throw f}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}function JNe(r){function t(){return(t=(0,B.Z)(function*({timeout:n,signal:s,headers:i,...o}){yield r.post("pin/remote/rm",{timeout:n,signal:s,headers:i,searchParams:vx({...o,all:!1})})})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}function XNe(r){function t(){return(t=(0,B.Z)(function*({timeout:n,signal:s,headers:i,...o}){yield r.post("pin/remote/rm",{timeout:n,signal:s,headers:i,searchParams:vx({...o,all:!0})})})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}function qNe(r){const e=String(r);if("undefined"===e)throw Error("endpoint is required");return"/"===e[e.length-1]?e.slice(0,-1):e}function eBe(r){return{service:r.Service,endpoint:new URL(r.ApiEndpoint),...r.Stat&&{stat:tBe(r.Stat)}}}function tBe(r){switch(r.Status){case"valid":{const{Pinning:e,Pinned:t,Queued:n,Failed:s}=r.PinCount;return{status:"valid",pinCount:{queued:n,pinning:e,pinned:t,failed:s}}}case"invalid":return{status:"invalid"};default:return{status:r.Status}}}function rBe(r){function t(){return(t=(0,B.Z)(function*(n,s){const{endpoint:i,key:o,headers:a,timeout:c,signal:u}=s;yield r.post("pin/remote/service/add",{timeout:c,signal:u,searchParams:Me({arg:[n,qNe(i),o]}),headers:a})})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}}function nBe(r){function t(){return(t=(0,B.Z)(function*(n={}){const{stat:s,headers:i,timeout:o,signal:a}=n,c=yield r.post("pin/remote/service/ls",{timeout:o,signal:a,headers:i,searchParams:!0===s?Me({stat:s}):void 0}),{RemoteServices:u}=yield c.json();return u.map(eBe)})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}function sBe(r){function t(){return(t=(0,B.Z)(function*(n,s={}){yield r.post("pin/remote/service/rm",{signal:s.signal,headers:s.headers,searchParams:Me({arg:n})})})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}function iBe(r){const e=new hx(r);return{add:rBe(e),ls:nBe(e),rm:sBe(e)}}function oBe(r){const e=new hx(r);return{add:YNe(e),ls:QNe(e),rm:JNe(e),rmAll:XNe(e),service:iBe(r)}}function aBe(r){return{addAll:xz(r),add:ZNe(r),ls:HNe(r),rmAll:Az(r),rm:GNe(r),remote:oBe(r)}}const cBe=r=>Array.isArray(r)?r.map(wx):r,wx=r=>U2(Wh(r)),Wh=r=>L2.decode(r),lBe=r=>BigInt(`0x${U2(L2.decode(r),"base16")}`),Ex=r=>L2.encode(k2(r)),uBe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const{Strings:s}=yield(yield r.post("pubsub/ls",{signal:n.signal,searchParams:Me(n),headers:n.headers})).json();return cBe(s)||[]})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),dBe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const i=yield r.post("pubsub/peers",{signal:s.signal,searchParams:Me({arg:Ex(n),...s}),headers:s.headers}),{Strings:o}=yield i.json();return o||[]})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),fBe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s,i={}){const o=Me({arg:Ex(n),...i}),a=new AbortController,c=lo(a.signal,i.signal);yield(yield r.post("pubsub/pub",{signal:c,searchParams:o,...yield co([s],a,i.headers)})).text()})).apply(this,arguments)}return function e(n,s){return t.apply(this,arguments)}}),hBe=Be("ipfs-http-client:pubsub:subscribe"),pBe=(r,e)=>ke(t=>{function s(){return(s=(0,B.Z)(function*(i,o,a={}){let c,u;a.signal=e.subscribe(i,o,a.signal);const f=new Promise((T,U)=>{c=T,u=U}),E=setTimeout(()=>c(),1e3);return t.post("pubsub/sub",{signal:a.signal,searchParams:Me({arg:Ex(i),...a}),headers:a.headers}).catch(T=>{e.unsubscribe(i,o),u(T)}).then(T=>{clearTimeout(E),T&&(yBe(T,{onMessage:U=>{if(o){if("function"==typeof o)return void o(U);"function"==typeof o.handleEvent&&o.handleEvent(U)}},onEnd:()=>e.unsubscribe(i,o),onError:a.onError}),c())}),f})).apply(this,arguments)}return function n(i,o){return s.apply(this,arguments)}})(r);function yBe(r,e){return xx.apply(this,arguments)}function xx(){return xx=(0,B.Z)(function*(r,{onMessage:e,onEnd:t,onError:n}){n=n||hBe;try{var o,s=!1,i=!1;try{for(var c,a=be(r.ndjson());s=!(c=yield a.next()).done;s=!1){const E=c.value;try{if(!E.from)continue;var u,f;e(null!=E.from&&null!=E.seqno?{type:"signed",from:bt(E.from),data:Wh(E.data),sequenceNumber:lBe(E.seqno),topic:wx(E.topicIDs[0]),key:Wh(null!==(u=E.key)&&void 0!==u?u:"u"),signature:Wh(null!==(f=E.signature)&&void 0!==f?f:"u")}:{type:"unsigned",data:Wh(E.data),topic:wx(E.topicIDs[0])})}catch(T){T.message=`Failed to parse pubsub message: ${T.message}`,n(T,!1,E)}}}catch(E){i=!0,o=E}finally{try{s&&null!=a.return&&(yield a.return())}finally{if(i)throw o}}}catch(E){gBe(E)||n(E,!0)}finally{t()}}),xx.apply(this,arguments)}const gBe=r=>{switch(r.type){case"aborted":case"abort":return!0;default:return"AbortError"===r.name}},bBe=(r,e)=>{function n(){return(n=(0,B.Z)(function*(s,i){e.unsubscribe(s,i)})).apply(this,arguments)}return function t(s,i){return n.apply(this,arguments)}};class _Be{constructor(){this._subs=new Map}subscribe(e,t,n){const s=this._subs.get(e)||[];if(s.find(o=>o.handler===t))throw new Error(`Already subscribed to ${e} with this handler`);const i=new AbortController;return this._subs.set(e,[{handler:t,controller:i}].concat(s)),n&&n.addEventListener("abort",()=>this.unsubscribe(e,t)),i.signal}unsubscribe(e,t){const n=this._subs.get(e)||[];let s;t?(this._subs.set(e,n.filter(i=>i.handler!==t)),s=n.filter(i=>i.handler===t)):(this._subs.set(e,[]),s=n),(this._subs.get(e)||[]).length||this._subs.delete(e),s.forEach(i=>i.controller.abort())}}function mBe(r){const e=new _Be;return{ls:uBe(r),peers:dBe(r),publish:fBe(r),subscribe:pBe(r,e),unsubscribe:bBe(0,e)}}const vBe=ke(r=>{function t(){return(t=Ee(function*(n={}){const s=yield X(r.post("refs/local",{signal:n.signal,transform:fn,searchParams:Me(n),headers:n.headers}));yield*Fe(be(s.ndjson()),X)})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),wBe=ke((r,e)=>Object.assign(function(){var n=Ee(function*(s,i={}){const o=Array.isArray(s)?s:[s],a=yield X(r.post("refs",{signal:i.signal,searchParams:Me({arg:o.map(c=>`${c instanceof Uint8Array?it.decode(c):c}`),...i}),headers:i.headers,transform:fn}));yield*Fe(be(a.ndjson()),X)});return function(i){return n.apply(this,arguments)}}(),{local:vBe(e)})),EBe=ke(r=>{function t(){return(t=Ee(function*(n={}){const s=yield X(r.post("repo/gc",{signal:n.signal,searchParams:Me(n),headers:n.headers,transform:i=>({err:i.Error?new Error(i.Error):null,cid:(i.Key||{})["/"]?it.parse(i.Key["/"]):null})}));yield*Fe(be(s.ndjson()),X)})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),Rz=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const i=yield(yield r.post("repo/stat",{signal:n.signal,searchParams:Me(n),headers:n.headers})).json();return{numObjects:BigInt(i.NumObjects),repoSize:BigInt(i.RepoSize),repoPath:i.RepoPath,version:i.Version,storageMax:BigInt(i.StorageMax)}})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),xBe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){return(yield(yield r.post("repo/version",{signal:n.signal,searchParams:Me(n),headers:n.headers})).json()).Version})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}});function SBe(r){return{gc:EBe(r),stat:Rz(r),version:xBe(r)}}const ABe=ke(r=>{function t(){return(t=Ee(function*(n={}){const s=yield X(r.post("stats/bw",{signal:n.signal,searchParams:Me(n),headers:n.headers,transform:i=>({totalIn:BigInt(i.TotalIn),totalOut:BigInt(i.TotalOut),rateIn:parseFloat(i.RateIn),rateOut:parseFloat(i.RateOut)})}));yield*Fe(be(s.ndjson()),X)})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}});function TBe(r){return{bitswap:fz(r),repo:Rz(r),bw:ABe(r)}}const CBe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.post("swarm/addrs",{signal:n.signal,searchParams:Me(n),headers:n.headers}),{Addrs:i}=yield s.json();return Object.keys(i).map(o=>({id:bt(o),addrs:(i[o]||[]).map(a=>at(a))}))})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),IBe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const i=yield r.post("swarm/connect",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers}),{Strings:o}=yield i.json();return o||[]})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),RBe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const i=yield r.post("swarm/disconnect",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers}),{Strings:o}=yield i.json();return o||[]})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),DBe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.post("swarm/addrs/local",{signal:n.signal,searchParams:Me(n),headers:n.headers}),{Strings:i}=yield s.json();return(i||[]).map(o=>at(o))})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),OBe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.post("swarm/peers",{signal:n.signal,searchParams:Me(n),headers:n.headers}),{Peers:i}=yield s.json();return(i||[]).map(o=>({addr:at(o.Addr),peer:bt(o.Peer),muxer:o.Muxer,latency:o.Latency,streams:o.Streams,direction:null==o.Direction?void 0:0===o.Direction?"inbound":"outbound"}))})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}});function PBe(r){return{addrs:CBe(r),connect:IBe(r),disconnect:RBe(r),localAddrs:DBe(r),peers:OBe(r)}}const Dz=ke(r=>{function t(){return(t=Ee(function*(n,s={}){const i=new AbortController,o=lo(i.signal,s.signal),{headers:a,body:c,total:u,parts:f}=yield X(co(n,i,s.headers)),[E,T]="function"==typeof s.progress?NBe(u,f,s.progress):[void 0,void 0],U=yield X(r.post("add",{searchParams:Me({"stream-channels":!0,...s,progress:Boolean(E)}),onUploadProgress:T,signal:o,headers:a,body:c}));var F,b=!1,P=!1;try{for(var H,M=be(U.ndjson());b=!(H=yield X(M.next())).done;b=!1){let $=H.value;$=fn($),void 0!==$.hash?yield LBe($):E&&E($.bytes||0,$.name)}}catch($){P=!0,F=$}finally{try{b&&null!=M.return&&(yield X(M.return()))}finally{if(P)throw F}}})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),NBe=(r,e,t)=>e?[void 0,BBe(r,e,t)]:[t,void 0],BBe=(r,e,t)=>{let n=0;const s=e.length;return({loaded:i,total:o})=>{const a=Math.floor(i/o*r);for(;n<s;){const{start:c,end:u,name:f}=e[n];if(a<u){t(a-c,f);break}t(u-c,f),n+=1}}};function LBe({name:r,hash:e,size:t,mode:n,mtime:s,mtimeNsecs:i}){const o={path:r,cid:it.parse(e),size:parseInt(t)};return null!=n&&(o.mode=parseInt(n,8)),null!=s&&(o.mtime={secs:s,nsecs:i||0}),o}function kBe(r){const e=Dz(r);return ke(()=>{function n(){return(n=(0,B.Z)(function*(s,i={}){return yield Ys(e(oN(s),i))})).apply(this,arguments)}return function t(s){return n.apply(this,arguments)}})(r)}const UBe=ke(r=>{function t(){return(t=Ee(function*(n,s={}){const i=yield X(r.post("cat",{signal:s.signal,searchParams:Me({arg:n.toString(),...s}),headers:s.headers}));yield*Fe(be(i.iterator()),X)})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),MBe=ke(r=>function(){var t=(0,B.Z)(function*(n={}){return(yield r.post("commands",{signal:n.signal,searchParams:Me(n),headers:n.headers})).json()});return function(){return t.apply(this,arguments)}}()),FBe=ke(r=>function(){var t=(0,B.Z)(function*(n,s={}){return(yield(yield r.post("dns",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers})).json()).Path});return function(s){return t.apply(this,arguments)}}()),zBe=ke(r=>()=>{const e=new URL(r.opts.base||"");return{host:e.hostname,port:e.port,protocol:e.protocol,pathname:e.pathname,"api-path":e.pathname}}),VBe=ke(r=>{function t(){return(t=Ee(function*(n,s={}){const i={arg:`${n instanceof Uint8Array?it.decode(n):n}`,...s};i.compressionLevel&&(i["compression-level"]=i.compressionLevel,delete i.compressionLevel);const o=yield X(r.post("get",{signal:s.signal,searchParams:Me(i),headers:s.headers}));yield*Fe(be(o.iterator()),X)})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),Oz=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const o={...fn(yield(yield r.post("id",{signal:n.signal,searchParams:Me({arg:n.peerId?n.peerId.toString():void 0,...n}),headers:n.headers})).json())};return o.id=bt(o.id),o.addresses&&(o.addresses=o.addresses.map(a=>at(a))),o})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),jBe=r=>{const e=Oz(r);function n(){return(n=(0,B.Z)(function*(s={}){const i=yield e(s);return Boolean(i&&i.addresses&&i.addresses.length)})).apply(this,arguments)}return function t(){return n.apply(this,arguments)}},$Be=ke((r,e)=>{function n(){return n=Ee(function*(s,i={}){const o=`${s instanceof Uint8Array?it.decode(s):s}`;function a(P){return c.apply(this,arguments)}function c(){return(c=(0,B.Z)(function*(P){let F=P.Hash;if(F.includes("/")){const H=F.startsWith("/ipfs/")?F:`/ipfs/${F}`;F=(yield Ez(e)(H)).cid}else F=it.parse(F);const M={name:P.Name,path:o+(P.Name?`/${P.Name}`:""),size:P.Size,cid:F,type:KBe(P)};return P.Mode&&(M.mode=parseInt(P.Mode,8)),null!=P.Mtime&&(M.mtime={secs:P.Mtime},null!=P.MtimeNsecs&&(M.mtime.nsecs=P.MtimeNsecs)),M})).apply(this,arguments)}const u=yield X(r.post("ls",{signal:i.signal,searchParams:Me({arg:o,...i}),headers:i.headers}));var T,f=!1,E=!1;try{for(var b,U=be(u.ndjson());f=!(b=yield X(U.next())).done;f=!1){let P=b.value;if(P=P.Objects,!P)throw new Error("expected .Objects in results");if(P=P[0],!P)throw new Error("expected one array in results.Objects");const F=P.Links;if(!Array.isArray(F))throw new Error("expected one array in results.Objects[0].Links");if(!F.length)return void(yield a(P));yield*Fe(be(F.map(a)),X)}}catch(P){E=!0,T=P}finally{try{f&&null!=U.return&&(yield X(U.return()))}finally{if(E)throw T}}}),n.apply(this,arguments)}return function t(s){return n.apply(this,arguments)}});function KBe(r){switch(r.Type){case 1:case 5:return"dir";default:return"file"}}const ZBe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.post("dns",{signal:n.signal,searchParams:Me(n),headers:n.headers});return fn(yield s.json())})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),HBe=ke(r=>{function t(){return(t=Ee(function*(n,s={}){const i=yield X(r.post("ping",{signal:s.signal,searchParams:Me({arg:`${n}`,...s}),headers:s.headers,transform:fn}));yield*Fe(be(i.ndjson()),X)})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),GBe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n,s={}){const i=yield r.post("resolve",{signal:s.signal,searchParams:Me({arg:n,...s}),headers:s.headers}),{Path:o}=yield i.json();return o})).apply(this,arguments)}return function e(n){return t.apply(this,arguments)}}),WBe=ke(r=>function(){var t=(0,B.Z)(function*(n={}){throw ee(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});return function(){return t.apply(this,arguments)}}()),YBe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){yield(yield r.post("shutdown",{signal:n.signal,searchParams:Me(n),headers:n.headers})).text()})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}}),QBe=ke(r=>{function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.post("version",{signal:n.signal,searchParams:Me(n),headers:n.headers});return{...fn(yield s.json()),"ipfs-http-client":"1.0.0"}})).apply(this,arguments)}return function e(){return t.apply(this,arguments)}});p(63897);var JBe=p(51721);const uo=Object.create(null);uo.open="0",uo.close="1",uo.ping="2",uo.pong="3",uo.message="4",uo.upgrade="5",uo.noop="6";const M2=Object.create(null);Object.keys(uo).forEach(r=>{M2[uo[r]]=r});const tLe={type:"error",data:"parser error"},rLe="function"==typeof Blob||typeof Blob<"u"&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),nLe="function"==typeof ArrayBuffer,Nz=(r,e)=>{const t=new FileReader;return t.onload=function(){const n=t.result.split(",")[1];e("b"+n)},t.readAsDataURL(r)},Bz=({type:r,data:e},t,n)=>rLe&&e instanceof Blob?t?n(e):Nz(e,n):nLe&&(e instanceof ArrayBuffer||(r=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer)(e))?t?n(e):Nz(new Blob([e]),n):n(uo[r]+(e||"")),Au="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Yh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let r=0;r<Au.length;r++)Yh[Au.charCodeAt(r)]=r;const aLe="function"==typeof ArrayBuffer,lLe=(r,e)=>{if(aLe){const t=(r=>{let n,i,o,a,c,e=.75*r.length,t=r.length,s=0;"="===r[r.length-1]&&(e--,"="===r[r.length-2]&&e--);const u=new ArrayBuffer(e),f=new Uint8Array(u);for(n=0;n<t;n+=4)i=Yh[r.charCodeAt(n)],o=Yh[r.charCodeAt(n+1)],a=Yh[r.charCodeAt(n+2)],c=Yh[r.charCodeAt(n+3)],f[s++]=i<<2|o>>4,f[s++]=(15&o)<<4|a>>2,f[s++]=(3&a)<<6|63&c;return u})(r);return Lz(t,e)}return{base64:!0,data:r}},Lz=(r,e)=>"blob"===e&&r instanceof ArrayBuffer?new Blob([r]):r,kz=(r,e)=>{if("string"!=typeof r)return{type:"message",data:Lz(r,e)};const t=r.charAt(0);return"b"===t?{type:"message",data:lLe(r.substring(1),e)}:M2[t]?r.length>1?{type:M2[t],data:r.substring(1)}:{type:M2[t]}:tLe},Uz=String.fromCharCode(30);function Wr(r){if(r)return function fLe(r){for(var e in Wr.prototype)r[e]=Wr.prototype[e];return r}(r)}Wr.prototype.on=Wr.prototype.addEventListener=function(r,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(e),this},Wr.prototype.once=function(r,e){function t(){this.off(r,t),e.apply(this,arguments)}return t.fn=e,this.on(r,t),this},Wr.prototype.off=Wr.prototype.removeListener=Wr.prototype.removeAllListeners=Wr.prototype.removeEventListener=function(r,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var t=this._callbacks["$"+r];if(!t)return this;if(1==arguments.length)return delete this._callbacks["$"+r],this;for(var n,s=0;s<t.length;s++)if((n=t[s])===e||n.fn===e){t.splice(s,1);break}return 0===t.length&&delete this._callbacks["$"+r],this},Wr.prototype.emitReserved=Wr.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+r],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t){n=0;for(var s=(t=t.slice(0)).length;n<s;++n)t[n].apply(this,e)}return this},Wr.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]},Wr.prototype.hasListeners=function(r){return!!this.listeners(r).length};const rc=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function Fz(r,...e){return e.reduce((t,n)=>(r.hasOwnProperty(n)&&(t[n]=r[n]),t),{})}const hLe=setTimeout,pLe=clearTimeout;function F2(r,e){e.useNativeTimers?(r.setTimeoutFn=hLe.bind(rc),r.clearTimeoutFn=pLe.bind(rc)):(r.setTimeoutFn=setTimeout.bind(rc),r.clearTimeoutFn=clearTimeout.bind(rc))}function gLe(r){return"string"==typeof r?function bLe(r){let e=0,t=0;for(let n=0,s=r.length;n<s;n++)e=r.charCodeAt(n),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(n++,t+=4);return t}(r):Math.ceil(1.33*(r.byteLength||r.size))}class _Le extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class zz extends Wr{constructor(e){super(),this.writable=!1,F2(this,e),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t,n){return super.emitReserved("error",new _Le(e,t,n)),this}open(){return("closed"===this.readyState||""===this.readyState)&&(this.readyState="opening",this.doOpen()),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=kz(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}}const Vz="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),jz={};let Kz,$z=0,nc=0;function Zz(r){let e="";do{e=Vz[r%64]+e,r=Math.floor(r/64)}while(r>0);return e}function Hz(){const r=Zz(+new Date);return r!==Kz?($z=0,Kz=r):r+"."+Zz($z++)}for(;nc<64;nc++)jz[Vz[nc]]=nc;function Gz(r){let e="";for(let t in r)r.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(r[t]));return e}let Wz=!1;try{Wz=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const vLe=Wz;function Yz(r){const e=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||vLe))return new XMLHttpRequest}catch{}if(!e)try{return new(rc[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch{}}function wLe(){}const ELe=null!=new Yz({xdomain:!1}).responseType;let V2=(()=>{class r extends Wr{constructor(t,n){super(),F2(this,n),this.opts=n,this.method=n.method||"GET",this.uri=t,this.async=!1!==n.async,this.data=void 0!==n.data?n.data:null,this.create()}create(){const t=Fz(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const n=this.xhr=new Yz(t);try{n.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let s in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(s)&&n.setRequestHeader(s,this.opts.extraHeaders[s])}}catch{}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof n.status?n.status:0)},0))},n.send(this.data)}catch(s){return void this.setTimeoutFn(()=>{this.onError(s)},0)}typeof document<"u"&&(this.index=r.requestsCount++,r.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(!(typeof this.xhr>"u"||null===this.xhr)){if(this.xhr.onreadystatechange=wLe,t)try{this.xhr.abort()}catch{}typeof document<"u"&&delete r.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}return r.requestsCount=0,r.requests={},r})();function Qz(){for(let r in V2.requests)V2.requests.hasOwnProperty(r)&&V2.requests[r].abort()}typeof document<"u"&&("function"==typeof attachEvent?attachEvent("onunload",Qz):"function"==typeof addEventListener&&addEventListener("onpagehide"in rc?"pagehide":"unload",Qz,!1));const Jz="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),j2=rc.WebSocket||rc.MozWebSocket;p(13195);const Xz=typeof navigator<"u"&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),CLe={websocket:class TLe extends zz{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,n=Xz?{}:Fz(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=Xz?new j2(e,t,n):t?new j2(e,t):new j2(e)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=t===e.length-1;Bz(e[t],this.supportsBinary,i=>{try{this.ws.send(i)}catch{}s&&Jz(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let n="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=Hz()),this.supportsBinary||(e.b64=1);const s=Gz(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(s.length?"?"+s:"")}check(){return!!j2}},polling:class xLe extends zz{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){const n="https:"===location.protocol;let s=location.port;s||(s=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||s!==e.port,this.xs=e.secure!==n}this.supportsBinary=ELe&&!(e&&e.forceBase64)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let n=0;this.polling&&(n++,this.once("pollComplete",function(){--n||t()})),this.writable||(n++,this.once("drain",function(){--n||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((r,e)=>{const t=r.split(Uz),n=[];for(let s=0;s<t.length;s++){const i=kz(t[s],e);if(n.push(i),"error"===i.type)break}return n})(e,this.socket.binaryType).forEach(n=>{if("opening"===this.readyState&&"open"===n.type&&this.onOpen(),"close"===n.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)}),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((r,e)=>{const t=r.length,n=new Array(t);let s=0;r.forEach((i,o)=>{Bz(i,!1,a=>{n[o]=a,++s===t&&e(n.join(Uz))})})})(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let n="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=Hz()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);const s=Gz(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(s.length?"?"+s:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new V2(this.uri(),e)}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(s,i)=>{this.onError("xhr post error",s,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,n)=>{this.onError("xhr poll error",t,n)}),this.pollXhr=e}}},ILe=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,RLe=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Ax(r){const e=r,t=r.indexOf("["),n=r.indexOf("]");-1!=t&&-1!=n&&(r=r.substring(0,t)+r.substring(t,n).replace(/:/g,";")+r.substring(n,r.length));let s=ILe.exec(r||""),i={},o=14;for(;o--;)i[RLe[o]]=s[o]||"";return-1!=t&&-1!=n&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=function DLe(r,e){const n=e.replace(/\/{2,9}/g,"/").split("/");return("/"==e.slice(0,1)||0===e.length)&&n.splice(0,1),"/"==e.slice(-1)&&n.splice(n.length-1,1),n}(0,i.path),i.queryKey=function OLe(r,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,s,i){s&&(t[s]=i)}),t}(0,i.query),i}let qz=(()=>{class r extends Wr{constructor(t,n={}){super(),t&&"object"==typeof t&&(n=t,t=null),t?(t=Ax(t),n.hostname=t.host,n.secure="https"===t.protocol||"wss"===t.protocol,n.port=t.port,t.query&&(n.query=t.query)):n.host&&(n.hostname=Ax(n.host).host),F2(this,n),this.secure=null!=n.secure?n.secure:typeof location<"u"&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=n.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},n),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=function mLe(r){let e={},t=r.split("&");for(let n=0,s=t.length;n<s;n++){let i=t[n].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=4,n.transport=t,this.id&&(n.sid=this.id);const s=Object.assign({},this.opts.transportOptions[t],this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new CLe[t](s)}open(){let t;if(this.opts.rememberUpgrade&&r.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch{return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",n=>this.onClose("transport close",n))}probe(t){let n=this.createTransport(t),s=!1;r.priorWebsocketSuccess=!1;const i=()=>{s||(n.send([{type:"ping",data:"probe"}]),n.once("packet",T=>{if(!s)if("pong"===T.type&&"probe"===T.data){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;r.priorWebsocketSuccess="websocket"===n.name,this.transport.pause(()=>{s||"closed"!==this.readyState&&(E(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const U=new Error("probe error");U.transport=n.name,this.emitReserved("upgradeError",U)}}))};function o(){s||(s=!0,E(),n.close(),n=null)}const a=T=>{const U=new Error("probe error: "+T);U.transport=n.name,o(),this.emitReserved("upgradeError",U)};function c(){a("transport closed")}function u(){a("socket closed")}function f(T){n&&T.name!==n.name&&o()}const E=()=>{n.removeListener("open",i),n.removeListener("error",a),n.removeListener("close",c),this.off("close",u),this.off("upgrading",f)};n.once("open",i),n.once("error",a),n.once("close",c),this.once("close",u),this.once("upgrading",f),n.open()}onOpen(){if(this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let t=0;const n=this.upgrades.length;for(;t<n;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const n=new Error("server error");n.code=t.data,this.onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let s=0;s<this.writeBuffer.length;s++){const i=this.writeBuffer[s].data;if(i&&(n+=gLe(i)),s>0&&n>this.maxPayload)return this.writeBuffer.slice(0,s);n+=2}return this.writeBuffer}write(t,n,s){return this.sendPacket("message",t,n,s),this}send(t,n,s){return this.sendPacket("message",t,n,s),this}sendPacket(t,n,s,i){if("function"==typeof n&&(i=n,n=void 0),"function"==typeof s&&(i=s,s=null),"closing"===this.readyState||"closed"===this.readyState)return;(s=s||{}).compress=!1!==s.compress;const o={type:t,data:n,options:s};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},s=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}onError(t){r.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,n){("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const n=[];let s=0;const i=t.length;for(;s<i;s++)~this.transports.indexOf(t[s])&&n.push(t[s]);return n}}return r.protocol=4,r})();const NLe="function"==typeof ArrayBuffer,eV=Object.prototype.toString,LLe="function"==typeof Blob||typeof Blob<"u"&&"[object BlobConstructor]"===eV.call(Blob),kLe="function"==typeof File||typeof File<"u"&&"[object FileConstructor]"===eV.call(File);function Tx(r){return NLe&&(r instanceof ArrayBuffer||(r=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer)(r))||LLe&&r instanceof Blob||kLe&&r instanceof File}function $2(r,e){if(!r||"object"!=typeof r)return!1;if(Array.isArray(r)){for(let t=0,n=r.length;t<n;t++)if($2(r[t]))return!0;return!1}if(Tx(r))return!0;if(r.toJSON&&"function"==typeof r.toJSON&&1===arguments.length)return $2(r.toJSON(),!0);for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&$2(r[t]))return!0;return!1}function ULe(r){const e=[],n=r;return n.data=Cx(r.data,e),n.attachments=e.length,{packet:n,buffers:e}}function Cx(r,e){if(!r)return r;if(Tx(r)){const t={_placeholder:!0,num:e.length};return e.push(r),t}if(Array.isArray(r)){const t=new Array(r.length);for(let n=0;n<r.length;n++)t[n]=Cx(r[n],e);return t}if("object"==typeof r&&!(r instanceof Date)){const t={};for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=Cx(r[n],e));return t}return r}function MLe(r,e){return r.data=Ix(r.data,e),r.attachments=void 0,r}function Ix(r,e){if(!r)return r;if(r&&!0===r._placeholder){if("number"==typeof r.num&&r.num>=0&&r.num<e.length)return e[r.num];throw new Error("illegal attachments")}if(Array.isArray(r))for(let t=0;t<r.length;t++)r[t]=Ix(r[t],e);else if("object"==typeof r)for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&(r[t]=Ix(r[t],e));return r}const FLe=5;var Rt=(()=>(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"}(Rt||(Rt={})),Rt))();class zLe{constructor(e){this.replacer=e}encode(e){return e.type!==Rt.EVENT&&e.type!==Rt.ACK||!$2(e)?[this.encodeAsString(e)]:(e.type=e.type===Rt.EVENT?Rt.BINARY_EVENT:Rt.BINARY_ACK,this.encodeAsBinary(e))}encodeAsString(e){let t=""+e.type;return(e.type===Rt.BINARY_EVENT||e.type===Rt.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=ULe(e),n=this.encodeAsString(t.packet),s=t.buffers;return s.unshift(n),s}}class Rx extends Wr{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e),t.type===Rt.BINARY_EVENT||t.type===Rt.BINARY_ACK?(this.reconstructor=new VLe(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!Tx(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===Rt[n.type])throw new Error("unknown packet type "+n.type);if(n.type===Rt.BINARY_EVENT||n.type===Rt.BINARY_ACK){const i=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const o=e.substring(i,t);if(o!=Number(o)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(o)}if("/"===e.charAt(t+1)){const i=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);n.nsp=e.substring(i,t)}else n.nsp="/";const s=e.charAt(t+1);if(""!==s&&Number(s)==s){const i=t+1;for(;++t;){const o=e.charAt(t);if(null==o||Number(o)!=o){--t;break}if(t===e.length)break}n.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(!Rx.isPayloadValid(n.type,i))throw new Error("invalid payload");n.data=i}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case Rt.CONNECT:return"object"==typeof t;case Rt.DISCONNECT:return void 0===t;case Rt.CONNECT_ERROR:return"string"==typeof t||"object"==typeof t;case Rt.EVENT:case Rt.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case Rt.ACK:case Rt.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class VLe{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=MLe(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Ui(r,e,t){return r.on(e,t),function(){r.off(e,t)}}const jLe=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class tV extends Wr{constructor(e,t,n){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Ui(e,"open",this.onopen.bind(this)),Ui(e,"packet",this.onpacket.bind(this)),Ui(e,"error",this.onerror.bind(this)),Ui(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(jLe.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');t.unshift(e);const n={type:Rt.EVENT,data:t,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const o=this.ids++,a=t.pop();this._registerAckCallback(o,a),n.id=o}return this.flags.volatile&&(!(this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable)||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(e,t){const n=this.flags.timeout;if(void 0===n)return void(this.acks[e]=t);const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let i=0;i<this.sendBuffer.length;i++)this.sendBuffer[i].id===e&&this.sendBuffer.splice(i,1);t.call(this,new Error("operation has timed out"))},n);this.acks[e]=(...i)=>{this.io.clearTimeoutFn(s),t.apply(this,[null,...i])}}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this.packet({type:Rt.CONNECT,data:e})}):this.packet({type:Rt.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Rt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Rt.EVENT:case Rt.BINARY_EVENT:this.onevent(e);break;case Rt.ACK:case Rt.BINARY_ACK:this.onack(e);break;case Rt.DISCONNECT:this.ondisconnect();break;case Rt.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e)}ack(e){const t=this;let n=!1;return function(...s){n||(n=!0,t.packet({type:Rt.ACK,id:e,data:s}))}}onack(e){const t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e){this.id=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Rt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function Tu(r){this.ms=(r=r||{}).min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}Tu.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*r);r=0==(1&Math.floor(10*e))?r-t:r+t}return 0|Math.min(r,this.max)},Tu.prototype.reset=function(){this.attempts=0},Tu.prototype.setMin=function(r){this.ms=r},Tu.prototype.setMax=function(r){this.max=r},Tu.prototype.setJitter=function(r){this.jitter=r};class Dx extends Wr{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,F2(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new Tu({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout??2e4),this._readyState="closed",this.uri=e;const s=t.parser||$_;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new qz(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=Ui(t,"open",function(){n.onopen(),e&&e()}),i=Ui(t,"error",o=>{n.cleanup(),n._readyState="closed",this.emitReserved("error",o),e?e(o):n.maybeReconnectOnOpen()});if(!1!==this._timeout){const o=this._timeout;0===o&&s();const a=this.setTimeoutFn(()=>{s(),t.close(),t.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(s),this.subs.push(i),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Ui(e,"ping",this.onping.bind(this)),Ui(e,"data",this.ondata.bind(this)),Ui(e,"error",this.onerror.bind(this)),Ui(e,"close",this.onclose.bind(this)),Ui(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Jz(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n||(n=new tV(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t)if(this.nsps[n].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(s=>{s?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",s)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(function(){clearTimeout(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Qh={};function K2(r,e){"object"==typeof r&&(e=r,r=void 0);const t=function PLe(r,e="",t){let n=r;t=t||typeof location<"u"&&location,null==r&&(r=t.protocol+"//"+t.host),"string"==typeof r&&("/"===r.charAt(0)&&(r="/"===r.charAt(1)?t.protocol+r:t.host+r),/^(https?|wss?):\/\//.test(r)||(r=typeof t<"u"?t.protocol+"//"+r:"https://"+r),n=Ax(r)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+e,n.href=n.protocol+"://"+i+(t&&t.port===n.port?"":":"+n.port),n}(r,(e=e||{}).path||"/socket.io"),n=t.source,s=t.id;let c;return e.forceNew||e["force new connection"]||!1===e.multiplex||Qh[s]&&t.path in Qh[s].nsps?c=new Dx(n,e):(Qh[s]||(Qh[s]=new Dx(n,e)),c=Qh[s]),t.query&&!e.query&&(e.query=t.queryKey),c.socket(t.path,e)}Object.assign(K2,{Manager:Dx,Socket:tV,io:K2,connect:K2});var Ox=p(79782);const HLe=function $Le(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},Z2=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class QLe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class JLe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return rV(this,e)}}class XLe{constructor(e){this.decoders=e}or(e){return rV(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const rV=(r,e)=>new XLe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class qLe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new QLe(e,t,n),this.decoder=new JLe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const H2=({name:r,prefix:e,encode:t,decode:n})=>new qLe(r,e,t,n),Jh=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=HLe(t,e);return H2({prefix:r,name:e,encode:n,decode:i=>Z2(s(i))})},zn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>H2({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),rke=H2({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),nke=zn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ske=zn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ike=Jh({prefix:"9",name:"base10",alphabet:"0123456789"}),oke=zn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ake=zn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),cke=zn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),lke=zn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),uke=zn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),dke=zn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),fke=zn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hke=zn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),pke=zn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),yke=zn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),gke=zn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),bke=Jh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),_ke=Jh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),mke=Jh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),vke=Jh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),wke=zn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Eke=zn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),xke=zn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ske=zn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),nV=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),Ake=nV.reduce((r,e,t)=>(r[t]=e,r),[]),Tke=nV.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),Rke=H2({prefix:"\u{1f680}",name:"base256emoji",encode:function Cke(r){return r.reduce((e,t)=>e+Ake[t],"")},decode:function Ike(r){const e=[];for(const t of r){const n=Tke[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var Nke=Math.pow(2,31),kke=Math.pow(2,7),Uke=Math.pow(2,14),Mke=Math.pow(2,21),Fke=Math.pow(2,28),zke=Math.pow(2,35),Vke=Math.pow(2,42),jke=Math.pow(2,49),$ke=Math.pow(2,56),Kke=Math.pow(2,63),Hke={encode:function iV(r,e,t){e=e||[];for(var n=t=t||0;r>=Nke;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,iV.bytes=t-n+1,e},decode:function Px(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw Px.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return Px.bytes=i-n,t},encodingLength:function(r){return r<kke?1:r<Uke?2:r<Mke?3:r<Fke?4:r<zke?5:r<Vke?6:r<jke?7:r<$ke?8:r<Kke?9:10}};const aV=Hke,cV=(r,e,t=0)=>(aV.encode(r,e,t),e),lV=r=>aV.encodingLength(r),Nx=(r,e)=>{const t=e.byteLength,n=lV(r),s=n+lV(t),i=new Uint8Array(s+t);return cV(r,i,0),cV(t,i,n),i.set(e,s),new uV(r,t,e,i)};class uV{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const dV=({name:r,code:e,encode:t})=>new Wke(r,e,t);class Wke{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Nx(this.code,t):t.then(n=>Nx(this.code,n))}throw Error("Unknown type, must be binary type")}}const fV=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),Yke=dV({name:"sha2-256",code:18,encode:fV("SHA-256")}),Qke=dV({name:"sha2-512",code:19,encode:fV("SHA-512")}),pV=Z2,Xke={code:0,name:"identity",encode:pV,digest:r=>Nx(0,pV(r))},qke="raw",eUe=85,tUe=r=>Z2(r),rUe=r=>Z2(r),nUe=new TextEncoder,sUe=new TextDecoder,iUe="json",oUe=512,aUe=r=>nUe.encode(JSON.stringify(r)),cUe=r=>JSON.parse(sUe.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const bV={...K_,...Z_,...H_,...G_,...W_,...Y_,...Q_,...J_,...X_,...q_};function _V(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const mV=_V("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),Lx=_V("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function gUe(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?function yUe(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),bUe={utf8:mV,"utf-8":mV,hex:bV.base16,latin1:Lx,ascii:Lx,binary:Lx,...bV};function vV(r,e="utf8"){const t=bUe[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}class mUe{constructor(e,t){this.label=e.label,this.open=en(),this.channel=e,this.channel.binaryType="arraybuffer",this.log=t.log,"number"==typeof this.channel.bufferedAmountLowThreshold&&(this.channel.bufferedAmountLowThreshold=65536),e.addEventListener("message",s=>{t.onMessage(s)}),e.addEventListener("bufferedamountlow",()=>{this.log("stop backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open.resolve()}),e.addEventListener("open",()=>{this.open.resolve(),t.onOpen()}),e.addEventListener("close",()=>{t.onClose()}),e.addEventListener("error",s=>{var i,o,a,c,u;if("Transport channel closed"===(null===(i=s.error)||void 0===i?void 0:i.message))return this.close();t.log.error('channel encounter an error in state "%s" message: "%s" detail: "%s',e.readyState,null===(o=s.error)||void 0===o?void 0:o.message,null===(a=s.error)||void 0===a?void 0:a.errorDetail);const f=s.error instanceof Error?s.error:new Error(`datachannel error: ${null===(c=s.error)||void 0===c?void 0:c.message} ${null===(u=s.error)||void 0===u?void 0:u.errorDetail}`);t.onError(ee(f,"ERR_DATA_CHANNEL"))});let n=!1;this.closingInterval=setInterval(()=>{"closing"===e.readyState?(n&&t.onClose(),n=!0):n=!1},5e3)}send(e){var t=this;return(0,B.Z)(function*(){yield t.open.promise,t.channel.send(e),t.channel.bufferedAmount>65536&&(t.log("start backpressure: bufferedAmount %d",t.channel.bufferedAmount),t.open=en())})()}close(){clearInterval(this.closingInterval),this.channel.close()}get bufferedAmount(){return this.channel.bufferedAmount}}var EV=p(42961);const vUe={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]};class xV extends wr{constructor(e){var t,n,s;super(),s=this,this.id=null!==(t=e.id)&&void 0!==t?t:vV(Ox(4),"hex").slice(0,7),this.log=Be(`libp2p:webrtc-peer:${e.logPrefix}:${this.id}`),this.wrtc=null!==(n=e.wrtc)&&void 0!==n?n:function wUe(){var r,e,t,n,s,i;if(typeof globalThis>"u")throw ee(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");const o={RTCPeerConnection:null!==(r=null!==(e=globalThis.RTCPeerConnection)&&void 0!==e?e:globalThis.mozRTCPeerConnection)&&void 0!==r?r:globalThis.webkitRTCPeerConnection,RTCSessionDescription:null!==(t=null!==(n=globalThis.RTCSessionDescription)&&void 0!==n?n:globalThis.mozRTCSessionDescription)&&void 0!==t?t:globalThis.webkitRTCSessionDescription,RTCIceCandidate:null!==(s=null!==(i=globalThis.RTCIceCandidate)&&void 0!==i?i:globalThis.mozRTCIceCandidate)&&void 0!==s?s:globalThis.webkitRTCIceCandidate};if(null==o.RTCPeerConnection)throw ee(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");return o}(),this.peerConnection=new this.wrtc.RTCPeerConnection(Object.assign({},vUe,e.peerConnectionConfig)),this.closed=!1,this.connected=en(),this.source=ss(),this.sink=function(){var i=(0,B.Z)(function*(o){if(yield s.connected.promise,null==s.channel)throw ee(new Error("Connected but no channel?!"),"ERR_DATA_CHANNEL");var u,a=!1,c=!1;try{for(var E,f=be(o);a=!(E=yield f.next()).done;a=!1){const T=E.value;yield s.channel.send(T)}}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield f.return())}finally{if(c)throw u}}yield s.close()});return function(o){return i.apply(this,arguments)}}()}handleDataChannelEvent(e){const t=e.channel;null!=t?this.channel=new mUe(t,{log:this.log,onMessage:n=>{this.source.push(new Uint8Array(n.data))},onOpen:()=>{this.connected.resolve(),this.dispatchEvent(new Qe("ready"))},onClose:()=>{this.close().catch(n=>{this.log("error closing connection after channel close",n)})},onError:n=>{this.close(n).catch(s=>{this.log("error closing connection after channel error",s)})}}):this.close(ee(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL")).catch(n=>{this.log("Error closing after event channel was found to be null",n)})}close(e){var t=this;return(0,B.Z)(function*(){var n;if(t.closed=!0,null==e&&null!=t.channel)for(;t.channel.bufferedAmount>0;)yield EV(100);null===(n=t.channel)||void 0===n||n.close(),t.peerConnection.close(),t.source.end(e),t.dispatchEvent(new Qe("close"))})()}}class SV extends wr{constructor(e){super(),this.log=e.log,this.peerConnection=e.peerConnection,this.wrtc=e.wrtc,this.status="idle",this.peerConnection.addEventListener("negotiationneeded",()=>{this.log("peer connection negotiation needed"),this.handleRenegotiate({type:"renegotiate"}).catch(t=>{this.log.error("could not renegotiate %o",t)})})}handleSignal(e){var t=this;return(0,B.Z)(function*(){return t.log('incoming signal "%s"',e.type),"offer"===e.type?yield t.handleOffer(e):"answer"===e.type?yield t.handleAnswer(e):"candidate"===e.type?yield t.handleCandidate(e):"renegotiate"===e.type?yield t.handleRenegotiate(e):"goodbye"===e.type?yield t.handleGoodye(e):void t.log(`Unknown signal type ${e.type}`)})()}handleOffer(e){return(0,B.Z)(function*(){})()}handleAnswer(e){return(0,B.Z)(function*(){})()}handleRenegotiate(e){return(0,B.Z)(function*(){})()}handleGoodye(e){var t=this;return(0,B.Z)(function*(){t.peerConnection.close()})()}handleCandidate(e){var t=this;return(0,B.Z)(function*(){const n=new t.wrtc.RTCIceCandidate(e.candidate);try{yield t.peerConnection.addIceCandidate(n)}catch(s){if(null!=n.address&&!n.address.endsWith(".local"))throw ee(s,"ERR_ADD_ICE_CANDIDATE");t.log("ignoring unsupported ICE candidate.")}})()}}const AV=Be("libp2p:webrtc-peer:receiver");class EUe extends xV{constructor(e={}){super({...e,logPrefix:"receiver"}),this.handshake=new xUe({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,answerOptions:e.answerOptions}),this.handshake.addEventListener("signal",t=>this.dispatchEvent(new Qe("signal",{detail:t.detail}))),this.peerConnection.addEventListener("datachannel",t=>{this.handleDataChannelEvent(t)})}handleSignal(e){this.handshake.handleSignal(e).catch(t=>{this.log("error handling signal %o %o",e,t)})}}class xUe extends SV{constructor(e){super(e),this.options=e,this.status="idle",this.iceCandidates=[]}handleRenegotiate(){var e=this;return(0,B.Z)(function*(){AV.trace("renegotiate"),e.dispatchEvent(new Qe("signal",{detail:{type:"renegotiate"}}))})()}handleOffer(e){var t=this;return(0,B.Z)(function*(){var n;yield t.peerConnection.setRemoteDescription(new t.wrtc.RTCSessionDescription(e));for(const i of t.iceCandidates)yield t.handleCandidate(i);t.iceCandidates=[];const s=yield t.peerConnection.createAnswer(t.options.answerOptions);yield t.peerConnection.setLocalDescription(s),AV.trace("handle offer",t.peerConnection.localDescription),t.dispatchEvent(new Qe("signal",{detail:null!==(n=t.peerConnection.localDescription)&&void 0!==n?n:s}))})()}handleCandidate(e){var t=()=>super.handleCandidate,n=this;return(0,B.Z)(function*(){null!=n.peerConnection.remoteDescription&&null!=n.peerConnection.remoteDescription.type?yield t().call(n,e):n.iceCandidates.push(e)})()}}class SUe extends Error{constructor(e){super(e),this.name="TimeoutError"}}class AUe extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const TV=r=>void 0===globalThis.DOMException?new AUe(r):new DOMException(r),CV=r=>{const e=void 0===r.reason?TV("This operation was aborted."):r.reason;return e instanceof Error?e:TV(e)};function CUe(r,e,t){let n;const s=new Promise((i,o)=>{if(!((t={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...t}).count>=0)||t.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(t.count))throw new TypeError("The `count` option should be at least 0 or more");const a=[e].flat(),c=[],{addListener:u,removeListener:f}=(r=>{const e=r.on||r.addListener||r.addEventListener,t=r.off||r.removeListener||r.removeEventListener;if(!e||!t)throw new TypeError("Emitter is not compatible");return{addListener:e.bind(r),removeListener:t.bind(r)}})(r),E=(...U)=>{const b=t.multiArgs?U:U[0];t.filter&&!t.filter(b)||(c.push(b),t.count===c.length&&(n(),i(c)))},T=U=>{n(),o(U)};n=()=>{for(const U of a)f(U,E);for(const U of t.rejectionEvents)f(U,T)};for(const U of a)u(U,E);for(const U of t.rejectionEvents)u(U,T);t.resolveImmediately&&i(c)});if(s.cancel=n,"number"==typeof t.timeout){const i=function TUe(r,e,t,n){let s;const i=new Promise((o,a)=>{if("number"!=typeof e||1!==Math.sign(e))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e!==Number.POSITIVE_INFINITY){if((n={customTimers:{setTimeout,clearTimeout},...n}).signal){const{signal:c}=n;c.aborted&&a(CV(c)),c.addEventListener("abort",()=>{a(CV(c))})}s=n.customTimers.setTimeout.call(void 0,()=>{if("function"==typeof t){try{o(t())}catch(f){a(f)}return}const u=t instanceof Error?t:new SUe("string"==typeof t?t:`Promise timed out after ${e} milliseconds`);"function"==typeof r.cancel&&r.cancel(),a(u)},e),(0,B.Z)(function*(){try{o(yield r)}catch(c){a(c)}finally{n.customTimers.clearTimeout.call(void 0,s)}})()}else o(r)});return i.clear=()=>{clearTimeout(s),s=void 0},i}(s,t.timeout);return i.cancel=n,i}return s}const kx=Be("libp2p:webrtc-peer:initator");class DUe extends xV{constructor(e={}){var t;super({...e,logPrefix:"initiator"}),this.handleDataChannelEvent({channel:this.peerConnection.createDataChannel(null!==(t=e.dataChannelLabel)&&void 0!==t?t:vV(Ox(20),"hex").slice(0,7),e.dataChannelInit)}),this.handshake=new OUe({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,offerOptions:e.offerOptions}),this.handshake.addEventListener("signal",n=>{this.dispatchEvent(new Qe("signal",{detail:n.detail}))})}handleSignal(e){this.handshake.handleSignal(e).catch(t=>{this.log("error handling signal %o %o",e,t)})}}class OUe extends SV{constructor(e){super(e),this.options=e,this.status="idle",this.peerConnection.addEventListener("icecandidate",t=>{if(null==t.candidate)return;const n={type:"candidate",candidate:{candidate:t.candidate.candidate,sdpMLineIndex:t.candidate.sdpMLineIndex,sdpMid:t.candidate.sdpMid}};kx.trace("create candidate",n),this.dispatchEvent(new Qe("signal",{detail:n})),this.dispatchEvent(new Qe("ice-candidate"))})}handleRenegotiate(){var e=this;return(0,B.Z)(function*(){var t;if("negotiating"===e.status)return void e.log("already negotiating, queueing");e.status="negotiating";const n=yield e.peerConnection.createOffer(e.options.offerOptions);yield e.peerConnection.setLocalDescription(n),yield function IUe(r,e,t){"function"==typeof t&&(t={filter:t});const n=CUe(r,e,t={...t,count:1,resolveImmediately:!1}),s=n.then(i=>i[0]);return s.cancel=n.cancel,s}(e,"ice-candidate"),yield EV(1e3),kx.trace("renegotiate",e.peerConnection.localDescription),e.dispatchEvent(new Qe("signal",{detail:null!==(t=e.peerConnection.localDescription)&&void 0!==t?t:n}))})()}handleAnswer(e){var t=this;return(0,B.Z)(function*(){kx.trace("handle answer",e),yield t.peerConnection.setRemoteDescription(new t.wrtc.RTCSessionDescription(e)),t.status="idle"})()}}const Ux=Be("libp2p:webrtc-star:socket");function RV(r,e){const{sink:t,source:n}=r,s={remoteAddr:e.remoteAddr,sink:i=>(0,B.Z)(function*(){null!=e.signal&&(i=Ms(i,e.signal));try{yield t(i)}catch(o){"aborted"!==o.type&&Ux.error(o)}})(),source:null!=e.signal?Ms(n,e.signal):n,timeline:{open:Date.now()},close:()=>(0,B.Z)(function*(){if(r.closed)return;const i=Date.now(),o=setTimeout(()=>{if(null!=s.remoteAddr){const{host:a,port:c}=s.remoteAddr.toOptions();Ux("timeout closing socket to %s:%s after %dms, destroying it manually",a,c,Date.now()-i)}r.closed||r.close().catch(a=>{Ux.error("could not close socket",a)})},2e3);try{yield r.close()}finally{clearTimeout(o)}})()};return r.addEventListener("close",()=>{null==s.timeline.close&&(s.timeline.close=Date.now())},{once:!0}),s}function DV(r){const e=r.toString().split("/"),t=r.protos()[1].name,n=r.protos()[2].name,s=r.stringTuples()[1][1];if("tcp"!==t||"ws"!==n&&"wss"!==n)throw new Error(`invalid multiaddr: ${r.toString()}`);if(!function $re(r){return!!Sl(r)&&r.protos().some(e=>e.resolvable)}(r))return`http://${e[2]}:${e[4]}`;if("ws"===n)return`http://${e[2]}${null==s||"80"===s?"":`:${s}`}`;if("wss"===n)return`https://${e[2]}${null==s||"443"===s?"":`:${s}`}`;throw new Error("invalid multiaddr: "+r.toString())}const fs=Be("libp2p:webrtc-star:listener"),NUe={transports:["websocket"],path:"/socket.io-next/"};class BUe extends wr{constructor(e,t,n,s,i){super(),this.signallingAddr=t,this.socket=K2(e,NUe),this.connections=[],this.channels=new Map,this.pendingSignals=new Map,this.upgrader=n,this.handler=s,this.channelOptions=i,this.handleWsHandshake=this.handleWsHandshake.bind(this);let o=!1;this.socket.on("connect_error",a=>{o&&"TransportError"===a.type||this.dispatchEvent(new Qe("error",{detail:a}))}),this.socket.on("error",a=>{this.dispatchEvent(new Qe("error",{detail:a}))}),this.socket.on("ws-handshake",this.handleWsHandshake),this.socket.on("ws-peer",a=>{this.dispatchEvent(new Qe("peer",{detail:a}))}),this.socket.on("connect",()=>{this.socket.emit("ss-join",this.signallingAddr.toString()),o&&this.dispatchEvent(new Qe("reconnect"))}),this.socket.once("connect",()=>{o=!0,this.dispatchEvent(new Qe("listening"))}),this.socket.on("disconnect",()=>{this.dispatchEvent(new Qe("disconnect"))})}_createChannel(e,t,n){const s={...this.channelOptions},i=new EUe(s),o=a=>{fs.error("incoming connection errored",a.detail)};return i.addEventListener("error",o),i.addEventListener("close",()=>{i.removeEventListener("error",o)},{once:!0}),i.addEventListener("signal",a=>{this.socket.emit("ss-handshake",{intentId:e,srcMultiaddr:t,dstMultiaddr:n,answer:!0,signal:a.detail})}),i.addEventListener("ready",()=>{const a=RV(i,{remoteAddr:this.signallingAddr});fs("new inbound connection %s",a.remoteAddr);try{this.upgrader.upgradeInbound(a).then(c=>{fs("inbound connection %s upgraded",a.remoteAddr),this.connections.push(a),i.addEventListener("close",()=>{this.connections=this.connections.filter(f=>f!==a),this.channels.delete(e),this.pendingSignals.delete(e)},{once:!0}),this.dispatchEvent(new Qe("connection",{detail:c})),this.handler(c)}).catch(c=>{fs.error("inbound connection failed to upgrade",c),a.close().catch(u=>{fs.error("inbound connection failed to close after failing to upgrade",u)})})}catch(c){fs.error("inbound connection failed to upgrade",c),a.close().catch(u=>{fs.error("inbound connection failed to close after failing to upgrade",u)})}},{once:!0}),i}handleWsHandshake(e){if(fs('incoming handshake. signal type "%s" is answer %s',e.signal.type,e.answer),!0===e.answer||null!=e.err||null==e.intentId)return;const t=e.intentId;let n=this.pendingSignals.get(t);null==n&&(n=[],this.pendingSignals.set(t,n)),n.push(e);let s=this.channels.get(t);if(null==s){if("offer"!==e.signal.type)return void fs("handshake is not an offer and channel does not exist, buffering until we receive an offer");fs("creating new channel to handle offer handshake"),s=this._createChannel(e.intentId,e.srcMultiaddr,e.dstMultiaddr),this.channels.set(t,s)}else fs("channel already exists, using it to handle handshake");for(;n.length>0;){const i=n.shift();null!=i?.signal&&s.handleSignal(i.signal)}}close(){var e=this;return(0,B.Z)(function*(){e.socket.emit("ss-leave",e.signallingAddr.toString()),e.socket.removeAllListeners(),e.socket.close(),yield Promise.all([...e.connections.map(function(){var t=(0,B.Z)(function*(n){return yield n.close()});return function(n){return t.apply(this,arguments)}}()),...Array.from(e.channels.values()).map(function(){var t=(0,B.Z)(function*(n){return yield n.close()});return function(n){return t.apply(this,arguments)}}())]),e.dispatchEvent(new Qe("close"))})()}}class LUe extends wr{constructor(e,t,n,s,i){super(),this.upgrader=e,this.handler=t,this.peerId=n,this.transport=s,this.options=i}listen(e){var t=this;return(0,B.Z)(function*(){if(null!=t.listeningAddr)throw ee(new Error("listener already in use"),"ERR_ALREADY_LISTENING");const n=en();let s;t.listeningAddr=e,s=e.protoCodes().includes(421)?e:e.encapsulate(`/p2p/${t.peerId.toString()}`);const i=t.signallingUrl=DV(e);fs("connecting to signalling server on: %s",t.signallingUrl);const o=new BUe(t.signallingUrl,s,t.upgrader,t.handler,t.options.channelOptions);return o.addEventListener("error",a=>{const c=a.detail;fs("error connecting to signalling server %o",c),o.close().catch(u=>{fs.error("error closing server after error",u)}),n.reject(c)}),o.addEventListener("listening",()=>{fs("connected to signalling server"),t.dispatchEvent(new Qe("listening")),n.resolve()}),o.addEventListener("peer",a=>{t.transport.peerDiscovered(a.detail)}),o.addEventListener("connection",a=>{const c=a.detail;if(null==c.remoteAddr)try{c.remoteAddr=e.decapsulateCode(421).encapsulate(`/p2p/${c.remotePeer.toString()}`)}catch(u){fs.error("could not determine remote address",u)}t.dispatchEvent(new Qe("connection",{detail:c}))}),o.addEventListener("disconnect",()=>{t.transport.sigServers.delete(i)}),o.addEventListener("reconnect",()=>{t.transport.sigServers.set(i,o)}),t.transport.sigServers.set(t.signallingUrl,o),yield n.promise})()}close(){var e=this;return(0,B.Z)(function*(){if(null!=e.signallingUrl){const t=e.transport.sigServers.get(e.signallingUrl);null!=t&&(yield t.close(),e.transport.sigServers.delete(e.signallingUrl))}e.dispatchEvent(new Qe("close")),e.listeningAddr=void 0})()}getAddrs(){return null!=this.listeningAddr?[this.listeningAddr]:[]}}const zUe=function UUe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},G2=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class KUe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ZUe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return OV(this,e)}}class HUe{constructor(e){this.decoders=e}or(e){return OV(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const OV=(r,e)=>new HUe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class GUe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new KUe(e,t,n),this.decoder=new ZUe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const W2=({name:r,prefix:e,encode:t,decode:n})=>new GUe(r,e,t,n),qh=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=zUe(t,e);return W2({prefix:r,name:e,encode:n,decode:i=>G2(s(i))})},Vn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>W2({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),QUe=W2({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),JUe=Vn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),XUe=Vn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),qUe=qh({prefix:"9",name:"base10",alphabet:"0123456789"}),eMe=Vn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),tMe=Vn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),rMe=Vn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),nMe=Vn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),sMe=Vn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),iMe=Vn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),oMe=Vn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),aMe=Vn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cMe=Vn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),lMe=Vn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),uMe=Vn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),dMe=qh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),fMe=qh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),hMe=qh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),pMe=qh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),yMe=Vn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),gMe=Vn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),bMe=Vn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_Me=Vn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),PV=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),mMe=PV.reduce((r,e,t)=>(r[t]=e,r),[]),vMe=PV.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),xMe=W2({prefix:"\u{1f680}",name:"base256emoji",encode:function wMe(r){return r.reduce((e,t)=>e+mMe[t],"")},decode:function EMe(r){const e=[];for(const t of r){const n=vMe[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var CMe=Math.pow(2,31),DMe=Math.pow(2,7),OMe=Math.pow(2,14),PMe=Math.pow(2,21),NMe=Math.pow(2,28),BMe=Math.pow(2,35),LMe=Math.pow(2,42),kMe=Math.pow(2,49),UMe=Math.pow(2,56),MMe=Math.pow(2,63),zMe={encode:function BV(r,e,t){e=e||[];for(var n=t=t||0;r>=CMe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,BV.bytes=t-n+1,e},decode:function Mx(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw Mx.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return Mx.bytes=i-n,t},encodingLength:function(r){return r<DMe?1:r<OMe?2:r<PMe?3:r<NMe?4:r<BMe?5:r<LMe?6:r<kMe?7:r<UMe?8:r<MMe?9:10}};const kV=zMe,UV=(r,e,t=0)=>(kV.encode(r,e,t),e),MV=r=>kV.encodingLength(r),Fx=(r,e)=>{const t=e.byteLength,n=MV(r),s=n+MV(t),i=new Uint8Array(s+t);return UV(r,i,0),UV(t,i,n),i.set(e,s),new FV(r,t,e,i)};class FV{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const zV=({name:r,code:e,encode:t})=>new jMe(r,e,t);class jMe{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Fx(this.code,t):t.then(n=>Fx(this.code,n))}throw Error("Unknown type, must be binary type")}}const VV=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),$Me=zV({name:"sha2-256",code:18,encode:VV("SHA-256")}),KMe=zV({name:"sha2-512",code:19,encode:VV("SHA-512")}),$V=G2,HMe={code:0,name:"identity",encode:$V,digest:r=>Fx(0,$V(r))},GMe="raw",WMe=85,YMe=r=>G2(r),QMe=r=>G2(r),JMe=new TextEncoder,XMe=new TextDecoder,qMe="json",eFe=512,tFe=r=>JMe.encode(JSON.stringify(r)),rFe=r=>JSON.parse(XMe.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const HV={...sm,...im,...om,...am,...cm,...lm,...um,...dm,...fm,...hm};function GV(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const WV=GV("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),Vx=GV("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function uFe(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?function lFe(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),dFe={utf8:WV,"utf-8":WV,hex:HV.base16,latin1:Vx,ascii:Vx,binary:Vx,...HV},Y2=Symbol.for("@libp2p/transport"),Cu=Symbol.for("@libp2p/peer-discovery"),hFe="RTCPeerConnection"in globalThis,qc=Be("libp2p:webrtc-star"),pFe=()=>{};class yFe extends wr{constructor(){super(...arguments),this.started=!1}get[Cu](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star-discovery"}isStarted(){return this.started}start(){var e=this;return(0,B.Z)(function*(){e.started=!0})()}stop(){var e=this;return(0,B.Z)(function*(){e.started=!1})()}dispatchEvent(e){return!!this.isStarted()&&super.dispatchEvent(e)}}class gFe{constructor(e){null!=e?.wrtc&&(this.wrtc=e.wrtc),this.sigServers=new Map,this._discovery=new yFe,this.discovery=()=>this._discovery,this.peerDiscovered=this.peerDiscovered.bind(this)}get[Y2](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star"}dial(e,t){var n=this;return(0,B.Z)(function*(){const i=RV(yield n._connect(e,t),{remoteAddr:e,signal:t.signal});qc("new outbound connection %s",i.remoteAddr);const o=yield t.upgrader.upgradeOutbound(i);return qc("outbound connection %s upgraded",i.remoteAddr),o})()}_connect(e,t){var n=this;return(0,B.Z)(function*(){var s,i;if(!0===(null===(s=t.signal)||void 0===s?void 0:s.aborted))throw new x2;const o={...null!==(i=t.channelOptions)&&void 0!==i?i:{}};null!=n.wrtc&&(o.wrtc=n.wrtc);const a=e.toOptions(),c=function fFe(r,e="utf8"){const t=dFe[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}(Ox(36),"hex");return yield new Promise((u,f)=>{var E;const T=n.sigServers.get(DV(e));if(null==T?.socket)return f(ee(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let U=!1;qc("dialing %s:%s",a.host,a.port);const b=new DUe(o),P=$=>{const V=$.detail;U||(qc.error(`connection error ${a.host}:${a.port}: ${V.message}`),H(V))},F=()=>{U=!0,qc("connection opened %s:%s",a.host,a.port),H()},M=()=>{qc.error("connection aborted %s:%s",a.host,a.port),b.close().finally(()=>{H(new x2)})},H=$=>{var V;b.removeEventListener("ready",F),null===(V=t.signal)||void 0===V||V.removeEventListener("abort",M),null==$?u(b):f($)};b.addEventListener("ready",F,{once:!0}),b.addEventListener("close",()=>{b.removeEventListener("error",P)}),null===(E=t.signal)||void 0===E||E.addEventListener("abort",M),b.addEventListener("signal",$=>{const V=$.detail;T.socket.emit("ss-handshake",{intentId:c,srcMultiaddr:T.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:V})}),T.socket.on("ws-handshake",$=>{$.intentId===c&&null!=$.err&&b.close().finally(()=>{f(ee(new Error($.err),"ERR_SIGNALLING_FAILED"))}),$.intentId===c&&null!=$.answer&&!b.closed&&b.handleSignal($.signal)})})})()}createListener(e){var t,n;if(!hFe&&null==this.wrtc)throw ee(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");if(e.channelOptions=null!==(t=e.channelOptions)&&void 0!==t?t:{},null!=this.wrtc&&(e.channelOptions.wrtc=this.wrtc),null==this.peerId)throw ee(new Error("PeerId not set"),"ERR_MISSING_PEER_ID");return function kUe(r,e,t,n,s){return new LUe(r,e,t,n,s)}(e.upgrader,null!==(n=e.handler)&&void 0!==n?n:pFe,this.peerId,this,e)}filter(e){return(e=Array.isArray(e)?e:[e]).filter(t=>!t.protoCodes().includes(290)&&X6.matches(t))}peerDiscovered(e){qc("peer discovered: %s",e),e=function PUe(r){const e="/libp2p-webrtc-star";if(r.startsWith(e)){let t=at(r=r.substring(e.length,r.length));const n=t.stringTuples().filter(s=>421===s[0])[0];if(null==n[1])throw new Error("invalid multiaddr: "+r);t=t.decapsulate("p2p"),t=t.encapsulate("/p2p-webrtc-star"),t=t.encapsulate(`/p2p/${n[1]}`),r=t.toString()}return r}(e);const t=at(e),n=t.getPeerId();if(null==n)return;const s=bt(n);this._discovery.dispatchEvent(new Qe("peer",{detail:{id:s,multiaddrs:[t],protocols:[]}}))}}var Ut=(()=>(function(r){r.NOT_STARTED_YET="The libp2p node is not started yet",r.DHT_DISABLED="DHT is not available",r.PUBSUB_DISABLED="PubSub is not available",r.CONN_ENCRYPTION_REQUIRED="At least one connection encryption module is required",r.ERR_TRANSPORTS_REQUIRED="At least one transport module is required",r.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",r.NOT_FOUND="Not found"}(Ut||(Ut={})),Ut))(),Ie=(()=>(function(r){r.DHT_DISABLED="ERR_DHT_DISABLED",r.ERR_PUBSUB_DISABLED="ERR_PUBSUB_DISABLED",r.PUBSUB_NOT_STARTED="ERR_PUBSUB_NOT_STARTED",r.DHT_NOT_STARTED="ERR_DHT_NOT_STARTED",r.CONN_ENCRYPTION_REQUIRED="ERR_CONN_ENCRYPTION_REQUIRED",r.ERR_TRANSPORTS_REQUIRED="ERR_TRANSPORTS_REQUIRED",r.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",r.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",r.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",r.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",r.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",r.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",r.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",r.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",r.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",r.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",r.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",r.ERR_DIALED_SELF="ERR_DIALED_SELF",r.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",r.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",r.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",r.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",r.ERR_INVALID_KEY="ERR_INVALID_KEY",r.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",r.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",r.ERR_INVALID_PEER="ERR_INVALID_PEER",r.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",r.ERR_NOT_FOUND="ERR_NOT_FOUND",r.ERR_TIMEOUT="ERR_TIMEOUT",r.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",r.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",r.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",r.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",r.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",r.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",r.ERR_FIND_SELF="ERR_FIND_SELF",r.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",r.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",r.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",r.ERR_KEYCHAIN_REQUIRED="ERR_KEYCHAIN_REQUIRED",r.ERR_INVALID_CMS="ERR_INVALID_CMS",r.ERR_MISSING_KEYS="ERR_MISSING_KEYS",r.ERR_NO_KEY="ERR_NO_KEY",r.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",r.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",r.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",r.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",r.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",r.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",r.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",r.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",r.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",r.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",r.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",r.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",r.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",r.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",r.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",r.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",r.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",r.ERR_INVALID_RECORD="ERR_INVALID_RECORD",r.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED",r.ERR_NO_HANDLER_FOR_PROTOCOL="ERR_NO_HANDLER_FOR_PROTOCOL",r.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",r.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",r.ERR_CONNECTION_DENIED="ERR_CONNECTION_DENIED"}(Ie||(Ie={})),Ie))();function jx(r,e){return $x.apply(this,arguments)}function $x(){return $x=Ee(function*(r,e){yield*Fe(be(os(r,function(){var t=(0,B.Z)(function*(n){return yield e.addressBook.add(n.id,n.multiaddrs),n});return function(n){return t.apply(this,arguments)}}())),X)}),$x.apply(this,arguments)}function YV(r){const e=new Set;return Js(r,t=>!e.has(t.id.toString())&&(e.add(t.id.toString()),!0))}function QV(r){return Kx.apply(this,arguments)}function Kx(){return Kx=Ee(function*(r,e=1){let t=0;var i,n=!1,s=!1;try{for(var a,o=be(r);n=!(a=yield X(o.next())).done;n=!1){const c=a.value;t++,yield c}}catch(c){s=!0,i=c}finally{try{n&&null!=o.return&&(yield X(o.return()))}finally{if(s)throw i}}if(t<e)throw ee(new Error("not found"),"NOT_FOUND")}),Kx.apply(this,arguments)}var Q2=p(20488),rt=p(83358);const JV=Be("libp2p:peer-routing");class mFe{constructor(e,t){var n;this.components=e,this.routers=t.routers,this.refreshManagerInit=null!==(n=t.refreshManager)&&void 0!==n?n:{},this.started=!1,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}isStarted(){return this.started}start(){var e=this;return(0,B.Z)(function*(){e.started||0===e.routers.length||null!=e.timeoutId||!1===e.refreshManagerInit.enabled||(e.timeoutId=(0,Q2.setDelayedInterval)(e._findClosestPeersTask,e.refreshManagerInit.interval,e.refreshManagerInit.bootDelay),e.started=!0)})()}_findClosestPeersTask(){var e=this;return(0,B.Z)(function*(){if(null==e.abortController)try{var t;e.abortController=new Ar.TimeoutController(null!==(t=e.refreshManagerInit.timeout)&&void 0!==t?t:1e4);try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,e.abortController.signal)}catch{}yield Oi(e.getClosestPeers(e.components.peerId.toBytes(),{signal:e.abortController.signal}))}catch(s){JV.error(s)}finally{var n;null===(n=e.abortController)||void 0===n||n.clear(),e.abortController=void 0}})()}stop(){var e=this;return(0,B.Z)(function*(){var t;(0,Q2.clearDelayedInterval)(e.timeoutId),null===(t=e.abortController)||void 0===t||t.abort(),e.started=!1})()}findPeer(e,t){var n=this;return(0,B.Z)(function*(){if(0===n.routers.length)throw ee(new Error("No peer routers available"),Ie.ERR_NO_ROUTERS_AVAILABLE);if(e.toString()===n.components.peerId.toString())throw ee(new Error("Should not try to find self"),Ie.ERR_FIND_SELF);const s=yield _t(Xs(...n.routers.map(i=>Ee(function*(){try{yield yield X(i.findPeer(e,t))}catch(o){JV.error(o)}})())),i=>Js(i,Boolean),i=>jx(i,n.components.peerStore),function(){var i=(0,B.Z)(function*(o){return yield Ni(o)});return function(o){return i.apply(this,arguments)}}());if(null!=s)return s;throw ee(new Error(Ut.NOT_FOUND),Ie.ERR_NOT_FOUND)})()}getClosestPeers(e,t){var n=this;return Ee(function*(){if(0===n.routers.length)throw ee(new Error("No peer routers available"),Ie.ERR_NO_ROUTERS_AVAILABLE);yield*Fe(be(_t(Xs(...n.routers.map(s=>s.getClosestPeers(e,t))),s=>jx(s,n.components.peerStore),s=>YV(s),s=>QV(s))),X)})()}}class vFe{constructor(e,t){var n;this.routers=null!==(n=t.routers)&&void 0!==n?n:[],this.started=!1,this.components=e}isStarted(){return this.started}start(){var e=this;return(0,B.Z)(function*(){e.started=!0})()}stop(){var e=this;return(0,B.Z)(function*(){e.started=!1})()}findProviders(e,t={}){var n=this;return Ee(function*(){if(0===n.routers.length)throw ee(new Error("No content this.routers available"),Ie.ERR_NO_ROUTERS_AVAILABLE);yield*Fe(be(_t(Xs(...n.routers.map(s=>s.findProviders(e,t))),s=>jx(s,n.components.peerStore),s=>YV(s),s=>QV(s))),X)})()}provide(e,t={}){var n=this;return(0,B.Z)(function*(){if(0===n.routers.length)throw ee(new Error("No content routers available"),Ie.ERR_NO_ROUTERS_AVAILABLE);yield Promise.all(n.routers.map(function(){var s=(0,B.Z)(function*(i){return yield i.provide(e,t)});return function(i){return s.apply(this,arguments)}}()))})()}put(e,t,n){var s=this;return(0,B.Z)(function*(){if(!s.isStarted())throw ee(new Error(Ut.NOT_STARTED_YET),Ie.DHT_NOT_STARTED);const i=s.components.dht;null!=i&&(yield Oi(i.put(e,t,n)))})()}get(e,t){var n=this;return(0,B.Z)(function*(){if(!n.isStarted())throw ee(new Error(Ut.NOT_STARTED_YET),Ie.DHT_NOT_STARTED);const s=n.components.dht;if(null!=s){var a,i=!1,o=!1;try{for(var u,c=be(s.get(e,t));i=!(u=yield c.next()).done;i=!1){const f=u.value;if("VALUE"===f.name)return f.value}}catch(f){o=!0,a=f}finally{try{i&&null!=c.return&&(yield c.return())}finally{if(o)throw a}}}throw ee(new Error(Ut.NOT_FOUND),Ie.ERR_NOT_FOUND)})()}getMany(e,t,n){var s=this;return Ee(function*(){if(!s.isStarted())throw ee(new Error(Ut.NOT_STARTED_YET),Ie.DHT_NOT_STARTED);if(null==t||0===t)return;let i=0;const o=s.components.dht;if(null!=o){var u,a=!1,c=!1;try{for(var E,f=be(o.get(e,n));a=!(E=yield X(f.next())).done;a=!1){const T=E.value;if("VALUE"===T.name&&(yield{from:T.from,val:T.value},i++,i===t))break}}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield X(f.return()))}finally{if(c)throw u}}}if(0===i)throw ee(new Error(Ut.NOT_FOUND),Ie.ERR_NOT_FOUND)})()}}function t0(r){if(Tc(r))return{id:r,multiaddrs:[],protocols:[]};let e;return"string"==typeof r&&(r=at(r)),Sl(r)&&(e=r,r=function wFe(r){const e=r.getPeerId();if(null==e)throw ee(new Error(`${r.toString()} does not have a valid peer type`),Ie.ERR_INVALID_MULTIADDR);try{return bt(e)}catch{throw ee(new Error(`${r.toString()} is not a valid peer type`),Ie.ERR_INVALID_MULTIADDR)}}(r)),{id:r,multiaddrs:null!=e?[e]:[],protocols:[]}}const EFe=r=>r;class xFe extends wr{constructor(e,t){var n;super();const{listen:s=[],announce:i=[]}=t;this.components=e,this.listen=new Set(s.map(o=>o.toString())),this.announce=new Set(i.map(o=>o.toString())),this.observed=new Set,this.announceFilter=null!==(n=t.announceFilter)&&void 0!==n?n:EFe}getListenAddrs(){return Array.from(this.listen).map(e=>at(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>at(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>at(e))}confirmObservedAddr(e){}removeObservedAddr(e){}addObservedAddr(e){let t=at(e);const n=t.getPeerId();null!=n&&bt(n).equals(this.components.peerId)&&(t=t.decapsulate(at(`/p2p/${this.components.peerId.toString()}`)));const s=t.toString();this.observed.has(s)||(this.observed.add(s),this.dispatchEvent(new Qe("change:addresses")))}getAddresses(){let e=this.getAnnounceAddrs().map(n=>n.toString());0===e.length&&(e=this.components.transportManager.getAddrs().map(n=>n.toString())),e=e.concat(this.getObservedAddrs().map(n=>n.toString()));const t=new Set(e);return this.announceFilter(Array.from(t).map(n=>at(n))).map(n=>n.getPeerId()===this.components.peerId.toString()?n:n.encapsulate(`/p2p/${this.components.peerId.toString()}`))}}const XV=Be("libp2p:connection-manager:latency-monitor:visibility-change-emitter");class SFe extends wr{constructor(){super(),this.hidden="hidden",this.visibilityChange="visibilityChange",null!=globalThis.document&&(this._initializeVisibilityVarNames(),this._addVisibilityChangeListener())}_initializeVisibilityVarNames(){let e="hidden",t="visibilitychange";typeof globalThis.document.hidden<"u"?(e="hidden",t="visibilitychange"):typeof globalThis.document.mozHidden<"u"?(e="mozHidden",t="mozvisibilitychange"):typeof globalThis.document.msHidden<"u"?(e="msHidden",t="msvisibilitychange"):typeof globalThis.document.webkitHidden<"u"&&(e="webkitHidden",t="webkitvisibilitychange"),this.hidden=e,this.visibilityChange=t}_addVisibilityChangeListener(){typeof globalThis.document.addEventListener>"u"||typeof document[this.hidden]>"u"?XV("Checking page visibility requires a browser that supports the Page Visibility API."):globalThis.document.addEventListener(this.visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(void 0!==this.hidden&&void 0!==document[this.hidden])return null==document[this.hidden]}_handleVisibilityChange(){const e=!1===globalThis.document[this.hidden];XV(e?"Page Visible":"Page Hidden"),this.dispatchEvent(new Qe("visibilityChange",{detail:e}))}}const Jo=Be("libp2p:connection-manager:latency-monitor");class AFe extends wr{constructor(e={}){var t,n;super();const{latencyCheckIntervalMs:s,dataEmitIntervalMs:i,asyncTestFn:o,latencyRandomPercentage:a}=e;this.latencyCheckIntervalMs=s??500,this.latencyRandomPercentage=a??10,this.latencyCheckMultiply=this.latencyRandomPercentage/100*2*this.latencyCheckIntervalMs,this.latencyCheckSubtract=this.latencyCheckMultiply/2,this.dataEmitIntervalMs=null===i||0===i?void 0:i??5e3,Jo("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",this.latencyCheckIntervalMs,this.dataEmitIntervalMs),null!=this.dataEmitIntervalMs?Jo("Expecting ~%s events per summary",this.latencyCheckIntervalMs/this.dataEmitIntervalMs):Jo("Not emitting summaries"),this.asyncTestFn=o,null!=(null===(t=globalThis.process)||void 0===t?void 0:t.hrtime)?(Jo("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=c=>{const u=this.now(c);return 1e3*u[0]+u[1]/1e6}):typeof window<"u"&&null!=(null===(n=window.performance)||void 0===n?void 0:n.now)?(Jo("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=c=>Math.round(this.now()-c)):(Jo("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=c=>this.now()-c),this.latencyData=this.initLatencyData()}start(){var e;(function TFe(){return typeof globalThis.window<"u"})()&&(this.visibilityChangeEmitter=new SFe,this.visibilityChangeEmitter.addEventListener("visibilityChange",t=>{const{detail:n}=t;n?this._startTimers():(this._emitSummary(),this._stopTimers())})),!0===(null===(e=this.visibilityChangeEmitter)||void 0===e?void 0:e.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){null==this.checkLatencyID&&(this.checkLatency(),null!=this.dataEmitIntervalMs&&(this.emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),"function"==typeof this.emitIntervalID.unref&&this.emitIntervalID.unref()))}_stopTimers(){null!=this.checkLatencyID&&(clearTimeout(this.checkLatencyID),this.checkLatencyID=void 0),null!=this.emitIntervalID&&(clearInterval(this.emitIntervalID),this.emitIntervalID=void 0)}_emitSummary(){const e=this.getSummary();e.events>0&&this.dispatchEvent(new Qe("data",{detail:e}))}getSummary(){const e={events:this.latencyData.events,minMs:this.latencyData.minMs,maxMs:this.latencyData.maxMs,avgMs:this.latencyData.events>0?this.latencyData.totalMs/this.latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this.latencyData.startTime)};return this.latencyData=this.initLatencyData(),Jo.trace("Summary: %O",e),e}checkLatency(){const e=Math.random()*this.latencyCheckMultiply-this.latencyCheckSubtract,t={deltaOffset:Math.ceil(this.latencyCheckIntervalMs+e),startTime:this.now()},n=()=>{if(null==this.checkLatencyID)return;const s=this.getDeltaMS(t.startTime)-t.deltaOffset;this.checkLatency(),this.latencyData.events++,this.latencyData.minMs=Math.min(this.latencyData.minMs,s),this.latencyData.maxMs=Math.max(this.latencyData.maxMs,s),this.latencyData.totalMs+=s,Jo.trace("MS: %s Data: %O",s,this.latencyData)};Jo.trace("localData: %O",t),this.checkLatencyID=setTimeout(()=>{null!=this.asyncTestFn?(t.deltaOffset=0,t.startTime=this.now(),this.asyncTestFn(n)):(t.deltaOffset-=1,n())},t.deltaOffset),"function"==typeof this.checkLatencyID.unref&&this.checkLatencyID.unref()}initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}}var r0=p(17765);const ej="CLOSING",Zx="CLOSED";function J2(r,e){const t={[Symbol.iterator]:()=>t,next:()=>{const n=r.next(),s=n.value;return!0===n.done||null==s?{done:!0,value:void 0}:{done:!1,value:e(s)}}};return t}class CFe{constructor(e){if(this.map=new Map,null!=e)for(const[t,n]of e.entries())this.map.set(t.toString(),n)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(e){this.map.delete(e.toString())}entries(){return J2(this.map.entries(),e=>[bt(e[0]),e[1]])}forEach(e){this.map.forEach((t,n)=>{e(t,bt(n),this)})}get(e){return this.map.get(e.toString())}has(e){return this.map.has(e.toString())}set(e,t){this.map.set(e.toString(),t)}keys(){return J2(this.map.keys(),e=>bt(e))}values(){return this.map.values()}get size(){return this.map.size}}class sc{constructor(e){if(this.set=new Set,null!=e)for(const t of e)this.set.add(t.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(e){this.set.add(e.toString())}clear(){this.set.clear()}delete(e){this.set.delete(e.toString())}entries(){return J2(this.set.entries(),e=>{const t=bt(e[0]);return[t,t]})}forEach(e){this.set.forEach(t=>{const n=bt(t);e(n,n,this)})}has(e){return this.set.has(e.toString())}values(){return J2(this.set.values(),e=>bt(e))}intersection(e){const t=new sc;for(const n of e)this.has(n)&&t.add(n);return t}difference(e){const t=new sc;for(const n of this)e.has(n)||t.add(n);return t}union(e){const t=new sc;for(const n of e)t.add(n);for(const n of this)t.add(n);return t}}Symbol;var tj=p(2518);const Yr=Be("libp2p:connection-manager"),RFe={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,inboundConnectionThreshold:5,maxIncomingPendingConnections:10},Gx="libp2p",Wx="connection-manager";class OFe extends wr{constructor(e,t){var n,s,i,o;if(super(),this.opts=Sr.call({ignoreUndefined:!0},RFe,t),this.opts.maxConnections<this.opts.minConnections)throw ee(new Error("Connection Manager maxConnections must be greater than minConnections"),Ie.ERR_INVALID_PARAMETERS);Yr("options: %o",this.opts),this.components=e,this.connections=new Map,this.started=!1,this._checkMetrics=this._checkMetrics.bind(this),this.latencyMonitor=new AFe({latencyCheckIntervalMs:t.pollInterval,dataEmitIntervalMs:t.pollInterval});try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,this)}catch{}this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.startupReconnectTimeout=null!==(n=t.startupReconnectTimeout)&&void 0!==n?n:6e4,this.dialTimeout=null!==(s=t.dialTimeout)&&void 0!==s?s:3e4,this.allow=(null!==(i=t.allow)&&void 0!==i?i:[]).map(a=>at(a)),this.deny=(null!==(o=t.deny)&&void 0!==o?o:[]).map(a=>at(a)),this.inboundConnectionRateLimiter=new tj.RateLimiterMemory({points:this.opts.inboundConnectionThreshold,duration:1}),this.incomingPendingConnections=0}isStarted(){return this.started}start(){var e=this;return(0,B.Z)(function*(){var t,n,s,i;null!=e.components.metrics&&(e.timer=null!==(i=e.timer)&&void 0!==i?i:r0(e._checkMetrics,e.opts.pollInterval)),null===(t=e.components.metrics)||void 0===t||t.updateComponentMetric({system:Gx,component:Wx,metric:"connections",label:"direction",value:()=>{const o={inbound:0,outbound:0};for(const a of e.connections.values())for(const c of a)"inbound"===c.stat.direction?o.inbound++:o.outbound++;return o}}),null===(n=e.components.metrics)||void 0===n||n.updateComponentMetric({system:Gx,component:Wx,metric:"protocol-streams-total",label:"protocol",value:()=>{const o={};for(const u of e.connections.values())for(const f of u)for(const E of f.streams){var a,c;const T=`${E.stat.direction} ${null!==(a=E.stat.protocol)&&void 0!==a?a:"unnegotiated"}`;o[T]=(null!==(c=o[T])&&void 0!==c?c:0)+1}return o}}),null===(s=e.components.metrics)||void 0===s||s.updateComponentMetric({system:Gx,component:Wx,metric:"protocol-streams-per-connection-90th-percentile",label:"protocol",value:()=>{const o={};for(const E of e.connections.values())for(const T of E){const U={};for(const b of T.streams){var a,c;const P=`${b.stat.direction} ${null!==(a=b.stat.protocol)&&void 0!==a?a:"unnegotiated"}`;U[P]=(null!==(c=U[P])&&void 0!==c?c:0)+1}for(const[b,P]of Object.entries(U)){var u;o[b]=null!==(u=o[b])&&void 0!==u?u:[],o[b].push(P)}}const f={};for(let[E,T]of Object.entries(o)){T=T.sort((b,P)=>b-P);const U=Math.floor(.9*T.length);f[E]=T[U]}return f}}),e.latencyMonitor.start(),e._onLatencyMeasure=e._onLatencyMeasure.bind(e),e.latencyMonitor.addEventListener("data",e._onLatencyMeasure),e.started=!0,Yr("started")})()}afterStart(){var e=this;return(0,B.Z)(function*(){e.components.upgrader.addEventListener("connection",e.onConnect),e.components.upgrader.addEventListener("connectionEnd",e.onDisconnect),Promise.resolve().then((0,B.Z)(function*(){var t;const n=[];for(const s of yield e.components.peerStore.all())(yield e.components.peerStore.getTags(s.id)).filter(a=>"keep-alive"===a.name).length>0&&n.push(s.id);null===(t=e.connectOnStartupController)||void 0===t||t.clear(),e.connectOnStartupController=new Ar.TimeoutController(e.startupReconnectTimeout);try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,e.connectOnStartupController.signal)}catch{}yield Promise.all(n.map(function(){var s=(0,B.Z)(function*(i){var o;yield e.openConnection(i,{signal:null===(o=e.connectOnStartupController)||void 0===o?void 0:o.signal}).catch(a=>{Yr.error(a)})});return function(i){return s.apply(this,arguments)}}()))})).catch(t=>{Yr.error(t)}).finally(()=>{var t;null===(t=e.connectOnStartupController)||void 0===t||t.clear()})})()}beforeStop(){var e=this;return(0,B.Z)(function*(){var t;null===(t=e.connectOnStartupController)||void 0===t||t.abort(),e.components.upgrader.removeEventListener("connection",e.onConnect),e.components.upgrader.removeEventListener("connectionEnd",e.onDisconnect)})()}stop(){var e=this;return(0,B.Z)(function*(){var t;null===(t=e.timer)||void 0===t||t.clear(),e.latencyMonitor.removeEventListener("data",e._onLatencyMeasure),e.latencyMonitor.stop(),e.started=!1,yield e._close(),Yr("stopped")})()}_close(){var e=this;return(0,B.Z)(function*(){const t=[];for(const n of e.connections.values())for(const s of n)t.push((0,B.Z)(function*(){try{yield s.close()}catch(i){Yr.error(i)}})());Yr("closing %d connections",t.length),yield Promise.all(t),e.connections.clear()})()}_checkMetrics(){var e=this;return(0,B.Z)(function*(){const t=e.components.metrics;if(null!=t)try{const n=t.getGlobal().getMovingAverages(),s=n.dataReceived[e.opts.movingAverageInterval].movingAverage;yield e._checkMaxLimit("maxReceivedData",s);const i=n.dataSent[e.opts.movingAverageInterval].movingAverage;yield e._checkMaxLimit("maxSentData",i);const o=s+i;yield e._checkMaxLimit("maxData",o),Yr.trace("metrics update",o)}finally{e.timer=r0(e._checkMetrics,e.opts.pollInterval)}})()}onConnect(e){this._onConnect(e).catch(t=>{Yr.error(t)})}_onConnect(e){var t=this;return(0,B.Z)(function*(){const{detail:n}=e;if(!t.started)return void(yield n.close());const s=n.remotePeer,i=s.toString(),o=t.connections.get(i);null!=o?o.push(n):t.connections.set(i,[n]),null!=s.publicKey&&(yield t.components.peerStore.keyBook.set(s,s.publicKey));const a=t.getConnections().length,c=a-t.opts.maxConnections;yield t._checkMaxLimit("maxConnections",a,c),t.dispatchEvent(new Qe("peer:connect",{detail:n}))})()}onDisconnect(e){const{detail:t}=e;if(!this.started)return;const n=t.remotePeer.toString();let s=this.connections.get(n);if(null!=s&&s.length>1)s=s.filter(o=>o.id!==t.id),this.connections.set(n,s);else if(null!=s){var i;this.connections.delete(n),this.dispatchEvent(new Qe("peer:disconnect",{detail:t})),null===(i=this.components.metrics)||void 0===i||i.onPeerDisconnected(t.remotePeer)}}getConnections(e){var t;if(null!=e)return null!==(t=this.connections.get(e.toString()))&&void 0!==t?t:[];let n=[];for(const s of this.connections.values())n=n.concat(s);return n}openConnection(e,t={}){var n=this;return(0,B.Z)(function*(){Yr("dial to %p",e);const s=n.getConnections(e);if(s.length>0)return Yr("had an existing connection to %p",e),s[0];let i;if(null==t?.signal){i=new Ar.TimeoutController(n.dialTimeout),t.signal=i.signal;try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,i.signal)}catch{}}try{const o=yield n.components.dialer.dial(e,t);let a=n.connections.get(e.toString());null==a&&(a=[],n.connections.set(e.toString(),a));let c=!1;for(const u of a)u.id===o.id&&(c=!0);return c||a.push(o),o}finally{i?.clear()}})()}closeConnections(e){var t=this;return(0,B.Z)(function*(){var n;const s=null!==(n=t.connections.get(e.toString()))&&void 0!==n?n:[];yield Promise.all(s.map(function(){var i=(0,B.Z)(function*(o){return yield o.close()});return function(o){return i.apply(this,arguments)}}()))})()}getAll(e){if(!Tc(e))throw ee(new Error("peerId must be an instance of peer-id"),Ie.ERR_INVALID_PARAMETERS);const t=e.toString(),n=this.connections.get(t);return null!=n?n.filter(s=>"OPEN"===s.stat.status):[]}_onLatencyMeasure(e){const{detail:t}=e;this._checkMaxLimit("maxEventLoopDelay",t.avgMs,1).catch(n=>{Yr.error(n)})}_checkMaxLimit(e,t,n=1){var s=this;return(0,B.Z)(function*(){const i=s.opts[e];Yr.trace("checking limit of %s. current value: %d of %d",e,t,i),t>i&&(Yr("%s: limit exceeded: %p, %d/%d, pruning %d connection(s)",s.components.peerId,e,t,i,n),yield s._pruneConnections(n))})()}_pruneConnections(e){var t=this;return(0,B.Z)(function*(){const n=t.getConnections(),s=new CFe;for(const a of n){const c=a.remotePeer;if(s.has(c))continue;const u=yield t.components.peerStore.getTags(c);s.set(c,u.reduce((f,E)=>f+E.value,0))}const i=n.sort((a,c)=>{var u,f;const E=null!==(u=s.get(a.remotePeer))&&void 0!==u?u:0,T=null!==(f=s.get(c.remotePeer))&&void 0!==f?f:0;return E>T?1:E<T?-1:0}),o=[];for(const a of i)if(Yr("too many connections open - closing a connection to %p",a.remotePeer),o.push(a),o.length===e)break;yield Promise.all(o.map(function(){var a=(0,B.Z)(function*(c){try{yield c.close()}catch(u){Yr.error(u)}t.onDisconnect(new Qe("connectionEnd",{detail:c}))});return function(c){return a.apply(this,arguments)}}()))})()}acceptIncomingConnection(e){var t=this;return(0,B.Z)(function*(){if(t.deny.some(i=>e.remoteAddr.toString().startsWith(i.toString())))return Yr("connection from %s refused - connection remote address was in deny list",e.remoteAddr),!1;if(t.allow.some(i=>e.remoteAddr.toString().startsWith(i.toString())))return t.incomingPendingConnections++,!0;if(t.incomingPendingConnections===t.opts.maxIncomingPendingConnections)return Yr("connection from %s refused - incomingPendingConnections exceeded by peer %s",e.remoteAddr),!1;if(e.remoteAddr.isThinWaistAddress()){const i=e.remoteAddr.nodeAddress().address;try{yield t.inboundConnectionRateLimiter.consume(i,1)}catch{return Yr("connection from %s refused - inboundConnectionThreshold exceeded by host %s",i,e.remoteAddr),!1}}return t.getConnections().length<t.opts.maxConnections?(t.incomingPendingConnections++,!0):(Yr("connection from %s refused - maxConnections exceeded",e.remoteAddr),!1)})()}afterUpgradeInbound(){this.incomingPendingConnections--}}const ic=Be("libp2p:connection-manager:auto-dialler"),PFe={enabled:!0,minConnections:0,autoDialInterval:1e4};class NFe{constructor(e,t){this.components=e,this.options=Sr.call({ignoreUndefined:!0},PFe,t),this.running=!1,this._autoDial=this._autoDial.bind(this),ic("options: %j",this.options)}isStarted(){return this.running}start(){var e=this;return(0,B.Z)(function*(){e.options.enabled?(e.running=!0,e._autoDial().catch(t=>{ic.error("could start autodial",t)}),ic("started")):ic("not enabled")})()}stop(){var e=this;return(0,B.Z)(function*(){e.options.enabled?(e.running=!1,null!=e.autoDialTimeout&&e.autoDialTimeout.clear(),ic("stopped")):ic("not enabled")})()}_autoDial(){var e=this;return(0,B.Z)(function*(){null!=e.autoDialTimeout&&e.autoDialTimeout.clear();const t=e.options.minConnections;if(e.components.connectionManager.getConnections().length>=t)return void(e.autoDialTimeout=r0(e._autoDial,e.options.autoDialInterval));const n=yield e.components.peerStore.all(),s=yield _t(n.sort(()=>Math.random()>.5?1:-1),i=>Js(i,o=>!o.id.equals(e.components.peerId)),i=>Fh(i,(o,a)=>a.protocols.length>o.protocols.length||null!=a.id.publicKey&&null==o.id.publicKey?1:-1),function(){var i=(0,B.Z)(function*(o){return yield Bc(o)});return function(o){return i.apply(this,arguments)}}());for(let i=0;e.running&&i<s.length&&e.components.connectionManager.getConnections().length<t;i++){if(!e.running)return;const o=s[i];if(0===e.components.connectionManager.getConnections(o.id).length){ic("connecting to a peerStore stored peer %p",o.id);try{yield e.components.connectionManager.openConnection(o.id)}catch(a){ic.error("could not connect to peerStore stored peer",a)}}}!e.running||(e.autoDialTimeout=r0(e._autoDial,e.options.autoDialInterval))})()}}var Et;!function(r){let e;var a;let t,n,s,i,o;(a=e=r.Status||(r.Status={})).SUCCESS="SUCCESS",a.HOP_SRC_ADDR_TOO_LONG="HOP_SRC_ADDR_TOO_LONG",a.HOP_DST_ADDR_TOO_LONG="HOP_DST_ADDR_TOO_LONG",a.HOP_SRC_MULTIADDR_INVALID="HOP_SRC_MULTIADDR_INVALID",a.HOP_DST_MULTIADDR_INVALID="HOP_DST_MULTIADDR_INVALID",a.HOP_NO_CONN_TO_DST="HOP_NO_CONN_TO_DST",a.HOP_CANT_DIAL_DST="HOP_CANT_DIAL_DST",a.HOP_CANT_OPEN_DST_STREAM="HOP_CANT_OPEN_DST_STREAM",a.HOP_CANT_SPEAK_RELAY="HOP_CANT_SPEAK_RELAY",a.HOP_CANT_RELAY_TO_SELF="HOP_CANT_RELAY_TO_SELF",a.STOP_SRC_ADDR_TOO_LONG="STOP_SRC_ADDR_TOO_LONG",a.STOP_DST_ADDR_TOO_LONG="STOP_DST_ADDR_TOO_LONG",a.STOP_SRC_MULTIADDR_INVALID="STOP_SRC_MULTIADDR_INVALID",a.STOP_DST_MULTIADDR_INVALID="STOP_DST_MULTIADDR_INVALID",a.STOP_RELAY_REFUSED="STOP_RELAY_REFUSED",a.MALFORMED_MESSAGE="MALFORMED_MESSAGE",function(a){a[a.SUCCESS=100]="SUCCESS",a[a.HOP_SRC_ADDR_TOO_LONG=220]="HOP_SRC_ADDR_TOO_LONG",a[a.HOP_DST_ADDR_TOO_LONG=221]="HOP_DST_ADDR_TOO_LONG",a[a.HOP_SRC_MULTIADDR_INVALID=250]="HOP_SRC_MULTIADDR_INVALID",a[a.HOP_DST_MULTIADDR_INVALID=251]="HOP_DST_MULTIADDR_INVALID",a[a.HOP_NO_CONN_TO_DST=260]="HOP_NO_CONN_TO_DST",a[a.HOP_CANT_DIAL_DST=261]="HOP_CANT_DIAL_DST",a[a.HOP_CANT_OPEN_DST_STREAM=262]="HOP_CANT_OPEN_DST_STREAM",a[a.HOP_CANT_SPEAK_RELAY=270]="HOP_CANT_SPEAK_RELAY",a[a.HOP_CANT_RELAY_TO_SELF=280]="HOP_CANT_RELAY_TO_SELF",a[a.STOP_SRC_ADDR_TOO_LONG=320]="STOP_SRC_ADDR_TOO_LONG",a[a.STOP_DST_ADDR_TOO_LONG=321]="STOP_DST_ADDR_TOO_LONG",a[a.STOP_SRC_MULTIADDR_INVALID=350]="STOP_SRC_MULTIADDR_INVALID",a[a.STOP_DST_MULTIADDR_INVALID=351]="STOP_DST_MULTIADDR_INVALID",a[a.STOP_RELAY_REFUSED=390]="STOP_RELAY_REFUSED",a[a.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE"}(t||(t={})),function(a){a.codec=()=>Cc(t)}(e=r.Status||(r.Status={})),function(a){a.HOP="HOP",a.STOP="STOP",a.STATUS="STATUS",a.CAN_HOP="CAN_HOP"}(n=r.Type||(r.Type={})),function(a){a[a.HOP=1]="HOP",a[a.STOP=2]="STOP",a[a.STATUS=3]="STATUS",a[a.CAN_HOP=4]="CAN_HOP"}(s||(s={})),function(a){a.codec=()=>Cc(s)}(n=r.Type||(r.Type={})),function(a){let c;a.codec=()=>(null==c&&(c=Rr((u,f,E={})=>{if(!1!==E.lengthDelimited&&f.fork(),(!0===E.writeDefaults||null!=u.id&&u.id.byteLength>0)&&(f.uint32(10),f.bytes(u.id)),null!=u.addrs)for(const T of u.addrs)f.uint32(18),f.bytes(T);!1!==E.lengthDelimited&&f.ldelim()},(u,f)=>{const E={id:new Uint8Array(0),addrs:[]},T=null==f?u.len:u.pos+f;for(;u.pos<T;){const U=u.uint32();switch(U>>>3){case 1:E.id=u.bytes();break;case 2:E.addrs.push(u.bytes());break;default:u.skipType(7&U)}}return E})),c),a.encode=u=>Ir(u,a.codec()),a.decode=u=>Cr(u,a.codec())}(i=r.Peer||(r.Peer={})),r.codec=()=>(null==o&&(o=Rr((a,c,u={})=>{!1!==u.lengthDelimited&&c.fork(),null!=a.type&&(c.uint32(8),r.Type.codec().encode(a.type,c)),null!=a.srcPeer&&(c.uint32(18),r.Peer.codec().encode(a.srcPeer,c,{writeDefaults:!1})),null!=a.dstPeer&&(c.uint32(26),r.Peer.codec().encode(a.dstPeer,c,{writeDefaults:!1})),null!=a.code&&(c.uint32(32),r.Status.codec().encode(a.code,c)),!1!==u.lengthDelimited&&c.ldelim()},(a,c)=>{const u={},f=null==c?a.len:a.pos+c;for(;a.pos<f;){const E=a.uint32();switch(E>>>3){case 1:u.type=r.Type.codec().decode(a);break;case 2:u.srcPeer=r.Peer.codec().decode(a,a.uint32());break;case 3:u.dstPeer=r.Peer.codec().decode(a,a.uint32());break;case 4:u.code=r.Status.codec().decode(a);break;default:a.skipType(7&E)}}return u})),o),r.encode=a=>Ir(a,r.codec()),r.decode=a=>Cr(a,r.codec())}(Et||(Et={}));const BFe=Be("libp2p:stream:converter");function rj(r,e={}){const{stream:t,remoteAddr:n}=r,{sink:s,source:i}=t,o=Ee(function*(){var T,f=!1,E=!1;try{for(var b,U=be(i);f=!(b=yield X(U.next())).done;f=!1){const P=b.value;yield*Fe(be(P),X)}}catch(P){E=!0,T=P}finally{try{f&&null!=U.return&&(yield X(U.return()))}finally{if(E)throw T}}})(),a={sink:f=>(0,B.Z)(function*(){null!=e.signal&&(f=Ms(f,e.signal));try{yield s(f),yield c()}catch(E){"aborted"!==E.type&&BFe(E)}})(),source:null!=e.signal?Ms(o,e.signal):o,remoteAddr:n,timeline:{open:Date.now(),close:void 0},close:()=>(0,B.Z)(function*(){yield s(Ee(function*(){yield new Uint8Array(0)})()),yield c()})()};function c(){return u.apply(this,arguments)}function u(){return(u=(0,B.Z)(function*(){return null==a.timeline.close&&(a.timeline.close=Date.now()),yield Promise.resolve()})).apply(this,arguments)}return a}const Iu="/libp2p/circuit/relay/0.1.0";function nj(r,e){r.write({type:Et.Type.STATUS,code:e})}function sj(r,e){try{var t;null!=(null===(t=r.dstPeer)||void 0===t?void 0:t.addrs)&&r.dstPeer.addrs.forEach(s=>at(s))}catch(s){throw nj(e,r.type===Et.Type.HOP?Et.Status.HOP_DST_MULTIADDR_INVALID:Et.Status.STOP_DST_MULTIADDR_INVALID),s}try{var n;null!=(null===(n=r.srcPeer)||void 0===n?void 0:n.addrs)&&r.srcPeer.addrs.forEach(s=>at(s))}catch(s){throw nj(e,r.type===Et.Type.HOP?Et.Status.HOP_SRC_MULTIADDR_INVALID:Et.Status.STOP_SRC_MULTIADDR_INVALID),s}}function X2(r){const e=ss(),t=function y3e(r){const e=Ee(function*(){let t=yield,n=new Or;var o,s=!1,i=!1;try{for(var c,a=be(r);s=!(c=yield X(a.next())).done;s=!1){const u=c.value;if(null!=t)for(n.append(u);n.length>=t;){const f=n.sublist(0,t);if(n.consume(t),t=yield f,null==t){n.length>0&&(t=yield n,n=new Or);break}}else n.append(u),t=yield n,n=new Or}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}if(null!=t)throw Object.assign(new Error(`stream ended before ${t} bytes became available`),{code:"ERR_UNDER_READ",buffer:n})})();return e.next(),e}(r.source),n=en();let s;const i=r.sink(Ee(function*(){yield*Fe(be(e),X);const a=yield X(n.promise);yield*Fe(be(a),X)})());i.catch(a=>{s=a});const o={sink:(a=(0,B.Z)(function*(c){return null!=s?yield Promise.reject(s):(n.resolve(c),yield i)}),function(u){return a.apply(this,arguments)}),source:t};var a;return{reader:t,writer:e,stream:o,rest:()=>e.end(),write:e.push,read:function(){var a=(0,B.Z)(function*(){const c=yield t.next();if(null!=c.value)return c.value});return function(){return a.apply(this,arguments)}}()}}const n0=Be("libp2p:circuit:stream-handler");class q2{constructor(e){const{stream:t,maxLength:n=4096}=e;this.stream=t,this.shake=X2(this.stream),this.decoder=Fs.fromReader(this.shake.reader,{maxDataLength:n})}read(){var e=this;return(0,B.Z)(function*(){const t=yield e.decoder.next();if(null!=t.value){const n=Et.decode(t.value);return n0("read message type",n.type),n}n0("read received no value, closing stream"),e.close()})()}write(e){n0("write message type %s",e.type),this.shake.write(ei.single(Et.encode(e)))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){n0("closing the stream"),this.rest().sink([]).catch(e=>{n0.error(e)})}}const s0=Be("libp2p:circuit:stop");function UFe(r){return Yx.apply(this,arguments)}function Yx(){return Yx=(0,B.Z)(function*(r){const{connection:e,request:t,signal:n}=r,s=yield e.newStream(Iu,{signal:n});s0("starting stop request to %p",e.remotePeer);const i=new q2({stream:s});i.write(t);const o=yield i.read();if(null!=o)return o.code===Et.Status.SUCCESS?(s0("stop request to %p was successful",e.remotePeer),i.rest()):(s0("stop request failed with code %d",o.code),void i.close());i.close()}),Yx.apply(this,arguments)}const pi=Be("libp2p:circuit:hop");function Qx(){return Qx=(0,B.Z)(function*(r){const{connection:e,request:t,streamHandler:n,circuit:s,connectionManager:i}=r;if(!s.hopEnabled())return pi("HOP request received but we are not acting as a relay"),n.end({type:Et.Type.STATUS,code:Et.Status.HOP_CANT_SPEAK_RELAY});try{sj(t,n)}catch(E){return void pi.error("invalid hop request via peer %p %o",e.remotePeer,E)}if(null==t.dstPeer)return void pi("HOP request received but we do not receive a dstPeer");const o=Ai(t.dstPeer.id),a=i.getConnections(o);if(0===a.length&&!s.hopActive())return pi("HOP request received but we are not connected to the destination peer"),n.end({type:Et.Type.STATUS,code:Et.Status.HOP_NO_CONN_TO_DST});if(0===a.length)return pi("did not have connection to remote peer"),n.end({type:Et.Type.STATUS,code:Et.Status.HOP_NO_CONN_TO_DST});const c={type:Et.Type.STOP,dstPeer:t.dstPeer,srcPeer:t.srcPeer};let u;try{pi("performing STOP request");const E=yield UFe({connection:a[0],request:c});if(null==E)throw new Error("Could not stop");u=E}catch(E){return void pi.error(E)}pi("hop request from %p is valid",e.remotePeer),n.write({type:Et.Type.STATUS,code:Et.Status.SUCCESS});const f=n.rest();return pi("creating related connections"),yield _t(f,u,f)}),Qx.apply(this,arguments)}function Jx(){return Jx=(0,B.Z)(function*(r){var e;const{connection:t,request:n,signal:s}=r,i=yield t.newStream(Iu,{signal:s}),o=new q2({stream:i});o.write(n);const a=yield o.read();if(null==a)throw ee(new Error("HOP request had no response"),Ie.ERR_HOP_REQUEST_FAILED);if(a.code===Et.Status.SUCCESS)return pi("hop request was successful"),o.rest();throw pi("hop request failed with code %d, closing stream",a.code),o.close(),ee(new Error(`HOP request failed with code "${null!==(e=a.code)&&void 0!==e?e:"unknown"}"`),Ie.ERR_HOP_REQUEST_FAILED)}),Jx.apply(this,arguments)}function Xx(){return Xx=(0,B.Z)(function*(r){const{connection:e,signal:t}=r,n=yield e.newStream(Iu,{signal:t}),s=new q2({stream:n});s.write({type:Et.Type.CAN_HOP});const i=yield s.read();return yield s.close(),!(null==i||i.code!==Et.Status.SUCCESS)}),Xx.apply(this,arguments)}const yi=Be("libp2p:circuit");class jFe{constructor(e,t){this._init=t,this.components=e,this._started=!1}isStarted(){return this._started}start(){var e=this;return(0,B.Z)(function*(){e._started||(e._started=!0,yield e.components.registrar.handle(Iu,t=>{e._onProtocol(t).catch(n=>{yi.error(n)})}).catch(t=>{yi.error(t)}))})()}stop(){var e=this;return(0,B.Z)(function*(){yield e.components.registrar.unhandle(Iu)})()}hopEnabled(){return!0}hopActive(){return!0}get[Y2](){return!0}get[Symbol.toStringTag](){return"libp2p/circuit-relay-v1"}_onProtocol(e){var t=this;return(0,B.Z)(function*(){const{connection:n,stream:s}=e,i=new Ar.TimeoutController(t._init.hop.timeout);try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,i.signal)}catch{}try{const c=oo(s,i.signal),u=new q2({stream:{...s,...c}}),f=yield u.read();if(null==f)return yi("request was invalid, could not read from stream"),u.write({type:Et.Type.STATUS,code:Et.Status.MALFORMED_MESSAGE}),void u.close();let E;switch(f.type){case Et.Type.CAN_HOP:yi("received CAN_HOP request from %p",n.remotePeer),yield function VFe(r){const{connection:e,streamHandler:t,circuit:n}=r,s=n.hopEnabled();pi("can hop (%s) request from %p",s,e.remotePeer),t.end({type:Et.Type.STATUS,code:s?Et.Status.SUCCESS:Et.Status.HOP_CANT_SPEAK_RELAY})}({circuit:t,connection:n,streamHandler:u});break;case Et.Type.HOP:yi("received HOP request from %p",n.remotePeer),yield function MFe(r){return Qx.apply(this,arguments)}({connection:n,request:f,streamHandler:u,circuit:t,connectionManager:t.components.connectionManager});break;case Et.Type.STOP:yi("received STOP request from %p",n.remotePeer),E=yield function kFe(r){const{connection:e,request:t,streamHandler:n}=r;try{sj(t,n)}catch(s){return void s0.error("invalid stop request via peer %p %o",e.remotePeer,s)}return s0("stop request is valid"),n.write({type:Et.Type.STATUS,code:Et.Status.SUCCESS}),n.rest()}({connection:n,request:f,streamHandler:u});break;default:return yi("Request of type %s not supported",f.type),u.write({type:Et.Type.STATUS,code:Et.Status.MALFORMED_MESSAGE}),void u.close()}if(null!=E){var o,a;const b=rj({stream:E,remoteAddr:n.remoteAddr.encapsulate("/p2p-circuit").encapsulate(at(null===(o=f.dstPeer)||void 0===o?void 0:o.addrs[0])),localAddr:at(null===(a=f.srcPeer)||void 0===a?void 0:a.addrs[0])}),P=f.type===Et.Type.HOP?"relay":"inbound";yi("new %s connection %s",P,b.remoteAddr);const F=yield t.components.upgrader.upgradeInbound(b);yi("%s connection %s upgraded",P,b.remoteAddr),null!=t.handler&&t.handler(F)}}finally{i.clear()}})()}dial(e,t={}){var n=this;return(0,B.Z)(function*(){const s=e.toString().split("/p2p-circuit"),i=at(s[0]),o=at(s[s.length-1]),a=i.getPeerId(),c=o.getPeerId();if(null==a||null==c){const b="Circuit relay dial failed as addresses did not have peer id";throw yi.error(b),ee(new Error(b),Ie.ERR_RELAYED_DIAL)}const u=bt(a),f=bt(c);let E=!1,U=n.components.connectionManager.getConnections(u)[0];null==U&&(yield n.components.peerStore.addressBook.add(u,[i]),U=yield n.components.connectionManager.openConnection(u,t),E=!0);try{const b=yield function FFe(r){return Jx.apply(this,arguments)}({...t,connection:U,request:{type:Et.Type.HOP,srcPeer:{id:n.components.peerId.toBytes(),addrs:n.components.addressManager.getAddresses().map(M=>M.bytes)},dstPeer:{id:f.toBytes(),addrs:[at(o).bytes]}}}),P=i.encapsulate(`/p2p-circuit/p2p/${n.components.peerId.toString()}`),F=rj({stream:b,remoteAddr:e,localAddr:P});return yi("new outbound connection %s",F.remoteAddr),yield n.components.upgrader.upgradeOutbound(F)}catch(b){throw yi.error("Circuit relay dial failed",b),E&&(yield U.close()),b}})()}createListener(e){return this.handler=e.handler,function LFe(r){const e=new Map;function n(){return(n=(0,B.Z)(function*(o){const c=at(o.toString().split("/p2p-circuit").find(U=>""!==U)),u=c.getPeerId();if(null==u)throw new Error("Could not determine relay peer from multiaddr");const f=bt(u);yield r.peerStore.addressBook.add(f,[c]);const E=yield r.connectionManager.openConnection(f),T=E.remoteAddr.encapsulate("/p2p-circuit");e.set(E.remotePeer.toString(),T),i.dispatchEvent(new Qe("listening"))})).apply(this,arguments)}const i=Object.assign(new wr,{close:(o=(0,B.Z)(function*(){return yield Promise.resolve()}),function(){return o.apply(this,arguments)}),listen:function t(o){return n.apply(this,arguments)},getAddrs:function s(){const o=[];for(const a of e.values())o.push(a);return o}});var o;return r.connectionManager.addEventListener("peer:disconnect",o=>{const{detail:a}=o;e.delete(a.remotePeer.toString())&&i.dispatchEvent(new Qe("close"))}),i}({connectionManager:this.components.connectionManager,peerStore:this.components.peerStore})}filter(e){return(e=Array.isArray(e)?e:[e]).filter(t=>Tl.matches(t))}}const HFe=function $Fe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},Ru=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class JFe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class XFe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return ij(this,e)}}class qFe{constructor(e){this.decoders=e}or(e){return ij(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ij=(r,e)=>new qFe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class eze{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new JFe(e,t,n),this.decoder=new XFe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const eg=({name:r,prefix:e,encode:t,decode:n})=>new eze(r,e,t,n),i0=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=HFe(t,e);return eg({prefix:r,name:e,encode:n,decode:i=>Ru(s(i))})},jn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>eg({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),nze=eg({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),sze=jn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ize=jn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),oze=i0({prefix:"9",name:"base10",alphabet:"0123456789"}),aze=jn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),cze=jn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),o0=jn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),lze=jn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),uze=jn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),dze=jn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),fze=jn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hze=jn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),pze=jn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),yze=jn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),gze=jn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),bze=i0({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),_ze=i0({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Xo=i0({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),mze=i0({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),vze=jn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),wze=jn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Eze=jn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),xze=jn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),oj=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),Sze=oj.reduce((r,e,t)=>(r[t]=e,r),[]),Aze=oj.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),Ize=eg({prefix:"\u{1f680}",name:"base256emoji",encode:function Tze(r){return r.reduce((e,t)=>e+Sze[t],"")},decode:function Cze(r){const e=[];for(const t of r){const n=Aze[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var Pze=Math.pow(2,31),Lze=Math.pow(2,7),kze=Math.pow(2,14),Uze=Math.pow(2,21),Mze=Math.pow(2,28),Fze=Math.pow(2,35),zze=Math.pow(2,42),Vze=Math.pow(2,49),jze=Math.pow(2,56),$ze=Math.pow(2,63),Zze={encode:function cj(r,e,t){e=e||[];for(var n=t=t||0;r>=Pze;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,cj.bytes=t-n+1,e},decode:function qx(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw qx.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return qx.bytes=i-n,t},encodingLength:function(r){return r<Lze?1:r<kze?2:r<Uze?3:r<Mze?4:r<Fze?5:r<zze?6:r<Vze?7:r<jze?8:r<$ze?9:10}};const tg=Zze,eS=(r,e=0)=>[tg.decode(r,e),tg.decode.bytes],rg=(r,e,t=0)=>(tg.encode(r,e,t),e),ng=r=>tg.encodingLength(r),sg=(r,e)=>{const t=e.byteLength,n=ng(r),s=n+ng(t),i=new Uint8Array(s+t);return rg(r,i,0),rg(t,i,n),i.set(e,s),new tS(r,t,e,i)};class tS{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const uj=({name:r,code:e,encode:t})=>new Yze(r,e,t);class Yze{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?sg(this.code,t):t.then(n=>sg(this.code,n))}throw Error("Unknown type, must be binary type")}}const dj=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),fj=uj({name:"sha2-256",code:18,encode:dj("SHA-256")}),Qze=uj({name:"sha2-512",code:19,encode:dj("SHA-512")}),pj=Ru,Xze={code:0,name:"identity",encode:pj,digest:r=>sg(0,pj(r))},qze="raw",eVe=85,tVe=r=>Ru(r),rVe=r=>Ru(r),nVe=new TextEncoder,sVe=new TextDecoder,iVe="json",oVe=512,aVe=r=>nVe.encode(JSON.stringify(r)),cVe=r=>JSON.parse(sVe.decode(r)),yj=new WeakMap,rS=r=>{const e=yj.get(r);if(null==e){const t=new Map;return yj.set(r,t),t}return e};class $n{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==a0)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==hVe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return $n.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=sg(e,t);return $n.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return $n.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?dVe(t,rS(r),e||Xo.encoder):fVe(t,rS(r),e||o0.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof $n)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new $n(n,s,i,o||gj(n,s,i.bytes))}if(!0===t[pVe]){const{version:n,multihash:s,code:i}=t,o=(r=>{const e=Ru(r),[t,n]=eS(e),[s,i]=eS(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new tS(t,s,o,e)})(s);return $n.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==a0)throw new Error(`Version 0 CID must use dag-pb (code: ${a0}) block encoding`);return new $n(e,t,n,n.bytes);case 1:{const s=gj(e,t,n.bytes);return new $n(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return $n.create(0,a0,e)}static createV1(e,t){return $n.create(1,e,t)}static decode(e){const[t,n]=$n.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=$n.inspectBytes(e),n=t.size-t.multihashSize,s=Ru(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new tS(t.multihashCode,t.digestSize,i,s);return[0===t.version?$n.createV0(o):$n.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=eS(e.subarray(t));return t+=T,E};let s=n(),i=a0;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=uVe(e,t),i=$n.decode(s);return rS(i).set(n,e),i}}const uVe=(r,e)=>{switch(r[0]){case"Q":return[Xo.prefix,(e||Xo).decode(`${Xo.prefix}${r}`)];case Xo.prefix:return[Xo.prefix,(e||Xo).decode(r)];case o0.prefix:return[o0.prefix,(e||o0).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},dVe=(r,e,t)=>{const{prefix:n}=t;if(n!==Xo.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},fVe=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},a0=112,hVe=18,gj=(r,e,t)=>{const n=ng(r),s=n+ng(e),i=new Uint8Array(s+t.byteLength);return rg(r,i,0),rg(e,i,n),i.set(t,s),i},pVe=Symbol.for("@ipld/js-cid/CID"),bj={..._m,...mm,...vm,...wm,...Em,...xm,...Sm,...Am,...Tm,...Cm};function nS(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function _j(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?nS(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function mj(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const vj=mj("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),sS=mj("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=_j((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),wj={utf8:vj,"utf-8":vj,hex:bj.base16,latin1:sS,ascii:sS,binary:sS,...bj};function rn(r,e="utf8"){const t=wj[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):nS(globalThis.Buffer.from(r,"utf-8"))}function qo(r,e="utf8"){const t=wj[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}function Ej(r){return iS.apply(this,arguments)}function iS(){return iS=(0,B.Z)(function*(r){const e=(new TextEncoder).encode(r),t=yield fj.digest(e);return $n.createV0(t)}),iS.apply(this,arguments)}const Sj="hop_relay",Tj="/libp2p/relay";var ig=p(7617);function Cj(r){const{address:e}=r.nodeAddress();return Boolean(ig(e))}function oS(r,e){const t=Cj(r.multiaddr),n=Cj(e.multiaddr);return t&&!n?1:!t&&n||r.isCertified&&!e.isCertified?-1:!r.isCertified&&e.isCertified?1:0}const c0=Be("libp2p:auto-relay"),_Ve=()=>{};class mVe{constructor(e,t){var n,s,i;this.components=e,this.addressSorter=null!==(n=t.addressSorter)&&void 0!==n?n:oS,this.maxListeners=null!==(s=t.maxListeners)&&void 0!==s?s:1,this.listenRelays=new Set,this.onError=null!==(i=t.onError)&&void 0!==i?i:_Ve,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this.components.peerStore.addEventListener("change:protocols",o=>{this._onProtocolChange(o).catch(a=>{c0.error(a)})}),this.components.connectionManager.addEventListener("peer:disconnect",this._onPeerDisconnected)}_onProtocolChange(e){var t=this;return(0,B.Z)(function*(){const{peerId:n,protocols:s}=e.detail,i=n.toString();if(null!=s.find(a=>a===Iu)){if(!t.listenRelays.has(i))try{const a=t.components.connectionManager.getConnections(n);if(0===a.length)return;const c=a[0];if(c.remoteAddr.protoCodes().includes(290))return void c0(`relayed connection to ${i} will not be used to hop on`);(yield function zFe(r){return Xx.apply(this,arguments)}({connection:c}))&&(yield t.components.peerStore.metadataBook.setValue(n,Sj,rn("true")),yield t._addListenRelay(c,i))}catch(a){t.onError(a)}}else t.listenRelays.has(i)&&(yield t._removeListenRelay(i))})()}_onPeerDisconnected(e){const s=e.detail.remotePeer.toString();!this.listenRelays.has(s)||this._removeListenRelay(s).catch(i=>{c0.error(i)})}_addListenRelay(e,t){var n=this;return(0,B.Z)(function*(){try{if(n.listenRelays.size>=n.maxListeners)return;const s=yield _t(yield n.components.peerStore.addressBook.get(e.remotePeer),o=>Fh(o,n.addressSorter),function(){var o=(0,B.Z)(function*(a){return yield Bc(a)});return function(a){return o.apply(this,arguments)}}());(yield Promise.all(s.map(function(){var o=(0,B.Z)(function*(a){try{let c=a.multiaddr;return null==c.getPeerId()&&(c=c.encapsulate(`/p2p/${e.remotePeer.toString()}`)),c=c.encapsulate("/p2p-circuit"),yield n.components.transportManager.listen([c]),!0}catch(c){c0.error("error listening on circuit address",c),n.onError(c)}return!1});return function(a){return o.apply(this,arguments)}}()))).includes(!0)&&n.listenRelays.add(t)}catch(s){n.onError(s),n.listenRelays.delete(t)}})()}_removeListenRelay(e){var t=this;return(0,B.Z)(function*(){t.listenRelays.delete(e)&&(yield t._listenOnAvailableHopRelays([e]))})()}_listenOnAvailableHopRelays(e=[]){var t=this;return(0,B.Z)(function*(){if(t.listenRelays.size>=t.maxListeners)return;const n=[],s=yield t.components.peerStore.all();for(const{id:f,metadata:E}of s){const T=f.toString();if(t.listenRelays.has(T)||e.includes(T))continue;const U=E.get(Sj);if(null==U||"true"!==qo(U))continue;const b=t.components.connectionManager.getConnections(f);if(0!==b.length){if(yield t._addListenRelay(b[0],T),t.listenRelays.size>=t.maxListeners)return}else n.push(f)}for(const f of n)if(yield t._tryToListenOnRelay(f),t.listenRelays.size>=t.maxListeners)return;try{const f=yield Ej(Tj);var a,i=!1,o=!1;try{for(var u,c=be(t.components.contentRouting.findProviders(f));i=!(u=yield c.next()).done;i=!1){const E=u.value;if(0===E.multiaddrs.length)continue;const T=E.id;if(!T.equals(t.components.peerId)&&(yield t.components.peerStore.addressBook.add(T,E.multiaddrs),yield t._tryToListenOnRelay(T),t.listenRelays.size>=t.maxListeners))return}}catch(E){o=!0,a=E}finally{try{i&&null!=c.return&&(yield c.return())}finally{if(o)throw a}}}catch(f){t.onError(f)}})()}_tryToListenOnRelay(e){var t=this;return(0,B.Z)(function*(){try{const n=yield t.components.connectionManager.openConnection(e);yield t._addListenRelay(n,e.toString())}catch(n){c0.error("Could not use %p as relay",e,n),t.onError(n,`could not connect and listen on known hop relay ${e.toString()}`)}})()}}const Ij=Be("libp2p:relay");class vVe{constructor(e,t){var n;this.components=e,this.autoRelay=!1!==(null===(n=t.autoRelay)||void 0===n?void 0:n.enabled)?new mVe(e,{addressSorter:t.addressSorter,...t.autoRelay}):void 0,this.started=!1,this.init=t,this._advertiseService=this._advertiseService.bind(this)}isStarted(){return this.started}start(){var e=this;return(0,B.Z)(function*(){!1!==e.init.hop.enabled&&!1!==e.init.advertise.enabled&&(e.timeout=(0,Q2.setDelayedInterval)(e._advertiseService,e.init.advertise.ttl,e.init.advertise.bootDelay)),e.started=!0})()}stop(){var e=this;return(0,B.Z)(function*(){null!=e.timeout&&(0,Q2.clearDelayedInterval)(e.timeout),e.started=!1})()}_advertiseService(){var e=this;return(0,B.Z)(function*(){try{const t=yield Ej(Tj);yield e.components.contentRouting.provide(t)}catch(t){t.code===Ie.ERR_NO_ROUTERS_AVAILABLE?(Ij.error("a content router, such as a DHT, must be provided in order to advertise the relay service",t),yield e.stop()):Ij.error(t)}})()}}var wVe=p(50522);p(12998),p(85466);const Rj=tr.pki;function aS(){return aS=(0,B.Z)(function*(r,e){const t=r.map(e);return r[(yield Promise.all(t)).findIndex(i=>i)]}),aS.apply(this,arguments)}const SVe=Be("libp2p:keychain:cms"),cS=new WeakMap;class AVe{constructor(e,t){if(null==e)throw ee(new Error("keychain is required"),Ie.ERR_KEYCHAIN_REQUIRED);this.keychain=e,cS.set(this,{dek:t})}encrypt(e,t){var n=this;return(0,B.Z)(function*(){if(!(t instanceof Uint8Array))throw ee(new Error("Plain data must be a Uint8Array"),Ie.ERR_INVALID_PARAMETERS);const s=yield n.keychain.findKeyByName(e),i=yield n.keychain.getPrivateKey(e),o=cS.get(n);if(null==o)throw ee(new Error("dek missing"),Ie.ERR_INVALID_PARAMETERS);const c=tr.pki.decryptRsaPrivateKey(i,o.dek),u=yield((r,e)=>{const t=Rj.rsa.setPublicKey(e.n,e.e),n=Rj.createCertificate();n.publicKey=t,n.serialNumber="01",n.validity.notBefore=new Date,n.validity.notAfter=new Date,n.validity.notAfter.setFullYear(n.validity.notBefore.getFullYear()+10);const s=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:r.id}];return n.setSubject(s),n.setIssuer(s),n.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),n.sign(e),n})(s,c),f=tr.pkcs7.createEnvelopedData();return f.addRecipient(u),f.content=tr.util.createBuffer(t),f.encrypt(),rn(tr.asn1.toDer(f.toAsn1()).getBytes(),"ascii")})()}decrypt(e){var t=this;return(0,B.Z)(function*(){if(!(e instanceof Uint8Array))throw ee(new Error("CMS data is required"),Ie.ERR_INVALID_PARAMETERS);let n;try{const E=tr.util.createBuffer(qo(e,"ascii")),T=tr.asn1.fromDer(E);n=tr.pkcs7.messageFromAsn1(T)}catch(E){throw SVe.error(E),ee(new Error("Invalid CMS"),Ie.ERR_INVALID_CMS)}const s=n.recipients.filter(E=>E.issuer.find(T=>"O"===T.shortName&&"ipfs"===T.value)).filter(E=>E.issuer.find(T=>"CN"===T.shortName)).map(E=>({recipient:E,keyId:E.issuer.find(T=>"CN"===T.shortName).value})),i=yield function xVe(r,e){return aS.apply(this,arguments)}(s,function(){var E=(0,B.Z)(function*(T){try{if(null!=(yield t.keychain.findKeyById(T.keyId)))return!0}catch{return!1}return!1});return function(T){return E.apply(this,arguments)}}());if(null==i){const E=s.map(T=>T.keyId);throw ee(new Error(`Decryption needs one of the key(s): ${E.join(", ")}`),Ie.ERR_MISSING_KEYS,{missingKeys:E})}const o=yield t.keychain.findKeyById(i.keyId);if(null==o)throw ee(new Error("No key available to decrypto"),Ie.ERR_NO_KEY);const a=yield t.keychain.getPrivateKey(o.name),c=cS.get(t);if(null==c)throw ee(new Error("dek missing"),Ie.ERR_INVALID_PARAMETERS);const f=tr.pki.decryptRsaPrivateKey(a,c.dek);return n.decrypt(i.recipient,f),rn(n.content.getBytes(),"ascii")})()}}const og=Be("libp2p:keychain"),oc=new WeakMap,lS={dek:{keyLength:64,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function ea(r){return null!=r&&"string"==typeof r&&r===wVe(r.trim())&&r.length>0}function Qt(){return uS.apply(this,arguments)}function uS(){return(uS=(0,B.Z)(function*(){const t=800*Math.random()+200;yield new Promise(n=>setTimeout(n,t))})).apply(this,arguments)}function fo(r){return new ft("/pkcs8/"+r)}function ta(r){return new ft("/info/"+r)}class Oj{constructor(e,t){var n,s,i,o,a,c,u,f,E,T;if(this.components=e,this.init=Sr(lS,t),null!=this.init.pass&&(null===(n=this.init.pass)||void 0===n?void 0:n.length)<20)throw new Error("pass must be least 20 characters");if(null!=(null===(s=this.init.dek)||void 0===s?void 0:s.keyLength)&&this.init.dek.keyLength<14)throw new Error("dek.keyLength must be least 14 bytes");if(null!=(null===(i=this.init.dek)||void 0===i||null===(o=i.salt)||void 0===o?void 0:o.length)&&this.init.dek.salt.length<16)throw new Error("dek.saltLength must be least 16 bytes");if(null!=(null===(a=this.init.dek)||void 0===a?void 0:a.iterationCount)&&this.init.dek.iterationCount<1e3)throw new Error("dek.iterationCount must be least 1000");const U=null!=this.init.pass&&null!=(null===(c=this.init.dek)||void 0===c?void 0:c.salt)?BF(this.init.pass,null===(u=this.init.dek)||void 0===u?void 0:u.salt,null===(f=this.init.dek)||void 0===f?void 0:f.iterationCount,null===(E=this.init.dek)||void 0===E?void 0:E.keyLength,null===(T=this.init.dek)||void 0===T?void 0:T.hash):"";oc.set(this,{dek:U}),this.started=!1}isStarted(){return this.started}start(){var e=this;return(0,B.Z)(function*(){const t=ta("self");(yield e.components.datastore.has(t))||(yield e.importPeer("self",e.components.peerId)),e.started=!0})()}stop(){this.started=!1}get cms(){const e=oc.get(this);if(null==e)throw ee(new Error("dek missing"),Ie.ERR_INVALID_PARAMETERS);return new AVe(this,e.dek)}static generateOptions(){const e=Object.assign({},lS),t=3*Math.ceil(16/3);return e.dek.salt=qo(Rf(t),"base64"),e}static get options(){return lS}createKey(e,t,n=2048){var s=this;return(0,B.Z)(function*(){if(!ea(e)||"self"===e)throw yield Qt(),ee(new Error("Invalid key name"),Ie.ERR_INVALID_KEY_NAME);if("string"!=typeof t)throw yield Qt(),ee(new Error("Invalid key type"),Ie.ERR_INVALID_KEY_TYPE);const i=fo(e);if(yield s.components.datastore.has(i))throw yield Qt(),ee(new Error("Key name already exists"),Ie.ERR_KEY_ALREADY_EXISTS);if("rsa"===t.toLowerCase()&&(!Number.isSafeInteger(n)||n<2048))throw yield Qt(),ee(new Error("Invalid RSA key size"),Ie.ERR_INVALID_KEY_SIZE);let a;try{const c=yield N8(t,n),u=yield c.id(),f=oc.get(s);if(null==f)throw ee(new Error("dek missing"),Ie.ERR_INVALID_PARAMETERS);const E=f.dek,T=yield c.export(E);a={name:e,id:u};const U=s.components.datastore.batch();U.put(i,rn(T)),U.put(ta(e),rn(JSON.stringify(a))),yield U.commit()}catch(c){throw yield Qt(),c}return a})()}listKeys(){var e=this;return(0,B.Z)(function*(){const t={prefix:"/info/"},n=[];var o,s=!1,i=!1;try{for(var c,a=be(e.components.datastore.query(t));s=!(c=yield a.next()).done;s=!1)n.push(JSON.parse(qo(c.value.value)))}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield a.return())}finally{if(i)throw o}}return n})()}findKeyById(e){var t=this;return(0,B.Z)(function*(){try{return(yield t.listKeys()).find(s=>s.id===e)}catch(n){throw yield Qt(),n}})()}findKeyByName(e){var t=this;return(0,B.Z)(function*(){if(!ea(e))throw yield Qt(),ee(new Error(`Invalid key name '${e}'`),Ie.ERR_INVALID_KEY_NAME);const n=ta(e);try{const s=yield t.components.datastore.get(n);return JSON.parse(qo(s))}catch(s){throw yield Qt(),og.error(s),ee(new Error(`Key '${e}' does not exist.`),Ie.ERR_KEY_NOT_FOUND)}})()}removeKey(e){var t=this;return(0,B.Z)(function*(){if(!ea(e)||"self"===e)throw yield Qt(),ee(new Error(`Invalid key name '${e}'`),Ie.ERR_INVALID_KEY_NAME);const n=fo(e),s=yield t.findKeyByName(e),i=t.components.datastore.batch();return i.delete(n),i.delete(ta(e)),yield i.commit(),s})()}renameKey(e,t){var n=this;return(0,B.Z)(function*(){if(!ea(e)||"self"===e)throw yield Qt(),ee(new Error(`Invalid old key name '${e}'`),Ie.ERR_OLD_KEY_NAME_INVALID);if(!ea(t)||"self"===t)throw yield Qt(),ee(new Error(`Invalid new key name '${t}'`),Ie.ERR_NEW_KEY_NAME_INVALID);const s=fo(e),i=fo(t),o=ta(e),a=ta(t);if(yield n.components.datastore.has(i))throw yield Qt(),ee(new Error(`Key '${t}' already exists`),Ie.ERR_KEY_ALREADY_EXISTS);try{const u=yield n.components.datastore.get(s),f=yield n.components.datastore.get(o),E=JSON.parse(qo(f));E.name=t;const T=n.components.datastore.batch();return T.put(i,u),T.put(a,rn(JSON.stringify(E))),T.delete(s),T.delete(o),yield T.commit(),E}catch(u){throw yield Qt(),u}})()}exportKey(e,t){var n=this;return(0,B.Z)(function*(){if(!ea(e))throw yield Qt(),ee(new Error(`Invalid key name '${e}'`),Ie.ERR_INVALID_KEY_NAME);if(null==t)throw yield Qt(),ee(new Error("Password is required"),Ie.ERR_PASSWORD_REQUIRED);const s=fo(e);try{const o=qo(yield n.components.datastore.get(s)),a=oc.get(n);if(null==a)throw ee(new Error("dek missing"),Ie.ERR_INVALID_PARAMETERS);const c=a.dek;return yield(yield kf(o,c)).export(t)}catch(i){throw yield Qt(),i}})()}importKey(e,t,n){var s=this;return(0,B.Z)(function*(){if(!ea(e)||"self"===e)throw yield Qt(),ee(new Error(`Invalid key name '${e}'`),Ie.ERR_INVALID_KEY_NAME);if(null==t)throw yield Qt(),ee(new Error("PEM encoded key is required"),Ie.ERR_PEM_REQUIRED);const i=fo(e);if(yield s.components.datastore.has(i))throw yield Qt(),ee(new Error(`Key '${e}' already exists`),Ie.ERR_KEY_ALREADY_EXISTS);let a,c;try{a=yield kf(t,n)}catch{throw yield Qt(),ee(new Error("Cannot read the key, most likely the password is wrong"),Ie.ERR_CANNOT_READ_KEY)}try{c=yield a.id();const E=oc.get(s);if(null==E)throw ee(new Error("dek missing"),Ie.ERR_INVALID_PARAMETERS);const T=E.dek;t=yield a.export(T)}catch(E){throw yield Qt(),E}const u={name:e,id:c},f=s.components.datastore.batch();return f.put(i,rn(t)),f.put(ta(e),rn(JSON.stringify(u))),yield f.commit(),u})()}importPeer(e,t){var n=this;return(0,B.Z)(function*(){try{if(!ea(e))throw ee(new Error(`Invalid key name '${e}'`),Ie.ERR_INVALID_KEY_NAME);if(null==t)throw ee(new Error("PeerId is required"),Ie.ERR_MISSING_PRIVATE_KEY);if(null==t.privateKey)throw ee(new Error("PeerId.privKey is required"),Ie.ERR_MISSING_PRIVATE_KEY);const s=yield Oo(t.privateKey),i=fo(e);if(yield n.components.datastore.has(i))throw yield Qt(),ee(new Error(`Key '${e}' already exists`),Ie.ERR_KEY_ALREADY_EXISTS);const a=oc.get(n);if(null==a)throw ee(new Error("dek missing"),Ie.ERR_INVALID_PARAMETERS);const c=a.dek,u=yield s.export(c),f={name:e,id:t.toString()},E=n.components.datastore.batch();return E.put(i,rn(u)),E.put(ta(e),rn(JSON.stringify(f))),yield E.commit(),f}catch(s){throw yield Qt(),s}})()}getPrivateKey(e){var t=this;return(0,B.Z)(function*(){if(!ea(e))throw yield Qt(),ee(new Error(`Invalid key name '${e}'`),Ie.ERR_INVALID_KEY_NAME);try{const n=fo(e);return qo(yield t.components.datastore.get(n))}catch(n){throw yield Qt(),og.error(n),ee(new Error(`Key '${e}' does not exist.`),Ie.ERR_KEY_NOT_FOUND)}})()}rotateKeychainPass(e,t){var n=this;return(0,B.Z)(function*(){var s,i,o,a;if("string"!=typeof e)throw yield Qt(),ee(new Error(`Invalid old pass type '${typeof e}'`),Ie.ERR_INVALID_OLD_PASS_TYPE);if("string"!=typeof t)throw yield Qt(),ee(new Error(`Invalid new pass type '${typeof t}'`),Ie.ERR_INVALID_NEW_PASS_TYPE);if(t.length<20)throw yield Qt(),ee(new Error(`Invalid pass length ${t.length}`),Ie.ERR_INVALID_PASS_LENGTH);og("recreating keychain");const c=oc.get(n);if(null==c)throw ee(new Error("dek missing"),Ie.ERR_INVALID_PARAMETERS);const u=c.dek;n.init.pass=t;const f=null!=t&&null!=(null===(s=n.init.dek)||void 0===s?void 0:s.salt)?BF(t,n.init.dek.salt,null===(i=n.init.dek)||void 0===i?void 0:i.iterationCount,null===(o=n.init.dek)||void 0===o?void 0:o.keyLength,null===(a=n.init.dek)||void 0===a?void 0:a.hash):"";oc.set(n,{dek:f});const E=yield n.listKeys();for(const T of E){const b=qo(yield n.components.datastore.get(fo(T.name))),P=yield kf(b,u),F=f.toString(),M=yield P.export(F),H=n.components.datastore.batch(),$={name:T.name,id:T.id};H.put(fo(T.name),rn(M)),H.put(ta(T.name),rn(JSON.stringify($))),yield H.commit()}og("keychain reconstructed")})()}}function Pj(r,e){return dS.apply(this,arguments)}function dS(){return dS=Ee(function*(r,e){var s,t=!1,n=!1;try{for(var o,i=be(r);t=!(o=yield X(i.next())).done;t=!1){const a=o.value;yield X(e(a)),yield a}}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield X(i.return()))}finally{if(n)throw s}}}),dS.apply(this,arguments)}class DVe{constructor(e){if("number"!=typeof e)throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");this.timespan=e,this.movingAverage=0,this.variance=0,this.deviation=0,this.forecast=0}alpha(e,t){return 1-Math.exp(-(e-t)/this.timespan)}push(e,t){if(null!=this.previousTime){const n=this.alpha(e,this.previousTime),s=t-this.movingAverage,i=n*s;this.movingAverage=n*t+(1-n)*this.movingAverage,this.variance=(1-n)*(this.variance+s*i),this.deviation=Math.sqrt(this.variance),this.forecast=this.movingAverage+n*s}else this.movingAverage=t;this.previousTime=e}}function kj(r){return new DVe(r)}class fS extends wr{constructor(e){super(),this.enabled=e.enabled,this.queue=[],this.stats={dataReceived:0n,dataSent:0n},this.frequencyLastTime=Date.now(),this.frequencyAccumulators={},this.movingAverages={dataReceived:[],dataSent:[]},this.computeThrottleMaxQueueSize=e.computeThrottleMaxQueueSize,this.computeThrottleTimeout=e.computeThrottleTimeout,this._update=this._update.bind(this),this.movingAverageIntervals=e.movingAverageIntervals;for(let t=0;t<e.initialCounters.length;t++){const n=e.initialCounters[t];this.stats[n]=0n,this.movingAverages[n]=[];for(let s=0;s<this.movingAverageIntervals.length;s++){const i=this.movingAverageIntervals[s];(this.movingAverages[n][i]=kj(i)).push(this.frequencyLastTime,0)}}}start(){!this.enabled||this.queue.length>0&&this._resetComputeTimeout()}stop(){null!=this.timeout&&(this.timeout.clear(),this.timeout=null)}getSnapshot(){return Object.assign({},this.stats)}getMovingAverages(){return Object.assign({},this.movingAverages)}push(e,t){this.queue.push([e,t,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this.timeout=r0(this._update,this._nextTimeout())}_nextTimeout(){return Math.max(this.computeThrottleTimeout*(1-this.queue.length/this.computeThrottleMaxQueueSize),0)}_update(){if(this.timeout=null,this.queue.length>0){let e=["",0,0];for(e of this.queue)this._applyOp(e);this.queue=[],e.length>2&&""!==e[0]&&this._updateFrequency(e[2]),this.dispatchEvent(new Qe("update",{detail:this.stats}))}}_updateFrequency(e){const t=e-this.frequencyLastTime;this._updateFrequencyFor("dataReceived",t,e),this._updateFrequencyFor("dataSent",t,e),this.frequencyLastTime=e}_updateFrequencyFor(e,t,n){var s;const i=null!==(s=this.frequencyAccumulators[e])&&void 0!==s?s:0;this.frequencyAccumulators[e]=0;const a=i/(t??1)*1e3;let c=this.movingAverages[e];null==c&&(c=this.movingAverages[e]=[]);const u=this.movingAverageIntervals;for(let f=0;f<u.length;f++){const E=u[f];let T=c[E];null==T&&(T=c[E]=kj(E)),T.push(n,a)}}_applyOp(e){const t=e[0],n=e[1];if("number"!=typeof n)throw new Error("invalid increment number");let s;s=Object.prototype.hasOwnProperty.call(this.stats,t)?this.stats[t]:this.stats[t]=0n,this.stats[t]=s+BigInt(n),null==this.frequencyAccumulators[t]&&(this.frequencyAccumulators[t]=0),this.frequencyAccumulators[t]+=n}}const OVe=["dataReceived","dataSent"],PVe={in:"dataReceived",out:"dataSent"};class NVe{constructor(e){var t;this.enabled=e.enabled,this.statsInit={...e,initialCounters:OVe},this.globalStats=new fS(this.statsInit),this.peerStats=new Map,this.protocolStats=new Map,this.oldPeers=cf(null!==(t=e.maxOldPeersRetention)&&void 0!==t?t:50),this.running=!1,this._onMessage=this._onMessage.bind(this),this.systems=new Map}isStarted(){return this.running}start(){var e=this;return(0,B.Z)(function*(){!e.enabled||(e.running=!0)})()}stop(){var e=this;return(0,B.Z)(function*(){if(e.running){e.running=!1,e.globalStats.stop();for(const t of e.peerStats.values())t.stop();for(const t of e.protocolStats.values())t.stop()}})()}getGlobal(){return this.globalStats}getPeers(){return Array.from(this.peerStats.keys())}getComponentMetrics(){return this.systems}updateComponentMetric(e){const{system:t="libp2p",component:n,metric:s,value:i,label:o,help:a}=e;this.systems.has(t)||this.systems.set(t,new Map);const c=this.systems.get(t);if(null==c)throw new Error("Unknown metric system");c.has(n)||c.set(n,new Map);const u=c.get(n);if(null==u)throw new Error("Unknown metric component");u.set(s,{label:o,help:a,calculate:"function"!=typeof i?()=>i:i})}forPeer(e){var t;const n=e.toString();return null!==(t=this.peerStats.get(n))&&void 0!==t?t:this.oldPeers.get(n)}getProtocols(){return Array.from(this.protocolStats.keys())}forProtocol(e){return this.protocolStats.get(e)}onPeerDisconnected(e){const t=e.toString(),n=this.peerStats.get(t);null!=n&&(n.stop(),this.peerStats.delete(t),this.oldPeers.set(t,n))}_onMessage(e){if(!this.running)return;const{remotePeer:t,protocol:n,direction:s,dataLength:i}=e,o=PVe[s];let a=this.forPeer(t);if(null==a){const c=new fS(this.statsInit);this.peerStats.set(t.toString(),c),a=c}if(a.push(o,i),this.globalStats.push(o,i),null!=n){let c=this.forProtocol(n);if(null==c){const u=new fS(this.statsInit);this.protocolStats.set(n,u),c=u}c.push(o,i)}}updatePlaceholder(e,t){var n,s;if(!this.running)return;const i=e.toString(),o=null!==(n=this.peerStats.get(i))&&void 0!==n?n:this.oldPeers.get(i),a=t.toString(),c=null!==(s=this.peerStats.get(a))&&void 0!==s?s:this.oldPeers.get(a);let u=o;null!=c&&(u=function BVe(r,e){return r.stop(),e.stop(),r.queue=[...r.queue,...e.queue],r}(c,u),this.oldPeers.remove(a)),this.peerStats.delete(e.toString()),this.peerStats.set(a,u),u.start()}trackStream(e){var t=this;const{stream:n,remotePeer:s,protocol:i}=e;if(!this.running)return;n.source=Pj(n.source,c=>this._onMessage({remotePeer:s,protocol:i,direction:"in",dataLength:c.byteLength}));const a=n.sink;n.sink=function(){var c=(0,B.Z)(function*(u){return yield _t(u,f=>Pj(f,E=>{t._onMessage({remotePeer:s,protocol:i,direction:"out",dataLength:E.byteLength})}),a)});return function(u){return c.apply(this,arguments)}}()}}function hS(r){return pS.apply(this,arguments)}function pS(){return pS=(0,B.Z)(function*(r){try{return{status:"fulfilled",value:yield r,isFulfilled:!0,isRejected:!1}}catch(e){return{status:"rejected",reason:e,isFulfilled:!1,isRejected:!0}}}),pS.apply(this,arguments)}function yS(r,e,t){(function LVe(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")})(r,e),e.set(r,t)}function Uj(r,e,t){if(!e.has(r))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(r)}function ra(r,e,t){return function kVe(r,e,t){if(e.set)e.set.call(r,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(r,Uj(r,e,"set"),t),t}function ac(r,e){return function UVe(r,e){return e.get?e.get.call(r):e.value}(r,Uj(r,e,"get"))}let Mj;class MVe{constructor(e){Tp(this,"value",void 0),Tp(this,"next",void 0),this.value=e}}var cc=new WeakMap,l0=new WeakMap,tl=new WeakMap;Mj=Symbol.iterator;class FVe{constructor(){yS(this,cc,{writable:!0,value:void 0}),yS(this,l0,{writable:!0,value:void 0}),yS(this,tl,{writable:!0,value:void 0}),this.clear()}enqueue(e){var t;const s=new MVe(e);ac(this,cc)?(ac(this,l0).next=s,ra(this,l0,s)):(ra(this,cc,s),ra(this,l0,s)),ra(this,tl,(t=ac(this,tl),++t))}dequeue(){var e;const n=ac(this,cc);if(n)return ra(this,cc,ac(this,cc).next),ra(this,tl,(e=ac(this,tl),--e)),n.value}clear(){ra(this,cc,void 0),ra(this,l0,void 0),ra(this,tl,0)}get size(){return ac(this,tl)}*[Mj](){let e=ac(this,cc);for(;e;)yield e.value,e=e.next}}function zVe(r){if(!Number.isInteger(r)&&r!==Number.POSITIVE_INFINITY||!(r>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const e=new FVe;let t=0;const s=function(){var a=(0,B.Z)(function*(c,u,f){t++;const E=(0,B.Z)(function*(){return c(...f)})();u(E);try{yield E}catch{}t--,e.size>0&&e.dequeue()()});return function(u,f,E){return a.apply(this,arguments)}}(),o=(a,...c)=>new Promise(u=>{((a,c,u)=>{e.enqueue(s.bind(void 0,a,c,u)),(0,B.Z)(function*(){yield Promise.resolve(),t<r&&e.size>0&&e.dequeue()()})()})(a,u,c)});return Object.defineProperties(o,{activeCount:{get:()=>t},pendingCount:{get:()=>e.size},clearQueue:{value:()=>{e.clear()}}}),o}function VVe(r){return gS.apply(this,arguments)}function gS(){return gS=(0,B.Z)(function*(r,e={}){const{concurrency:t=Number.POSITIVE_INFINITY}=e,n=zVe(t);return Promise.all(r.map(s=>hS(s&&"function"==typeof s.then?s:"function"==typeof s?n(()=>s()):Promise.resolve(s))))}),gS.apply(this,arguments)}class jVe extends Map{constructor(e){super();const{system:t,component:n,metric:s,metrics:i}=e;this.system=t??"libp2p",this.component=n,this.metric=s,this.metrics=i,this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metrics.updateComponentMetric({system:this.system,component:this.component,metric:this.metric,value:this.size})}}function rl(r){const{system:e,component:t,metric:n,metrics:s}=r;let i;return i=null!=s?new jVe({system:e,component:t,metric:n,metrics:s}):new Map,i}const nl=Be("libp2p:transports");class $Ve extends wr{constructor(e,t={}){var n;super(),this.components=e,this.started=!1,this.transports=new Map,this.listeners=rl({component:"transport-manager",metric:"listeners",metrics:this.components.metrics}),this.faultTolerance=null!==(n=t.faultTolerance)&&void 0!==n?n:sl.FATAL_ALL}add(e){const t=e[Symbol.toStringTag];if(null==t)throw ee(new Error("Transport must have a valid tag"),Ie.ERR_INVALID_KEY);if(this.transports.has(t))throw ee(new Error("There is already a transport with this tag"),Ie.ERR_DUPLICATE_TRANSPORT);nl("adding transport %s",t),this.transports.set(t,e),this.listeners.has(t)||this.listeners.set(t,[])}isStarted(){return this.started}start(){var e=this;return(0,B.Z)(function*(){const t=e.components.addressManager.getListenAddrs();yield e.listen(t),e.started=!0})()}stop(){var e=this;return(0,B.Z)(function*(){const t=[];for(const[n,s]of e.listeners)for(nl("closing listeners for %s",n);s.length>0;){const i=s.pop();null!=i&&t.push(i.close())}yield Promise.all(t),nl("all listeners closed");for(const n of e.listeners.keys())e.listeners.set(n,[]);e.started=!1})()}dial(e,t){var n=this;return(0,B.Z)(function*(){const s=n.transportForMultiaddr(e);if(null==s)throw ee(new Error(`No transport available for address ${String(e)}`),Ie.ERR_TRANSPORT_UNAVAILABLE);try{return yield s.dial(e,{...t,upgrader:n.components.upgrader})}catch(i){throw null==i.code&&(i.code=Ie.ERR_TRANSPORT_DIAL_FAILED),i}})()}getAddrs(){let e=[];for(const t of this.listeners.values())for(const n of t)e=[...e,...n.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}transportForMultiaddr(e){for(const t of this.transports.values())if(t.filter([e]).length>0)return t}listen(e){var t=this;return(0,B.Z)(function*(){if(null==e||0===e.length)return void nl("no addresses were provided for listening, this node is dial only");const n=[];for(const[s,i]of t.transports.entries()){const o=i.filter(e),a=[];for(const f of o){nl("creating listener for %s on %s",s,f);const E=i.createListener({upgrader:t.components.upgrader});let T=t.listeners.get(s);null==T&&(T=[],t.listeners.set(s,T)),T.push(E),E.addEventListener("listening",()=>{t.dispatchEvent(new Qe("listener:listening",{detail:E}))}),E.addEventListener("close",()=>{t.dispatchEvent(new Qe("listener:close",{detail:E}))}),a.push(E.listen(f))}if(0!==a.length){if(null==(yield VVe(a)).find(f=>f.isFulfilled)&&t.faultTolerance!==sl.NO_FATAL)throw ee(new Error(`Transport (${s}) could not listen on any available address`),Ie.ERR_NO_VALID_ADDRESSES)}else n.push(s)}if(n.length===t.transports.size){const s=`no valid addresses were provided for transports [${n.join(", ")}]`;if(t.faultTolerance===sl.FATAL_ALL)throw ee(new Error(s),Ie.ERR_NO_VALID_ADDRESSES);nl(`libp2p in dial mode only: ${s}`)}})()}remove(e){var t=this;return(0,B.Z)(function*(){nl("removing %s",e);for(const s of null!==(n=t.listeners.get(e))&&void 0!==n?n:[]){var n;yield s.close()}t.transports.delete(e),t.listeners.delete(e)})()}removeAll(){var e=this;return(0,B.Z)(function*(){const t=[];for(const n of e.transports.keys())t.push(e.remove(n));yield Promise.all(t)})()}}var sl=(()=>(function(r){r[r.FATAL_ALL=0]="FATAL_ALL",r[r.NO_FATAL=1]="NO_FATAL"}(sl||(sl={})),sl))();const Du="/multistream/1.0.0";const WVe=function ZVe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},ag=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class XVe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class qVe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Fj(this,e)}}class eje{constructor(e){this.decoders=e}or(e){return Fj(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Fj=(r,e)=>new eje({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class tje{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new XVe(e,t,n),this.decoder=new qVe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const cg=({name:r,prefix:e,encode:t,decode:n})=>new tje(r,e,t,n),u0=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=WVe(t,e);return cg({prefix:r,name:e,encode:n,decode:i=>ag(s(i))})},Kn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>cg({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),sje=cg({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),ije=Kn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),oje=Kn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),aje=u0({prefix:"9",name:"base10",alphabet:"0123456789"}),cje=Kn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),lje=Kn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),uje=Kn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),dje=Kn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),fje=Kn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),hje=Kn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),pje=Kn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),yje=Kn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),gje=Kn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),bje=Kn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_je=Kn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),mje=u0({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),vje=u0({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),wje=u0({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Eje=u0({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),xje=Kn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Sje=Kn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Aje=Kn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Tje=Kn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),zj=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),Cje=zj.reduce((r,e,t)=>(r[t]=e,r),[]),Ije=zj.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),Oje=cg({prefix:"\u{1f680}",name:"base256emoji",encode:function Rje(r){return r.reduce((e,t)=>e+Cje[t],"")},decode:function Dje(r){const e=[];for(const t of r){const n=Ije[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var Lje=Math.pow(2,31),Mje=Math.pow(2,7),Fje=Math.pow(2,14),zje=Math.pow(2,21),Vje=Math.pow(2,28),jje=Math.pow(2,35),$je=Math.pow(2,42),Kje=Math.pow(2,49),Zje=Math.pow(2,56),Hje=Math.pow(2,63),Wje={encode:function jj(r,e,t){e=e||[];for(var n=t=t||0;r>=Lje;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,jj.bytes=t-n+1,e},decode:function bS(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw bS.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return bS.bytes=i-n,t},encodingLength:function(r){return r<Mje?1:r<Fje?2:r<zje?3:r<Vje?4:r<jje?5:r<$je?6:r<Kje?7:r<Zje?8:r<Hje?9:10}};const Kj=Wje,Zj=(r,e,t=0)=>(Kj.encode(r,e,t),e),Hj=r=>Kj.encodingLength(r),_S=(r,e)=>{const t=e.byteLength,n=Hj(r),s=n+Hj(t),i=new Uint8Array(s+t);return Zj(r,i,0),Zj(t,i,n),i.set(e,s),new Gj(r,t,e,i)};class Gj{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const Wj=({name:r,code:e,encode:t})=>new Qje(r,e,t);class Qje{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?_S(this.code,t):t.then(n=>_S(this.code,n))}throw Error("Unknown type, must be binary type")}}const Yj=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),Jje=Wj({name:"sha2-256",code:18,encode:Yj("SHA-256")}),Xje=Wj({name:"sha2-512",code:19,encode:Yj("SHA-512")}),Jj=ag,e$e={code:0,name:"identity",encode:Jj,digest:r=>_S(0,Jj(r))},t$e="raw",r$e=85,n$e=r=>ag(r),s$e=r=>ag(r),i$e=new TextEncoder,o$e=new TextDecoder,a$e="json",c$e=512,l$e=r=>i$e.encode(JSON.stringify(r)),u$e=r=>JSON.parse(o$e.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const e$={...Pm,...Nm,...Bm,...Lm,...km,...Um,...Mm,...Fm,...zm,...Vm};function t$(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function r$(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const n$=r$("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),vS=r$("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function b$e(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?t$(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),s$={utf8:n$,"utf-8":n$,hex:e$.base16,latin1:vS,ascii:vS,binary:vS,...e$};function lc(r,e="utf8"){const t=s$[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):t$(globalThis.Buffer.from(r,"utf-8"))}var _$e=p(91635);function m$e(r,e="utf8"){const t=s$[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}const i$=lc("\n");function wS(r){const e=new Or(r,i$);return ei.single(e)}function f0(r,e,t={}){const n=wS(e);r.push(!0===t.writeBytes?n.subarray():n)}function v$e(r,e,t={}){const n=new Or;for(const s of e)n.append(wS(s));r.push(!0===t.writeBytes?n.subarray():n)}function w$e(r,e){return ES.apply(this,arguments)}function ES(){return ES=(0,B.Z)(function*(r,e){let t=1;const n={[Symbol.asyncIterator]:()=>n,next:(a=(0,B.Z)(function*(){return yield r.next(t)}),function(){return a.apply(this,arguments)})};var a;let s=n;null!=e?.signal&&(s=Ms(n,e.signal));const o=yield _t(s,Fs({onLength:a=>{t=a},maxDataLength:1024}),function(){var a=(0,B.Z)(function*(c){return yield _$e(c)});return function(c){return a.apply(this,arguments)}}());if(null==o||0===o.length)throw ee(new Error("no buffer returned"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");if(o.get(o.byteLength-1)!==i$[0])throw ee(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return o.sublist(0,-1)}),ES.apply(this,arguments)}function lg(r,e){return xS.apply(this,arguments)}function xS(){return xS=(0,B.Z)(function*(r,e){return m$e((yield w$e(r,e)).subarray())}),xS.apply(this,arguments)}p(99948);const h0=Be("libp2p:mss:select");function SS(r,e){return AS.apply(this,arguments)}function AS(){return AS=(0,B.Z)(function*(r,e,t={}){e=Array.isArray(e)?[...e]:[e];const{reader:n,writer:s,rest:i,stream:o}=X2(r),a=e.shift();if(null==a)throw new Error("At least one protocol must be specified");h0('select: write ["%s", "%s"]',Du,a),v$e(s,[lc(Du),lc(a)],t);let f=yield lg(n,t);if(h0('select: read "%s"',f),f===Du&&(f=yield lg(n,t),h0('select: read "%s"',f)),f===a)return i(),{stream:o,protocol:a};for(const E of e){h0('select: write "%s"',E),f0(s,lc(E),t);const T=yield lg(n,t);if(h0('select: read "%s" for "%s"',T,E),T===E)return i(),{stream:o,protocol:E}}throw i(),ee(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}),AS.apply(this,arguments)}const p0=Be("libp2p:mss:handle");function TS(r,e,t){return CS.apply(this,arguments)}function CS(){return CS=(0,B.Z)(function*(r,e,t){e=Array.isArray(e)?e:[e];const{writer:n,reader:s,rest:i,stream:o}=X2(r);for(;;){const a=yield lg(s,t);if(p0('read "%s"',a),a!==Du){if(e.includes(a))return f0(n,lc(a),t),p0('respond with "%s" for "%s"',a,a),i(),{stream:o,protocol:a};"ls"!==a?(f0(n,lc("na"),t),p0('respond with "na" for "%s"',a)):(f0(n,new Or(...e.map(c=>wS(lc(c)))),t),p0('respond with "%s" for %s',e,a))}else p0('respond with "%s" for "%s"',Du,a),f0(n,lc(Du),t)}}),CS.apply(this,arguments)}var o$=p(35551);const a$=Symbol.for("@libp2p/connection"),E$e=Be("libp2p:connection");class x$e{constructor(e){const{remoteAddr:t,remotePeer:n,newStream:s,close:i,getStreams:o,stat:a}=e;this.id=`${parseInt(String(1e9*Math.random())).toString(36)}${Date.now()}`,this.remoteAddr=t,this.remotePeer=n,this.stat={...a,status:"OPEN"},this._newStream=s,this._close=i,this._getStreams=o,this.tags=[],this._closing=!1}get[Symbol.toStringTag](){return"Connection"}get[a$](){return!0}get streams(){return this._getStreams()}newStream(e,t){var n=this;return(0,B.Z)(function*(){if(n.stat.status===ej)throw ee(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(n.stat.status===Zx)throw ee(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);const s=yield n._newStream(e,t);return s.stat.direction="outbound",s})()}addStream(e){e.stat.direction="inbound"}removeStream(e){}close(){var e=this;return(0,B.Z)(function*(){if(e.stat.status!==Zx&&!e._closing){e.stat.status=ej;try{e.streams.forEach(t=>t.close())}catch(t){E$e.error(t)}e._closing=!0,yield e._close(),e._closing=!1,e.stat.timeline.close=Date.now(),e.stat.status=Zx}})()}}const c$=Be("libp2p:registrar");class A$e{constructor(e){this.topologies=new Map,this.handlers=new Map,this.components=e,this._onDisconnect=this._onDisconnect.bind(this),this._onProtocolChange=this._onProtocolChange.bind(this),this.components.connectionManager.addEventListener("peer:disconnect",this._onDisconnect),this.components.peerStore.addEventListener("change:protocols",this._onProtocolChange)}getProtocols(){return Array.from(new Set([...this.topologies.keys(),...this.handlers.keys()])).sort()}getHandler(e){const t=this.handlers.get(e);if(null==t)throw ee(new Error(`No handler registered for protocol ${e}`),Ie.ERR_NO_HANDLER_FOR_PROTOCOL);return t}getTopologies(e){const t=this.topologies.get(e);return null==t?[]:[...t.values()]}handle(e,t,n){var s=this;return(0,B.Z)(function*(){if(s.handlers.has(e))throw ee(new Error(`Handler already registered for protocol ${e}`),Ie.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);const i=Sr.bind({ignoreUndefined:!0})({maxInboundStreams:32,maxOutboundStreams:64},n);s.handlers.set(e,{handler:t,options:i}),yield s.components.peerStore.protoBook.add(s.components.peerId,[e])})()}unhandle(e){var t=this;return(0,B.Z)(function*(){const n=Array.isArray(e)?e:[e];n.forEach(s=>{t.handlers.delete(s)}),yield t.components.peerStore.protoBook.remove(t.components.peerId,n)})()}register(e,t){var n=this;return(0,B.Z)(function*(){if(!function aIe(r){return null!=r&&Boolean(r[z9])}(t))throw c$.error("topology must be an instance of interfaces/topology"),ee(new Error("topology must be an instance of interfaces/topology"),Ie.ERR_INVALID_PARAMETERS);const s=`${(1e9*Math.random()).toString(36)}${Date.now()}`;let i=n.topologies.get(e);return null==i&&(i=new Map,n.topologies.set(e,i)),i.set(s,t),yield t.setRegistrar(n),s})()}unregister(e){for(const[t,n]of this.topologies.entries())n.has(e)&&(n.delete(e),0===n.size&&this.topologies.delete(t))}_onDisconnect(e){const t=e.detail;this.components.peerStore.protoBook.get(t.remotePeer).then(n=>{for(const s of n){const i=this.topologies.get(s);if(null!=i)for(const o of i.values())o.onDisconnect(t.remotePeer)}}).catch(n=>{c$.error(n)})}_onProtocolChange(e){const{peerId:t,protocols:n,oldProtocols:s}=e.detail,i=s.filter(a=>!n.includes(a)),o=n.filter(a=>!s.includes(a));for(const a of i){const c=this.topologies.get(a);if(null!=c)for(const u of c.values())u.onDisconnect(t)}for(const a of o){const c=this.topologies.get(a);if(null!=c)for(const u of c.values()){const f=this.components.connectionManager.getConnections(t)[0];null!=f&&u.onConnect(t,f)}}}}const ar=Be("libp2p:upgrader");function d$(r,e,t){let n=0;return t.streams.forEach(s=>{s.stat.direction===e&&s.stat.protocol===r&&n++}),n}class I$e extends wr{constructor(e,t){super(),this.components=e,this.connectionEncryption=new Map,t.connectionEncryption.forEach(n=>{this.connectionEncryption.set(n.protocol,n)}),this.muxers=new Map,t.muxers.forEach(n=>{this.muxers.set(n.protocol,n)}),this.inboundUpgradeTimeout=t.inboundUpgradeTimeout}upgradeInbound(e){var t=this;return(0,B.Z)(function*(){if(!(yield t.components.connectionManager.acceptIncomingConnection(e)))throw ee(new Error("connection denied"),Ie.ERR_CONNECTION_DENIED);let s,i,o,a,c,u,f;const E=t.components.metrics,T=new Ar.TimeoutController(t.inboundUpgradeTimeout);try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,T.signal)}catch{}try{const U=oo(e,T.signal);if(e.source=U.source,e.sink=U.sink,yield t.components.connectionGater.denyInboundConnection(e))throw ee(new Error("The multiaddr connection is blocked by gater.acceptConnection"),Ie.ERR_CONNECTION_INTERCEPTED);if(null!=E){({setTarget:u,proxy:f}=o$());const F=`${(1e9*Math.random()).toString(36)}${Date.now()}`;u({toString:()=>F}),E.trackStream({stream:e,remotePeer:f})}ar("starting the inbound connection upgrade");let b=e;const P=t.components.connectionProtector;null!=P&&(ar("protecting the inbound connection"),b=yield P.protect(e));try{if(({conn:s,remotePeer:i,protocol:c}=yield t._encryptInbound(b)),yield t.components.connectionGater.denyInboundEncryptedConnection(i,{...b,...s}))throw ee(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Ie.ERR_CONNECTION_INTERCEPTED);if(t.muxers.size>0){const F=yield t._multiplexInbound({...b,...s},t.muxers);a=F.muxerFactory,o=F.stream}else o=s}catch(F){throw ar.error("Failed to upgrade inbound connection",F),F}if(yield t.components.connectionGater.denyInboundUpgradedConnection(i,{...b,...s}))throw ee(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Ie.ERR_CONNECTION_INTERCEPTED);return null!=E&&(E.updatePlaceholder(f,i),u(i)),ar("Successfully upgraded inbound connection"),t._createConnection({cryptoProtocol:c,direction:"inbound",maConn:e,upgradedConn:o,muxerFactory:a,remotePeer:i})}finally{t.components.connectionManager.afterUpgradeInbound(),T.clear()}})()}upgradeOutbound(e,t){var n=this;return(0,B.Z)(function*(){const s=e.remoteAddr.getPeerId();if(null==s)throw ee(new Error("outbound connection must have a peer id"),Ie.ERR_INVALID_MULTIADDR);const i=bt(s);if(yield n.components.connectionGater.denyOutboundConnection(i,e))throw ee(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),Ie.ERR_CONNECTION_INTERCEPTED);let o,a,c,u,f,E,T;const U=n.components.metrics;if(null!=U){({setTarget:E,proxy:T}=o$());const P=`${(1e9*Math.random()).toString(36)}${Date.now()}`;E({toB58String:()=>P}),U.trackStream({stream:e,remotePeer:T})}ar("Starting the outbound connection upgrade");let b=e;if(!0!==t?.skipProtection){const P=n.components.connectionProtector;null!=P&&(b=yield P.protect(e))}try{if(o=b,!0!==t?.skipEncryption){if(({conn:o,remotePeer:a,protocol:u}=yield n._encryptOutbound(b,i)),yield n.components.connectionGater.denyOutboundEncryptedConnection(a,{...b,...o}))throw ee(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Ie.ERR_CONNECTION_INTERCEPTED)}else u="native",a=i;if(c=o,null!=t?.muxerFactory)f=t.muxerFactory;else if(n.muxers.size>0){const P=yield n._multiplexOutbound({...b,...o},n.muxers);f=P.muxerFactory,c=P.stream}}catch(P){throw ar.error("Failed to upgrade outbound connection",P),yield e.close(P),P}if(yield n.components.connectionGater.denyOutboundUpgradedConnection(a,{...b,...o}))throw ee(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Ie.ERR_CONNECTION_INTERCEPTED);return null!=U&&(U.updatePlaceholder(T,a),E(a)),ar("Successfully upgraded outbound connection"),n._createConnection({cryptoProtocol:u,direction:"outbound",maConn:e,upgradedConn:c,muxerFactory:f,remotePeer:a})})()}_createConnection(e){var n,s,t=this;const{cryptoProtocol:i,direction:o,maConn:a,upgradedConn:c,remotePeer:u,muxerFactory:f}=e;let E,T,U;null!=f&&(E=f.createStreamMuxer({direction:o,onIncomingStream:F=>{null!=U&&Promise.resolve().then((0,B.Z)(function*(){const M=t.components.registrar.getProtocols(),{stream:H,protocol:$}=yield TS(F,M);if(ar("%s: incoming stream opened on %s",o,$),t.components.metrics?.trackStream({stream:H,remotePeer:u,protocol:$}),null==U)return;const W=function T$e(r,e){try{const{options:t}=e.getHandler(r);return t.maxInboundStreams}catch(t){if(t.code!==Ie.ERR_NO_HANDLER_FOR_PROTOCOL)throw t}return 32}($,t.components.registrar);d$($,"inbound",U)!==W?(F.source=H.source,F.sink=H.sink,F.stat.protocol=$,t.components.peerStore.protoBook.add(u,[$]).catch(Y=>ar.error(Y)),U.addStream(F),t._onStream({connection:U,stream:F,protocol:$})):F.abort(ee(new Error(`Too many inbound protocol streams for protocol "${$}" - limit ${W}`),Ie.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS))})).catch(M=>{ar.error(M),null==F.stat.timeline.close&&F.close()})},onStreamEnd:F=>{var M;null===(M=U)||void 0===M||M.removeStream(F.id)}}),T=function(){var F=(0,B.Z)(function*(M,H={}){if(null==E)throw ee(new Error("Stream is not multiplexed"),Ie.ERR_MUXER_UNAVAILABLE);ar("%s: starting new stream on %s",o,M);const $=yield E.newStream(),V=t.components.metrics;let W;try{if(null==H.signal){ar("No abort signal was passed while trying to negotiate protocols %s falling back to default timeout",M),W=new Ar.TimeoutController(3e4),H.signal=W.signal;try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,W.signal)}catch{}}const{stream:ne,protocol:Y}=yield SS($,M,H);V?.trackStream({stream:ne,remotePeer:u,protocol:Y});const q=function C$e(r,e){try{const{options:t}=e.getHandler(r);return t.maxOutboundStreams}catch(t){if(t.code!==Ie.ERR_NO_HANDLER_FOR_PROTOCOL)throw t}return 64}(Y,t.components.registrar);if(d$(Y,"outbound",U)===q){const Ce=ee(new Error(`Too many outbound protocol streams for protocol "${Y}" - limit ${q}`),Ie.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS);throw $.abort(Ce),Ce}return t.components.peerStore.protoBook.add(u,[Y]).catch(Ce=>ar.error(Ce)),$.source=ne.source,$.sink=ne.sink,$.stat.protocol=Y,$}catch(ne){throw ar.error("could not create new stream",ne),null==$.stat.timeline.close&&$.close(),null!=ne.code?ne:ee(ne,Ie.ERR_UNSUPPORTED_PROTOCOL)}finally{W?.clear()}});return function(H){return F.apply(this,arguments)}}(),_t(c,E,c).catch(ar.error));const b=a.timeline;a.timeline=new Proxy(b,{set:(...F)=>(null!=U&&"close"===F[1]&&null!=F[2]&&null==b.close&&(0,B.Z)(function*(){try{"OPEN"===U.stat.status&&(yield U.close())}catch(M){ar.error(M)}finally{t.dispatchEvent(new Qe("connectionEnd",{detail:U}))}})().catch(M=>{ar.error(M)}),Reflect.set(...F))}),a.timeline.upgraded=Date.now();const P=()=>{throw ee(new Error("connection is not multiplexed"),Ie.ERR_CONNECTION_NOT_MULTIPLEXED)};return U=function S$e(r){return new x$e(r)}({remoteAddr:a.remoteAddr,remotePeer:u,stat:{status:"OPEN",direction:o,timeline:a.timeline,multiplexer:null===(n=E)||void 0===n?void 0:n.protocol,encryption:i},newStream:null!==(s=T)&&void 0!==s?s:P,getStreams:()=>null!=E?E.streams:P(),close:(F=(0,B.Z)(function*(){yield a.close(),E?.close()}),function(){return F.apply(this,arguments)})}),this.dispatchEvent(new Qe("connection",{detail:U})),U;var F}_onStream(e){const{connection:t,stream:n,protocol:s}=e,{handler:i}=this.components.registrar.getHandler(s);i({connection:t,stream:n})}_encryptInbound(e){var t=this;return(0,B.Z)(function*(){const n=Array.from(t.connectionEncryption.keys());ar("handling inbound crypto protocol selection",n);try{const{stream:s,protocol:i}=yield TS(e,n,{writeBytes:!0}),o=t.connectionEncryption.get(i);if(null==o)throw new Error(`no crypto module found for ${i}`);return ar("encrypting inbound connection..."),{...yield o.secureInbound(t.components.peerId,s),protocol:i}}catch(s){throw ee(s,Ie.ERR_ENCRYPTION_FAILED)}})()}_encryptOutbound(e,t){var n=this;return(0,B.Z)(function*(){const s=Array.from(n.connectionEncryption.keys());ar("selecting outbound crypto protocol",s);try{const{stream:i,protocol:o}=yield SS(e,s,{writeBytes:!0}),a=n.connectionEncryption.get(o);if(null==a)throw new Error(`no crypto module found for ${o}`);return ar("encrypting outbound connection to %p",t),{...yield a.secureOutbound(n.components.peerId,i,t),protocol:o}}catch(i){throw ee(i,Ie.ERR_ENCRYPTION_FAILED)}})()}_multiplexOutbound(e,t){return(0,B.Z)(function*(){const n=Array.from(t.keys());ar("outbound selecting muxer %s",n);try{const{stream:s,protocol:i}=yield SS(e,n,{writeBytes:!0});return ar("%s selected as muxer protocol",i),{stream:s,muxerFactory:t.get(i)}}catch(s){throw ar.error("error multiplexing outbound stream",s),ee(s,Ie.ERR_MUXER_UNAVAILABLE)}})()}_multiplexInbound(e,t){return(0,B.Z)(function*(){const n=Array.from(t.keys());ar("inbound handling muxers %s",n);try{const{stream:s,protocol:i}=yield TS(e,n,{writeBytes:!0});return{stream:s,muxerFactory:t.get(i)}}catch(s){throw ar.error("error multiplexing inbound stream",s),ee(s,Ie.ERR_MUXER_UNAVAILABLE)}})()}}var il;!function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{if(!1!==s.lengthDelimited&&n.fork(),null!=t.protocolVersion&&(n.uint32(42),n.string(t.protocolVersion)),null!=t.agentVersion&&(n.uint32(50),n.string(t.agentVersion)),null!=t.publicKey&&(n.uint32(10),n.bytes(t.publicKey)),null!=t.listenAddrs)for(const i of t.listenAddrs)n.uint32(18),n.bytes(i);if(null!=t.observedAddr&&(n.uint32(34),n.bytes(t.observedAddr)),null!=t.protocols)for(const i of t.protocols)n.uint32(26),n.string(i);null!=t.signedPeerRecord&&(n.uint32(66),n.bytes(t.signedPeerRecord)),!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={listenAddrs:[],protocols:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();switch(o>>>3){case 5:s.protocolVersion=t.string();break;case 6:s.agentVersion=t.string();break;case 1:s.publicKey=t.bytes();break;case 2:s.listenAddrs.push(t.bytes());break;case 4:s.observedAddr=t.bytes();break;case 3:s.protocols.push(t.string());break;case 8:s.signedPeerRecord=t.bytes();break;default:t.skipType(7&o)}}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(il||(il={}));const h$="js-libp2p/0.0.0",sr=Be("libp2p:identify");class IS{constructor(e,t){this.components=e,this.started=!1,this.init=t,this.identifyProtocolStr=`/${t.protocolPrefix}/id/1.0.0`,this.identifyPushProtocolStr=`/${t.protocolPrefix}/id/push/1.0.0`,this.host={protocolVersion:`${t.protocolPrefix}/0.1.0`,...t.host},this.components.connectionManager.addEventListener("peer:connect",n=>{this.identify(n.detail).catch(sr.error)}),this.components.peerStore.addEventListener("change:multiaddrs",n=>{const{peerId:s}=n.detail;this.components.peerId.equals(s)&&this.pushToPeerStore().catch(i=>sr.error(i))}),this.components.peerStore.addEventListener("change:protocols",n=>{const{peerId:s}=n.detail;this.components.peerId.equals(s)&&this.pushToPeerStore().catch(i=>sr.error(i))})}isStarted(){return this.started}start(){var e=this;return(0,B.Z)(function*(){e.started||(yield e.components.peerStore.metadataBook.setValue(e.components.peerId,"AgentVersion",rn(e.host.agentVersion)),yield e.components.peerStore.metadataBook.setValue(e.components.peerId,"ProtocolVersion",rn(e.host.protocolVersion)),yield e.components.registrar.handle(e.identifyProtocolStr,t=>{e._handleIdentify(t).catch(n=>{sr.error(n)})},{maxInboundStreams:e.init.maxInboundStreams,maxOutboundStreams:e.init.maxOutboundStreams}),yield e.components.registrar.handle(e.identifyPushProtocolStr,t=>{e._handlePush(t).catch(n=>{sr.error(n)})},{maxInboundStreams:e.init.maxPushIncomingStreams,maxOutboundStreams:e.init.maxPushOutgoingStreams}),e.started=!0)})()}stop(){var e=this;return(0,B.Z)(function*(){yield e.components.registrar.unhandle(e.identifyProtocolStr),yield e.components.registrar.unhandle(e.identifyPushProtocolStr),e.started=!1})()}push(e){var t=this;return(0,B.Z)(function*(){const n=yield t.components.peerStore.addressBook.getRawEnvelope(t.components.peerId),s=t.components.addressManager.getAddresses().map(a=>a.bytes),i=yield t.components.peerStore.protoBook.get(t.components.peerId),o=e.map(function(){var a=(0,B.Z)(function*(c){let u;const f=new Ar.TimeoutController(t.init.timeout);try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,f.signal)}catch{}try{u=yield c.newStream([t.identifyPushProtocolStr],{signal:f.signal}),yield oo(u,f.signal).sink(_t([il.encode({listenAddrs:s,signedPeerRecord:n,protocols:i})],ei()))}catch(E){sr.error("could not push identify update to peer",E)}finally{u?.close(),f.clear()}});return function(c){return a.apply(this,arguments)}}());yield Promise.all(o)})()}pushToPeerStore(){var e=this;return(0,B.Z)(function*(){if(!e.isStarted())return;const t=[];for(const n of e.components.connectionManager.getConnections()){const s=n.remotePeer;!(yield e.components.peerStore.get(s)).protocols.includes(e.identifyPushProtocolStr)||t.push(n)}yield e.push(t)})()}_identify(e,t={}){var n=this;return(0,B.Z)(function*(){let s,o,i=t.signal;if(null==i){s=new Ar.TimeoutController(n.init.timeout),i=s.signal;try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,s.signal)}catch{}}try{var a;o=yield e.newStream([n.identifyProtocolStr],{signal:i});const c=oo(o,i),u=yield _t([],c,Fs({maxDataLength:null!==(a=n.init.maxIdentifyMessageSize)&&void 0!==a?a:8192}),function(){var f=(0,B.Z)(function*(E){return yield Ni(E)});return function(E){return f.apply(this,arguments)}}());if(null==u)throw ee(new Error("No data could be retrieved"),Ie.ERR_CONNECTION_ENDED);try{return il.decode(u)}catch(f){throw ee(f,Ie.ERR_INVALID_MESSAGE)}}finally{s?.clear(),o?.close()}})()}identify(e,t={}){var n=this;return(0,B.Z)(function*(){const s=yield n._identify(e,t),{publicKey:i,listenAddrs:o,protocols:a,observedAddr:c,signedPeerRecord:u,agentVersion:f,protocolVersion:E}=s;if(null==i)throw ee(new Error("public key was missing from identify message"),Ie.ERR_MISSING_PUBLIC_KEY);const T=yield Ti(i);if(!e.remotePeer.equals(T))throw ee(new Error("identified peer does not match the expected peer"),Ie.ERR_INVALID_PEER);if(n.components.peerId.equals(T))throw ee(new Error("identified peer is our own peer id?"),Ie.ERR_INVALID_PEER);const U=IS.getCleanMultiaddr(c);if(null!=u){sr("received signed peer record from %p",T);try{const b=yield Us.openAndCertify(u,bu.DOMAIN);if(!b.peerId.equals(T))throw ee(new Error("identified peer does not match the expected peer"),Ie.ERR_INVALID_PEER);if(yield n.components.peerStore.addressBook.consumePeerRecord(b))return yield n.components.peerStore.protoBook.set(T,a),null!=f&&(yield n.components.peerStore.metadataBook.setValue(T,"AgentVersion",rn(f))),null!=E&&(yield n.components.peerStore.metadataBook.setValue(T,"ProtocolVersion",rn(E))),void sr("identify completed for peer %p and protocols %o",T,a)}catch(b){sr("received invalid envelope, discard it and fallback to listenAddrs is available",b)}}else sr("no signed peer record received from %p",T);sr("falling back to legacy addresses from %p",T);try{yield n.components.peerStore.addressBook.set(T,o.map(b=>at(b)))}catch(b){sr.error("received invalid addrs",b)}yield n.components.peerStore.protoBook.set(T,a),null!=f&&(yield n.components.peerStore.metadataBook.setValue(T,"AgentVersion",rn(f))),null!=E&&(yield n.components.peerStore.metadataBook.setValue(T,"ProtocolVersion",rn(E))),sr("identify completed for peer %p and protocols %o",T,a),sr("received observed address of %s",U?.toString())})()}_handleIdentify(e){var t=this;return(0,B.Z)(function*(){const{connection:n,stream:s}=e,i=new Ar.TimeoutController(t.init.timeout);try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,i.signal)}catch{}try{var o;const a=null!==(o=t.components.peerId.publicKey)&&void 0!==o?o:new Uint8Array(0),c=yield t.components.peerStore.get(t.components.peerId),u=t.components.addressManager.getAddresses().map(b=>b.decapsulateCode(jr("p2p").code));let f=c.peerRecordEnvelope;if(u.length>0&&null==f){const b=new bu({peerId:t.components.peerId,multiaddrs:u}),P=yield Us.seal(b,t.components.peerId);yield t.components.peerStore.addressBook.consumePeerRecord(P),f=P.marshal().subarray()}const E=il.encode({protocolVersion:t.host.protocolVersion,agentVersion:t.host.agentVersion,publicKey:a,listenAddrs:u.map(b=>b.bytes),signedPeerRecord:f,observedAddr:n.remoteAddr.bytes,protocols:c.protocols}),T=oo(s,i.signal),U=_t([E],ei());yield T.sink(U)}catch(a){sr.error("could not respond to identify request",a)}finally{s.close(),i.clear()}})()}_handlePush(e){var t=this;return(0,B.Z)(function*(){const{connection:n,stream:s}=e,i=new Ar.TimeoutController(t.init.timeout);try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,i.signal)}catch{}let o;try{var a;const u=oo(s,i.signal),f=yield _t([],u,Fs({maxDataLength:null!==(a=t.init.maxIdentifyMessageSize)&&void 0!==a?a:8192}),function(){var E=(0,B.Z)(function*(T){return yield Ni(T)});return function(T){return E.apply(this,arguments)}}());null!=f&&(o=il.decode(f))}catch(u){return sr.error("received invalid message",u)}finally{s.close(),i.clear()}if(null==o)return sr.error("received invalid message");const c=n.remotePeer;if(t.components.peerId.equals(c))sr("received push from ourselves?");else{if(sr("received push from %p",c),null!=o.signedPeerRecord){sr("received signedPeerRecord in push");try{const u=yield Us.openAndCertify(o.signedPeerRecord,bu.DOMAIN);if(yield t.components.peerStore.addressBook.consumePeerRecord(u))return sr("consumed signedPeerRecord sent in push"),void(yield t.components.peerStore.protoBook.set(c,o.protocols));sr("failed to consume signedPeerRecord sent in push")}catch(u){sr("received invalid envelope, discard it and fallback to listenAddrs is available",u)}}else sr("did not receive signedPeerRecord in push");try{yield t.components.peerStore.addressBook.set(c,o.listenAddrs.map(u=>at(u)))}catch(u){sr.error("received invalid addrs",u)}try{yield t.components.peerStore.protoBook.set(c,o.protocols)}catch(u){sr.error("received invalid protocols",u)}sr("handled push from %p",c)}})()}static getCleanMultiaddr(e){if(null!=e&&e.length>0)try{return at(e)}catch{}}}var ug,ho;!function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{!1!==s.lengthDelimited&&n.fork(),(!0===s.writeDefaults||""!==t.identifier)&&(n.uint32(10),n.string(t.identifier)),!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={identifier:""},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();o>>>3==1?s.identifier=t.string():t.skipType(7&o)}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(ug||(ug={})),function(r){let e;var s;let t,n;(s=e=r.StatusCode||(r.StatusCode={})).OK="OK",s.NOT_FOUND="NOT_FOUND",s.ERROR="ERROR",function(s){s[s.OK=0]="OK",s[s.NOT_FOUND=1]="NOT_FOUND",s[s.ERROR=2]="ERROR"}(t||(t={})),function(s){s.codec=()=>Cc(t)}(e=r.StatusCode||(r.StatusCode={})),r.codec=()=>(null==n&&(n=Rr((s,i,o={})=>{!1!==o.lengthDelimited&&i.fork(),(!0===o.writeDefaults||null!=s.status&&0!==t[s.status])&&(i.uint32(8),r.StatusCode.codec().encode(s.status,i)),(!0===o.writeDefaults||null!=s.data&&s.data.byteLength>0)&&(i.uint32(18),i.bytes(s.data)),!1!==o.lengthDelimited&&i.ldelim()},(s,i)=>{const o={status:e.OK,data:new Uint8Array(0)},a=null==i?s.len:s.pos+i;for(;s.pos<a;){const c=s.uint32();switch(c>>>3){case 1:o.status=r.StatusCode.codec().decode(s);break;case 2:o.data=s.bytes();break;default:s.skipType(7&c)}}return o})),n),r.encode=s=>Ir(s,r.codec()),r.decode=s=>Cr(s,r.codec())}(ho||(ho={}));const y$=Be("libp2p:fetch");class F$e{constructor(e,t){var n;this.started=!1,this.components=e,this.protocol=`/${null!==(n=t.protocolPrefix)&&void 0!==n?n:"libp2p"}/fetch/0.0.1`,this.lookupFunctions=new Map,this.handleMessage=this.handleMessage.bind(this),this.init=t}start(){var e=this;return(0,B.Z)(function*(){yield e.components.registrar.handle(e.protocol,t=>{e.handleMessage(t).catch(n=>{y$.error(n)}).finally(()=>{t.stream.close()})},{maxInboundStreams:e.init.maxInboundStreams,maxOutboundStreams:e.init.maxOutboundStreams}),e.started=!0})()}stop(){var e=this;return(0,B.Z)(function*(){yield e.components.registrar.unhandle(e.protocol),e.started=!1})()}isStarted(){return this.started}fetch(e,t,n={}){var s=this;return(0,B.Z)(function*(){y$("dialing %s to %p",s.protocol,e);const i=yield s.components.connectionManager.openConnection(e,n);let o,c,a=n.signal;if(null==a){o=new Ar.TimeoutController(s.init.timeout),a=o.signal;try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,o.signal)}catch{}}try{c=yield i.newStream([s.protocol],{signal:a});const u=oo(c,a),f=yield _t([ug.encode({identifier:t})],ei(),u,Fs(),function(){var E=(0,B.Z)(function*(T){const U=yield Ni(T);if(null==U)throw ee(new Error("No data received"),Ie.ERR_INVALID_MESSAGE);const b=ho.decode(U);switch(b.status){case ho.StatusCode.OK:return b.data;case ho.StatusCode.NOT_FOUND:return null;case ho.StatusCode.ERROR:{const P=(new TextDecoder).decode(b.data);throw ee(new Error("Error in fetch protocol response: "+P),Ie.ERR_INVALID_PARAMETERS)}default:throw ee(new Error("Unknown response status"),Ie.ERR_INVALID_MESSAGE)}});return function(T){return E.apply(this,arguments)}}());return f??null}finally{o?.clear(),c?.close()}})()}handleMessage(e){var t=this;return(0,B.Z)(function*(){const{stream:n}=e,s=t;yield _t(n,Fs(),function(){var i=Ee(function*(o){const a=yield X(Ni(o));if(null==a)throw ee(new Error("No data received"),Ie.ERR_INVALID_MESSAGE);const c=ug.decode(a);let u;const f=s._getLookupFunction(c.identifier);if(null!=f){const E=yield X(f(c.identifier));u=null!=E?{status:ho.StatusCode.OK,data:E}:{status:ho.StatusCode.NOT_FOUND,data:new Uint8Array(0)}}else{const E=(new TextEncoder).encode("No lookup function registered for key: "+c.identifier);u={status:ho.StatusCode.ERROR,data:E}}yield ho.encode(u)});return function(o){return i.apply(this,arguments)}}(),ei(),n)})()}_getLookupFunction(e){for(const t of this.lookupFunctions.keys())if(e.startsWith(t))return this.lookupFunctions.get(t)}registerLookupFunction(e,t){if(this.lookupFunctions.has(e))throw ee(new Error("Fetch protocol handler for key prefix '"+e+"' already registered"),Ie.ERR_KEY_ALREADY_EXISTS);this.lookupFunctions.set(e,t)}unregisterLookupFunction(e,t){null!=t&&this.lookupFunctions.get(e)!==t||this.lookupFunctions.delete(e)}}const g$=Be("libp2p:ping");class K$e{constructor(e,t){this.components=e,this.started=!1,this.protocol=`/${t.protocolPrefix}/ping/1.0.0`,this.init=t}start(){var e=this;return(0,B.Z)(function*(){yield e.components.registrar.handle(e.protocol,e.handleMessage,{maxInboundStreams:e.init.maxInboundStreams,maxOutboundStreams:e.init.maxOutboundStreams}),e.started=!0})()}stop(){var e=this;return(0,B.Z)(function*(){yield e.components.registrar.unhandle(e.protocol),e.started=!1})()}isStarted(){return this.started}handleMessage(e){const{stream:t}=e;_t(t,t).catch(n=>{g$.error(n)})}ping(e,t={}){var n=this;return(0,B.Z)(function*(){g$("dialing %s to %p",n.protocol,e);const s=Date.now(),i=Rf(32),o=yield n.components.connectionManager.openConnection(e,t);let a,u,c=t.signal;if(null==c){a=new Ar.TimeoutController(n.init.timeout),c=a.signal;try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,a.signal)}catch{}}try{u=yield o.newStream([n.protocol],{signal:c});const f=oo(u,c),E=yield _t([i],f,function(){var U=(0,B.Z)(function*(b){return yield Ni(b)});return function(b){return U.apply(this,arguments)}}()),T=Date.now();if(null==E||!function z$e(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}(i,E.subarray()))throw ee(new Error("Received wrong ping ack"),Ie.ERR_WRONG_PING_ACK);return T-s}finally{a?.clear(),u?.close()}})()}}function RS(){return(RS=(0,B.Z)(function*(){throw new Error("Not supported in browsers")})).apply(this,arguments)}var H$e=p(96480);const OS="object"==typeof window&&"object"==typeof document&&9===document.nodeType,dg=H$e(),fg=OS&&!dg,G$e=dg&&!OS,W$e=dg&&OS,Y$e=typeof globalThis.process<"u"&&typeof globalThis.process.release<"u"&&"node"===globalThis.process.release.name&&!dg,b$="function"==typeof importScripts&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,Q$e=(typeof globalThis.process<"u"&&typeof globalThis.process.env<"u"&&globalThis,typeof navigator<"u"&&"ReactNative"===navigator.product);function X$e(r){const{address:e}=r.nodeAddress();return function J$e(r){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(r)||/^::1$/.test(r)}(e)}const PS=Be("libp2p:nat");function q$e(r=1024,e=65535){return Math.floor(Math.random()*(e-r+1)+r)}class eKe{constructor(e,t){var n,s,i;if(this.components=e,this.started=!1,this.enabled=t.enabled,this.externalAddress=t.externalAddress,this.localAddress=t.localAddress,this.description=null!==(n=t.description)&&void 0!==n?n:`libp2p@0.0.0 ${this.components.peerId.toString()}`,this.ttl=null!==(s=t.ttl)&&void 0!==s?s:7200,this.keepAlive=null===(i=t.keepAlive)||void 0===i||i,this.gateway=t.gateway,this.ttl<7200)throw ee(new Error("NatManager ttl should be at least 7200 seconds"),Ie.ERR_INVALID_PARAMETERS)}isStarted(){return this.started}start(){}afterStart(){fg||!this.enabled||this.started||(this.started=!0,this._start().catch(e=>{PS.error(e)}))}_start(){var e=this;return(0,B.Z)(function*(){const t=e.components.transportManager.getAddrs();for(const s of t){var n;const{family:i,host:o,port:a,transport:c}=s.toOptions();if(!s.isThinWaistAddress()||"tcp"!==c||X$e(s)||4!==i)continue;const u=yield e._getClient(),f=null!==(n=e.externalAddress)&&void 0!==n?n:yield u.externalIp();if(ig(f))throw new Error(`${f} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);const E=q$e();PS(`opening uPnP connection from ${f}:${E} to ${o}:${a}`),yield u.map({publicPort:E,localPort:a,localAddress:e.localAddress,protocol:"TCP"===c.toUpperCase()?"TCP":"UDP"}),e.components.addressManager.addObservedAddr(jre({family:4,address:f,port:E},c))}})()}_getClient(){var e=this;return(0,B.Z)(function*(){return null!=e.client||(e.client=yield function Z$e(){return RS.apply(this,arguments)}({description:e.description,ttl:e.ttl,keepAlive:e.keepAlive,gateway:e.gateway})),e.client})()}stop(){var e=this;return(0,B.Z)(function*(){if(!fg&&null!=e.client)try{yield e.client.close(),e.client=void 0}catch(t){PS.error(t)}})()}}const tKe=Be("libp2p:peer-record-updater");class rKe{constructor(e){this.components=e,this.started=!1,this.update=this.update.bind(this)}isStarted(){return this.started}start(){var e=this;return(0,B.Z)(function*(){e.started=!0,e.components.transportManager.addEventListener("listener:listening",e.update),e.components.transportManager.addEventListener("listener:close",e.update),e.components.addressManager.addEventListener("change:addresses",e.update)})()}stop(){var e=this;return(0,B.Z)(function*(){e.started=!1,e.components.transportManager.removeEventListener("listener:listening",e.update),e.components.transportManager.removeEventListener("listener:close",e.update),e.components.addressManager.removeEventListener("change:addresses",e.update)})()}update(){var e=this;Promise.resolve().then((0,B.Z)(function*(){const t=new bu({peerId:e.components.peerId,multiaddrs:e.components.addressManager.getAddresses().map(s=>s.decapsulateCode(jr("p2p").code))}),n=yield Us.seal(t,e.components.peerId);yield e.components.peerStore.addressBook.consumePeerRecord(n)})).catch(t=>{tKe.error("Could not update self peer record: %o",t)})}}class nKe{constructor(e){this.dht=e}findPeer(e,t={}){var n=this;return(0,B.Z)(function*(){var o,s=!1,i=!1;try{for(var c,a=be(n.dht.findPeer(e,t));s=!(c=yield a.next()).done;s=!1){const u=c.value;if("FINAL_PEER"===u.name)return u.peer}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield a.return())}finally{if(i)throw o}}throw ee(new Error(Ut.NOT_FOUND),Ie.ERR_NOT_FOUND)})()}getClosestPeers(e,t={}){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(n.dht.getClosestPeers(e,t));s=!(c=yield X(a.next())).done;s=!1){const u=c.value;"FINAL_PEER"===u.name&&(yield u.peer)}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()}}var sKe=p(47286),iKe=p(52107),oKe=p(45156),aKe=p(66499);const Jt=Be("libp2p:peer-store:address-book"),hg="change:multiaddrs";function cKe(){return BS.apply(this,arguments)}function BS(){return(BS=(0,B.Z)(function*(){return!0})).apply(this,arguments)}class lKe{constructor(e,t,n){this.dispatchEvent=e,this.store=t,this.addressFilter=n??cKe}consumePeerRecord(e){var t=this;return(0,B.Z)(function*(){Jt.trace("consumePeerRecord await write lock");const n=yield t.store.lock.writeLock();let s,i,o;Jt.trace("consumePeerRecord got write lock");try{let a;try{a=bu.createFromProtobuf(e.payload)}catch{return Jt.error("invalid peer record received"),!1}s=a.peerId;const c=a.multiaddrs;if(!s.equals(e.peerId))return Jt("signing key does not match PeerId in the PeerRecord"),!1;if(null==c||0===c.length)return!1;if((yield t.store.has(s))&&(i=yield t.store.load(s),null!=i.peerRecordEnvelope)){const f=yield Us.createFromProtobuf(i.peerRecordEnvelope),E=bu.createFromProtobuf(f.payload);if(E.seqNumber>=a.seqNumber)return Jt("sequence number was lower or equal to existing sequence number - stored: %d received: %d",E.seqNumber,a.seqNumber),!1}const u=yield LS(s,c,t.addressFilter,!0);o=yield t.store.patchOrCreate(s,{addresses:u,peerRecordEnvelope:e.marshal().subarray()}),Jt("stored provided peer record for %p",a.peerId)}finally{Jt.trace("consumePeerRecord release write lock"),n()}return t.dispatchEvent(new Qe(hg,{detail:{peerId:s,multiaddrs:o.addresses.map(({multiaddr:a})=>a),oldMultiaddrs:null==i?[]:i.addresses.map(({multiaddr:a})=>a)}})),!0})()}getRawEnvelope(e){var t=this;return(0,B.Z)(function*(){Jt.trace("getRawEnvelope await read lock");const n=yield t.store.lock.readLock();Jt.trace("getRawEnvelope got read lock");try{return(yield t.store.load(e)).peerRecordEnvelope}catch(s){if("ERR_NOT_FOUND"!==s.code)throw s}finally{Jt.trace("getRawEnvelope release read lock"),n()}})()}getPeerRecord(e){var t=this;return(0,B.Z)(function*(){const n=yield t.getRawEnvelope(e);if(null!=n)return yield Us.createFromProtobuf(n)})()}get(e){var t=this;return(0,B.Z)(function*(){e=Sn(e),Jt.trace("get wait for read lock");const n=yield t.store.lock.readLock();Jt.trace("get got read lock");try{return(yield t.store.load(e)).addresses}catch(s){if("ERR_NOT_FOUND"!==s.code)throw s}finally{Jt.trace("get release read lock"),n()}return[]})()}set(e,t){var n=this;return(0,B.Z)(function*(){if(e=Sn(e),!Array.isArray(t))throw Jt.error("multiaddrs must be an array of Multiaddrs"),ee(new Error("multiaddrs must be an array of Multiaddrs"),"ERR_INVALID_PARAMETERS");Jt.trace("set await write lock");const s=yield n.store.lock.writeLock();Jt.trace("set got write lock");let o,a,i=!1;try{const c=yield LS(e,t,n.addressFilter);if(0===c.length)return;try{if(o=yield n.store.load(e),i=!0,new Set([...c.map(({multiaddr:u})=>u.toString()),...o.addresses.map(({multiaddr:u})=>u.toString())]).size===o.addresses.length&&c.length===o.addresses.length)return}catch(u){if("ERR_NOT_FOUND"!==u.code)throw u}a=yield n.store.patchOrCreate(e,{addresses:c}),Jt("set multiaddrs for %p",e)}finally{Jt.trace("set multiaddrs for %p",e),Jt("set release write lock"),s()}n.dispatchEvent(new Qe(hg,{detail:{peerId:e,multiaddrs:a.addresses.map(c=>c.multiaddr),oldMultiaddrs:null==o?[]:o.addresses.map(({multiaddr:c})=>c)}})),i||n.dispatchEvent(new Qe("peer",{detail:{id:e,multiaddrs:a.addresses.map(c=>c.multiaddr),protocols:a.protocols}}))})()}add(e,t){var n=this;return(0,B.Z)(function*(){if(e=Sn(e),!Array.isArray(t))throw Jt.error("multiaddrs must be an array of Multiaddrs"),ee(new Error("multiaddrs must be an array of Multiaddrs"),"ERR_INVALID_PARAMETERS");Jt.trace("add await write lock");const s=yield n.store.lock.writeLock();let i,o,a;Jt.trace("add got write lock");try{const c=yield LS(e,t,n.addressFilter);if(0===c.length)return;try{if(o=yield n.store.load(e),i=!0,new Set([...c.map(({multiaddr:u})=>u.toString()),...o.addresses.map(({multiaddr:u})=>u.toString())]).size===o.addresses.length)return}catch(u){if("ERR_NOT_FOUND"!==u.code)throw u}a=yield n.store.mergeOrCreate(e,{addresses:c}),Jt("added multiaddrs for %p",e)}finally{Jt.trace("set release write lock"),s()}n.dispatchEvent(new Qe(hg,{detail:{peerId:e,multiaddrs:a.addresses.map(c=>c.multiaddr),oldMultiaddrs:null==o?[]:o.addresses.map(({multiaddr:c})=>c)}})),!0===i&&n.dispatchEvent(new Qe("peer",{detail:{id:e,multiaddrs:a.addresses.map(c=>c.multiaddr),protocols:a.protocols}}))})()}delete(e){var t=this;return(0,B.Z)(function*(){e=Sn(e),Jt.trace("delete await write lock");const n=yield t.store.lock.writeLock();let s;Jt.trace("delete got write lock");try{try{s=yield t.store.load(e)}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i}yield t.store.patchOrCreate(e,{addresses:[]})}finally{Jt.trace("delete release write lock"),n()}null!=s&&t.dispatchEvent(new Qe(hg,{detail:{peerId:e,multiaddrs:[],oldMultiaddrs:null==s?[]:s.addresses.map(({multiaddr:i})=>i)}}))})()}}function LS(r,e,t){return kS.apply(this,arguments)}function kS(){return kS=(0,B.Z)(function*(r,e,t,n=!1){return yield _t(e,s=>aKe(s,i=>{if(!Sl(i))throw Jt.error("multiaddr must be an instance of Multiaddr"),ee(new Error("multiaddr must be an instance of Multiaddr"),"ERR_INVALID_PARAMETERS")}),s=>iKe(s,function(){var i=(0,B.Z)(function*(o){return yield t(r,o)});return function(o){return i.apply(this,arguments)}}()),s=>oKe(s,i=>({multiaddr:i,isCertified:n})),function(){var s=(0,B.Z)(function*(i){return yield sKe(i)});return function(i){return s.apply(this,arguments)}}())}),kS.apply(this,arguments)}function US(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}const po=Be("libp2p:peer-store:key-book"),_$="change:pubkey";class uKe{constructor(e,t){this.dispatchEvent=e,this.store=t}set(e,t){var n=this;return(0,B.Z)(function*(){if(e=Sn(e),!(t instanceof Uint8Array))throw po.error("publicKey must be an instance of Uint8Array to store data"),ee(new Error("publicKey must be an instance of PublicKey"),"ERR_INVALID_PARAMETERS");po.trace("set await write lock");const s=yield n.store.lock.writeLock();po.trace("set got write lock");let o,i=!1;try{try{if(o=yield n.store.load(e),null!=o.pubKey&&US(o.pubKey,t))return}catch(a){if("ERR_NOT_FOUND"!==a.code)throw a}yield n.store.patchOrCreate(e,{pubKey:t}),i=!0}finally{po.trace("set release write lock"),s()}i&&n.dispatchEvent(new Qe(_$,{detail:{peerId:e,publicKey:t,oldPublicKey:o?.pubKey}}))})()}get(e){var t=this;return(0,B.Z)(function*(){e=Sn(e),po.trace("get await write lock");const n=yield t.store.lock.readLock();po.trace("get got write lock");try{return(yield t.store.load(e)).pubKey}catch(s){if("ERR_NOT_FOUND"!==s.code)throw s}finally{po("get release write lock"),n()}})()}delete(e){var t=this;return(0,B.Z)(function*(){e=Sn(e),po.trace("delete await write lock");const n=yield t.store.lock.writeLock();let s;po.trace("delete got write lock");try{try{s=yield t.store.load(e)}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i}yield t.store.patchOrCreate(e,{pubKey:void 0})}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i}finally{po.trace("delete release write lock"),n()}t.dispatchEvent(new Qe(_$,{detail:{peerId:e,publicKey:void 0,oldPublicKey:s?.pubKey}}))})()}}const Qr=Be("libp2p:peer-store:metadata-book"),pg="change:metadata";class dKe{constructor(e,t){this.dispatchEvent=e,this.store=t}get(e){var t=this;return(0,B.Z)(function*(){e=Sn(e),Qr.trace("get await read lock");const n=yield t.store.lock.readLock();Qr.trace("get got read lock");try{return(yield t.store.load(e)).metadata}catch(s){if("ERR_NOT_FOUND"!==s.code)throw s}finally{Qr.trace("get release read lock"),n()}return new Map})()}getValue(e,t){var n=this;return(0,B.Z)(function*(){e=Sn(e),Qr.trace("getValue await read lock");const s=yield n.store.lock.readLock();Qr.trace("getValue got read lock");try{return(yield n.store.load(e)).metadata.get(t)}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i}finally{Qr.trace("getValue release write lock"),s()}})()}set(e,t){var n=this;return(0,B.Z)(function*(){if(e=Sn(e),!(t instanceof Map))throw Qr.error("valid metadata must be provided to store data"),ee(new Error("valid metadata must be provided"),"ERR_INVALID_PARAMETERS");Qr.trace("set await write lock");const s=yield n.store.lock.writeLock();let i;Qr.trace("set got write lock");try{try{i=yield n.store.load(e)}catch(o){if("ERR_NOT_FOUND"!==o.code)throw o}yield n.store.mergeOrCreate(e,{metadata:t})}finally{Qr.trace("set release write lock"),s()}n.dispatchEvent(new Qe(pg,{detail:{peerId:e,metadata:t,oldMetadata:null==i?new Map:i.metadata}}))})()}setValue(e,t,n){var s=this;return(0,B.Z)(function*(){if(e=Sn(e),"string"!=typeof t||!(n instanceof Uint8Array))throw Qr.error("valid key and value must be provided to store data"),ee(new Error("valid key and value must be provided"),"ERR_INVALID_PARAMETERS");Qr.trace("setValue await write lock");const i=yield s.store.lock.writeLock();let o,a;Qr.trace("setValue got write lock");try{try{o=yield s.store.load(e);const c=o.metadata.get(t);if(null!=c&&US(n,c))return}catch(c){if("ERR_NOT_FOUND"!==c.code)throw c}a=yield s.store.mergeOrCreate(e,{metadata:new Map([[t,n]])})}finally{Qr.trace("setValue release write lock"),i()}s.dispatchEvent(new Qe(pg,{detail:{peerId:e,metadata:a.metadata,oldMetadata:null==o?new Map:o.metadata}}))})()}delete(e){var t=this;return(0,B.Z)(function*(){e=Sn(e),Qr.trace("delete await write lock");const n=yield t.store.lock.writeLock();let s;Qr.trace("delete got write lock");try{try{s=yield t.store.load(e)}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i}null!=s&&(yield t.store.patch(e,{metadata:new Map}))}finally{Qr.trace("delete release write lock"),n()}null!=s&&t.dispatchEvent(new Qe(pg,{detail:{peerId:e,metadata:new Map,oldMetadata:s.metadata}}))})()}deleteValue(e,t){var n=this;return(0,B.Z)(function*(){e=Sn(e),Qr.trace("deleteValue await write lock");const s=yield n.store.lock.writeLock();let i,o;Qr.trace("deleteValue got write lock");try{o=yield n.store.load(e),i=o.metadata,i.delete(t),yield n.store.patch(e,{metadata:i})}catch(a){if("ERR_NOT_FOUND"!==a.code)throw a}finally{Qr.trace("deleteValue release write lock"),s()}null!=i&&n.dispatchEvent(new Qe(pg,{detail:{peerId:e,metadata:i,oldMetadata:null==o?new Map:o.metadata}}))})()}}const Jr=Be("libp2p:peer-store:proto-book"),yg="change:protocols";class fKe{constructor(e,t){this.dispatchEvent=e,this.store=t}get(e){var t=this;return(0,B.Z)(function*(){Jr.trace("get wait for read lock");const n=yield t.store.lock.readLock();Jr.trace("get got read lock");try{return(yield t.store.load(e)).protocols}catch(s){if("ERR_NOT_FOUND"!==s.code)throw s}finally{Jr.trace("get release read lock"),n()}return[]})()}set(e,t){var n=this;return(0,B.Z)(function*(){if(e=Sn(e),!Array.isArray(t))throw Jr.error("protocols must be provided to store data"),ee(new Error("protocols must be provided"),"ERR_INVALID_PARAMETERS");Jr.trace("set await write lock");const s=yield n.store.lock.writeLock();let i,o;Jr.trace("set got write lock");try{try{if(i=yield n.store.load(e),new Set([...t]).size===i.protocols.length)return}catch(a){if("ERR_NOT_FOUND"!==a.code)throw a}o=yield n.store.patchOrCreate(e,{protocols:t}),Jr("stored provided protocols for %p",e)}finally{Jr.trace("set release write lock"),s()}n.dispatchEvent(new Qe(yg,{detail:{peerId:e,protocols:o.protocols,oldProtocols:null==i?[]:i.protocols}}))})()}add(e,t){var n=this;return(0,B.Z)(function*(){if(e=Sn(e),!Array.isArray(t))throw Jr.error("protocols must be provided to store data"),ee(new Error("protocols must be provided"),"ERR_INVALID_PARAMETERS");Jr.trace("add await write lock");const s=yield n.store.lock.writeLock();let i,o;Jr.trace("add got write lock");try{try{if(i=yield n.store.load(e),new Set([...i.protocols,...t]).size===i.protocols.length)return}catch(a){if("ERR_NOT_FOUND"!==a.code)throw a}o=yield n.store.mergeOrCreate(e,{protocols:t}),Jr("added provided protocols for %p",e)}finally{Jr.trace("add release write lock"),s()}n.dispatchEvent(new Qe(yg,{detail:{peerId:e,protocols:o.protocols,oldProtocols:null==i?[]:i.protocols}}))})()}remove(e,t){var n=this;return(0,B.Z)(function*(){if(e=Sn(e),!Array.isArray(t))throw Jr.error("protocols must be provided to store data"),ee(new Error("protocols must be provided"),"ERR_INVALID_PARAMETERS");Jr.trace("remove await write lock");const s=yield n.store.lock.writeLock();let i,o;Jr.trace("remove got write lock");try{try{i=yield n.store.load(e);const a=new Set(i.protocols);for(const c of t)a.delete(c);if(i.protocols.length===a.size)return;t=Array.from(a)}catch(a){if("ERR_NOT_FOUND"!==a.code)throw a}o=yield n.store.patchOrCreate(e,{protocols:t})}finally{Jr.trace("remove release write lock"),s()}n.dispatchEvent(new Qe(yg,{detail:{peerId:e,protocols:o.protocols,oldProtocols:null==i?[]:i.protocols}}))})()}delete(e){var t=this;return(0,B.Z)(function*(){e=Sn(e),Jr.trace("delete await write lock");const n=yield t.store.lock.writeLock();let s;Jr.trace("delete got write lock");try{try{s=yield t.store.load(e)}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i}yield t.store.patchOrCreate(e,{protocols:[]})}finally{Jr.trace("delete release write lock"),n()}null!=s&&t.dispatchEvent(new Qe(yg,{detail:{peerId:e,protocols:[],oldProtocols:s.protocols}}))})()}}new Uint8Array(0);class pKe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class yKe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return m$(this,e)}}class gKe{constructor(e){this.decoders=e}or(e){return m$(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const m$=(r,e)=>new gKe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class bKe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new pKe(e,t,n),this.decoder=new yKe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const na=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>(({name:r,prefix:e,encode:t,decode:n})=>new bKe(r,e,t,n))({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),vKe=na({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});var gg,bg,_g;na({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),na({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),na({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),na({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),na({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),na({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),na({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),na({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{if(!1!==s.lengthDelimited&&n.fork(),null!=t.addresses)for(const i of t.addresses)n.uint32(10),bg.codec().encode(i,n,{writeDefaults:!0});if(null!=t.protocols)for(const i of t.protocols)n.uint32(18),n.string(i);if(null!=t.metadata)for(const i of t.metadata)n.uint32(26),_g.codec().encode(i,n,{writeDefaults:!0});null!=t.pubKey&&(n.uint32(34),n.bytes(t.pubKey)),null!=t.peerRecordEnvelope&&(n.uint32(42),n.bytes(t.peerRecordEnvelope)),!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={addresses:[],protocols:[],metadata:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();switch(o>>>3){case 1:s.addresses.push(bg.codec().decode(t,t.uint32()));break;case 2:s.protocols.push(t.string());break;case 3:s.metadata.push(_g.codec().decode(t,t.uint32()));break;case 4:s.pubKey=t.bytes();break;case 5:s.peerRecordEnvelope=t.bytes();break;default:t.skipType(7&o)}}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(gg||(gg={})),function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{!1!==s.lengthDelimited&&n.fork(),(!0===s.writeDefaults||null!=t.multiaddr&&t.multiaddr.byteLength>0)&&(n.uint32(10),n.bytes(t.multiaddr)),null!=t.isCertified&&(n.uint32(16),n.bool(t.isCertified)),!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={multiaddr:new Uint8Array(0)},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();switch(o>>>3){case 1:s.multiaddr=t.bytes();break;case 2:s.isCertified=t.bool();break;default:t.skipType(7&o)}}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(bg||(bg={})),function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{!1!==s.lengthDelimited&&n.fork(),(!0===s.writeDefaults||""!==t.key)&&(n.uint32(10),n.string(t.key)),(!0===s.writeDefaults||null!=t.value&&t.value.byteLength>0)&&(n.uint32(18),n.bytes(t.value)),!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={key:"",value:new Uint8Array(0)},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();switch(o>>>3){case 1:s.key=t.string();break;case 2:s.value=t.bytes();break;default:t.skipType(7&o)}}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(_g||(_g={}));const w$=Be("libp2p:peer-store:store"),E$="/peers/";class wKe{constructor(e){this.components=e,this.lock=$E({name:"peer-store",singleProcess:!0})}_peerIdToDatastoreKey(e){if(null==e.type)throw w$.error("peerId must be an instance of peer-id to store data"),ee(new Error("peerId must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");const t=e.toCID().toString();return new ft(`${E$}${t}`)}has(e){var t=this;return(0,B.Z)(function*(){return yield t.components.datastore.has(t._peerIdToDatastoreKey(e))})()}delete(e){var t=this;return(0,B.Z)(function*(){yield t.components.datastore.delete(t._peerIdToDatastoreKey(e))})()}load(e){var t=this;return(0,B.Z)(function*(){var n,s;const i=yield t.components.datastore.get(t._peerIdToDatastoreKey(e)),o=gg.decode(i),a=new Map;for(const c of o.metadata)a.set(c.key,c.value);return{...o,id:e,addresses:o.addresses.map(({multiaddr:c,isCertified:u})=>({multiaddr:at(c),isCertified:u??!1})),metadata:a,pubKey:null!==(n=o.pubKey)&&void 0!==n?n:void 0,peerRecordEnvelope:null!==(s=o.peerRecordEnvelope)&&void 0!==s?s:void 0}})()}save(e){var t=this;return(0,B.Z)(function*(){if(null!=e.pubKey&&null!=e.id.publicKey&&!US(e.pubKey,e.id.publicKey))throw w$.error("peer publicKey bytes do not match peer id publicKey bytes"),ee(new Error("publicKey bytes do not match peer id publicKey bytes"),"ERR_INVALID_PARAMETERS");const n=new Set,s=e.addresses.filter(a=>!n.has(a.multiaddr.toString())&&(n.add(a.multiaddr.toString()),!0)).sort((a,c)=>a.multiaddr.toString().localeCompare(c.multiaddr.toString())).map(({multiaddr:a,isCertified:c})=>({multiaddr:a.bytes,isCertified:c})),i=[];[...e.metadata.keys()].sort().forEach(a=>{const c=e.metadata.get(a);null!=c&&i.push({key:a,value:c})});const o=gg.encode({addresses:s,protocols:e.protocols.sort(),pubKey:e.pubKey,metadata:i,peerRecordEnvelope:e.peerRecordEnvelope});return yield t.components.datastore.put(t._peerIdToDatastoreKey(e.id),o.subarray()),yield t.load(e.id)})()}patch(e,t){var n=this;return(0,B.Z)(function*(){const s=yield n.load(e);return yield n._patch(e,t,s)})()}patchOrCreate(e,t){var n=this;return(0,B.Z)(function*(){let s;try{s=yield n.load(e)}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i;s={id:e,addresses:[],protocols:[],metadata:new Map}}return yield n._patch(e,t,s)})()}_patch(e,t,n){var s=this;return(0,B.Z)(function*(){return yield s.save({...n,...t,id:e})})()}merge(e,t){var n=this;return(0,B.Z)(function*(){const s=yield n.load(e);return yield n._merge(e,t,s)})()}mergeOrCreate(e,t){var n=this;return(0,B.Z)(function*(){let s;try{s=yield n.load(e)}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i;s={id:e,addresses:[],protocols:[],metadata:new Map}}return yield n._merge(e,t,s)})()}_merge(e,t,n){var s=this;return(0,B.Z)(function*(){var i,o,a,c,u,f,E,T,U;const b=new Map;return n.addresses.forEach(P=>{b.set(P.multiaddr.toString(),P.isCertified)}),(null!==(i=t.addresses)&&void 0!==i?i:[]).forEach(P=>{const F=P.multiaddr.toString(),H=Boolean(b.get(F))||P.isCertified;b.set(F,H)}),yield s.save({id:e,addresses:Array.from(b.entries()).map(([P,F])=>({multiaddr:at(P),isCertified:F})),protocols:Array.from(new Set([...null!==(o=n.protocols)&&void 0!==o?o:[],...null!==(a=t.protocols)&&void 0!==a?a:[]])),metadata:new Map([...null!==(c=null===(u=n.metadata)||void 0===u?void 0:u.entries())&&void 0!==c?c:[],...null!==(f=null===(E=t.metadata)||void 0===E?void 0:E.entries())&&void 0!==f?f:[]]),pubKey:null!==(T=t.pubKey)&&void 0!==T?T:n?.pubKey,peerRecordEnvelope:null!==(U=t.peerRecordEnvelope)&&void 0!==U?U:n?.peerRecordEnvelope})})()}all(){var e=this;return Ee(function*(){var s,t=!1,n=!1;try{for(var o,i=be(e.components.datastore.queryKeys({prefix:E$}));t=!(o=yield X(i.next())).done;t=!1){const c=o.value.toString().split("/")[2],u=vKe.decode(c);yield e.load(Ai(u))}}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield X(i.return()))}finally{if(n)throw s}}})()}}var uc,mg;!function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{if(!1!==s.lengthDelimited&&n.fork(),null!=t.tags)for(const i of t.tags)n.uint32(10),mg.codec().encode(i,n,{writeDefaults:!0});!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={tags:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();o>>>3==1?s.tags.push(mg.codec().decode(t,t.uint32())):t.skipType(7&o)}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(uc||(uc={})),function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{!1!==s.lengthDelimited&&n.fork(),(!0===s.writeDefaults||""!==t.name)&&(n.uint32(10),n.string(t.name)),null!=t.value&&(n.uint32(16),n.uint32(t.value)),null!=t.expiry&&(n.uint32(24),n.uint64(t.expiry)),!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={name:""},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();switch(o>>>3){case 1:s.name=t.string();break;case 2:s.value=t.uint32();break;case 3:s.expiry=t.uint64();break;default:t.skipType(7&o)}}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(mg||(mg={}));const gi=Be("libp2p:peer-store");class EKe extends wr{constructor(e,t={}){super(),this.components=e,this.store=new wKe(e),this.addressBook=new lKe(this.dispatchEvent.bind(this),this.store,t.addressFilter),this.keyBook=new uKe(this.dispatchEvent.bind(this),this.store),this.metadataBook=new dKe(this.dispatchEvent.bind(this),this.store),this.protoBook=new fKe(this.dispatchEvent.bind(this),this.store)}forEach(e){var t=this;return(0,B.Z)(function*(){gi.trace("getPeers await read lock");const n=yield t.store.lock.readLock();gi.trace("getPeers got read lock");try{var o,s=!1,i=!1;try{for(var c,a=be(t.store.all());s=!(c=yield a.next()).done;s=!1){const u=c.value;u.id.equals(t.components.peerId)||e(u)}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield a.return())}finally{if(i)throw o}}}finally{gi.trace("getPeers release read lock"),n()}})()}all(){var e=this;return(0,B.Z)(function*(){const t=[];return yield e.forEach(n=>{t.push(n)}),t})()}delete(e){var t=this;return(0,B.Z)(function*(){gi.trace("delete await write lock");const n=yield t.store.lock.writeLock();gi.trace("delete got write lock");try{yield t.store.delete(e)}finally{gi.trace("delete release write lock"),n()}})()}get(e){var t=this;return(0,B.Z)(function*(){gi.trace("get await read lock");const n=yield t.store.lock.readLock();gi.trace("get got read lock");try{return yield t.store.load(e)}finally{gi.trace("get release read lock"),n()}})()}has(e){var t=this;return(0,B.Z)(function*(){gi.trace("has await read lock");const n=yield t.store.lock.readLock();gi.trace("has got read lock");try{return yield t.store.has(e)}finally{gi.trace("has release read lock"),n()}})()}tagPeer(e,t,n={}){var s=this;return(0,B.Z)(function*(){var i,o;const a=null!==(i=n.value)&&void 0!==i?i:0,c=Math.round(a),u=null!==(o=n.ttl)&&void 0!==o?o:void 0;if(c!==a||c<0||c>100)throw ee(new Error("Tag value must be between 0-100"),"ERR_TAG_VALUE_OUT_OF_BOUNDS");const f=yield s.metadataBook.getValue(e,"tags");let E=[];null!=f&&(E=uc.decode(f).tags);for(const T of E)if(T.name===t)throw ee(new Error("Peer already tagged"),"ERR_DUPLICATE_TAG");E.push({name:t,value:c,expiry:null==u?void 0:BigInt(Date.now()+u)}),yield s.metadataBook.setValue(e,"tags",uc.encode({tags:E}).subarray())})()}unTagPeer(e,t){var n=this;return(0,B.Z)(function*(){const s=yield n.metadataBook.getValue(e,"tags");let i=[];null!=s&&(i=uc.decode(s).tags),i=i.filter(o=>o.name!==t),yield n.metadataBook.setValue(e,"tags",uc.encode({tags:i}).subarray())})()}getTags(e){var t=this;return(0,B.Z)(function*(){const n=yield t.metadataBook.getValue(e,"tags");let s=[];null!=n&&(s=uc.decode(n).tags);const i=BigInt(Date.now()),o=s.filter(a=>null==a.expiry||a.expiry>i);return o.length!==s.length&&(yield t.metadataBook.setValue(e,"tags",uc.encode({tags:o}).subarray())),o.map(a=>{var c;return{name:a.name,value:null!==(c=a.value)&&void 0!==c?c:0}})})()}}class xKe{constructor(e){this.dht=e}provide(e){var t=this;return(0,B.Z)(function*(){yield Oi(t.dht.provide(e))})()}findProviders(e,t={}){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(n.dht.findProviders(e,t));s=!(c=yield X(a.next())).done;s=!1){const u=c.value;"PROVIDER"===u.name&&(yield*Fe(be(u.providers),X))}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()}put(e,t,n){var s=this;return(0,B.Z)(function*(){yield Oi(s.dht.put(e,t,n))})()}get(e,t){var n=this;return(0,B.Z)(function*(){var o,s=!1,i=!1;try{for(var c,a=be(n.dht.get(e,t));s=!(c=yield a.next()).done;s=!1){const u=c.value;if("VALUE"===u.name)return u.value}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield a.return())}finally{if(i)throw o}}throw ee(new Error("Not found"),"ERR_NOT_FOUND")})()}}class SKe{constructor(e={}){this._started=!1,this._peerId=e.peerId,this._addressManager=e.addressManager,this._peerStore=e.peerStore,this._upgrader=e.upgrader,this._metrics=e.metrics,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._connectionGater=e.connectionGater,this._contentRouting=e.contentRouting,this._peerRouting=e.peerRouting,this._datastore=e.datastore,this._connectionProtector=e.connectionProtector,this._dht=e.dht,this._pubsub=e.pubsub,this._dialer=e.dialer}isStarted(){return this._started}beforeStart(){var e=this;return(0,B.Z)(function*(){yield Promise.all(Object.values(e).filter(t=>Ds(t)).map(function(){var t=(0,B.Z)(function*(n){null!=n.beforeStart&&(yield n.beforeStart())});return function(n){return t.apply(this,arguments)}}()))})()}start(){var e=this;return(0,B.Z)(function*(){yield Promise.all(Object.values(e).filter(t=>Ds(t)).map(function(){var t=(0,B.Z)(function*(n){yield n.start()});return function(n){return t.apply(this,arguments)}}())),e._started=!0})()}afterStart(){var e=this;return(0,B.Z)(function*(){yield Promise.all(Object.values(e).filter(t=>Ds(t)).map(function(){var t=(0,B.Z)(function*(n){null!=n.afterStart&&(yield n.afterStart())});return function(n){return t.apply(this,arguments)}}()))})()}beforeStop(){var e=this;return(0,B.Z)(function*(){yield Promise.all(Object.values(e).filter(t=>Ds(t)).map(function(){var t=(0,B.Z)(function*(n){null!=n.beforeStop&&(yield n.beforeStop())});return function(n){return t.apply(this,arguments)}}()))})()}stop(){var e=this;return(0,B.Z)(function*(){yield Promise.all(Object.values(e).filter(t=>Ds(t)).map(function(){var t=(0,B.Z)(function*(n){yield n.stop()});return function(n){return t.apply(this,arguments)}}())),e._started=!1})()}afterStop(){var e=this;return(0,B.Z)(function*(){yield Promise.all(Object.values(e).filter(t=>Ds(t)).map(function(){var t=(0,B.Z)(function*(n){null!=n.afterStop&&(yield n.afterStop())});return function(n){return t.apply(this,arguments)}}()))})()}get peerId(){if(null==this._peerId)throw ee(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this._peerId}set peerId(e){this._peerId=e}get addressManager(){if(null==this._addressManager)throw ee(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this._addressManager}set addressManager(e){this._addressManager=e}get peerStore(){if(null==this._peerStore)throw ee(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this._peerStore}set peerStore(e){this._peerStore=e}get upgrader(){if(null==this._upgrader)throw ee(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this._upgrader}set upgrader(e){this._upgrader=e}get registrar(){if(null==this._registrar)throw ee(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this._registrar}set registrar(e){this._registrar=e}get connectionManager(){if(null==this._connectionManager)throw ee(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this._connectionManager}set connectionManager(e){this._connectionManager=e}get transportManager(){if(null==this._transportManager)throw ee(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this._transportManager}set transportManager(e){this._transportManager=e}get connectionGater(){if(null==this._connectionGater)throw ee(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this._connectionGater}set connectionGater(e){this._connectionGater=e}get contentRouting(){if(null==this._contentRouting)throw ee(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this._contentRouting}set contentRouting(e){this._contentRouting=e}get peerRouting(){if(null==this._peerRouting)throw ee(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this._peerRouting}set peerRouting(e){this._peerRouting=e}get datastore(){if(null==this._datastore)throw ee(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this._datastore}set datastore(e){this._datastore=e}get connectionProtector(){return this._connectionProtector}set connectionProtector(e){this._connectionProtector=e}get dialer(){if(null==this._dialer)throw ee(new Error("dialer not set"),"ERR_SERVICE_MISSING");return this._dialer}set dialer(e){this._dialer=e}get metrics(){return this._metrics}set metrics(e){this._metrics=e}get dht(){return this._dht}set dht(e){this._dht=e}get pubsub(){return this._pubsub}set pubsub(e){this._pubsub=e}}var x$=p(63389);const AKe=globalThis.fetch,TKe=globalThis.Headers;function MS(r,e,t){return`${r}?name=${e}&type=${t}`}function CKe(r,e){return FS.apply(this,arguments)}function FS(){return FS=(0,B.Z)(function*(r,e){return yield(yield AKe(r,{headers:new TKe({accept:"application/dns-json"}),signal:e})).json()}),FS.apply(this,arguments)}function Ou(r,e){return`${e}_${r}`}globalThis,globalThis;const zS=Object.assign(Br("dns-over-http-resolver"),{error:Br("dns-over-http-resolver:error")}),RKe=class IKe{constructor(e={}){var t,n,s;this._cache=new x$({max:null!==(t=e?.maxCache)&&void 0!==t?t:100}),this._TXTcache=new x$({max:null!==(n=e?.maxCache)&&void 0!==n?n:100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=null!==(s=e.request)&&void 0!==s?s:CKe,this._abortControllers=[]}cancel(){this._abortControllers.forEach(e=>e.abort())}getServers(){return this._servers}_getShuffledServers(){const e=[...this._servers];for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*t),s=e[t];e[t]=e[n],e[n]=s}return e}setServers(e){this._servers=e}resolve(e,t="A"){var n=this;return(0,B.Z)(function*(){switch(t){case"A":return yield n.resolve4(e);case"AAAA":return yield n.resolve6(e);case"TXT":return yield n.resolveTxt(e);default:throw new Error(`${t} is not supported`)}})()}resolve4(e){var t=this;return(0,B.Z)(function*(){const s=t._cache.get(Ou(e,"A"));if(null!=s)return s;let i=!1;for(const o of t._getShuffledServers()){const a=new AbortController;t._abortControllers.push(a);try{const c=yield t._request(MS(o,e,"A"),a.signal),u=c.Answer.map(E=>E.data),f=Math.min(...c.Answer.map(E=>E.TTL));return t._cache.set(Ou(e,"A"),u,{ttl:f}),u}catch{a.signal.aborted&&(i=!0),zS.error(`${o} could not resolve ${e} record A`)}finally{t._abortControllers=t._abortControllers.filter(c=>c!==a)}}throw i?Object.assign(new Error("queryA ECANCELLED"),{code:"ECANCELLED"}):new Error(`Could not resolve ${e} record A`)})()}resolve6(e){var t=this;return(0,B.Z)(function*(){const n="AAAA",s=t._cache.get(Ou(e,n));if(null!=s)return s;let i=!1;for(const o of t._getShuffledServers()){const a=new AbortController;t._abortControllers.push(a);try{const c=yield t._request(MS(o,e,n),a.signal),u=c.Answer.map(E=>E.data),f=Math.min(...c.Answer.map(E=>E.TTL));return t._cache.set(Ou(e,n),u,{ttl:f}),u}catch{a.signal.aborted&&(i=!0),zS.error(`${o} could not resolve ${e} record AAAA`)}finally{t._abortControllers=t._abortControllers.filter(c=>c!==a)}}throw i?Object.assign(new Error("queryAaaa ECANCELLED"),{code:"ECANCELLED"}):new Error(`Could not resolve ${e} record AAAA`)})()}resolveTxt(e){var t=this;return(0,B.Z)(function*(){const n="TXT",s=t._TXTcache.get(Ou(e,n));if(null!=s)return s;let i=!1;for(const o of t._getShuffledServers()){const a=new AbortController;t._abortControllers.push(a);try{const c=yield t._request(MS(o,e,n),a.signal),u=c.Answer.map(E=>[E.data.replace(/['"]+/g,"")]),f=Math.min(...c.Answer.map(E=>E.TTL));return t._TXTcache.set(Ou(e,n),u,{ttl:f}),u}catch{a.signal.aborted&&(i=!0),zS.error(`${o} could not resolve ${e} record TXT`)}finally{t._abortControllers=t._abortControllers.filter(c=>c!==a)}}throw i?Object.assign(new Error("queryTxt ECANCELLED"),{code:"ECANCELLED"}):new Error(`Could not resolve ${e} record TXT`)})()}clearCache(){this._cache.clear(),this._TXTcache.clear()}},{code:DKe}=jr("dnsaddr");function VS(){return VS=(0,B.Z)(function*(r,e={}){var t;const n=new RKe;null!=e.signal&&e.signal.addEventListener("abort",()=>{n.cancel()});const s=r.getPeerId(),[,i]=null!==(t=r.stringTuples().find(([c])=>c===DKe))&&void 0!==t?t:[];if(null==i)throw new Error("No hostname found in multiaddr");let a=(yield n.resolveTxt(`_dnsaddr.${i}`)).flat().map(c=>c.split("=")[1]);return null!=s&&(a=a.filter(c=>c.includes(s))),a}),VS.apply(this,arguments)}const PKe={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:r=>r},connectionManager:{maxConnections:300,minConnections:50,autoDial:!0,autoDialInterval:1e4,maxParallelDials:100,maxDialsPerPeer:4,dialTimeout:3e4,inboundUpgradeTimeout:3e4,resolvers:{dnsaddr:function OKe(r){return VS.apply(this,arguments)}},addressSorter:oS},connectionGater:{},transportManager:{faultTolerance:sl.FATAL_ALL},metrics:{enabled:!1,computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[6e4,3e5,9e5],maxOldPeersRetention:50},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0},relay:{enabled:!0,advertise:{bootDelay:9e5,enabled:!1,ttl:18e5},hop:{enabled:!1,active:!1,timeout:3e4},autoRelay:{enabled:!1,maxListeners:2}},identify:{protocolPrefix:"ipfs",host:{agentVersion:h$},timeout:6e4,maxInboundStreams:1,maxOutboundStreams:1,maxPushIncomingStreams:1,maxPushOutgoingStreams:1},ping:{protocolPrefix:"ipfs",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4},fetch:{protocolPrefix:"libp2p",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4}};function NKe(r){var e,t;const n=Sr(PKe,r);if(null==n.transports||n.transports.length<1)throw ee(new Error(Ut.ERR_TRANSPORTS_REQUIRED),Ie.ERR_TRANSPORTS_REQUIRED);if(null==n.connectionEncryption||0===n.connectionEncryption.length)throw ee(new Error(Ut.CONN_ENCRYPTION_REQUIRED),Ie.CONN_ENCRYPTION_REQUIRED);if(null===n.connectionProtector&&null!=(null===(e=globalThis.process)||void 0===e||null===(t=e.env)||void 0===t?void 0:t.LIBP2P_FORCE_PNET))throw ee(new Error(Ut.ERR_PROTECTOR_REQUIRED),Ie.ERR_PROTECTOR_REQUIRED);return n.identify.host.agentVersion===h$&&(Y$e||G$e?n.identify.host.agentVersion+=` UserAgent=${globalThis.process.version}`:(fg||b$||W$e||Q$e)&&(n.identify.host.agentVersion+=` UserAgent=${globalThis.navigator.userAgent}`)),n}const UKe=function BKe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},vg=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class VKe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class jKe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return S$(this,e)}}class $Ke{constructor(e){this.decoders=e}or(e){return S$(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const S$=(r,e)=>new $Ke({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class KKe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new VKe(e,t,n),this.decoder=new jKe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const wg=({name:r,prefix:e,encode:t,decode:n})=>new KKe(r,e,t,n),y0=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=UKe(t,e);return wg({prefix:r,name:e,encode:n,decode:i=>vg(s(i))})},Zn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>wg({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),GKe=wg({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),WKe=Zn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),YKe=Zn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),QKe=y0({prefix:"9",name:"base10",alphabet:"0123456789"}),JKe=Zn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),XKe=Zn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),qKe=Zn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),eZe=Zn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),tZe=Zn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),rZe=Zn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),nZe=Zn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),sZe=Zn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),iZe=Zn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),oZe=Zn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),aZe=Zn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),cZe=y0({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),lZe=y0({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),uZe=y0({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),dZe=y0({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),fZe=Zn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),hZe=Zn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),pZe=Zn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),yZe=Zn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),A$=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),gZe=A$.reduce((r,e,t)=>(r[t]=e,r),[]),bZe=A$.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),vZe=wg({prefix:"\u{1f680}",name:"base256emoji",encode:function _Ze(r){return r.reduce((e,t)=>e+gZe[t],"")},decode:function mZe(r){const e=[];for(const t of r){const n=bZe[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var SZe=Math.pow(2,31),CZe=Math.pow(2,7),IZe=Math.pow(2,14),RZe=Math.pow(2,21),DZe=Math.pow(2,28),OZe=Math.pow(2,35),PZe=Math.pow(2,42),NZe=Math.pow(2,49),BZe=Math.pow(2,56),LZe=Math.pow(2,63),UZe={encode:function C$(r,e,t){e=e||[];for(var n=t=t||0;r>=SZe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,C$.bytes=t-n+1,e},decode:function jS(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw jS.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return jS.bytes=i-n,t},encodingLength:function(r){return r<CZe?1:r<IZe?2:r<RZe?3:r<DZe?4:r<OZe?5:r<PZe?6:r<NZe?7:r<BZe?8:r<LZe?9:10}};const R$=UZe,D$=(r,e,t=0)=>(R$.encode(r,e,t),e),O$=r=>R$.encodingLength(r),$S=(r,e)=>{const t=e.byteLength,n=O$(r),s=n+O$(t),i=new Uint8Array(s+t);return D$(r,i,0),D$(t,i,n),i.set(e,s),new P$(r,t,e,i)};class P${constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const N$=({name:r,code:e,encode:t})=>new FZe(r,e,t);class FZe{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?$S(this.code,t):t.then(n=>$S(this.code,n))}throw Error("Unknown type, must be binary type")}}const B$=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),zZe=N$({name:"sha2-256",code:18,encode:B$("SHA-256")}),VZe=N$({name:"sha2-512",code:19,encode:B$("SHA-512")}),k$=vg,$Ze={code:0,name:"identity",encode:k$,digest:r=>$S(0,k$(r))},KZe="raw",ZZe=85,HZe=r=>vg(r),GZe=r=>vg(r),WZe=new TextEncoder,YZe=new TextDecoder,QZe="json",JZe=512,XZe=r=>WZe.encode(JSON.stringify(r)),qZe=r=>JSON.parse(YZe.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");function z$(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}z$("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),z$("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function aHe(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?function oHe(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e});var j$;!function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{!1!==s.lengthDelimited&&n.fork(),(!0===s.writeDefaults||null!=t.id&&t.id.byteLength>0)&&(n.uint32(10),n.bytes(t.id)),null!=t.pubKey&&(n.uint32(18),n.bytes(t.pubKey)),null!=t.privKey&&(n.uint32(26),n.bytes(t.privKey)),!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={id:new Uint8Array(0)},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();switch(o>>>3){case 1:s.id=t.bytes();break;case 2:s.pubKey=t.bytes();break;case 3:s.privKey=t.bytes();break;default:t.skipType(7&o)}}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(j$||(j$={}));const $$=function(){var r=(0,B.Z)(function*(){const e=yield N8("Ed25519"),t=yield GS(e);if("Ed25519"===t.type)return t;throw new Error(`Generated unexpected PeerId type "${t.type}"`)});return function(){return r.apply(this,arguments)}}(),cHe=function(){var r=(0,B.Z)(function*(e){var t;const n=yield N8("RSA",null!==(t=e?.bits)&&void 0!==t?t:2048),s=yield GS(n);if("RSA"===s.type)return s;throw new Error(`Generated unexpected PeerId type "${s.type}"`)});return function(t){return r.apply(this,arguments)}}();function GS(r){return WS.apply(this,arguments)}function WS(){return WS=(0,B.Z)(function*(r){return yield Ti(k8(r.public),Ede(r))}),WS.apply(this,arguments)}class dHe extends wr{get[Cu](){return!0}get[Symbol.toStringTag](){return"@libp2p/dummy-dht"}get wan(){throw ee(new Error(Ut.DHT_DISABLED),Ie.DHT_DISABLED)}get lan(){throw ee(new Error(Ut.DHT_DISABLED),Ie.DHT_DISABLED)}get(){throw ee(new Error(Ut.DHT_DISABLED),Ie.DHT_DISABLED)}findProviders(){throw ee(new Error(Ut.DHT_DISABLED),Ie.DHT_DISABLED)}findPeer(){throw ee(new Error(Ut.DHT_DISABLED),Ie.DHT_DISABLED)}getClosestPeers(){throw ee(new Error(Ut.DHT_DISABLED),Ie.DHT_DISABLED)}provide(){throw ee(new Error(Ut.DHT_DISABLED),Ie.DHT_DISABLED)}put(){throw ee(new Error(Ut.DHT_DISABLED),Ie.DHT_DISABLED)}getMode(){return(0,B.Z)(function*(){throw ee(new Error(Ut.DHT_DISABLED),Ie.DHT_DISABLED)})()}setMode(){return(0,B.Z)(function*(){throw ee(new Error(Ut.DHT_DISABLED),Ie.DHT_DISABLED)})()}refreshRoutingTable(){return(0,B.Z)(function*(){throw ee(new Error(Ut.DHT_DISABLED),Ie.DHT_DISABLED)})()}}class fHe extends wr{constructor(){super(...arguments),this.topicValidators=new Map}isStarted(){return!1}start(){}stop(){}get globalSignaturePolicy(){throw ee(new Error(Ut.PUBSUB_DISABLED),Ie.ERR_PUBSUB_DISABLED)}get multicodecs(){throw ee(new Error(Ut.PUBSUB_DISABLED),Ie.ERR_PUBSUB_DISABLED)}getPeers(){throw ee(new Error(Ut.PUBSUB_DISABLED),Ie.ERR_PUBSUB_DISABLED)}getTopics(){throw ee(new Error(Ut.PUBSUB_DISABLED),Ie.ERR_PUBSUB_DISABLED)}subscribe(){throw ee(new Error(Ut.PUBSUB_DISABLED),Ie.ERR_PUBSUB_DISABLED)}unsubscribe(){throw ee(new Error(Ut.PUBSUB_DISABLED),Ie.ERR_PUBSUB_DISABLED)}getSubscribers(){throw ee(new Error(Ut.PUBSUB_DISABLED),Ie.ERR_PUBSUB_DISABLED)}publish(){return(0,B.Z)(function*(){throw ee(new Error(Ut.PUBSUB_DISABLED),Ie.ERR_PUBSUB_DISABLED)})()}}class Pu extends Error{constructor(e="The operation was aborted"){super(e),this.code=Pu.code,this.type=Pu.type}static get code(){return"ABORT_ERR"}static get type(){return"aborted"}}var hHe=p(93037);const Z$=Be("libp2p:dialer:dial-request");class pHe{constructor(e){const{addrs:t,dialAction:n,dialer:s}=e;this.addrs=t,this.dialer=s,this.dialAction=n}run(e={}){var t=this;return(0,B.Z)(function*(){const n=t.dialer.getTokens(t.addrs.length);if(n.length<1)throw ee(new Error("No dial tokens available"),Ie.ERR_NO_DIAL_TOKENS);const s=new hHe;for(const c of n)s.push(c).catch(u=>{Z$.error(u)});const i=t.addrs.map(()=>{const c=new AbortController;try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,c.signal)}catch{}return c});if(null!=e.signal)try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,e.signal)}catch{}let o=0,a=!1;try{return yield Promise.any(t.addrs.map(function(){var c=(0,B.Z)(function*(u,f){const E=yield s.shift();if(a)throw t.dialer.releaseToken(n.splice(n.indexOf(E),1)[0]),ee(new Error("dialAction already succeeded"),Ie.ERR_ALREADY_SUCCEEDED);const T=i[f];if(null==T)throw ee(new Error("dialAction did not come with an AbortController"),Ie.ERR_INVALID_PARAMETERS);let U;try{const b=T.signal;U=yield t.dialAction(u,{...e,signal:null!=e.signal?(0,wn.anySignal)([b,e.signal]):b}),i[f]=void 0}finally{o++,t.addrs.length-o>=n.length?s.push(E).catch(b=>{Z$.error(b)}):t.dialer.releaseToken(n.splice(n.indexOf(E),1)[0])}if(null==U)throw ee(new Error("dialAction led to empty object"),Ie.ERR_TRANSPORT_DIAL_FAILED);return a=!0,U});return function(u,f){return c.apply(this,arguments)}}()))}finally{i.forEach(c=>{void 0!==c&&c.abort()}),n.forEach(c=>t.dialer.releaseToken(c))}})()}}const Mi=Be("libp2p:dialer"),H$="dialler";class bHe{constructor(e,t={}){var n,s,i,o,a;this.started=!1,this.addressSorter=null!==(n=t.addressSorter)&&void 0!==n?n:oS,this.maxAddrsToDial=null!==(s=t.maxAddrsToDial)&&void 0!==s?s:25,this.timeout=null!==(i=t.dialTimeout)&&void 0!==i?i:3e4,this.maxDialsPerPeer=null!==(o=t.maxDialsPerPeer)&&void 0!==o?o:4,this.tokens=[...new Array(null!==(a=t.maxParallelDials)&&void 0!==a?a:100)].map((u,f)=>f),this.components=e,this.pendingDials=rl({component:H$,metric:"pending-dials",metrics:t.metrics}),this.pendingDialTargets=rl({component:H$,metric:"pending-dial-targets",metrics:e.metrics});for(const[u,f]of Object.entries(null!==(c=t.resolvers)&&void 0!==c?c:{})){var c;zI.set(u,f)}}isStarted(){return this.started}start(){var e=this;return(0,B.Z)(function*(){e.started=!0})()}stop(){var e=this;return(0,B.Z)(function*(){e.started=!1;for(const t of e.pendingDials.values())try{t.controller.abort()}catch(n){Mi.error(n)}e.pendingDials.clear();for(const t of e.pendingDialTargets.values())t.reject(new Pu("Dialer was destroyed"));e.pendingDialTargets.clear()})()}dial(e,t={}){var n=this;return(0,B.Z)(function*(){var s;const{id:i,multiaddrs:o}=t0(e);if(n.components.peerId.equals(i))throw ee(new Error("Tried to dial self"),Ie.ERR_DIALED_SELF);if(Mi("check multiaddrs %p",i),null!=o&&o.length>0&&(Mi("storing multiaddrs %p",i,o),yield n.components.peerStore.addressBook.add(i,o)),yield n.components.connectionGater.denyDialPeer(i))throw ee(new Error("The dial request is blocked by gater.allowDialPeer"),Ie.ERR_PEER_DIAL_INTERCEPTED);Mi("creating dial target for %p",i);const a=yield n._createCancellableDialTarget(i,t);if(0===a.addrs.length)throw ee(new Error("The dial request has no valid addresses"),Ie.ERR_NO_VALID_ADDRESSES);const c=null!==(s=n.pendingDials.get(a.id))&&void 0!==s?s:n._createPendingDial(a,t);try{const u=yield c.promise;return Mi("dial succeeded to %s",a.id),u}catch(u){throw Mi("dial failed to %s",a.id,u),c.controller.signal.aborted&&(u.code=Ie.ERR_TIMEOUT),Mi.error(u),u}finally{c.destroy()}})()}_createCancellableDialTarget(e,t){var n=this;return(0,B.Z)(function*(){const s=`${parseInt(String(1e9*Math.random()),10).toString()}${Date.now()}`,i=new Promise((o,a)=>{n.pendingDialTargets.set(s,{resolve:o,reject:a})});try{return yield Promise.race([n._createDialTarget(e,t),i])}finally{n.pendingDialTargets.delete(s)}})()}_createDialTarget(e,t){var n=this;return(0,B.Z)(function*(){const s=n._resolve.bind(n),i=yield _t(yield n.components.peerStore.addressBook.get(e),o=>Js(o,function(){var a=(0,B.Z)(function*(c){return!(yield n.components.connectionGater.denyDialMultiaddr(e,c.multiaddr))});return function(c){return a.apply(this,arguments)}}()),o=>Fh(o,n.addressSorter),function(){var o=Ee(function*(c){var E,u=!1,f=!1;try{for(var U,T=be(c);u=!(U=yield X(T.next())).done;u=!1){const b=U.value;yield*Fe(be(yield X(s(b.multiaddr,t))),X)}}catch(b){f=!0,E=b}finally{try{u&&null!=T.return&&(yield X(T.return()))}finally{if(f)throw E}}});return function a(c){return o.apply(this,arguments)}}(),o=>Js(o,a=>Boolean(n.components.transportManager.transportForMultiaddr(a))),o=>os(o,a=>e.toString()===a.getPeerId()?a:a.encapsulate(`/p2p/${e.toString()}`)),function(){var o=(0,B.Z)(function*(a){return yield Bc(a)});return function(a){return o.apply(this,arguments)}}());if(i.length>n.maxAddrsToDial)throw yield n.components.peerStore.delete(e),ee(new Error("dial with more addresses than allowed"),Ie.ERR_TOO_MANY_ADDRESSES);return{id:e.toString(),addrs:i}})()}_createPendingDial(e,t={}){var n=this;const s=function(){var f=(0,B.Z)(function*(E,T={}){var U;if(!0===(null===(U=T.signal)||void 0===U?void 0:U.aborted))throw ee(new Error("already aborted"),Ie.ERR_ALREADY_ABORTED);return yield n.components.transportManager.dial(E,T).catch(b=>{throw Mi.error("dial to %s failed",E,b),b})});return function(T){return f.apply(this,arguments)}}(),i=new pHe({addrs:e.addrs,dialAction:s,dialer:this}),o=new Ar.TimeoutController(this.timeout),a=[o.signal];null!=t.signal&&a.push(t.signal);const c=(0,wn.anySignal)(a);try{null==rt.setMaxListeners||(0,rt.setMaxListeners)(1/0,c)}catch{}const u={dialRequest:i,controller:o,promise:i.run({...t,signal:c}),destroy:()=>{o.clear(),this.pendingDials.delete(e.id)}};return this.pendingDials.set(e.id,u),u}getTokens(e){const t=Math.min(e,this.maxDialsPerPeer,this.tokens.length),n=this.tokens.splice(0,t);return Mi("%d tokens request, returning %d, %d remaining",e,t,this.tokens.length),n}releaseToken(e){this.tokens.includes(e)||(Mi("token %d released",e),this.tokens.push(e))}_resolve(e,t){var n=this;return(0,B.Z)(function*(){if(!e.protoNames().includes("dnsaddr"))return[e];const i=yield n._resolveRecord(e,t);return(yield Promise.all(i.map(function(){var c=(0,B.Z)(function*(u){return yield n._resolve(u,t)});return function(u){return c.apply(this,arguments)}}()))).flat().reduce((c,u)=>(null==c.find(f=>f.equals(u))&&c.push(u),c),[])})()}_resolveRecord(e,t){return(0,B.Z)(function*(){try{return e=at(e.toString()),yield e.resolve(t)}catch(n){return Mi.error(`multiaddr ${e.toString()} could not be resolved`,n),[]}})()}}const sa=Be("libp2p");class _He extends wr{constructor(e){var t,n,s,i,o;super(),this.started=!1,this.peerId=e.peerId;const a=this.components=new SKe({peerId:e.peerId,datastore:null!==(t=e.datastore)&&void 0!==t?t:new Ihe,connectionGater:{denyDialPeer:(T=(0,B.Z)(function*(){return yield Promise.resolve(!1)}),function(){return T.apply(this,arguments)}),denyDialMultiaddr:function(){var T=(0,B.Z)(function*(){return yield Promise.resolve(!1)});return function(){return T.apply(this,arguments)}}(),denyInboundConnection:function(){var T=(0,B.Z)(function*(){return yield Promise.resolve(!1)});return function(){return T.apply(this,arguments)}}(),denyOutboundConnection:function(){var T=(0,B.Z)(function*(){return yield Promise.resolve(!1)});return function(){return T.apply(this,arguments)}}(),denyInboundEncryptedConnection:function(){var T=(0,B.Z)(function*(){return yield Promise.resolve(!1)});return function(){return T.apply(this,arguments)}}(),denyOutboundEncryptedConnection:function(){var T=(0,B.Z)(function*(){return yield Promise.resolve(!1)});return function(){return T.apply(this,arguments)}}(),denyInboundUpgradedConnection:function(){var T=(0,B.Z)(function*(){return yield Promise.resolve(!1)});return function(){return T.apply(this,arguments)}}(),denyOutboundUpgradedConnection:function(){var T=(0,B.Z)(function*(){return yield Promise.resolve(!1)});return function(){return T.apply(this,arguments)}}(),filterMultiaddrForPeer:function(){var T=(0,B.Z)(function*(){return yield Promise.resolve(!0)});return function(){return T.apply(this,arguments)}}(),...e.connectionGater}});var T;a.peerStore=new EKe(a,{addressFilter:this.components.connectionGater.filterMultiaddrForPeer,...e.peerStore}),this.services=[a],e.metrics.enabled&&(this.metrics=this.components.metrics=new NVe(e.metrics)),this.peerStore=this.components.peerStore,this.peerStore.addEventListener("peer",T=>{const{detail:U}=T;this.dispatchEvent(new Qe("peer:discovery",{detail:U}))}),null!=e.connectionProtector&&(this.components.connectionProtector=e.connectionProtector(a)),this.components.upgrader=new I$e(this.components,{connectionEncryption:(null!==(n=e.connectionEncryption)&&void 0!==n?n:[]).map(T=>this.configureComponent(T(this.components))),muxers:(null!==(s=e.streamMuxers)&&void 0!==s?s:[]).map(T=>this.configureComponent(T(this.components))),inboundUpgradeTimeout:e.connectionManager.inboundUpgradeTimeout}),this.components.dialer=new bHe(this.components,e.connectionManager),this.connectionManager=this.components.connectionManager=new OFe(this.components,e.connectionManager),this.registrar=this.components.registrar=new A$e(this.components),this.components.transportManager=new $Ve(this.components,e.transportManager),this.components.addressManager=new xFe(this.components,e.addresses),this.configureComponent(new rKe(this.components)),this.configureComponent(new NFe(this.components,{enabled:e.connectionManager.autoDial,minConnections:e.connectionManager.minConnections,autoDialInterval:e.connectionManager.autoDialInterval}));const c=Oj.generateOptions();this.keychain=this.configureComponent(new Oj(this.components,{...c,...e.keychain})),this.services.push(new eKe(this.components,e.nat)),e.transports.forEach(T=>{this.components.transportManager.add(this.configureComponent(T(this.components)))}),this.identifyService=new IS(this.components,{...e.identify}),this.configureComponent(this.identifyService),this.dht=null!=e.dht?this.components.dht=e.dht(this.components):new dHe,this.pubsub=null!=e.pubsub?this.components.pubsub=e.pubsub(this.components):new fHe;const u=(null!==(i=e.peerRouters)&&void 0!==i?i:[]).map(T=>this.configureComponent(T(this.components)));null!=e.dht&&(u.push(this.configureComponent(new nKe(this.dht))),this.dht.addEventListener("peer",T=>{this.onDiscoveryPeer(T)})),this.peerRouting=this.components.peerRouting=this.configureComponent(new mFe(this.components,{...e.peerRouting,routers:u}));const f=(null!==(o=e.contentRouters)&&void 0!==o?o:[]).map(T=>this.configureComponent(T(this.components)));null!=e.dht&&f.push(this.configureComponent(new xKe(this.dht))),this.contentRouting=this.components.contentRouting=this.configureComponent(new vFe(this.components,{routers:f})),e.relay.enabled&&(this.components.transportManager.add(this.configureComponent(new jFe(this.components,e.relay))),this.configureComponent(new vVe(this.components,{addressSorter:e.connectionManager.addressSorter,...e.relay}))),this.fetchService=this.configureComponent(new F$e(this.components,{...e.fetch})),this.pingService=this.configureComponent(new K$e(this.components,{...e.ping}));for(const T of null!==(E=e.peerDiscovery)&&void 0!==E?E:[]){var E;this.configureComponent(T(this.components)).addEventListener("peer",b=>{this.onDiscoveryPeer(b)})}}configureComponent(e){return Ds(e)&&this.services.push(e),e}start(){var e=this;return(0,B.Z)(function*(){if(!e.started){e.started=!0,sa("libp2p is starting");try{yield Promise.all(e.services.map(function(){var t=(0,B.Z)(function*(n){null!=n.beforeStart&&(yield n.beforeStart())});return function(n){return t.apply(this,arguments)}}())),yield Promise.all(e.services.map(t=>t.start())),yield Promise.all(e.services.map(function(){var t=(0,B.Z)(function*(n){null!=n.afterStart&&(yield n.afterStart())});return function(n){return t.apply(this,arguments)}}())),sa("libp2p has started")}catch(t){throw sa.error("An error occurred starting libp2p",t),yield e.stop(),t}}})()}stop(){var e=this;return(0,B.Z)(function*(){!e.started||(sa("libp2p is stopping"),e.started=!1,yield Promise.all(e.services.map(function(){var t=(0,B.Z)(function*(n){null!=n.beforeStop&&(yield n.beforeStop())});return function(n){return t.apply(this,arguments)}}())),yield Promise.all(e.services.map(t=>t.stop())),yield Promise.all(e.services.map(function(){var t=(0,B.Z)(function*(n){null!=n.afterStop&&(yield n.afterStop())});return function(n){return t.apply(this,arguments)}}())),sa("libp2p has stopped"))})()}isStarted(){return this.started}getConnections(e){return this.components.connectionManager.getConnections(e)}getPeers(){const e=new sc;for(const t of this.components.connectionManager.getConnections())e.add(t.remotePeer);return Array.from(e)}dial(e,t={}){var n=this;return(0,B.Z)(function*(){const{id:s,multiaddrs:i}=t0(e);return yield n.components.peerStore.addressBook.add(s,i),yield n.components.connectionManager.openConnection(s,t)})()}dialProtocol(e,t,n={}){var s=this;return(0,B.Z)(function*(){if(null==t)throw ee(new Error("no protocols were provided to open a stream"),Ie.ERR_INVALID_PROTOCOLS_FOR_STREAM);if(0===(t=Array.isArray(t)?t:[t]).length)throw ee(new Error("no protocols were provided to open a stream"),Ie.ERR_INVALID_PROTOCOLS_FOR_STREAM);return yield(yield s.dial(e,n)).newStream(t,n)})()}getMultiaddrs(){return this.components.addressManager.getAddresses()}hangUp(e){var t=this;return(0,B.Z)(function*(){const{id:n}=t0(e);yield t.components.connectionManager.closeConnections(n)})()}getPublicKey(e,t={}){var n=this;return(0,B.Z)(function*(){if(sa("getPublicKey %p",e),null!=e.publicKey)return e.publicKey;const s=yield n.peerStore.get(e);if(null!=s.pubKey)return s.pubKey;if(null==n.dht)throw ee(new Error("Public key was not in the peer store and the DHT is not enabled"),Ie.ERR_NO_ROUTERS_AVAILABLE);const i=function uHe(r,e){null==e&&(e=r.reduce((s,i)=>s+i.length,0));const t=_j(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return nS(t)}([rn("/pk/"),e.multihash.digest]);var c,o=!1,a=!1;try{for(var f,u=be(n.dht.get(i,t));o=!(f=yield u.next()).done;o=!1){const E=f.value;if("VALUE"===E.name){const T=Pc(E.value);return yield n.peerStore.keyBook.set(e,E.value),T.bytes}}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield u.return())}finally{if(a)throw c}}throw ee(new Error(`Node not responding with its public key: ${e.toString()}`),Ie.ERR_INVALID_RECORD)})()}fetch(e,t,n={}){var s=this;return(0,B.Z)(function*(){const{id:i,multiaddrs:o}=t0(e);return null!=o&&(yield s.components.peerStore.addressBook.add(i,o)),yield s.fetchService.fetch(i,t,n)})()}ping(e,t={}){var n=this;return(0,B.Z)(function*(){const{id:s,multiaddrs:i}=t0(e);return i.length>0&&(yield n.components.peerStore.addressBook.add(s,i)),yield n.pingService.ping(s,t)})()}handle(e,t,n){var s=this;return(0,B.Z)(function*(){Array.isArray(e)||(e=[e]),yield Promise.all(e.map(function(){var i=(0,B.Z)(function*(o){yield s.components.registrar.handle(o,t,n)});return function(o){return i.apply(this,arguments)}}()))})()}unhandle(e){var t=this;return(0,B.Z)(function*(){Array.isArray(e)||(e=[e]),yield Promise.all(e.map(function(){var n=(0,B.Z)(function*(s){yield t.components.registrar.unhandle(s)});return function(s){return n.apply(this,arguments)}}()))})()}onDiscoveryPeer(e){const{detail:t}=e;t.id.toString()!==this.peerId.toString()?(t.multiaddrs.length>0&&this.components.peerStore.addressBook.add(t.id,t.multiaddrs).catch(n=>sa.error(n)),t.protocols.length>0&&this.components.peerStore.protoBook.set(t.id,t.protocols).catch(n=>sa.error(n)),this.dispatchEvent(new Qe("peer:discovery",{detail:t}))):sa.error(new Error(Ie.ERR_DISCOVERED_SELF))}}function mHe(r){return XS.apply(this,arguments)}function XS(){return XS=(0,B.Z)(function*(r){return null==r.peerId&&(r.peerId=yield $$()),new _He(NKe(r))}),XS.apply(this,arguments)}function qS(){return qS=(0,B.Z)(function*(r){return yield mHe(r)}),qS.apply(this,arguments)}var wHe=p(17395);new Uint8Array(0);const Nu=r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")};var RHe=Math.pow(2,31),PHe=Math.pow(2,7),NHe=Math.pow(2,14),BHe=Math.pow(2,21),LHe=Math.pow(2,28),kHe=Math.pow(2,35),UHe=Math.pow(2,42),MHe=Math.pow(2,49),FHe=Math.pow(2,56),zHe=Math.pow(2,63),jHe={encode:function W$(r,e,t){e=e||[];for(var n=t=t||0;r>=RHe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,W$.bytes=t-n+1,e},decode:function eA(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw eA.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return eA.bytes=i-n,t},encodingLength:function(r){return r<PHe?1:r<NHe?2:r<BHe?3:r<LHe?4:r<kHe?5:r<UHe?6:r<MHe?7:r<FHe?8:r<zHe?9:10}};const Eg=jHe,tA=(r,e=0)=>[Eg.decode(r,e),Eg.decode.bytes],xg=(r,e,t=0)=>(Eg.encode(r,e,t),e),Sg=r=>Eg.encodingLength(r),Ag=(r,e)=>{const t=e.byteLength,n=Sg(r),s=n+Sg(t),i=new Uint8Array(s+t);return xg(r,i,0),xg(t,i,n),i.set(e,s),new rA(r,t,e,i)};class rA{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const Q$=({name:r,code:e,encode:t})=>new HHe(r,e,t);class HHe{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ag(this.code,t):t.then(n=>Ag(this.code,n))}throw Error("Unknown type, must be binary type")}}const J$=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),nA=Q$({name:"sha2-256",code:18,encode:J$("SHA-256")}),GHe=Q$({name:"sha2-512",code:19,encode:J$("SHA-512")});const JHe=function WHe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class XHe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class qHe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return X$(this,e)}}class eGe{constructor(e){this.decoders=e}or(e){return X$(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const X$=(r,e)=>new eGe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class tGe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new XHe(e,t,n),this.decoder=new qHe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Tg=({name:r,prefix:e,encode:t,decode:n})=>new tGe(r,e,t,n),b0=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=JHe(t,e);return Tg({prefix:r,name:e,encode:n,decode:i=>Nu(s(i))})},Hn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Tg({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),sGe=Tg({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),iGe=Hn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),oGe=Hn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),aGe=b0({prefix:"9",name:"base10",alphabet:"0123456789"}),cGe=Hn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),lGe=Hn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),_0=Hn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),uGe=Hn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),dGe=Hn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),fGe=Hn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),hGe=Hn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),pGe=Hn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),yGe=Hn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),gGe=Hn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),bGe=Hn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),_Ge=b0({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),mGe=b0({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),ia=b0({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),vGe=b0({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),wGe=Hn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),EGe=Hn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),xGe=Hn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),SGe=Hn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),q$=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),AGe=q$.reduce((r,e,t)=>(r[t]=e,r),[]),TGe=q$.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),RGe=Tg({prefix:"\u{1f680}",name:"base256emoji",encode:function CGe(r){return r.reduce((e,t)=>e+AGe[t],"")},decode:function IGe(r){const e=[];for(const t of r){const n=TGe[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}}),tK=Nu,OGe={code:0,name:"identity",encode:tK,digest:r=>Ag(0,tK(r))},PGe="raw",NGe=85,BGe=r=>Nu(r),LGe=r=>Nu(r),kGe=new TextEncoder,UGe=new TextDecoder,MGe="json",FGe=512,zGe=r=>kGe.encode(JSON.stringify(r)),VGe=r=>JSON.parse(UGe.decode(r)),rK=new WeakMap,sA=r=>{const e=rK.get(r);if(null==e){const t=new Map;return rK.set(r,t),t}return e};class hn{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==m0)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==HGe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return hn.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=Ag(e,t);return hn.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return hn.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?KGe(t,sA(r),e||ia.encoder):ZGe(t,sA(r),e||_0.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof hn)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new hn(n,s,i,o||nK(n,s,i.bytes))}if(!0===t[GGe]){const{version:n,multihash:s,code:i}=t,o=(r=>{const e=Nu(r),[t,n]=tA(e),[s,i]=tA(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new rA(t,s,o,e)})(s);return hn.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==m0)throw new Error(`Version 0 CID must use dag-pb (code: ${m0}) block encoding`);return new hn(e,t,n,n.bytes);case 1:{const s=nK(e,t,n.bytes);return new hn(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return hn.create(0,m0,e)}static createV1(e,t){return hn.create(1,e,t)}static decode(e){const[t,n]=hn.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=hn.inspectBytes(e),n=t.size-t.multihashSize,s=Nu(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new rA(t.multihashCode,t.digestSize,i,s);return[0===t.version?hn.createV0(o):hn.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=tA(e.subarray(t));return t+=T,E};let s=n(),i=m0;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=$Ge(e,t),i=hn.decode(s);return sA(i).set(n,e),i}}const $Ge=(r,e)=>{switch(r[0]){case"Q":return[ia.prefix,(e||ia).decode(`${ia.prefix}${r}`)];case ia.prefix:return[ia.prefix,(e||ia).decode(r)];case _0.prefix:return[_0.prefix,(e||_0).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},KGe=(r,e,t)=>{const{prefix:n}=t;if(n!==ia.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},ZGe=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},m0=112,HGe=18,nK=(r,e,t)=>{const n=Sg(r),s=n+Sg(e),i=new Uint8Array(s+t.byteLength);return xg(r,i,0),xg(e,i,n),i.set(t,s),i},GGe=Symbol.for("@ipld/js-cid/CID"),sK={...av,...cv,...lv,...uv,...dv,...fv,...hv,...pv,...yv,...gv};function Cg(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function iA(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?Cg(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function iK(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const oK=iK("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),oA=iK("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=iA((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),aK={utf8:oK,"utf-8":oK,hex:sK.base16,latin1:oA,ascii:oA,binary:oA,...sK};function ol(r,e="utf8"){const t=aK[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}const cK="/dht/provider",lA=20,Ig=3,sWe=Number(3e5),iWe=Number(3e4),oWe=Number(3e5),aWe=Number(3e4),cWe=Number(3e4),lWe=function WGe(r,e="utf8"){const t=aK[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):Cg(globalThis.Buffer.from(r,"utf-8"))}("/pk/");function uA(r){return{...r,multiaddrs:r.multiaddrs.filter(e=>{const[[t,n]]=e.stringTuples();return(4===t||6===t)&&null!=n&&!ig(n)})}}function dA(r){return{...r,multiaddrs:r.multiaddrs.filter(e=>{const[[t,n]]=e.stringTuples();return(4===t||6===t)&&null!=n&&ig(n)})}}function Bu(r){return fA.apply(this,arguments)}function fA(){return fA=(0,B.Z)(function*(r){return(yield nA.digest(r)).digest}),fA.apply(this,arguments)}function oa(r){return hA.apply(this,arguments)}function hA(){return hA=(0,B.Z)(function*(r){return yield Bu(r.toBytes())}),hA.apply(this,arguments)}function Lu(r){return new ft(`/dht/record/${ol(r,"base32")}`,!1)}function lK(r,e){const t=new Date;return new Ts(r,e,t).serialize()}const pA="routing-table-size";class vWe{constructor(e,t){const{kBucketSize:n,pingTimeout:s,lan:i,pingConcurrency:o,protocol:a,tagName:c,tagValue:u}=t;this.components=e,this.log=Be(`libp2p:kad-dht:${i?"lan":"wan"}:routing-table`),this.kBucketSize=n??20,this.pingTimeout=s??1e4,this.pingConcurrency=o??10,this.lan=i,this.running=!1,this.protocol=a,this.tagName=c??"kad-close",this.tagValue=u??50;const f=()=>{var E,T;null===(E=this.components.metrics)||void 0===E||E.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:"ping-queue-size",value:this.pingQueue.size}),null===(T=this.components.metrics)||void 0===T||T.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:"ping-running",value:this.pingQueue.pending})};this.pingQueue=new an({concurrency:this.pingConcurrency}),this.pingQueue.addListener("add",f),this.pingQueue.addListener("next",f),this._onPing=this._onPing.bind(this)}isStarted(){return this.running}start(){var e=this;return(0,B.Z)(function*(){e.running=!0;const t=new wHe({localNodeId:yield oa(e.components.peerId),numberOfNodesPerKBucket:e.kBucketSize,numberOfNodesToPing:1});e.kb=t,t.on("ping",e._onPing),e._tagPeers(t)})()}stop(){var e=this;return(0,B.Z)(function*(){e.running=!1,e.pingQueue.clear(),e.kb=void 0})()}_tagPeers(e){var t=this;let n=new sc;const s=function hWe(r,e=100){let t;return()=>{clearTimeout(t),t=setTimeout(()=>r(),e)}}(()=>{const i=new sc(e.closest(e.localNodeId,20).map(c=>c.peer)),o=i.difference(n),a=n.difference(i);Promise.resolve().then((0,B.Z)(function*(){for(const c of o)yield t.components.peerStore.tagPeer(c,t.tagName,{value:t.tagValue});for(const c of a)yield t.components.peerStore.unTagPeer(c,t.tagName)})).catch(c=>{this.log.error("Could not update peer tags",c)}),n=i});e.on("added",()=>{s()}),e.on("removed",()=>{s()})}_onPing(e,t){var n=this;this.pingQueue.add((0,B.Z)(function*(){if(!n.running)return;let s=0;try{yield Promise.all(e.map(function(){var i=(0,B.Z)(function*(o){let a;try{a=new Ar.TimeoutController(n.pingTimeout);const u={signal:a.signal};n.log("pinging old contact %p",o.peer),(yield(yield n.components.connectionManager.openConnection(o.peer,u)).newStream(n.protocol,u)).close(),s++}catch(u){n.running&&null!=n.kb&&(n.log.error("could not ping peer %p",o.peer,u),n.log("evicting old contact after ping failed %p",o),n.kb.remove(o.id))}finally{var c;a?.clear(),null===(c=n.components.metrics)||void 0===c||c.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(n.lan?"lan":"wan"),metric:pA,value:n.size})}});return function(o){return i.apply(this,arguments)}}())),n.running&&s<e.length&&null!=n.kb&&(n.log("adding new contact %p",t.peer),n.kb.add(t))}catch(i){n.log.error("could not process k-bucket ping event",i)}})).catch(s=>{this.log.error("could not process k-bucket ping event",s)})}get size(){return null==this.kb?0:this.kb.count()}find(e){var t=this;return(0,B.Z)(function*(){const n=yield oa(e),s=t.closestPeer(n);if(null!=s&&e.equals(s))return s})()}closestPeer(e){const t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e,t=this.kBucketSize){return null==this.kb?[]:this.kb.closest(e,t).map(s=>s.peer)}add(e){var t=this;return(0,B.Z)(function*(){var n;if(null==t.kb)throw new Error("RoutingTable is not started");const s=yield oa(e);t.kb.add({id:s,peer:e}),t.log("added %p with kad id %b",e,s),null===(n=t.components.metrics)||void 0===n||n.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(t.lan?"lan":"wan"),metric:pA,value:t.size})})()}remove(e){var t=this;return(0,B.Z)(function*(){var n;if(null==t.kb)throw new Error("RoutingTable is not started");const s=yield oa(e);t.kb.remove(s),null===(n=t.components.metrics)||void 0===n||n.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(t.lan?"lan":"wan"),metric:pA,value:t.size})})()}}function w0(r,e){if(r.length!==e.length)throw new Error("Inputs should have the same length");const t=iA(r.length);for(let n=0;n<r.length;n++)t[n]=r[n]^e[n];return Cg(t)}const wWe=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782];class EWe{constructor(e){const{peerRouting:t,routingTable:n,refreshInterval:s,refreshQueryTimeout:i,lan:o}=e;this.log=Be(`libp2p:kad-dht:${o?"lan":"wan"}:routing-table:refresh`),this.peerRouting=t,this.routingTable=n,this.refreshInterval=s??oWe,this.refreshQueryTimeout=i??aWe,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}start(){var e=this;return(0,B.Z)(function*(){e.log(`refreshing routing table every ${e.refreshInterval}ms`),e.refreshTable(!0)})()}stop(){var e=this;return(0,B.Z)(function*(){null!=e.refreshTimeoutId&&clearTimeout(e.refreshTimeoutId)})()}refreshTable(e=!1){var t=this;this.log("refreshing routing table");const n=this._maxCommonPrefix(),s=this._getTrackedCommonPrefixLengthsForRefresh(n);this.log(`max common prefix length ${n}`),this.log(`tracked CPLs [ ${s.map(i=>i.toISOString()).join(", ")} ]`),Promise.all(s.map(function(){var i=(0,B.Z)(function*(o,a){try{if(yield t._refreshCommonPrefixLength(a,o,e),0===t._numPeersForCpl(n)){const c=Math.min(2*(a+1),s.length-1);for(let u=a+1;u<c+1;u++)try{yield t._refreshCommonPrefixLength(u,o,e)}catch(f){t.log.error(f)}}}catch(c){t.log.error(c)}});return function(o,a){return i.apply(this,arguments)}}())).catch(i=>{this.log.error(i)}).then(()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),null!=this.refreshTimeoutId.unref&&this.refreshTimeoutId.unref()}).catch(i=>{this.log.error(i)})}_refreshCommonPrefixLength(e,t,n){var s=this;return(0,B.Z)(function*(){if(!n&&t.getTime()>Date.now()-s.refreshInterval)return void s.log("not running refresh for cpl %s as time since last refresh not above interval",e);const i=yield s._generateRandomPeerId(e);s.log("starting refreshing cpl %s with key %p (routing table size was %s)",e,i,s.routingTable.size);const o=new Ar.TimeoutController(s.refreshQueryTimeout);try{const a=yield uu(s.peerRouting.getClosestPeers(i.toBytes(),{signal:o.signal}));s.log(`found ${a} peers that were close to imaginary peer %p`,i),s.log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,i,s.routingTable.size)}finally{o.clear()}})()}_getTrackedCommonPrefixLengthsForRefresh(e){e>15&&(e=15);const t=[];for(let s=0;s<=e;s++){var n;t[s]=null!==(n=this.commonPrefixLengthRefreshedAt[s])&&void 0!==n?n:new Date}return t}_generateRandomPeerId(e){var t=this;return(0,B.Z)(function*(){if(null==t.routingTable.kb)throw new Error("Routing table not started");const n=Rf(2),s=(n[1]<<8)+n[0];return Ai(yield t._makePeerId(t.routingTable.kb.localNodeId,s,e))})()}_makePeerId(e,t,n){return(0,B.Z)(function*(){if(n>15)throw new Error("Cannot generate peer ID for common prefix length greater than 15");const o=new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1)^32768>>n,a=65535<<16-(n+1),u=wWe[o&a|t&~a],f=new ArrayBuffer(34),E=new DataView(f,0,f.byteLength);return E.setUint8(0,nA.code),E.setUint8(1,32),E.setUint32(2,u,!1),new Uint8Array(E.buffer,E.byteOffset,E.byteLength)})()}_maxCommonPrefix(){let e=0;for(const t of this._prefixLengths())t>e&&(e=t);return e}_numPeersForCpl(e){let t=0;for(const n of this._prefixLengths())n===e&&t++;return t}*_prefixLengths(){if(null!=this.routingTable.kb)for(const{id:e}of this.routingTable.kb.toIterable()){const t=w0(this.routingTable.kb.localNodeId,e);let n=0;for(const s of t){if(0!==s)break;n++}yield n}}}var dK,al;!function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{!1!==s.lengthDelimited&&n.fork(),null!=t.key&&(n.uint32(10),n.bytes(t.key)),null!=t.value&&(n.uint32(18),n.bytes(t.value)),null!=t.author&&(n.uint32(26),n.bytes(t.author)),null!=t.signature&&(n.uint32(34),n.bytes(t.signature)),null!=t.timeReceived&&(n.uint32(42),n.string(t.timeReceived)),!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();switch(o>>>3){case 1:s.key=t.bytes();break;case 2:s.value=t.bytes();break;case 3:s.author=t.bytes();break;case 4:s.signature=t.bytes();break;case 5:s.timeReceived=t.string();break;default:t.skipType(7&o)}}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(dK||(dK={})),function(r){let e;var a;let t,n,s,i,o;(a=e=r.MessageType||(r.MessageType={})).PUT_VALUE="PUT_VALUE",a.GET_VALUE="GET_VALUE",a.ADD_PROVIDER="ADD_PROVIDER",a.GET_PROVIDERS="GET_PROVIDERS",a.FIND_NODE="FIND_NODE",a.PING="PING",function(a){a[a.PUT_VALUE=0]="PUT_VALUE",a[a.GET_VALUE=1]="GET_VALUE",a[a.ADD_PROVIDER=2]="ADD_PROVIDER",a[a.GET_PROVIDERS=3]="GET_PROVIDERS",a[a.FIND_NODE=4]="FIND_NODE",a[a.PING=5]="PING"}(t||(t={})),function(a){a.codec=()=>Cc(t)}(e=r.MessageType||(r.MessageType={})),function(a){a.NOT_CONNECTED="NOT_CONNECTED",a.CONNECTED="CONNECTED",a.CAN_CONNECT="CAN_CONNECT",a.CANNOT_CONNECT="CANNOT_CONNECT"}(n=r.ConnectionType||(r.ConnectionType={})),function(a){a[a.NOT_CONNECTED=0]="NOT_CONNECTED",a[a.CONNECTED=1]="CONNECTED",a[a.CAN_CONNECT=2]="CAN_CONNECT",a[a.CANNOT_CONNECT=3]="CANNOT_CONNECT"}(s||(s={})),function(a){a.codec=()=>Cc(s)}(n=r.ConnectionType||(r.ConnectionType={})),function(a){let c;a.codec=()=>(null==c&&(c=Rr((u,f,E={})=>{if(!1!==E.lengthDelimited&&f.fork(),null!=u.id&&(f.uint32(10),f.bytes(u.id)),null==u.addrs)throw new Error('Protocol error: required field "addrs" was not found in object');for(const T of u.addrs)f.uint32(18),f.bytes(T);null!=u.connection&&(f.uint32(24),r.ConnectionType.codec().encode(u.connection,f)),!1!==E.lengthDelimited&&f.ldelim()},(u,f)=>{const E={addrs:[]},T=null==f?u.len:u.pos+f;for(;u.pos<T;){const U=u.uint32();switch(U>>>3){case 1:E.id=u.bytes();break;case 2:E.addrs.push(u.bytes());break;case 3:E.connection=r.ConnectionType.codec().decode(u);break;default:u.skipType(7&U)}}return E})),c),a.encode=u=>Ir(u,a.codec()),a.decode=u=>Cr(u,a.codec())}(i=r.Peer||(r.Peer={})),r.codec=()=>(null==o&&(o=Rr((a,c,u={})=>{if(!1!==u.lengthDelimited&&c.fork(),null!=a.type&&(c.uint32(8),r.MessageType.codec().encode(a.type,c)),null!=a.clusterLevelRaw&&(c.uint32(80),c.int32(a.clusterLevelRaw)),null!=a.key&&(c.uint32(18),c.bytes(a.key)),null!=a.record&&(c.uint32(26),c.bytes(a.record)),null==a.closerPeers)throw new Error('Protocol error: required field "closerPeers" was not found in object');for(const f of a.closerPeers)c.uint32(66),r.Peer.codec().encode(f,c);if(null==a.providerPeers)throw new Error('Protocol error: required field "providerPeers" was not found in object');for(const f of a.providerPeers)c.uint32(74),r.Peer.codec().encode(f,c);!1!==u.lengthDelimited&&c.ldelim()},(a,c)=>{const u={closerPeers:[],providerPeers:[]},f=null==c?a.len:a.pos+c;for(;a.pos<f;){const E=a.uint32();switch(E>>>3){case 1:u.type=r.MessageType.codec().decode(a);break;case 10:u.clusterLevelRaw=a.int32();break;case 2:u.key=a.bytes();break;case 3:u.record=a.bytes();break;case 8:u.closerPeers.push(r.Peer.codec().decode(a,a.uint32()));break;case 9:u.providerPeers.push(r.Peer.codec().decode(a,a.uint32()));break;default:a.skipType(7&E)}}return u})),o),r.encode=a=>Ir(a,r.codec()),r.decode=a=>Cr(a,r.codec())}(al||(al={}));const gs=al.MessageType,xWe=al.ConnectionType,SWe=Object.keys(gs);class Vs{constructor(e,t,n){if(!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this.clusterLevelRaw=n,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){const e=this.clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this.clusterLevelRaw=e}serialize(){return al.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(fK),providerPeers:this.providerPeers.map(fK),record:null==this.record?void 0:this.record.serialize().subarray()})}static deserialize(e){var t,n,s,i;const o=al.decode(e),a=new Vs(null!==(t=o.type)&&void 0!==t?t:al.MessageType.PUT_VALUE,null!==(n=o.key)&&void 0!==n?n:Uint8Array.from([]),null!==(s=o.clusterLevelRaw)&&void 0!==s?s:0);return a.closerPeers=o.closerPeers.map(hK),a.providerPeers=o.providerPeers.map(hK),null!=(null===(i=o.record)||void 0===i?void 0:i.length)&&(a.record=Ts.deserialize(o.record)),a}}function fK(r){var e;return{id:r.id.toBytes(),addrs:(null!==(e=r.multiaddrs)&&void 0!==e?e:[]).map(n=>n.bytes),connection:xWe.CONNECTED}}function hK(r){var e;if(null==r.id)throw new Error("Invalid peer in message");return{id:Ai(r.id),multiaddrs:(null!==(e=r.addrs)&&void 0!==e?e:[]).map(t=>at(t)),protocols:[]}}function pK(r){return{...r,name:"SENDING_QUERY",type:0,messageName:r.type,messageType:SWe.indexOf(r.type.toString())}}function yA(r){return{...r,name:"PEER_RESPONSE",type:1,messageName:r.messageType,closer:null!=r.closer?r.closer:[],providers:null!=r.providers?r.providers:[]}}function Dg(r){return{...r,name:"FINAL_PEER",type:2}}function aa(r){return{...r,name:"QUERY_ERROR",type:3}}function yK(r){return{...r,name:"PROVIDER",type:4}}function gA(r){return{...r,name:"VALUE",type:5}}function gK(r){return{...r,name:"DIALING_PEER",type:7}}class AWe extends wr{constructor(e,t){super();const{protocol:n,lan:s}=t;this.components=e,this.log=Be(`libp2p:kad-dht:${s?"lan":"wan"}:network`),this.running=!1,this.protocol=n}start(){var e=this;return(0,B.Z)(function*(){e.running||(e.running=!0)})()}stop(){var e=this;return(0,B.Z)(function*(){e.running=!1})()}isStarted(){return this.running}sendRequest(e,t,n={}){var s=this;return Ee(function*(){if(s.running){s.log("sending %s to %p",t.type,e),yield gK({peer:e}),yield pK({to:e,type:t.type});try{const o=yield X(s.components.connectionManager.openConnection(e,n)),a=yield X(o.newStream(s.protocol,n)),c=yield X(s._writeReadMessage(a,t.serialize(),n));yield yA({from:e,messageType:c.type,closer:c.closerPeers,providers:c.providerPeers,record:c.record})}catch(o){yield aa({from:e,error:o})}}})()}sendMessage(e,t,n={}){var s=this;return Ee(function*(){if(s.running){s.log("sending %s to %p",t.type,e),yield gK({peer:e}),yield pK({to:e,type:t.type});try{const o=yield X(s.components.connectionManager.openConnection(e,n)),a=yield X(o.newStream(s.protocol,n));yield X(s._writeMessage(a,t.serialize(),n)),yield yA({from:e,messageType:t.type})}catch(o){yield aa({from:e,error:o})}}})()}_writeMessage(e,t,n){return(0,B.Z)(function*(){null!=n.signal&&(e=oo(e,n.signal)),yield _t([t],ei(),e,Oi)})()}_writeReadMessage(e,t,n){var s=this;return(0,B.Z)(function*(){null!=n.signal&&(e=oo(e,n.signal));const i=yield _t([t],ei(),e,Fs(),function(){var a=(0,B.Z)(function*(c){const u=yield Ni(c);if(null!=u)return u;throw ee(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED")});return function(c){return a.apply(this,arguments)}}()),o=Vs.deserialize(i);return o.closerPeers.forEach(a=>{s.dispatchEvent(new Qe("peer",{detail:a}))}),o.providerPeers.forEach(a=>{s.dispatchEvent(new Qe("peer",{detail:a}))}),o})()}}function Og(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}const RWe=function TWe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},Pg=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class NWe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class BWe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return bK(this,e)}}class LWe{constructor(e){this.decoders=e}or(e){return bK(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const bK=(r,e)=>new LWe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class kWe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new NWe(e,t,n),this.decoder=new BWe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ng=({name:r,prefix:e,encode:t,decode:n})=>new kWe(r,e,t,n),E0=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=RWe(t,e);return Ng({prefix:r,name:e,encode:n,decode:i=>Pg(s(i))})},Gn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Ng({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),FWe=Ng({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),zWe=Gn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),VWe=Gn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),jWe=E0({prefix:"9",name:"base10",alphabet:"0123456789"}),$We=Gn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),KWe=Gn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ZWe=Gn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),HWe=Gn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),GWe=Gn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),WWe=Gn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),YWe=Gn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),QWe=Gn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),JWe=Gn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),XWe=Gn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qWe=Gn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),eYe=E0({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),tYe=E0({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),rYe=E0({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),nYe=E0({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),sYe=Gn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),iYe=Gn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),oYe=Gn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),aYe=Gn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),_K=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),cYe=_K.reduce((r,e,t)=>(r[t]=e,r),[]),lYe=_K.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),fYe=Ng({prefix:"\u{1f680}",name:"base256emoji",encode:function uYe(r){return r.reduce((e,t)=>e+cYe[t],"")},decode:function dYe(r){const e=[];for(const t of r){const n=lYe[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var gYe=Math.pow(2,31),mYe=Math.pow(2,7),vYe=Math.pow(2,14),wYe=Math.pow(2,21),EYe=Math.pow(2,28),xYe=Math.pow(2,35),SYe=Math.pow(2,42),AYe=Math.pow(2,49),TYe=Math.pow(2,56),CYe=Math.pow(2,63),RYe={encode:function vK(r,e,t){e=e||[];for(var n=t=t||0;r>=gYe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,vK.bytes=t-n+1,e},decode:function bA(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw bA.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return bA.bytes=i-n,t},encodingLength:function(r){return r<mYe?1:r<vYe?2:r<wYe?3:r<EYe?4:r<xYe?5:r<SYe?6:r<AYe?7:r<TYe?8:r<CYe?9:10}};const EK=RYe,xK=(r,e,t=0)=>(EK.encode(r,e,t),e),SK=r=>EK.encodingLength(r),_A=(r,e)=>{const t=e.byteLength,n=SK(r),s=n+SK(t),i=new Uint8Array(s+t);return xK(r,i,0),xK(t,i,n),i.set(e,s),new AK(r,t,e,i)};class AK{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const TK=({name:r,code:e,encode:t})=>new OYe(r,e,t);class OYe{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?_A(this.code,t):t.then(n=>_A(this.code,n))}throw Error("Unknown type, must be binary type")}}const CK=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),IK=TK({name:"sha2-256",code:18,encode:CK("SHA-256")}),PYe=TK({name:"sha2-512",code:19,encode:CK("SHA-512")}),DK=Pg,BYe={code:0,name:"identity",encode:DK,digest:r=>_A(0,DK(r))},LYe="raw",kYe=85,UYe=r=>Pg(r),MYe=r=>Pg(r),FYe=new TextEncoder,zYe=new TextDecoder,VYe="json",jYe=512,$Ye=r=>FYe.encode(JSON.stringify(r)),KYe=r=>JSON.parse(zYe.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const NK={...vv,...wv,...Ev,...xv,...Sv,...Av,...Tv,...Cv,...Iv,...Rv};function BK(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const LK=BK("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),vA=BK("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function XYe(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?function JYe(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),qYe={utf8:LK,"utf-8":LK,hex:NK.base16,latin1:vA,ascii:vA,binary:vA,...NK};function wA(r,e="utf8"){const t=qYe[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}function EA(r,e){const t=e.key,s=wA(t).split("/");if(s.length<3)return;const i=r[s[1].toString()];if(null==i)throw ee(new Error("Invalid record keytype"),"ERR_INVALID_RECORD_KEY_TYPE");return i(t,e.value)}const tQe={pk:function(){var r=(0,B.Z)(function*(e,t){if(!(e instanceof Uint8Array))throw ee(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(e.byteLength<5)throw ee(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if("/pk/"!==wA(e.subarray(0,4)))throw ee(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");if(!function eQe(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}(e.slice(4),(yield IK.digest(t)).bytes))throw ee(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")});return function(t,n){return r.apply(this,arguments)}}()},sQe={pk:function nQe(r,e){return 0}};class iQe{constructor(e,t){const{validators:n,selectors:s,peerRouting:i,queryManager:o,routingTable:a,network:c,lan:u}=t;this.components=e,this.log=Be(`libp2p:kad-dht:${u?"lan":"wan"}:content-fetching`),this.validators=n,this.selectors=s,this.peerRouting=i,this.queryManager=o,this.routingTable=a,this.network=c}putLocal(e,t){var n=this;return(0,B.Z)(function*(){const s=Lu(e);yield n.components.datastore.put(s,t)})()}getLocal(e){var t=this;return(0,B.Z)(function*(){t.log("getLocal %b",e);const n=Lu(e);t.log("fetching record for key %k",n);const s=yield t.components.datastore.get(n);t.log("found %k in local datastore",n);const i=Ts.deserialize(s);return yield EA(t.validators,i),i})()}sendCorrectionRecord(e,t,n,s={}){var i=this;return Ee(function*(){i.log("sendCorrection for %b",e);const o=yield X(lK(e,n));for(const{value:T,from:U}of t){if(Og(T,n)){i.log("record was ok");continue}if(i.components.peerId.equals(U)){try{const F=Lu(e);i.log(`Storing corrected record for key ${F.toString()}`),yield X(i.components.datastore.put(F,o.subarray()))}catch(F){i.log.error("Failed error correcting self",F)}continue}let b=!1;const P=new Vs(gs.PUT_VALUE,e,0);P.record=Ts.deserialize(o);var u,a=!1,c=!1;try{for(var E,f=be(i.network.sendRequest(U,P,s));a=!(E=yield X(f.next())).done;a=!1){const F=E.value;"PEER_RESPONSE"===F.name&&null!=F.record&&Og(F.record.value,Ts.deserialize(o).value)&&(b=!0),yield F}}catch(F){c=!0,u=F}finally{try{a&&null!=f.return&&(yield X(f.return()))}finally{if(c)throw u}}b||(yield aa({from:U,error:ee(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})),i.log.error("Failed error correcting entry")}})()}put(e,t,n={}){var s=this;return Ee(function*(){s.log("put key %b value %b",e,t);const i=yield X(lK(e,t)),o=Lu(e);s.log(`storing record for key ${o.toString()}`),yield X(s.components.datastore.put(o,i.subarray())),yield*Fe(be(_t(s.peerRouting.getClosestPeers(e,{signal:n.signal}),a=>os(a,c=>(0,B.Z)(function*(){if("FINAL_PEER"!==c.name)return[c];const u=[],f=new Vs(gs.PUT_VALUE,e,0);f.record=Ts.deserialize(i),s.log("send put to %p",c.peer.id);var U,E=!1,T=!1;try{for(var P,b=be(s.network.sendRequest(c.peer.id,f,n));E=!(P=yield b.next()).done;E=!1){const F=P.value;u.push(F),"PEER_RESPONSE"===F.name&&(null!=F.record&&Og(F.record.value,Ts.deserialize(i).value)||u.push(aa({from:c.peer.id,error:ee(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})))}}catch(F){T=!0,U=F}finally{try{E&&null!=b.return&&(yield b.return())}finally{if(T)throw U}}return u})),a=>k1(a,{ordered:!1,concurrency:Ig}),function(){var a=Ee(function*(c){var E,u=!1,f=!1;try{for(var U,T=be(c);u=!(U=yield X(T.next())).done;u=!1){const b=U.value;yield*Fe(be(b),X)}}catch(b){f=!0,E=b}finally{try{u&&null!=T.return&&(yield X(T.return()))}finally{if(f)throw E}}});return function(c){return a.apply(this,arguments)}}())),X)})()}get(e,t={}){var n=this;return Ee(function*(){n.log("get %b",e);const s=[];var a,i=!1,o=!1;try{for(var u,c=be(n.getMany(e,t));i=!(u=yield X(c.next())).done;i=!1){const U=u.value;"VALUE"===U.name&&s.push(U),yield U}}catch(U){o=!0,a=U}finally{try{i&&null!=c.return&&(yield X(c.return()))}finally{if(o)throw a}}if(0===s.length)return;const f=s.map(U=>U.value);let E=0;try{E=function rQe(r,e,t){if(0===t.length)throw ee(new Error("No records given"),"ERR_NO_RECORDS_RECEIVED");const s=wA(e).split("/");if(s.length<3)throw ee(new Error("Record key does not have a selector function"),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY");const i=r[s[1].toString()];if(null==i)throw ee(new Error(`Unrecognized key prefix: ${s[1]}`),"ERR_UNRECOGNIZED_KEY_PREFIX");return 1===t.length?0:i(e,t)}(n.selectors,e,f)}catch(U){if("ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY"!==U.code)throw U}const T=f[E];if(n.log("GetValue %b %b",e,T),null==T)throw ee(new Error("best value was not found"),"ERR_NOT_FOUND");yield*Fe(be(n.sendCorrectionRecord(e,s,T,t)),X),yield s[E]})()}getMany(e,t={}){var n=this;return Ee(function*(){n.log("getMany values for %b",e);try{const c=yield X(n.getLocal(e));yield gA({value:c.value,from:n.components.peerId})}catch(c){n.log("error getting local value for %b",e,c)}const s=yield X(Bu(e)),i=n.routingTable.closestPeers(s);n.log("found %d peers in routing table",i.length);const o=n,a=function(){var c=Ee(function*({peer:u,signal:f}){var U,E=!1,T=!1;try{for(var P,b=be(o.peerRouting.getValueOrPeers(u,e,{signal:f}));E=!(P=yield X(b.next())).done;E=!1){const F=P.value;yield F,"PEER_RESPONSE"===F.name&&null!=F.record&&(yield gA({from:u,value:F.record.value}))}}catch(F){T=!0,U=F}finally{try{E&&null!=b.return&&(yield X(b.return()))}finally{if(T)throw U}}});return function(f){return c.apply(this,arguments)}}();yield*Fe(be(n.queryManager.run(e,i,a,t)),X)})()}}class oQe{constructor(e,t){const{network:n,peerRouting:s,queryManager:i,routingTable:o,providers:a,lan:c}=t;this.components=e,this.log=Be(`libp2p:kad-dht:${c?"lan":"wan"}:content-routing`),this.network=n,this.peerRouting=s,this.queryManager=i,this.routingTable=o,this.providers=a}provide(e,t,n={}){var s=this;return Ee(function*(){s.log("provide %s",e),yield X(s.providers.addProvider(e,s.components.peerId));const i=new Vs(gs.ADD_PROVIDER,e.bytes,0);i.providerPeers=[{id:s.components.peerId,multiaddrs:t,protocols:[]}];let o=0;yield*Fe(be(_t(s.peerRouting.getClosestPeers(e.multihash.bytes,n),c=>os(c,u=>(c=>(0,B.Z)(function*(){if("FINAL_PEER"!==c.name)return[c];const u=[];s.log("putProvider %s to %p",e,c.peer.id);try{s.log("sending provider record for %s to %p",e,c.peer.id);var T,f=!1,E=!1;try{for(var b,U=be(s.network.sendMessage(c.peer.id,i,n));f=!(b=yield U.next()).done;f=!1){const P=b.value;"PEER_RESPONSE"===P.name&&(s.log("sent provider record for %s to %p",e,c.peer.id),o++),u.push(P)}}catch(P){E=!0,T=P}finally{try{f&&null!=U.return&&(yield U.return())}finally{if(E)throw T}}}catch(P){s.log.error("error sending provide record to peer %p",c.peer.id,P),u.push(aa({from:c.peer.id,error:P}))}return u}))(u)),c=>k1(c,{ordered:!1,concurrency:Ig}),function(){var c=Ee(function*(u){var T,f=!1,E=!1;try{for(var b,U=be(u);f=!(b=yield X(U.next())).done;f=!1){const P=b.value;yield*Fe(be(P),X)}}catch(P){E=!0,T=P}finally{try{f&&null!=U.return&&(yield X(U.return()))}finally{if(E)throw T}}});return function(u){return c.apply(this,arguments)}}())),X),s.log("sent provider records to %d peers",o)})()}findProviders(e,t){var n=this;return Ee(function*(){const s=n.routingTable.kBucketSize,i=e.multihash.bytes,o=yield X(Bu(i)),a=n;n.log("findProviders %c",e);const c=yield X(n.providers.getProviders(e));if(c.length>0){const M=[];for(const H of c.slice(0,s)){var u;M.push({id:H,multiaddrs:(null!==(u=yield X(n.components.peerStore.addressBook.get(H)))&&void 0!==u?u:[]).map($=>$.multiaddr),protocols:[]})}yield yA({from:n.components.peerId,messageType:gs.GET_PROVIDERS,providers:M}),yield yK({from:n.components.peerId,providers:M})}if(c.length>=s)return;const f=function(){var M=Ee(function*({peer:H,signal:$}){const V=new Vs(gs.GET_PROVIDERS,i,0);yield*Fe(be(a.network.sendRequest(H,V,{signal:$})),X)});return function($){return M.apply(this,arguments)}}(),E=new Set(c.map(M=>M.toString()));var b,T=!1,U=!1;try{for(var F,P=be(n.queryManager.run(i,n.routingTable.closestPeers(o),f,t));T=!(F=yield X(P.next())).done;T=!1){const M=F.value;if(yield M,"PEER_RESPONSE"===M.name){n.log("Found %d provider entries for %c and %d closer peers",M.providers.length,e,M.closer.length);const H=[];for(const $ of M.providers)E.has($.id.toString())||(E.add($.id.toString()),H.push($));if(H.length>0&&(yield yK({from:M.from,providers:H})),E.size===s)return}}}catch(M){U=!0,b=M}finally{try{T&&null!=P.return&&(yield X(P.return()))}finally{if(U)throw b}}})()}}function kK(r,e){for(let t=0;t<r.byteLength;t++){if(r[t]<e[t])return-1;if(r[t]>e[t])return 1}return r.byteLength>e.byteLength?1:r.byteLength<e.byteLength?-1:0}class aQe{constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(e=>e.peerId)}add(e){var t=this;return(0,B.Z)(function*(){if(null!=t.peerDistances.find(i=>i.peerId.equals(e)))return;const n=yield oa(e),s={peerId:e,distance:w0(t.originDhtKey,n)};t.peerDistances.push(s),t.peerDistances.sort((i,o)=>kK(i.distance,o.distance)),t.peerDistances=t.peerDistances.slice(0,t.capacity)})()}anyCloser(e){var t=this;return(0,B.Z)(function*(){if(0===e.length)return!1;if(0===t.length)return!0;const n=yield Promise.all(e.map(oa)),s=t.peerDistances[t.peerDistances.length-1].distance;for(const i of n)if(kK(w0(t.originDhtKey,i),s)<0)return!0;return!1})()}}class cQe{constructor(e,t){const{routingTable:n,network:s,validators:i,queryManager:o,lan:a}=t;this.components=e,this.routingTable=n,this.network=s,this.validators=i,this.queryManager=o,this.log=Be(`libp2p:kad-dht:${a?"lan":"wan"}:peer-routing`)}findPeerLocal(e){var t=this;return(0,B.Z)(function*(){let n;const s=yield t.routingTable.find(e);if(null!=s){t.log("findPeerLocal found %p in routing table",e);try{n=yield t.components.peerStore.get(s)}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i}}if(null==n)try{n=yield t.components.peerStore.get(e)}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i}if(null!=n)return t.log("findPeerLocal found %p in peer store",e),{id:n.id,multiaddrs:n.addresses.map(i=>i.multiaddr),protocols:[]}})()}_getValueSingle(e,t,n={}){var s=this;return Ee(function*(){const i=new Vs(gs.GET_VALUE,t,0);yield*Fe(be(s.network.sendRequest(e,i,n)),X)})()}getPublicKeyFromNode(e,t={}){var n=this;return Ee(function*(){const s=function uWe(r){return function YGe(r,e){null==e&&(e=r.reduce((s,i)=>s+i.length,0));const t=iA(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return Cg(t)}([lWe,r.toBytes()])}(e);var a,i=!1,o=!1;try{for(var u,c=be(n._getValueSingle(e,s,t));i=!(u=yield X(c.next())).done;i=!1){const f=u.value;if(yield f,"PEER_RESPONSE"===f.name&&null!=f.record){const E=yield X(Ti(k8({bytes:f.record.value})));if(!E.equals(e))throw ee(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(null==E.publicKey)throw ee(new Error("public key missing"),"ERR_PUBLIC_KEY_MISSING");yield gA({from:e,value:E.publicKey})}}}catch(f){o=!0,a=f}finally{try{i&&null!=c.return&&(yield X(c.return()))}finally{if(o)throw a}}throw ee(new Error(`Node not responding with its public key: ${e.toString()}`),"ERR_INVALID_RECORD")})()}findPeer(e,t={}){var n=this;return Ee(function*(){n.log("findPeer %p",e);const s=yield X(n.findPeerLocal(e));if(null!=s)return n.log("found local"),void(yield Dg({from:n.components.peerId,peer:s}));const i=yield X(oa(e)),o=n.routingTable.closestPeers(i);if(null!=o.find(F=>F.equals(e)))try{const F=yield X(n.components.peerStore.get(e));return n.log("found in peerStore"),void(yield Dg({from:n.components.peerId,peer:{id:F.id,multiaddrs:F.addresses.map(M=>M.multiaddr),protocols:[]}}))}catch(F){if("ERR_NOT_FOUND"!==F.code)throw F}const c=n,u=function(){var F=Ee(function*({peer:M,signal:H}){const $=new Vs(gs.FIND_NODE,e.toBytes(),0);var ne,V=!1,W=!1;try{for(var q,Y=be(c.network.sendRequest(M,$,{signal:H}));V=!(q=yield X(Y.next())).done;V=!1){const ge=q.value;if(yield ge,"PEER_RESPONSE"===ge.name){const Ce=ge.closer.find(De=>De.id.equals(e));null!=Ce&&(yield Dg({from:ge.from,peer:Ce}))}}}catch(ge){W=!0,ne=ge}finally{try{V&&null!=Y.return&&(yield X(Y.return()))}finally{if(W)throw ne}}});return function(H){return F.apply(this,arguments)}}();let f=!1;var U,E=!1,T=!1;try{for(var P,b=be(n.queryManager.run(e.toBytes(),o,u,t));E=!(P=yield X(b.next())).done;E=!1){const F=P.value;"FINAL_PEER"===F.name&&(f=!0),yield F}}catch(F){T=!0,U=F}finally{try{E&&null!=b.return&&(yield X(b.return()))}finally{if(T)throw U}}f||(yield aa({from:n.components.peerId,error:ee(new Error("Not found"),"ERR_NOT_FOUND")}))})()}getClosestPeers(e,t={}){var n=this;return Ee(function*(){n.log("getClosestPeers to %b",e);const s=yield X(Bu(e)),i=n.routingTable.closestPeers(s),o=n,a=new aQe(s,n.routingTable.kBucketSize);yield X(Promise.all(i.map(function(){var P=(0,B.Z)(function*(F){return yield a.add(F)});return function(F){return P.apply(this,arguments)}}())));const c=function(){var P=Ee(function*({peer:F,signal:M}){o.log("closerPeersSingle %s from %p",ol(e,"base32"),F);const H=new Vs(gs.FIND_NODE,e,0);yield*Fe(be(o.network.sendRequest(F,H,{signal:M})),X)});return function(M){return P.apply(this,arguments)}}();var E,u=!1,f=!1;try{for(var U,T=be(n.queryManager.run(e,i,c,t));u=!(U=yield X(T.next())).done;u=!1){const P=U.value;yield P,"PEER_RESPONSE"===P.name&&(yield X(Promise.all(P.closer.map(function(){var F=(0,B.Z)(function*(M){return yield a.add(M.id)});return function(M){return F.apply(this,arguments)}}()))))}}catch(P){f=!0,E=P}finally{try{u&&null!=T.return&&(yield X(T.return()))}finally{if(f)throw E}}n.log("found %d peers close to %b",a.length,e);for(const P of a.peers){var b;yield Dg({from:n.components.peerId,peer:{id:P,multiaddrs:(null!==(b=yield X(n.components.peerStore.addressBook.get(P)))&&void 0!==b?b:[]).map(F=>F.multiaddr),protocols:[]}})}})()}getValueOrPeers(e,t,n={}){var s=this;return Ee(function*(){var a,i=!1,o=!1;try{for(var u,c=be(s._getValueSingle(e,t,n));i=!(u=yield X(c.next())).done;i=!1){const f=u.value;if("PEER_RESPONSE"===f.name&&null!=f.record)try{yield X(s._verifyRecordOnline(f.record))}catch{const T="invalid record received, discarded";s.log(T),yield aa({from:f.from,error:ee(new Error(T),"ERR_INVALID_RECORD")});continue}yield f}}catch(f){o=!0,a=f}finally{try{i&&null!=c.return&&(yield X(c.return()))}finally{if(o)throw a}}})()}_verifyRecordOnline(e){var t=this;return(0,B.Z)(function*(){if(null==e.timeReceived)throw ee(new Error("invalid record received"),"ERR_INVALID_RECORD");yield EA(t.validators,new Ts(e.key,e.value,e.timeReceived))})()}getCloserPeersOffline(e,t){var n=this;return(0,B.Z)(function*(){const s=yield Bu(e),i=n.routingTable.closestPeers(s),o=[];for(const a of i)if(!a.equals(t))try{const c=yield n.components.peerStore.addressBook.get(a),u=yield n.components.peerStore.protoBook.get(a);o.push({id:a,multiaddrs:c.map(f=>f.multiaddr),protocols:u})}catch(c){if("ERR_NOT_FOUND"!==c.code)throw c}return o.length>0?n.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",o.length,e,t):n.log("getCloserPeersOffline could not find peer closer to %b than %p",e,t),o})()}}const ca=Be("libp2p:kad-dht:providers");class lQe{constructor(e,t={}){const{cacheSize:n,cleanupInterval:s,provideValidity:i}=t;this.components=e,this.cleanupInterval=s??36e5,this.provideValidity=i??864e5,this.cache=cf(n??256),this.syncQueue=new an({concurrency:1}),this.started=!1}isStarted(){return this.started}start(){var e=this;return(0,B.Z)(function*(){e.started||(e.started=!0,e.cleaner=setInterval(()=>{e._cleanup().catch(t=>{ca.error(t)})},e.cleanupInterval))})()}stop(){var e=this;return(0,B.Z)(function*(){e.started=!1,null!=e.cleaner&&(clearInterval(e.cleaner),e.cleaner=void 0)})()}_cleanup(){var e=this;return(0,B.Z)(function*(){return yield e.syncQueue.add((0,B.Z)(function*(){const t=Date.now();let n=0,s=0;const i=new Map,o=e.components.datastore.batch(),a=e.components.datastore.query({prefix:cK});var f,c=!1,u=!1;try{for(var T,E=be(a);c=!(T=yield E.next()).done;c=!1){const b=T.value;try{const{cid:P,peerId:F}=UK(b.key),M=MK(b.value).getTime(),H=Date.now(),$=H-M,V=$>e.provideValidity;if(ca("comparing: %d - %d = %d > %d %s",H,M,$,e.provideValidity,V?"(expired)":""),V){var U;s++,o.delete(b.key);const W=null!==(U=i.get(P))&&void 0!==U?U:new Set;W.add(F),i.set(P,W)}n++}catch(P){ca.error(P.message)}}}catch(b){u=!0,f=b}finally{try{c&&null!=E.return&&(yield E.return())}finally{if(u)throw f}}i.size>0?(ca("deleting %d / %d entries",s,n),yield o.commit()):ca("nothing to delete");for(const[b,P]of i){const F=S0(b),M=e.cache.get(F);if(null!=M){for(const H of P)M.delete(H);0===M.size?e.cache.remove(F):e.cache.set(F,M)}}ca("Cleanup successful (%dms)",Date.now()-t)}))})()}_getProvidersMap(e){var t=this;return(0,B.Z)(function*(){const n=S0(e);let s=t.cache.get(n);return null==s&&(s=yield function dQe(r,e){return SA.apply(this,arguments)}(t.components.datastore,e),t.cache.set(n,s)),s})()}addProvider(e,t){var n=this;return(0,B.Z)(function*(){return yield n.syncQueue.add((0,B.Z)(function*(){ca("%p provides %s",t,e);const s=yield n._getProvidersMap(e);ca("loaded %s provs",s.size);const i=new Date;s.set(t.toString(),i);const o=S0(e);n.cache.set(o,s),yield function uQe(r,e,t,n){return xA.apply(this,arguments)}(n.components.datastore,e,t,i)}))})()}getProviders(e){var t=this;return(0,B.Z)(function*(){return yield t.syncQueue.add((0,B.Z)(function*(){return ca("get providers for %s",e),[...(yield t._getProvidersMap(e)).keys()].map(s=>bt(s))}))})()}}function S0(r){const e="string"==typeof r?r:ol(r.multihash.bytes,"base32");return`${cK}/${e}`}function xA(){return xA=(0,B.Z)(function*(r,e,t,n){const s=[S0(e),"/",t.toString()].join(""),i=new ft(s),o=Uint8Array.from(vt.encode(n.getTime()));return yield r.put(i,o)}),xA.apply(this,arguments)}function UK(r){const e=r.toString().split("/");if(5!==e.length)throw new Error(`incorrectly formatted provider entry key in datastore: ${r.toString()}`);return{cid:e[3],peerId:e[4]}}function SA(){return SA=(0,B.Z)(function*(r,e){const t=new Map,n=r.query({prefix:S0(e)});var o,s=!1,i=!1;try{for(var c,a=be(n);s=!(c=yield a.next()).done;s=!1){const u=c.value,{peerId:f}=UK(u.key);t.set(f,MK(u.value))}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield a.return())}finally{if(i)throw o}}return t}),SA.apply(this,arguments)}function MK(r){return new Date(vt.decode(r))}const fQe=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");function AA(){return AA=Ee(function*(r){const{key:e,startingPeer:t,ourPeerId:n,signal:s,query:i,alpha:o,pathIndex:a,numPaths:c,cleanUp:u,queryFuncTimeout:f,log:E,peersSeen:T}=r,U=new an({concurrency:o}),b=yield X(Bu(e));(function P(F,M){if(null==F)return;T.add(F);const H=BigInt("0x"+ol(w0(M,b),"base16"));U.add((0,B.Z)(function*(){let $;const V=[s];null!=f&&($=new Ar.TimeoutController(f),V.push($.signal));const W=(0,wn.anySignal)(V);try{var ne,ge,Y=!1,q=!1;try{for(var De,Ce=be(i({key:e,peer:F,signal:W,pathIndex:a,numPaths:c}));Y=!(De=yield Ce.next()).done;Y=!1){const Xe=De.value;if(W.aborted)return;if("PEER_RESPONSE"===Xe.name)for(const gt of Xe.closer){if(T.has(gt.id)){E("already seen %p in query",gt.id);continue}if(n.equals(gt.id)){E("not querying ourselves");continue}const Pr=yield oa(gt.id);BigInt("0x"+ol(w0(Pr,b),"base16"))>H?E("skipping %p as they are not closer to %b than %p",gt.id,e,F):(E("querying closer peer %p",gt.id),P(gt.id,Pr))}U.emit("completed",Xe)}}catch(Xe){q=!0,ge=Xe}finally{try{Y&&null!=Ce.return&&(yield Ce.return())}finally{if(q)throw ge}}null===(ne=$)||void 0===ne||ne.clear()}catch(Xe){s.aborted?U.emit("error",Xe):U.emit("completed",aa({from:F,error:Xe}))}finally{var Je;null===(Je=$)||void 0===Je||Je.clear()}}),{priority:fQe-H}).catch($=>{E.error($)})})(t,yield X(oa(t))),yield*Fe(be(pQe(U,s,u,E)),X)}),AA.apply(this,arguments)}function pQe(r,e,t,n){return TA.apply(this,arguments)}function TA(){return TA=Ee(function*(r,e,t,n){let s=en(),i=!0;const o=[],a=()=>{!i||(n("clean up queue, results %d, queue size %d, pending tasks %d",o.length,r.size,r.pending),i=!1,r.clear(),o.splice(0,o.length))};for(r.on("completed",c=>{o.push(c),s.resolve()}),r.on("error",c=>{n("queue error",c),a(),s.reject(c)}),r.on("idle",()=>{n("queue idle"),i=!1,s.resolve()}),e.addEventListener("abort",()=>{n("abort queue");const c=i;a(),c&&s.reject(ee(new Error("Query aborted"),"ERR_QUERY_ABORTED"))}),t.addEventListener("cleanup",()=>{a(),s.resolve()});i;)for(yield X(s.promise),s=en();o.length>0;){const c=o.shift();null!=c&&(yield c)}yield*Fe(be(o),X)}),TA.apply(this,arguments)}const FK="running-queries";class yQe{constructor(e,t){const{lan:n=!1,disjointPaths:s=lA,alpha:i=Ig}=t;this.components=e,this.disjointPaths=s??lA,this.controllers=new Set,this.running=!1,this.alpha=i??Ig,this.lan=n,this.queries=0}isStarted(){return this.running}start(){var e=this;return(0,B.Z)(function*(){e.running=!0})()}stop(){var e=this;return(0,B.Z)(function*(){e.running=!1;for(const t of e.controllers)t.abort();e.controllers.clear()})()}run(e,t,n,s={}){var i=this;return Ee(function*(){if(!i.running)throw new Error("QueryManager not started");let o;if(null==s.signal){o=new Ar.TimeoutController(cWe),s.signal=o.signal;try{null!=rt.setMaxListeners&&(0,rt.setMaxListeners)(1/0,o.signal)}catch{}}const a=new AbortController;i.controllers.add(a);const c=[a.signal];null!=s.signal&&c.push(s.signal);const u=(0,wn.anySignal)(c);try{null!=rt.setMaxListeners&&(0,rt.setMaxListeners)(1/0,u)}catch{}const f=Be(`libp2p:kad-dht:${i.lan?"lan":"wan"}:query:`+ol(e,"base58btc")),E=t.slice(0,Math.min(i.disjointPaths,t.length)),T=Date.now(),U=new wr;try{var b;if(f("query:start"),i.queries++,null===(b=i.components.metrics)||void 0===b||b.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(i.lan?"lan":"wan"),metric:FK,value:i.queries}),0===t.length)return void f.error("Running query with no peers");const W=new sc,ne=E.map((Y,q)=>function hQe(r){return AA.apply(this,arguments)}({key:e,startingPeer:Y,ourPeerId:i.components.peerId,signal:u,query:n,pathIndex:q,numPaths:E.length,alpha:i.alpha,cleanUp:U,queryFuncTimeout:s.queryFuncTimeout,log:f,peersSeen:W}));var M,P=!1,F=!1;try{for(var $,H=be(Xs(...ne));P=!($=yield X(H.next())).done;P=!1){const Y=$.value;yield Y,"QUERY_ERROR"===Y.name&&f("error",Y.error)}}catch(Y){F=!0,M=Y}finally{try{P&&null!=H.return&&(yield X(H.return()))}finally{if(F)throw M}}}catch(W){if(i.running||"ERR_QUERY_ABORTED"!==W.code)throw W}finally{var V;i.controllers.delete(a),o?.clear(),i.queries--,null===(V=i.components.metrics)||void 0===V||V.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(i.lan?"lan":"wan"),metric:FK,value:i.queries}),U.dispatchEvent(new Qe("cleanup")),f("query:done in %dms",Date.now()-T)}})()}}const A0=Be("libp2p:kad-dht:rpc:handlers:add-provider");class gQe{constructor(e){const{providers:t}=e;this.providers=t}handle(e,t){var n=this;return(0,B.Z)(function*(){if(A0("start"),null==t.key||0===t.key.length)throw ee(new Error("Missing key"),"ERR_MISSING_KEY");let s;try{s=hn.decode(t.key)}catch{throw ee(new Error("Invalid CID"),"ERR_INVALID_CID")}(null==t.providerPeers||0===t.providerPeers.length)&&A0.error("no providers found in message"),yield Promise.all(t.providerPeers.map(function(){var i=(0,B.Z)(function*(o){o.id.equals(e)?o.multiaddrs.length<1?A0("no valid addresses for provider %p. Ignore",e):(A0("received provider %p for %s (addrs %s)",e,s,o.multiaddrs.map(a=>a.toString())),yield n.providers.addProvider(s,o.id)):A0("invalid provider peer %p from %p",o.id,e)});return function(o){return i.apply(this,arguments)}}()))})()}}const zK=Be("libp2p:kad-dht:rpc:handlers:find-node");class bQe{constructor(e,t){const{peerRouting:n,lan:s}=t;this.components=e,this.peerRouting=n,this.lan=Boolean(s)}handle(e,t){var n=this;return(0,B.Z)(function*(){zK("incoming request from %p for peers closer to %b",e,t.key);let s=[];s=Og(n.components.peerId.toBytes(),t.key)?[{id:n.components.peerId,multiaddrs:n.components.addressManager.getAddresses().map(o=>o.decapsulateCode(jr("p2p").code)),protocols:[]}]:yield n.peerRouting.getCloserPeersOffline(t.key,e),s=s.map(n.lan?dA:uA).filter(({multiaddrs:o})=>o.length);const i=new Vs(t.type,new Uint8Array(0),t.clusterLevel);return s.length>0?i.closerPeers=s:zK("could not find any peers closer to %b than %p",t.key,e),i})()}}const VK=Be("libp2p:kad-dht:rpc:handlers:get-providers");class _Qe{constructor(e,t){const{peerRouting:n,providers:s,lan:i}=t;this.components=e,this.peerRouting=n,this.providers=s,this.lan=Boolean(i)}handle(e,t){var n=this;return(0,B.Z)(function*(){let s;try{s=hn.decode(t.key)}catch{throw ee(new Error("Invalid CID"),"ERR_INVALID_CID")}VK("%p asking for providers for %s",e,s);const[i,o]=yield Promise.all([n.providers.getProviders(s),n.peerRouting.getCloserPeersOffline(t.key,e)]),a=yield n._getPeers(i),c=yield n._getPeers(o.map(({id:f})=>f)),u=new Vs(t.type,t.key,t.clusterLevel);return a.length>0&&(u.providerPeers=a),c.length>0&&(u.closerPeers=c),VK("got %s providers %s closerPeers",a.length,c.length),u})()}_getAddresses(e){var t=this;return(0,B.Z)(function*(){return(yield t.components.peerStore.addressBook.get(e)).map(s=>s.multiaddr)})()}_getPeers(e){var t=this;return(0,B.Z)(function*(){const n=[],s=t.lan?dA:uA;for(const i of e){const o=s({id:i,multiaddrs:yield t._getAddresses(i),protocols:[]});o.multiaddrs.length>0&&n.push(o)}return n})()}}const ku=Be("libp2p:kad-dht:rpc:handlers:get-value");class mQe{constructor(e,t){const{peerRouting:n}=t;this.components=e,this.peerRouting=n}handle(e,t){var n=this;return(0,B.Z)(function*(){const s=t.key;if(ku("%p asked for key %b",e,s),null==s||0===s.length)throw ee(new Error("Invalid key"),"ERR_INVALID_KEY");const i=new Vs(gs.GET_VALUE,s,t.clusterLevel);if(function dWe(r){return"/pk/"===ol(r.subarray(0,4))}(s)){ku("is public key");const c=function fWe(r){return Ai(r.subarray(4))}(s);let u;try{const f=yield n.components.peerStore.keyBook.get(c);if(null==f)throw ee(new Error("No public key found in key book"),"ERR_NOT_FOUND");u=f}catch(f){if("ERR_NOT_FOUND"!==f.code)throw f}if(null!=u)return ku("returning found public key"),i.record=new Ts(s,u,new Date),i}const[o,a]=yield Promise.all([n._checkLocalDatastore(s),n.peerRouting.getCloserPeersOffline(t.key,e)]);return null!=o&&(ku("had record for %b in local datastore",s),i.record=o),a.length>0&&(ku("had %s closer peers in routing table",a.length),i.closerPeers=a),i})()}_checkLocalDatastore(e){var t=this;return(0,B.Z)(function*(){ku("checkLocalDatastore looking for %b",e);const n=Lu(e);let s;try{s=yield t.components.datastore.get(n)}catch(o){if("ERR_NOT_FOUND"===o.code)return;throw o}const i=Ts.deserialize(s);if(null==i)throw ee(new Error("Invalid record"),"ERR_INVALID_RECORD");if(!(null==i.timeReceived||Date.now()-i.timeReceived.getTime()>1296e5))return i;yield t.components.datastore.delete(n)})()}}const vQe=Be("libp2p:kad-dht:rpc:handlers:ping");class wQe{handle(e,t){return(0,B.Z)(function*(){return vQe("ping from %p",e),t})()}}class EQe{constructor(e,t){const{validators:n}=t;this.components=e,this.log=Be("libp2p:kad-dht:rpc:handlers:put-value"),this.validators=n}handle(e,t){var n=this;return(0,B.Z)(function*(){const s=t.key;n.log("%p asked us to store value for key %b",e,s);const i=t.record;if(null==i){const o=`Empty record from: ${e.toString()}`;throw n.log.error(o),ee(new Error(o),"ERR_EMPTY_RECORD")}try{yield EA(n.validators,i),i.timeReceived=new Date;const o=Lu(i.key);yield n.components.datastore.put(o,i.serialize().subarray()),n.log("put record for %b into datastore under key %k",s,o)}catch(o){n.log("did not put record for key %b into datastore %o",s,o)}return t})()}}class xQe{constructor(e,t){const{providers:n,peerRouting:s,validators:i,lan:o}=t;this.log=Be("libp2p:kad-dht:rpc"),this.routingTable=t.routingTable,this.handlers={[gs.GET_VALUE]:new mQe(e,{peerRouting:s}),[gs.PUT_VALUE]:new EQe(e,{validators:i}),[gs.FIND_NODE]:new bQe(e,{peerRouting:s,lan:o}),[gs.ADD_PROVIDER]:new gQe({providers:n}),[gs.GET_PROVIDERS]:new _Qe(e,{peerRouting:s,providers:n,lan:o}),[gs.PING]:new wQe}}handleMessage(e,t){var n=this;return(0,B.Z)(function*(){try{yield n.routingTable.add(e)}catch(i){n.log.error("Failed to update the kbucket store",i)}const s=n.handlers[t.type];if(null!=s)return yield s.handle(e,t);n.log.error(`no handler found for message type: ${t.type}`)})()}onIncomingStream(e){var t=this;Promise.resolve().then((0,B.Z)(function*(){const{stream:n,connection:s}=e,i=s.remotePeer;try{yield t.routingTable.add(i)}catch(a){t.log.error(a)}const o=t;yield _t(n,Fs(),function(){var a=Ee(function*(c){var E,u=!1,f=!1;try{for(var U,T=be(c);u=!(U=yield X(T.next())).done;u=!1){const P=Vs.deserialize(U.value);o.log("incoming %s from %p",P.type,i);const F=yield X(o.handleMessage(i,P));null!=F&&(yield F.serialize())}}catch(b){f=!0,E=b}finally{try{u&&null!=T.return&&(yield X(T.return()))}finally{if(f)throw E}}});return function(c){return a.apply(this,arguments)}}(),ei(),n)})).catch(n=>{this.log.error(n)})}}class SQe extends wr{constructor(e,t){super();const{protocol:n,lan:s}=t;this.components=e,this.log=Be("libp2p:kad-dht:topology-listener:"+(s?"lan":"wan")),this.running=!1,this.protocol=n}isStarted(){return this.running}start(){var e=this;return(0,B.Z)(function*(){if(e.running)return;e.running=!0;const t=V9({onConnect:n=>{e.log("observed peer %p with protocol %s",n,e.protocol),e.dispatchEvent(new Qe("peer",{detail:n}))}});e.registrarId=yield e.components.registrar.register(e.protocol,t)})()}stop(){this.running=!1,null!=this.registrarId&&(this.components.registrar.unregister(this.registrarId),this.registrarId=void 0)}}class AQe{constructor(e,t){const{peerRouting:n,lan:s,count:i,interval:o,queryTimeout:a}=t;this.components=e,this.log=Be(`libp2p:kad-dht:${s?"lan":"wan"}:query-self`),this.running=!1,this.peerRouting=n,this.count=i??lA,this.interval=o??sWe,this.queryTimeout=a??iWe}isStarted(){return this.running}start(){var e=this;return(0,B.Z)(function*(){e.running||(e.running=!0,e._querySelf())})()}stop(){var e=this;return(0,B.Z)(function*(){e.running=!1,null!=e.timeoutId&&clearTimeout(e.timeoutId),null!=e.controller&&e.controller.abort()})()}_querySelf(){var e=this;Promise.resolve().then((0,B.Z)(function*(){const t=new Ar.TimeoutController(e.queryTimeout);try{e.controller=new AbortController;const n=(0,wn.anySignal)([e.controller.signal,t.signal]);try{null!=rt.setMaxListeners&&(0,rt.setMaxListeners)(1/0,n)}catch{}const s=yield _t(e.peerRouting.getClosestPeers(e.components.peerId.toBytes(),{signal:n}),i=>A9(i,e.count),function(){var i=(0,B.Z)(function*(o){return yield uu(o)});return function(o){return i.apply(this,arguments)}}());e.log("query ran successfully - found %d peers",s)}catch(n){e.log("query error",n)}finally{e.timeoutId=setTimeout(e._querySelf.bind(e),e.interval),t.clear()}})).catch(t=>{this.log("query error",t)})}}class jK extends wr{constructor(e,t){var n;super(),n=this;const{kBucketSize:s,clientMode:i,validators:o,selectors:a,querySelfInterval:c,lan:u,protocolPrefix:f,pingTimeout:E,pingConcurrency:T,maxInboundStreams:U,maxOutboundStreams:b}=t;this.running=!1,this.components=e,this.lan=Boolean(u),this.log=Be("libp2p:kad-dht:"+(!0===u?"lan":"wan")),this.protocol=`${f??"/ipfs"}${!0===u?"/lan":""}/kad/1.0.0`,this.kBucketSize=s??20,this.clientMode=i??!0,this.maxInboundStreams=U??32,this.maxOutboundStreams=b??64,this.routingTable=new vWe(e,{kBucketSize:s,lan:this.lan,pingTimeout:E,pingConcurrency:T,protocol:this.protocol}),this.providers=new lQe(e),this.validators={...tQe,...o},this.selectors={...sQe,...a},this.network=new AWe(e,{protocol:this.protocol,lan:this.lan}),this.queryManager=new yQe(e,{disjointPaths:Math.ceil(this.kBucketSize/2),lan:u}),this.peerRouting=new cQe(e,{routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,lan:this.lan}),this.contentFetching=new iQe(e,{validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,network:this.network,lan:this.lan}),this.contentRouting=new oQe(e,{network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,lan:this.lan}),this.routingTableRefresh=new EWe({peerRouting:this.peerRouting,routingTable:this.routingTable,lan:this.lan}),this.rpc=new xQe(e,{routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,lan:this.lan}),this.topologyListener=new SQe(e,{protocol:this.protocol,lan:this.lan}),this.querySelf=new AQe(e,{peerRouting:this.peerRouting,interval:c,lan:this.lan}),this.network.addEventListener("peer",P=>{const F=P.detail;this.onPeerConnect(F).catch(M=>{this.log.error("could not add %p to routing table",F.id,M)}),this.dispatchEvent(new Qe("peer",{detail:F}))}),this.topologyListener.addEventListener("peer",P=>{const F=P.detail;Promise.resolve().then((0,B.Z)(function*(){const M=yield n.components.peerStore.addressBook.get(F),H={id:F,multiaddrs:M.map($=>$.multiaddr),protocols:[]};yield n.onPeerConnect(H)})).catch(M=>{this.log.error("could not add %p to routing table",F,M)})})}get[Cu](){return!0}get[Symbol.toStringTag](){return"@libp2p/kad-dht"}onPeerConnect(e){var t=this;return(0,B.Z)(function*(){if(t.log("peer %p connected with protocols %s",e.id,e.protocols),0!==(e=t.lan?dA(e):uA(e)).multiaddrs.length)try{yield t.routingTable.add(e.id)}catch(n){t.log.error("could not add %p to routing table",e.id,n)}else t.log("ignoring %p as they do not have any %s addresses in %s",e.id,t.lan?"private":"public",e.multiaddrs.map(n=>n.toString()))})()}isStarted(){return this.running}getMode(){var e=this;return(0,B.Z)(function*(){return e.clientMode?"client":"server"})()}setMode(e){var t=this;return(0,B.Z)(function*(){yield t.components.registrar.unhandle(t.protocol),"client"===e?(t.log("enabling client mode"),t.clientMode=!0):(t.log("enabling server mode"),t.clientMode=!1,yield t.components.registrar.handle(t.protocol,t.rpc.onIncomingStream.bind(t.rpc),{maxInboundStreams:t.maxInboundStreams,maxOutboundStreams:t.maxOutboundStreams}))})()}start(){var e=this;return(0,B.Z)(function*(){e.running=!0,yield e.setMode(e.clientMode?"client":"server"),yield Promise.all([e.providers.start(),e.queryManager.start(),e.network.start(),e.routingTable.start(),e.topologyListener.start(),e.querySelf.start()]),yield e.routingTableRefresh.start()})()}stop(){var e=this;return(0,B.Z)(function*(){e.running=!1,yield Promise.all([e.providers.stop(),e.queryManager.stop(),e.network.stop(),e.routingTable.stop(),e.routingTableRefresh.stop(),e.topologyListener.stop(),e.querySelf.stop()])})()}put(e,t,n={}){var s=this;return Ee(function*(){yield*Fe(be(s.contentFetching.put(e,t,n)),X)})()}get(e,t={}){var n=this;return Ee(function*(){yield*Fe(be(n.contentFetching.get(e,t)),X)})()}provide(e,t={}){var n=this;return Ee(function*(){yield*Fe(be(n.contentRouting.provide(e,n.components.addressManager.getAddresses(),t)),X)})()}findProviders(e,t={}){var n=this;return Ee(function*(){yield*Fe(be(n.contentRouting.findProviders(e,t)),X)})()}findPeer(e,t={}){var n=this;return Ee(function*(){yield*Fe(be(n.peerRouting.findPeer(e,t)),X)})()}getClosestPeers(e,t={}){var n=this;return Ee(function*(){yield*Fe(be(n.peerRouting.getClosestPeers(e,t)),X)})()}refreshRoutingTable(){var e=this;return(0,B.Z)(function*(){yield e.routingTableRefresh.refreshTable(!0)})()}}const IQe=Be("libp2p:kad-dht");class RQe extends wr{constructor(e,t,n){super(),this.components=e,this.wan=t,this.lan=n,this.wan.addEventListener("peer",s=>{this.dispatchEvent(new Qe("peer",{detail:s.detail}))}),this.lan.addEventListener("peer",s=>{this.dispatchEvent(new Qe("peer",{detail:s.detail}))})}get[Cu](){return!0}get[Symbol.toStringTag](){return"@libp2p/dual-kad-dht"}isStarted(){return this.wan.isStarted()&&this.lan.isStarted()}getMode(){var e=this;return(0,B.Z)(function*(){return yield e.wan.getMode()})()}setMode(e){var t=this;return(0,B.Z)(function*(){yield t.wan.setMode(e)})()}start(){var e=this;return(0,B.Z)(function*(){yield Promise.all([e.lan.start(),e.wan.start()])})()}stop(){var e=this;return(0,B.Z)(function*(){yield Promise.all([e.lan.stop(),e.wan.stop()])})()}put(e,t,n={}){var s=this;return Ee(function*(){var a,i=!1,o=!1;try{for(var u,c=be(Xs(s.lan.put(e,t,n),s.wan.put(e,t,n)));i=!(u=yield X(c.next())).done;i=!1)yield u.value}catch(f){o=!0,a=f}finally{try{i&&null!=c.return&&(yield X(c.return()))}finally{if(o)throw a}}})()}get(e,t={}){var n=this;return Ee(function*(){let s=!1,i=!1;var c,o=!1,a=!1;try{for(var f,u=be(Xs(n.lan.get(e,t),n.wan.get(e,t)));o=!(f=yield X(u.next())).done;o=!1){const E=f.value;yield E,"DIALING_PEER"===E.name&&(s=!0),"VALUE"===E.name&&(s=!0,null!=E.value&&(i=!0)),"SENDING_QUERY"===E.name&&(s=!0)}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}if(!s)throw ee(new Error("No peers found in routing table!"),"ERR_NO_PEERS_IN_ROUTING_TABLE");i||(yield aa({from:n.components.peerId,error:ee(new Error("Not found"),"ERR_NOT_FOUND")}))})()}provide(e,t={}){var n=this;return Ee(function*(){let s=0,i=0;const o=[],a=[n.lan];"server"===(yield X(n.wan.getMode()))&&a.push(n.wan);var f,c=!1,u=!1;try{for(var T,E=be(Xs(...a.map(U=>U.provide(e,t))));c=!(T=yield X(E.next())).done;c=!1){const U=T.value;yield U,"SENDING_QUERY"===U.name&&s++,"QUERY_ERROR"===U.name&&o.push(U.error),"PEER_RESPONSE"===U.name&&"ADD_PROVIDER"===U.messageName&&(IQe("sent provider record for %s to %p",e,U.from),i++)}}catch(U){u=!0,f=U}finally{try{c&&null!=E.return&&(yield X(E.return()))}finally{if(u)throw f}}if(0===i)throw o.length>0?ee(new Error(`Failed to provide to ${o.length} of ${s} peers`),"ERR_PROVIDES_FAILED",{errors:o}):ee(new Error("Failed to provide - no peers found"),"ERR_PROVIDES_FAILED")})()}findProviders(e,t={}){var n=this;return Ee(function*(){yield*Fe(be(Xs(n.lan.findProviders(e,t),n.wan.findProviders(e,t))),X)})()}findPeer(e,t={}){var n=this;return Ee(function*(){let s=!1;var a,i=!1,o=!1;try{for(var u,c=be(Xs(n.lan.findPeer(e,t),n.wan.findPeer(e,t)));i=!(u=yield X(c.next())).done;i=!1){const f=u.value;yield f,("SENDING_QUERY"===f.name||"FINAL_PEER"===f.name)&&(s=!0)}}catch(f){o=!0,a=f}finally{try{i&&null!=c.return&&(yield X(c.return()))}finally{if(o)throw a}}if(!s)throw ee(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED")})()}getClosestPeers(e,t={}){var n=this;return Ee(function*(){yield*Fe(be(Xs(n.lan.getClosestPeers(e,t),n.wan.getClosestPeers(e,t))),X)})()}refreshRoutingTable(){var e=this;return(0,B.Z)(function*(){yield Promise.all([e.lan.refreshRoutingTable(),e.wan.refreshRoutingTable()])})()}}class DQe extends RQe{constructor(e,t){super(e,new jK(e,{protocolPrefix:"/ipfs",...t,lan:!1}),new jK(e,{protocolPrefix:"/ipfs",...t,clientMode:!1,lan:!0}))}}const Bg=Be("libp2p:bootstrap");let kQe=(()=>{class r extends wr{constructor(t,n={list:[]}){var s;if(null==n.list||0===n.list.length)throw new Error("Bootstrap requires a list of peer addresses");super(),this.components=t,this.timeout=null!==(s=n.timeout)&&void 0!==s?s:1e3,this.list=[];for(const i of n.list){if(!HI.matches(i)){Bg.error("Invalid multiaddr");continue}const o=at(i),a=o.getPeerId();if(null==a){Bg.error("Invalid bootstrap multiaddr without peer id");continue}const c={id:bt(a),multiaddrs:[o],protocols:[]};this.list.push(c)}this._init=n}get[Cu](){return!0}get[Symbol.toStringTag](){return"@libp2p/bootstrap"}isStarted(){return Boolean(this.timer)}start(){this.isStarted()||(Bg("Starting bootstrap node discovery, discovering peers after %s ms",this.timeout),this.timer=setTimeout(()=>{this._discoverBootstrapPeers().catch(t=>{Bg.error(t)})},this.timeout))}_discoverBootstrapPeers(){var t=this;return(0,B.Z)(function*(){if(null!=t.timer)for(const o of t.list){var n,s,i;if(yield t.components.peerStore.tagPeer(o.id,null!==(n=t._init.tagName)&&void 0!==n?n:"bootstrap",{value:null!==(s=t._init.tagValue)&&void 0!==s?s:50,ttl:null!==(i=t._init.tagTTL)&&void 0!==i?i:12e4}),null==t.timer)return;t.dispatchEvent(new Qe("peer",{detail:o}))}})()}stop(){null!=this.timer&&clearTimeout(this.timer),this.timer=void 0}}return r.tag="bootstrap",r})();const MQe=WebSocket;var FQe=p(36883);const $Qe=function zQe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},Lg=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class GQe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class WQe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return $K(this,e)}}class YQe{constructor(e){this.decoders=e}or(e){return $K(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const $K=(r,e)=>new YQe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class QQe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new GQe(e,t,n),this.decoder=new WQe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const kg=({name:r,prefix:e,encode:t,decode:n})=>new QQe(r,e,t,n),T0=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=$Qe(t,e);return kg({prefix:r,name:e,encode:n,decode:i=>Lg(s(i))})},Wn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>kg({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),qQe=kg({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),eJe=Wn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),tJe=Wn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),rJe=T0({prefix:"9",name:"base10",alphabet:"0123456789"}),nJe=Wn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),sJe=Wn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),iJe=Wn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),oJe=Wn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),aJe=Wn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),cJe=Wn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),lJe=Wn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),uJe=Wn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),dJe=Wn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),fJe=Wn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hJe=Wn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),pJe=T0({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),yJe=T0({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),gJe=T0({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),bJe=T0({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),_Je=Wn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),mJe=Wn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),vJe=Wn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),wJe=Wn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),KK=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),EJe=KK.reduce((r,e,t)=>(r[t]=e,r),[]),xJe=KK.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),TJe=kg({prefix:"\u{1f680}",name:"base256emoji",encode:function SJe(r){return r.reduce((e,t)=>e+EJe[t],"")},decode:function AJe(r){const e=[];for(const t of r){const n=xJe[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var DJe=Math.pow(2,31),NJe=Math.pow(2,7),BJe=Math.pow(2,14),LJe=Math.pow(2,21),kJe=Math.pow(2,28),UJe=Math.pow(2,35),MJe=Math.pow(2,42),FJe=Math.pow(2,49),zJe=Math.pow(2,56),VJe=Math.pow(2,63),$Je={encode:function HK(r,e,t){e=e||[];for(var n=t=t||0;r>=DJe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,HK.bytes=t-n+1,e},decode:function CA(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw CA.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return CA.bytes=i-n,t},encodingLength:function(r){return r<NJe?1:r<BJe?2:r<LJe?3:r<kJe?4:r<UJe?5:r<MJe?6:r<FJe?7:r<zJe?8:r<VJe?9:10}};const WK=$Je,YK=(r,e,t=0)=>(WK.encode(r,e,t),e),QK=r=>WK.encodingLength(r),IA=(r,e)=>{const t=e.byteLength,n=QK(r),s=n+QK(t),i=new Uint8Array(s+t);return YK(r,i,0),YK(t,i,n),i.set(e,s),new JK(r,t,e,i)};class JK{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const XK=({name:r,code:e,encode:t})=>new ZJe(r,e,t);class ZJe{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?IA(this.code,t):t.then(n=>IA(this.code,n))}throw Error("Unknown type, must be binary type")}}const qK=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),HJe=XK({name:"sha2-256",code:18,encode:qK("SHA-256")}),GJe=XK({name:"sha2-512",code:19,encode:qK("SHA-512")}),tZ=Lg,YJe={code:0,name:"identity",encode:tZ,digest:r=>IA(0,tZ(r))},QJe="raw",JJe=85,XJe=r=>Lg(r),qJe=r=>Lg(r),eXe=new TextEncoder,tXe=new TextDecoder,rXe="json",nXe=512,sXe=r=>eXe.encode(JSON.stringify(r)),iXe=r=>JSON.parse(tXe.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const sZ={...Bv,...Lv,...kv,...Uv,...Mv,...Fv,...zv,...Vv,...jv,...$v};function iZ(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function oZ(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const aZ=oZ("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),DA=oZ("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function fXe(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?iZ(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),hXe={utf8:aZ,"utf-8":aZ,hex:sZ.base16,latin1:DA,ascii:DA,binary:DA,...sZ};function cZ(r){var e;return r instanceof ArrayBuffer||"ArrayBuffer"===(null==r||null===(e=r.constructor)||void 0===e?void 0:e.name)&&"number"==typeof r?.byteLength}const yXe=r=>{r.binaryType="arraybuffer";const e=function(){var i=(0,B.Z)(function*(){return yield new Promise((o,a)=>{if(n)return o();if(null!=s)return a(s);const c=E=>{r.removeEventListener("open",u),r.removeEventListener("error",f),E()},u=()=>c(o),f=E=>{c(()=>{var T;return a(null!==(T=E.error)&&void 0!==T?T:new Error(`connect ECONNREFUSED ${r.url}`))})};r.addEventListener("open",u),r.addEventListener("error",f)})});return function(){return i.apply(this,arguments)}}(),t=Ee(function*(){const i=new FQe.zN(({push:E,stop:T,fail:U})=>{const b=F=>{let M=null;"string"==typeof F.data&&(M=function pXe(r,e="utf8"){const t=hXe[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):iZ(globalThis.Buffer.from(r,"utf-8"))}(F.data)),cZ(F.data)&&(M=new Uint8Array(F.data)),F.data instanceof Uint8Array&&(M=F.data),null!=M&&E(M)},P=F=>{var M;return U(null!==(M=F.error)&&void 0!==M?M:new Error("Socket error"))};return r.addEventListener("message",b),r.addEventListener("error",P),r.addEventListener("close",T),()=>{r.removeEventListener("message",b),r.removeEventListener("error",P),r.removeEventListener("close",T)}},{highWaterMark:1/0});yield X(e());var c,o=!1,a=!1;try{for(var f,u=be(i);o=!(f=yield X(u.next())).done;o=!1){const E=f.value;yield cZ(E)?new Uint8Array(E):E}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}})();let s,n=1===r.readyState;return r.addEventListener("open",()=>{n=!0,s=null}),r.addEventListener("close",()=>{n=!1,s=null}),r.addEventListener("error",i=>{var o;n||(s=null!==(o=i.error)&&void 0!==o?o:new Error(`connect ECONNREFUSED ${r.url}`))}),Object.assign(t,{connected:e})},gXe=r=>{if(r.readyState>=2)throw new Error("socket closed");if(1!==r.readyState)return new Promise((e,t)=>{function n(){r.removeEventListener("open",s),r.removeEventListener("error",i)}function s(){n(),e()}function i(o){var a;n(),t(null!==(a=o.error)&&void 0!==a?a:new Error(`connect ECONNREFUSED ${r.url}`))}r.addEventListener("open",s),r.addEventListener("error",i)})},bXe=(r,e)=>{var t;return(e=null!==(t=e)&&void 0!==t?t:{}).closeOnEnd=!1!==e.closeOnEnd,function(){var s=(0,B.Z)(function*(i){var c,o=!1,a=!1;try{for(var f,u=be(i);o=!(f=yield u.next()).done;o=!1){const E=f.value;try{yield gXe(r)}catch(T){if("socket closed"===T.message)break;throw T}r.send(E)}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield u.return())}finally{if(a)throw c}}if(null!=e.closeOnEnd&&r.readyState<=1)return yield new Promise((E,T)=>{r.addEventListener("close",U=>{if(U.wasClean||1006===U.code)E();else{const b=Object.assign(new Error("ws error"),{event:U});T(b)}}),setTimeout(()=>r.close())})});return function(o){return s.apply(this,arguments)}}()},_Xe=(r,e)=>{var t;e=null!==(t=e)&&void 0!==t?t:{};const n=yXe(r);let s=e.remoteAddress,i=e.remotePort;if(null!=r.url)try{const a=new URL(r.url);s=a.hostname,i=parseInt(a.port,10)}catch{}if(null==s||null==i)throw new Error("Remote connection did not have address and/or port");return{sink:bXe(r,e),source:n,connected:(a=(0,B.Z)(function*(){return yield n.connected()}),function(){return a.apply(this,arguments)}),close:function(){var a=(0,B.Z)(function*(){(r.readyState===r.CONNECTING||r.readyState===r.OPEN)&&(yield new Promise(c=>{r.addEventListener("close",()=>{c()}),r.close()}))});return function(){return a.apply(this,arguments)}}(),destroy:()=>{null!=r.terminate?r.terminate():r.close()},remoteAddress:s,remotePort:i,socket:r};var a},mXe={http:"ws",https:"wss"};const dZ=Be("libp2p:websockets:socket"),dc=Be("libp2p:websockets");class DXe{constructor(e){this.init=e}get[Symbol.toStringTag](){return"@libp2p/websockets"}get[Y2](){return!0}dial(e,t){var n=this;return(0,B.Z)(function*(){var s;dc("dialing %s",e),t=null!==(s=t)&&void 0!==s?s:{};const o=function CXe(r,e,t){var n;const s={sink:i=>(0,B.Z)(function*(){var o;null!=(null===(o=t)||void 0===o?void 0:o.signal)&&(i=Ms(i,t.signal));try{yield r.sink(i)}catch(a){"aborted"!==a.type&&dZ.error(a)}})(),source:null!=(t=null!==(n=t)&&void 0!==n?n:{}).signal?Ms(r.source,t.signal):r.source,remoteAddr:e,timeline:{open:Date.now()},close:()=>(0,B.Z)(function*(){const i=Date.now();try{yield Jk(r.close(),{milliseconds:2e3})}catch{const{host:a,port:c}=s.remoteAddr.toOptions();dZ("timeout closing stream to %s:%s after %dms, destroying it manually",a,c,Date.now()-i),r.destroy()}finally{s.timeline.close=Date.now()}})()};return r.socket.addEventListener("close",()=>{null==s.timeline.close&&(s.timeline.close=Date.now())},{once:!0}),s}(yield n._connect(e,t),e);dc("new outbound connection %s",o.remoteAddr);const a=yield t.upgrader.upgradeOutbound(o);return dc("outbound connection %s upgraded",o.remoteAddr),a})()}_connect(e,t){var n=this;return(0,B.Z)(function*(){var s;if(!0===(null==t||null===(s=t.signal)||void 0===s?void 0:s.aborted))throw new Pu;const i=e.toOptions();dc("dialing %s:%s",i.host,i.port);const o=en(),a=T=>{dc.error("connection error:",T),o.reject(T)},c=function EXe(r,e){var t;e=null!==(t=e)&&void 0!==t?t:{};const s=((r,e)=>(0,QI.relative)(r,e,mXe,"ws"))(r,(typeof window>"u"?"":window.location).toString()),i=new MQe(s,e.websocket);return _Xe(i,e)}(zE(e),n.init);if(null!=c.socket.on?c.socket.on("error",a):c.socket.onerror=a,null==t.signal)return yield Promise.race([c.connected(),o.promise]),dc("connected %s",e),c;let u;const f=new Promise((T,U)=>{var b,P;if(u=()=>{U(new Pu),c.close().catch(F=>{dc.error("error closing raw socket",F)})},!0===(null==t||null===(b=t.signal)||void 0===b?void 0:b.aborted))return u();null==t||null===(P=t.signal)||void 0===P||P.addEventListener("abort",u)});try{yield Promise.race([f,o.promise,c.connected()])}finally{var E;null!=u&&(null==t||null===(E=t.signal)||void 0===E||E.removeEventListener("abort",u))}return dc("connected %s",e),c})()}createListener(e){return function xXe(){throw new Error("WebSocket Servers can not be created in the browser!")}()}filter(e){var t,n;return e=Array.isArray(e)?e:[e],null!=(null===(t=this.init)||void 0===t?void 0:t.filter)?null===(n=this.init)||void 0===n?void 0:n.filter(e):fg||b$?function RXe(r){return r.filter(e=>{if(e.protoCodes().includes(290))return!1;const t=e.decapsulateCode(421);return Sc.matches(t)&&xc.matches(t.decapsulateCode(6).decapsulateCode(478))})}(e):function IXe(r){return r.filter(e=>{if(e.protoCodes().includes(290))return!1;const t=e.decapsulateCode(421);return Al.matches(t)||Sc.matches(t)})}(e)}}function fZ(r){return new Uint8Array(r)}var At=(()=>(function(r){r[r.NEW_STREAM=0]="NEW_STREAM",r[r.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",r[r.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",r[r.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",r[r.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",r[r.RESET_RECEIVER=5]="RESET_RECEIVER",r[r.RESET_INITIATOR=6]="RESET_INITIATOR"}(At||(At={})),At))();const OA=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),hZ=Object.freeze({NEW_STREAM:At.NEW_STREAM,MESSAGE:At.MESSAGE_INITIATOR,CLOSE:At.CLOSE_INITIATOR,RESET:At.RESET_INITIATOR}),PXe=Object.freeze({MESSAGE:At.MESSAGE_RECEIVER,CLOSE:At.CLOSE_RECEIVER,RESET:At.RESET_RECEIVER}),pZ=new class NXe{constructor(){this._pool=fZ(10240),this._poolOffset=0}write(e){const t=this._pool;let n=this._poolOffset;vt.encode(e.id<<3|e.type,t,n),n+=vt.encode.bytes,vt.encode(e.type!==At.NEW_STREAM&&e.type!==At.MESSAGE_INITIATOR&&e.type!==At.MESSAGE_RECEIVER||null==e.data?0:e.data.length,t,n),n+=vt.encode.bytes;const s=t.subarray(this._poolOffset,n);return 10240-n<100?(this._pool=fZ(10240),this._poolOffset=0):this._poolOffset=n,e.type!==At.NEW_STREAM&&e.type!==At.MESSAGE_INITIATOR&&e.type!==At.MESSAGE_RECEIVER||null==e.data?[s]:[s,...e.data instanceof Uint8Array?[e.data]:e.data]}};function NA(){return NA=Ee(function*(r){var n,e=!1,t=!1;try{for(var i,s=be(r);e=!(i=yield X(s.next())).done;e=!1){const o=i.value;if(Array.isArray(o))for(const a of o)yield*Fe(be(pZ.write(a)),X);else yield*Fe(be(pZ.write(o)),X)}}catch(o){t=!0,n=o}finally{try{e&&null!=s.return&&(yield X(s.return()))}finally{if(t)throw n}}}),NA.apply(this,arguments)}class LXe{constructor(){this._buffer=new Or,this._headerInfo=null}write(e){if(null==e||0===e.length)return[];this._buffer.append(e);const t=[];for(;0!==this._buffer.length;){if(null==this._headerInfo)try{this._headerInfo=this._decodeHeader(this._buffer)}catch{break}const{id:n,type:s,length:i,offset:o}=this._headerInfo;if(this._buffer.length-o<i)break;const c={id:n,type:s};(s===At.NEW_STREAM||s===At.MESSAGE_INITIATOR||s===At.MESSAGE_RECEIVER)&&(c.data=this._buffer.sublist(o,o+i)),t.push(c),this._buffer.consume(o+i),this._headerInfo=null}return t}_decodeHeader(e){const{value:t,offset:n}=gZ(e),{value:s,offset:i}=gZ(e,n),o=7&t;if(null==OA[o])throw new Error(`Invalid type received: ${o}`);return{id:t>>3,type:o,offset:n+i,length:s}}}function gZ(r,e=0){let i,t=0,n=0,s=e;const o=r.length;do{if(s>=o||n>49)throw e=0,new RangeError("Could not decode varint");i=r.get(s++),t+=n<28?(127&i)<<n:(127&i)*Math.pow(2,n),n+=7}while(i>=128);return{value:t,offset:e=s-e}}function UXe(r){return BA.apply(this,arguments)}function BA(){return BA=Ee(function*(r){const e=new LXe;var s,t=!1,n=!1;try{for(var o,i=be(r);t=!(o=yield X(i.next())).done;t=!1){const c=e.write(o.value);c.length>0&&(yield c)}}catch(a){n=!0,s=a}finally{try{t&&null!=i.return&&(yield X(i.return()))}finally{if(n)throw s}}}),BA.apply(this,arguments)}const bZ=1<<20;const jXe=function FXe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},Ug=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class HXe{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class GXe{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return _Z(this,e)}}class WXe{constructor(e){this.decoders=e}or(e){return _Z(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _Z=(r,e)=>new WXe({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class YXe{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new HXe(e,t,n),this.decoder=new GXe(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Mg=({name:r,prefix:e,encode:t,decode:n})=>new YXe(r,e,t,n),I0=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=jXe(t,e);return Mg({prefix:r,name:e,encode:n,decode:i=>Ug(s(i))})},Yn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Mg({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),XXe=Mg({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),qXe=Yn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),eqe=Yn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),tqe=I0({prefix:"9",name:"base10",alphabet:"0123456789"}),rqe=Yn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),nqe=Yn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),sqe=Yn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),iqe=Yn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),oqe=Yn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),aqe=Yn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),cqe=Yn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),lqe=Yn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),uqe=Yn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),dqe=Yn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),fqe=Yn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),hqe=I0({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),pqe=I0({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),yqe=I0({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),gqe=I0({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),bqe=Yn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),_qe=Yn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),mqe=Yn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),vqe=Yn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),mZ=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),wqe=mZ.reduce((r,e,t)=>(r[t]=e,r),[]),Eqe=mZ.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),Aqe=Mg({prefix:"\u{1f680}",name:"base256emoji",encode:function xqe(r){return r.reduce((e,t)=>e+wqe[t],"")},decode:function Sqe(r){const e=[];for(const t of r){const n=Eqe[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var Rqe=Math.pow(2,31),Pqe=Math.pow(2,7),Nqe=Math.pow(2,14),Bqe=Math.pow(2,21),Lqe=Math.pow(2,28),kqe=Math.pow(2,35),Uqe=Math.pow(2,42),Mqe=Math.pow(2,49),Fqe=Math.pow(2,56),zqe=Math.pow(2,63),jqe={encode:function wZ(r,e,t){e=e||[];for(var n=t=t||0;r>=Rqe;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,wZ.bytes=t-n+1,e},decode:function LA(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw LA.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return LA.bytes=i-n,t},encodingLength:function(r){return r<Pqe?1:r<Nqe?2:r<Bqe?3:r<Lqe?4:r<kqe?5:r<Uqe?6:r<Mqe?7:r<Fqe?8:r<zqe?9:10}};const xZ=jqe,SZ=(r,e,t=0)=>(xZ.encode(r,e,t),e),AZ=r=>xZ.encodingLength(r),kA=(r,e)=>{const t=e.byteLength,n=AZ(r),s=n+AZ(t),i=new Uint8Array(s+t);return SZ(r,i,0),SZ(t,i,n),i.set(e,s),new TZ(r,t,e,i)};class TZ{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const CZ=({name:r,code:e,encode:t})=>new Kqe(r,e,t);class Kqe{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?kA(this.code,t):t.then(n=>kA(this.code,n))}throw Error("Unknown type, must be binary type")}}const IZ=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),Zqe=CZ({name:"sha2-256",code:18,encode:IZ("SHA-256")}),Hqe=CZ({name:"sha2-512",code:19,encode:IZ("SHA-512")}),DZ=Ug,Wqe={code:0,name:"identity",encode:DZ,digest:r=>kA(0,DZ(r))},Yqe="raw",Qqe=85,Jqe=r=>Ug(r),Xqe=r=>Ug(r),qqe=new TextEncoder,eet=new TextDecoder,tet="json",ret=512,net=r=>qqe.encode(JSON.stringify(r)),set=r=>JSON.parse(eet.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const NZ={...Wv,...Yv,...Qv,...Jv,...Xv,...qv,...e3,...t3,...r3,...n3};function BZ(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function LZ(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const kZ=LZ("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),MA=LZ("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function fet(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?BZ(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),UZ={utf8:kZ,"utf-8":kZ,hex:NZ.base16,latin1:MA,ascii:MA,binary:MA,...NZ};function het(r,e="utf8"){const t=UZ[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):BZ(globalThis.Buffer.from(r,"utf-8"))}const Fi=Be("libp2p:mplex:stream"),FA="ERR_STREAM_RESET";function zA(r,e="utf8"){const t=UZ[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}const zi=Be("libp2p:mplex");function MZ(r){const e={...r,type:`${OA[r.type]} (${r.type})`};return r.type===At.NEW_STREAM&&(e.data=zA(r.data instanceof Uint8Array?r.data:r.data.subarray())),(r.type===At.MESSAGE_INITIATOR||r.type===At.MESSAGE_RECEIVER)&&(e.data=zA(r.data instanceof Uint8Array?r.data:r.data.subarray(),"base16")),e}class Eet{constructor(e){var t,n;this.protocol="/mplex/6.7.0",e=null!==(t=e)&&void 0!==t?t:{},this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=e,this.sink=this._createSink();const s=this._createSource();this._source=s,this.source=s,this.closeController=new AbortController,this.rateLimiter=new tj.RateLimiterMemory({points:null!==(n=e.disconnectThreshold)&&void 0!==n?n:5,duration:1})}get streams(){const e=[];for(const t of this._streams.initiators.values())e.push(t);for(const t of this._streams.receivers.values())e.push(t);return e}newStream(e){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");const t=this._streamId++;return e=null==e?t.toString():e.toString(),this._newStream({id:t,name:e,type:"initiator",registry:this._streams.initiators})}close(e){this.closeController.signal.aborted||(this.streams.forEach(null!=e?t=>t.abort(e):t=>t.close()),this.closeController.abort())}_newReceiverStream(e){const{id:t,name:n}=e;return this._newStream({id:t,name:n,type:"receiver",registry:this._streams.receivers})}_newStream(e){var t;const{id:n,name:s,type:i,registry:o}=e;if(zi("new %s stream %s %s",i,n),"initiator"===i&&this._streams.initiators.size===(null!==(t=this._init.maxOutboundStreams)&&void 0!==t?t:1024))throw ee(new Error("Too many outbound streams open"),"ERR_TOO_MANY_OUTBOUND_STREAMS");if(o.has(n))throw new Error(`${i} stream ${n} already exists!`);const u=function bet(r){const{id:e,name:t,send:n,onEnd:s,type:i="initiator",maxMsgSize:o=bZ}=r,a=new AbortController,c=new AbortController,u=new AbortController,f="initiator"===i?hZ:PXe,E="initiator"===i?`i${e}`:`r${e}`,T=`${t??e}`;let F,U=!1,b=!1,P=!1;const M={open:Date.now()},$=ne=>{b||(b=!0,Fi.trace("%s stream %s sink end - err: %o",i,T,ne),null!=ne&&null==F&&(F=ne),U&&(M.close=Date.now(),s?.(F)))},V=ss({onEnd:ne=>{U||(U=!0,Fi.trace("%s stream %s source end - err: %o",i,T,ne),null!=ne&&null==F&&(F=ne),b&&(W.stat.timeline.close=Date.now(),s?.(F)))}}),W={close:()=>{Fi.trace("%s stream %s close",i,T),W.closeRead(),W.closeWrite()},closeRead:()=>{Fi.trace("%s stream %s closeRead",i,T),!U&&V.end()},closeWrite:()=>{if(Fi.trace("%s stream %s closeWrite",i,T),!b){u.abort();try{n({id:e,type:f.CLOSE})}catch(ne){Fi.trace("%s stream %s error sending close",i,t,ne)}$()}},abort:ne=>{Fi.trace("%s stream %s abort",i,T,ne),V.end(ne),a.abort(),$(ne)},reset:()=>{const ne=ee(new Error("stream reset"),FA);c.abort(),V.end(ne),$(ne)},sink:(ne=(0,B.Z)(function*(Y){if(P)throw ee(new Error("sink already called on stream"),"ERR_DOUBLE_SINK");if(P=!0,b)throw ee(new Error("stream closed for writing"),"ERR_SINK_ENDED");Y=Ms(Y,(0,wn.anySignal)([a.signal,c.signal,u.signal]));try{"initiator"===i&&n({id:e,type:hZ.NEW_STREAM,data:new Or(het(T))});const Xe=new Or;var Ce,q=!1,ge=!1;try{for(var Je,De=be(Y);q=!(Je=yield De.next()).done;q=!1){const gt=Je.value;if(gt.length<=o)n({id:e,type:f.MESSAGE,data:gt instanceof Or?gt:new Or(gt)});else for(Xe.append(gt);0!==Xe.length;){if(Xe.length<=o){n({id:e,type:f.MESSAGE,data:Xe.sublist()}),Xe.consume(Xe.length);break}n({id:e,type:f.MESSAGE,data:Xe.sublist(0,o)}),Xe.consume(o)}}}catch(gt){ge=!0,Ce=gt}finally{try{q&&null!=De.return&&(yield De.return())}finally{if(ge)throw Ce}}}catch(Xe){if("aborted"===Xe.type&&"The operation was aborted"===Xe.message){if(u.signal.aborted)return;c.signal.aborted&&(Xe.message="stream reset",Xe.code=FA),a.signal.aborted&&(Xe.message="stream aborted",Xe.code="ERR_STREAM_ABORT")}if(Xe.code===FA)Fi.trace("%s stream %s reset",i,t);else{Fi.trace("%s stream %s error",i,t,Xe);try{n({id:e,type:f.RESET})}catch(gt){Fi.trace("%s stream %s error sending reset",i,t,gt)}}return V.end(Xe),void $(Xe)}try{n({id:e,type:f.CLOSE})}catch(Xe){Fi.trace("%s stream %s error sending close",i,t,Xe)}$()}),function(q){return ne.apply(this,arguments)}),source:V,sourcePush:ne=>{V.push(ne)},sourceReadableLength:()=>V.readableLength,stat:{direction:"initiator"===i?"outbound":"inbound",timeline:M},metadata:{},id:E};var ne;return W}({id:n,name:s,send:f=>{zi.enabled&&zi.trace("%s stream %s send",i,n,MZ(f)),this._source.push(f)},type:i,onEnd:()=>{zi("%s stream with id %s and protocol %s ended",i,n,u.stat.protocol),o.delete(n),null!=this._init.onStreamEnd&&this._init.onStreamEnd(u)},maxMsgSize:this._init.maxMsgSize});return o.set(n,u),u}_createSink(){var e=this;return function(){var n=(0,B.Z)(function*(s){const i=[e.closeController.signal];null!=e._init.signal&&i.push(e._init.signal),s=Ms(s,wn(i));try{yield _t(s,UXe,function MXe(r){const e=r??bZ,t=n=>{if((n.type===At.NEW_STREAM||n.type===At.MESSAGE_INITIATOR||n.type===At.MESSAGE_RECEIVER)&&n.data.byteLength>e)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return n=>{return(s=Ee(function*(){var c,o=!1,a=!1;try{for(var f,u=be(n);o=!(f=yield X(u.next())).done;o=!1){const E=f.value;Array.isArray(E)?(E.forEach(t),yield*Fe(be(E),X)):(t(E),yield E)}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield X(u.return()))}finally{if(a)throw c}}}),function i(){return s.apply(this,arguments)})();var s}}(e._init.maxMsgSize),function(){var o=(0,B.Z)(function*(a){var f,c=!1,u=!1;try{for(var T,E=be(a);c=!(T=yield E.next()).done;c=!1){const U=T.value;yield e._handleIncoming(U)}}catch(U){u=!0,f=U}finally{try{c&&null!=E.return&&(yield E.return())}finally{if(u)throw f}}});return function(a){return o.apply(this,arguments)}}()),e._source.end()}catch(o){zi("error in sink",o),e._source.end(o)}});return function(i){return n.apply(this,arguments)}}()}_createSource(){const t=function vhe(r={}){return mP(t=>{let n;const s=[];for(;!t.isEmpty()&&(n=t.shift(),null!=n);){if(null!=n.error)throw n.error;!1===n.done&&s.push(n.value)}return null==n?{done:!0}:{done:!0===n.done,value:s}},r)}({objectMode:!0,onEnd:n=>{this.close(n)}});return Object.assign(function BXe(r){return NA.apply(this,arguments)}(t),{push:t.push,end:t.end,return:t.return})}_handleIncoming(e){var t=this;return(0,B.Z)(function*(){var n;const{id:s,type:i}=e;if(zi.enabled&&zi.trace("incoming message",MZ(e)),e.type===At.NEW_STREAM){var o;if(t._streams.receivers.size===(null!==(o=t._init.maxInboundStreams)&&void 0!==o?o:1024)){zi("too many inbound streams open"),t._source.push({id:s,type:At.RESET_RECEIVER});try{yield t.rateLimiter.consume("new-stream",1)}catch{return zi("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),void t._source.end(new Error("Too many open streams"))}return}const f=t._newReceiverStream({id:s,name:zA(e.data instanceof Uint8Array?e.data:e.data.subarray())});return void(null!=t._init.onIncomingStream&&t._init.onIncomingStream(f))}const c=(1==(1&i)?t._streams.initiators:t._streams.receivers).get(s);if(null==c)return void zi("missing stream %s for message type %s",s,OA[i]);const u=null!==(n=t._init.maxStreamBufferSize)&&void 0!==n?n:4194304;switch(i){case At.MESSAGE_INITIATOR:case At.MESSAGE_RECEIVER:if(c.sourceReadableLength()>u){t._source.push({id:e.id,type:i===At.MESSAGE_INITIATOR?At.RESET_RECEIVER:At.RESET_INITIATOR});const f=ee(new Error("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers"),"ERR_STREAM_INPUT_BUFFER_FULL");return void c.abort(f)}c.sourcePush(e.data);break;case At.CLOSE_INITIATOR:case At.CLOSE_RECEIVER:c.closeRead();break;case At.RESET_INITIATOR:case At.RESET_RECEIVER:c.reset();break;default:zi("unknown message type %s",i)}})()}}class xet{constructor(e={}){this.protocol="/mplex/6.7.0",this._init=e}createStreamMuxer(e={}){return new Eet({...e,...this._init})}}function Aet(r={}){return()=>new xet(r)}function FZ(r,e={}){const t=X2(r),n=Fs.fromReader(t.reader,e),s={read:(i=(0,B.Z)(function*(o){const{value:a}=yield t.reader.next(o);if(null==a)throw new Error("Value is null");return a}),function(a){return i.apply(this,arguments)}),readLP:function(){var i=(0,B.Z)(function*(){const{value:o}=yield n.next();if(null==o)throw new Error("Value is null");return o});return function(){return i.apply(this,arguments)}}(),readPB:function(){var i=(0,B.Z)(function*(o){const a=yield s.readLP();if(null==a)throw new Error("Value is null");const c=a instanceof Uint8Array?a:a.slice();return o.decode(c)});return function(a){return i.apply(this,arguments)}}(),write:i=>{i instanceof Uint8Array?t.writer.push(i):t.writer.push(i.slice())},writeLP:i=>{s.write(ei.single(i,e))},writePB:(i,o)=>{s.writeLP(o.encode(i))},pb:i=>{return{read:(o=(0,B.Z)(function*(){return yield s.readPB(i)}),function(){return o.apply(this,arguments)}),write:o=>s.writePB(o,i)};var o},unwrap:()=>(t.rest(),t.stream)};var i;return s}function zZ(){const r=en();let e=!1;return{sink:(t=(0,B.Z)(function*(n){if(e)throw new Error("already piped");e=!0,r.resolve(n)}),function(s){return t.apply(this,arguments)}),source:Ee(function*(){const t=yield X(r.promise);yield*Fe(be(t),X)})()};var t}var VA,jA;const D0=65535,Cet=Boolean(null===(VA=globalThis.process)||void 0===VA||null===(jA=VA.env)||void 0===jA?void 0:jA.DUMP_SESSION_KEYS);var Iet=p(87510),$A=p(43747),jZ=p(41122),$Z=p(90250);const Ret={hashSHA256:r=>(0,jZ.vp)(r),getHKDF(r,e){const s=new Iet.t(jZ.mE,e,r).expand(96);return[s.subarray(0,32),s.subarray(32,64),s.subarray(64,96)]},generateX25519KeyPair(){const r=$A.Au();return{publicKey:r.publicKey,privateKey:r.secretKey}},generateX25519KeyPairFromSeed(r){const e=$A._w(r);return{publicKey:e.publicKey,privateKey:e.secretKey}},generateX25519SharedKey:(r,e)=>$A.gi(r,e),chaCha20Poly1305Encrypt:(r,e,t,n)=>new $Z.OK(n).seal(e,r,t),chaCha20Poly1305Decrypt:(r,e,t,n)=>new $Z.OK(n).open(e,r,t)};function KA(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function KZ(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?KA(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function O0(r,e){null==e&&(e=r.reduce((s,i)=>s+i.length,0));const t=KZ(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return KA(t)}const Fg=r=>{const e=globalThis.Buffer?globalThis.Buffer.allocUnsafe(2):new Uint8Array(2);return new DataView(e.buffer,e.byteOffset,e.byteLength).setUint16(0,r,!1),e};Fg.bytes=2;const zg=r=>{if(r.length<2)throw RangeError("Could not decode int16BE");return r instanceof Uint8Array?new DataView(r.buffer,r.byteOffset,r.byteLength).getUint16(0,!1):r.getUint16(0)};zg.bytes=2;class Vg extends Error{constructor(e="Unexpected Peer"){super(e),this.code=Vg.code}static get code(){return"ERR_UNEXPECTED_PEER"}}class Uu extends Error{constructor(e="Invalid crypto exchange"){super(e),this.code=Uu.code}static get code(){return"ERR_INVALID_CRYPTO_EXCHANGE"}}Error;const jet=function Fet(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}},jg=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")});class Het{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Get{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return HZ(this,e)}}class Wet{constructor(e){this.decoders=e}or(e){return HZ(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const HZ=(r,e)=>new Wet({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class Yet{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new Het(e,t,n),this.decoder=new Get(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const $g=({name:r,prefix:e,encode:t,decode:n})=>new Yet(r,e,t,n),P0=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=jet(t,e);return $g({prefix:r,name:e,encode:n,decode:i=>jg(s(i))})},Qn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>$g({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),Xet=$g({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),qet=Qn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ett=Qn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ttt=P0({prefix:"9",name:"base10",alphabet:"0123456789"}),rtt=Qn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ntt=Qn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),stt=Qn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),itt=Qn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ott=Qn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),att=Qn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ctt=Qn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ltt=Qn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),utt=Qn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),dtt=Qn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ftt=Qn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),htt=P0({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ptt=P0({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),ytt=P0({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),gtt=P0({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),btt=Qn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),_tt=Qn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),mtt=Qn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),vtt=Qn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),GZ=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),wtt=GZ.reduce((r,e,t)=>(r[t]=e,r),[]),Ett=GZ.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),Att=$g({prefix:"\u{1f680}",name:"base256emoji",encode:function xtt(r){return r.reduce((e,t)=>e+wtt[t],"")},decode:function Stt(r){const e=[];for(const t of r){const n=Ett[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}});var Rtt=Math.pow(2,31),Ptt=Math.pow(2,7),Ntt=Math.pow(2,14),Btt=Math.pow(2,21),Ltt=Math.pow(2,28),ktt=Math.pow(2,35),Utt=Math.pow(2,42),Mtt=Math.pow(2,49),Ftt=Math.pow(2,56),ztt=Math.pow(2,63),jtt={encode:function YZ(r,e,t){e=e||[];for(var n=t=t||0;r>=Rtt;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,YZ.bytes=t-n+1,e},decode:function ZA(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw ZA.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return ZA.bytes=i-n,t},encodingLength:function(r){return r<Ptt?1:r<Ntt?2:r<Btt?3:r<Ltt?4:r<ktt?5:r<Utt?6:r<Mtt?7:r<Ftt?8:r<ztt?9:10}};const JZ=jtt,XZ=(r,e,t=0)=>(JZ.encode(r,e,t),e),qZ=r=>JZ.encodingLength(r),HA=(r,e)=>{const t=e.byteLength,n=qZ(r),s=n+qZ(t),i=new Uint8Array(s+t);return XZ(r,i,0),XZ(t,i,n),i.set(e,s),new eH(r,t,e,i)};class eH{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const tH=({name:r,code:e,encode:t})=>new Ktt(r,e,t);class Ktt{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?HA(this.code,t):t.then(n=>HA(this.code,n))}throw Error("Unknown type, must be binary type")}}const rH=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),Ztt=tH({name:"sha2-256",code:18,encode:rH("SHA-256")}),Htt=tH({name:"sha2-512",code:19,encode:rH("SHA-512")}),sH=jg,Wtt={code:0,name:"identity",encode:sH,digest:r=>HA(0,sH(r))},Ytt="raw",Qtt=85,Jtt=r=>jg(r),Xtt=r=>jg(r),qtt=new TextEncoder,ert=new TextDecoder,trt="json",rrt=512,nrt=r=>qtt.encode(JSON.stringify(r)),srt=r=>JSON.parse(ert.decode(r));Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const aH={...c3,...l3,...u3,...d3,...f3,...h3,...p3,...y3,...g3,...b3};function cH(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const lH=cH("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),WA=cH("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=KZ((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),uH={utf8:lH,"utf-8":lH,hex:aH.base16,latin1:WA,ascii:WA,binary:WA,...aH};function dH(r,e="utf8"){const t=uH[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.decoder.decode(`${t.prefix}${r}`):KA(globalThis.Buffer.from(r,"utf-8"))}var Kg,Zg;function YA(){return YA=(0,B.Z)(function*(r,e,t){const n=yield hrt(r,pH(e));if(null==r.publicKey)throw new Error("PublicKey was missing from local PeerId");return frt(r.publicKey,n,t)}),YA.apply(this,arguments)}function frt(r,e,t){return Zg.encode({identityKey:r,identitySig:e,extensions:t??{webtransportCerthashes:[]}}).subarray()}function hrt(r,e){return QA.apply(this,arguments)}function QA(){return QA=(0,B.Z)(function*(r,e){if(null==r.privateKey)throw new Error("PrivateKey was missing from PeerId");return yield(yield Oo(r.privateKey)).sign(e)}),QA.apply(this,arguments)}function fH(r){return JA.apply(this,arguments)}function JA(){return JA=(0,B.Z)(function*(r){return yield Ti(r.identityKey)}),JA.apply(this,arguments)}function hH(r){return Zg.decode(r)}function pH(r){const e=dH("noise-libp2p-static-key:");return O0([e,r],e.length+r.length)}function yH(r,e,t){return XA.apply(this,arguments)}function XA(){return XA=(0,B.Z)(function*(r,e,t){const n=yield Ti(e.identityKey);if(!n.equals(t))throw new Error("Peer ID doesn't match libp2p public key.");const s=pH(r);if(null==n.publicKey)throw new Error("PublicKey was missing from PeerId");if(null==e.identitySig)throw new Error("Signature was missing from message");if(!(yield Pc(n.publicKey).verify(s,e.identitySig)))throw new Error("Static key doesn't match to peer that signed payload!");return n}),XA.apply(this,arguments)}function Hg(r){return!(!(r instanceof Uint8Array)||32!==r.length)}function fc(r,e="utf8"){const t=uH[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}!function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{if(!1!==s.lengthDelimited&&n.fork(),null!=t.webtransportCerthashes)for(const i of t.webtransportCerthashes)n.uint32(10),n.bytes(i);!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={webtransportCerthashes:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();o>>>3==1?s.webtransportCerthashes.push(t.bytes()):t.skipType(7&o)}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(Kg||(Kg={})),function(r){let e;r.codec=()=>(null==e&&(e=Rr((t,n,s={})=>{!1!==s.lengthDelimited&&n.fork(),(!0===s.writeDefaults||null!=t.identityKey&&t.identityKey.byteLength>0)&&(n.uint32(10),n.bytes(t.identityKey)),(!0===s.writeDefaults||null!=t.identitySig&&t.identitySig.byteLength>0)&&(n.uint32(18),n.bytes(t.identitySig)),null!=t.extensions&&(n.uint32(34),Kg.codec().encode(t.extensions,n,{writeDefaults:!1})),!1!==s.lengthDelimited&&n.ldelim()},(t,n)=>{const s={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const o=t.uint32();switch(o>>>3){case 1:s.identityKey=t.bytes();break;case 2:s.identitySig=t.bytes();break;case 4:s.extensions=Kg.codec().decode(t,t.uint32());break;default:t.skipType(7&o)}}return s})),e),r.encode=t=>Ir(t,r.codec()),r.decode=t=>Cr(t,r.codec())}(Zg||(Zg={}));const ws=Be("libp2p:noise");let bi;function gH(r){r?(bi(`LOCAL_PUBLIC_EPHEMERAL_KEY ${fc(r.publicKey,"hex")}`),bi(`LOCAL_PRIVATE_EPHEMERAL_KEY ${fc(r.privateKey,"hex")}`)):bi("Missing local ephemeral keys.")}function bH(r){bi(`REMOTE_EPHEMERAL_PUBLIC_KEY ${fc(r,"hex")}`)}bi=Cet?ws:Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});class wrt{constructor(e=0){this.n=e,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error("Cipherstate has reached maximum n, a new handshake must be performed")}}class xrt extends class Ert{constructor(e){this.crypto=e}encryptWithAd(e,t,n){const s=this.encrypt(e.k,e.n,t,n);return e.n.increment(),s}decryptWithAd(e,t,n){const{plaintext:s,valid:i}=this.decrypt(e.k,e.n,t,n);return i&&e.n.increment(),{plaintext:s,valid:i}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){return function prt(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}(this.createEmptyKey(),e)}encrypt(e,t,n,s){return t.assertValue(),this.crypto.chaCha20Poly1305Encrypt(s,t.getBytes(),n,e)}encryptAndHash(e,t){let n;return n=this.hasKey(e.cs)?this.encryptWithAd(e.cs,e.h,t):t,this.mixHash(e,n),n}decrypt(e,t,n,s){t.assertValue();const i=this.crypto.chaCha20Poly1305Decrypt(s,t.getBytes(),n,e);return i?{plaintext:i,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,t){let n,s=!0;return this.hasKey(e.cs)?({plaintext:n,valid:s}=this.decryptWithAd(e.cs,e.h,t)):n=t,this.mixHash(e,t),{plaintext:n,valid:s}}dh(e,t){try{const n=this.crypto.generateX25519SharedKey(e,t);return 32===n.length?n:n.subarray(0,32)}catch(n){return ws(n.message),new Uint8Array(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){return this.crypto.hashSHA256(O0([e,t],e.length+t.length))}mixKey(e,t){const[n,s]=this.crypto.getHKDF(e.ck,t);e.cs=this.initializeKey(s),e.ck=n}initializeKey(e){return{k:e,n:new wrt}}initializeSymmetric(e){const t=dH(e,"utf-8"),n=this.hashProtocolName(t),s=n,i=this.createEmptyKey();return{cs:this.initializeKey(i),ck:s,h:n}}hashProtocolName(e){if(e.length<=32){const t=new Uint8Array(32);return t.set(e),t}return this.getHash(e,new Uint8Array(0))}split(e){const[t,n]=this.crypto.getHKDF(e.ck,new Uint8Array(0));return{cs1:this.initializeKey(t),cs2:this.initializeKey(n)}}writeMessageRegular(e,t){const n=this.encryptWithAd(e,new Uint8Array(0),t);return{ne:this.createEmptyKey(),ns:new Uint8Array(0),ciphertext:n}}readMessageRegular(e,t){return this.decryptWithAd(e,new Uint8Array(0),t.ciphertext)}}{initializeInitiator(e,t,n,s){const o=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");return this.mixHash(o,e),{ss:o,s:t,rs:n,psk:s,re:new Uint8Array(32)}}initializeResponder(e,t,n,s){const o=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");return this.mixHash(o,e),{ss:o,s:t,rs:n,psk:s,re:new Uint8Array(32)}}writeMessageA(e,t,n){const s=new Uint8Array(0);e.e=void 0!==n?n:this.crypto.generateX25519KeyPair();const i=e.e.publicKey;return this.mixHash(e.ss,i),{ne:i,ns:s,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageB(e,t){e.e=this.crypto.generateX25519KeyPair();const n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const i=this.encryptAndHash(e.ss,e.s.publicKey);return this.mixKey(e.ss,this.dh(e.s.privateKey,e.re)),{ne:n,ns:i,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageC(e,t){const s=this.encryptAndHash(e.ss,e.s.publicKey);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));const i=this.encryptAndHash(e.ss,t),a={ne:this.createEmptyKey(),ns:s,ciphertext:i},{cs1:c,cs2:u}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:u}}readMessageA(e,t){return Hg(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(Hg(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const{plaintext:n,valid:s}=this.decryptAndHash(e.ss,t.ns);s&&Hg(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:i,valid:s&&o}}readMessageC(e,t){const{plaintext:n,valid:s}=this.decryptAndHash(e.ss,t.ns);if(s&&Hg(n)&&(e.rs=n),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:o}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:i,valid:s&&o,cs1:a,cs2:c}}initSession(e,t,n){const s=this.createEmptyKey(),i=new Uint8Array(32);let o;return o=e?this.initializeInitiator(t,n,i,s):this.initializeResponder(t,n,i,s),{hs:o,i:e,mc:0}}sendMessage(e,t,n){let s;if(0===e.mc)s=this.writeMessageA(e.hs,t,n);else if(1===e.mc)s=this.writeMessageB(e.hs,t);else if(2===e.mc){const{h:i,messageBuffer:o,cs1:a,cs2:c}=this.writeMessageC(e.hs,t);s=o,e.h=i,e.cs1=a,e.cs2=c}else{if(!(e.mc>2))throw new Error("Session invalid.");if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");s=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");s=this.writeMessageRegular(e.cs2,t)}}return e.mc++,s}recvMessage(e,t){let n=new Uint8Array(0),s=!1;if(0===e.mc)({plaintext:n,valid:s}=this.readMessageA(e.hs,t));else if(1===e.mc)({plaintext:n,valid:s}=this.readMessageB(e.hs,t));else if(2===e.mc){const{h:i,plaintext:o,valid:a,cs1:c,cs2:u}=this.readMessageC(e.hs,t);n=o,s=a,e.h=i,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:n,valid:s}}}class Srt{constructor(e,t,n,s,i,o,a,c){this.remoteExtensions={webtransportCerthashes:[]},this.isInitiator=e,this.payload=t,this.prologue=n,this.staticKeypair=i,this.connection=o,a&&(this.remotePeer=a),this.xx=c??new xrt(s),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}propose(){var e=this;return(0,B.Z)(function*(){if(function yrt(r){bi(`LOCAL_STATIC_PUBLIC_KEY ${fc(r.publicKey,"hex")}`),bi(`LOCAL_STATIC_PRIVATE_KEY ${fc(r.privateKey,"hex")}`)}(e.session.hs.s),e.isInitiator){ws("Stage 0 - Initiator starting to send first message.");const t=e.xx.sendMessage(e.session,new Uint8Array(0));e.connection.writeLP(function Oet(r){return O0([r.ne,r.ciphertext],r.ne.length+r.ciphertext.length)}(t)),ws("Stage 0 - Initiator finished sending first message."),gH(e.session.hs.e)}else{ws("Stage 0 - Responder waiting to receive first message...");const t=function Bet(r){if(r.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:r.subarray(0,32),ciphertext:r.subarray(32,r.length),ns:new Uint8Array(0)}}((yield e.connection.readLP()).subarray()),{valid:n}=e.xx.recvMessage(e.session,t);if(!n)throw new Uu("xx handshake stage 0 validation fail");ws("Stage 0 - Responder received first message."),bH(e.session.hs.re)}})()}exchange(){var e=this;return(0,B.Z)(function*(){if(e.isInitiator){ws("Stage 1 - Initiator waiting to receive first message from responder...");const t=function Let(r){if(r.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:r.subarray(0,32),ns:r.subarray(32,80),ciphertext:r.subarray(80,r.length)}}((yield e.connection.readLP()).subarray()),{plaintext:n,valid:s}=e.xx.recvMessage(e.session,t);if(!s)throw new Uu("xx handshake stage 1 validation fail");ws("Stage 1 - Initiator received the message."),bH(e.session.hs.re),function grt(r){bi(`REMOTE_STATIC_PUBLIC_KEY ${fc(r,"hex")}`)}(e.session.hs.rs),ws("Initiator going to check remote's signature...");try{const i=hH(n);e.remotePeer=e.remotePeer||(yield fH(i)),yield yH(e.session.hs.rs,i,e.remotePeer),e.setRemoteNoiseExtension(i.extensions)}catch(i){throw new Vg(`Error occurred while verifying signed payload: ${i.message}`)}ws("All good with the signature!")}else{ws("Stage 1 - Responder sending out first message with signed payload and static key.");const t=e.xx.sendMessage(e.session,e.payload);e.connection.writeLP(function Pet(r){return O0([r.ne,r.ns,r.ciphertext],r.ne.length+r.ns.length+r.ciphertext.length)}(t)),ws("Stage 1 - Responder sent the second handshake message with signed payload."),gH(e.session.hs.e)}})()}finish(){var e=this;return(0,B.Z)(function*(){if(e.isInitiator){ws("Stage 2 - Initiator sending third handshake message.");const t=e.xx.sendMessage(e.session,e.payload);e.connection.writeLP(function Net(r){return O0([r.ns,r.ciphertext],r.ns.length+r.ciphertext.length)}(t)),ws("Stage 2 - Initiator sent message with signed payload.")}else{ws("Stage 2 - Responder waiting for third handshake message...");const t=function ket(r){if(r.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:r.subarray(0,48),ciphertext:r.subarray(48,r.length)}}((yield e.connection.readLP()).subarray()),{plaintext:n,valid:s}=e.xx.recvMessage(e.session,t);if(!s)throw new Uu("xx handshake stage 2 validation fail");ws("Stage 2 - Responder received the message, finished handshake.");try{const i=hH(n);e.remotePeer=e.remotePeer||(yield fH(i)),yield yH(e.session.hs.rs,i,e.remotePeer),e.setRemoteNoiseExtension(i.extensions)}catch(i){throw new Vg(`Error occurred while verifying signed payload: ${i.message}`)}}!function brt(r){r.cs1&&r.cs2?(bi(`CIPHER_STATE_1 ${r.cs1.n.getUint64()} ${fc(r.cs1.k,"hex")}`),bi(`CIPHER_STATE_2 ${r.cs2.n.getUint64()} ${fc(r.cs2.k,"hex")}`)):bi("Missing cipher state.")}(e.session)})()}encrypt(e,t){const n=this.getCS(t);return this.xx.encryptWithAd(n,new Uint8Array(0),e)}decrypt(e,t){const n=this.getCS(t,!1);return this.xx.decryptWithAd(n,new Uint8Array(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Uu("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteNoiseExtension(e){e&&(this.remoteExtensions=e)}}class Trt{constructor(e={}){this.protocol="/noise";const{staticNoiseKey:t,extensions:n,crypto:s,prologueBytes:i,metrics:o}=e;this.crypto=s??Ret,this.extensions=n,this.metrics=o?function Art(r){return{xxHandshakeSuccesses:r.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:r.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:r.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:r.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:r.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}(o):void 0,this.staticKeys=t?this.crypto.generateX25519KeyPairFromSeed(t):this.crypto.generateX25519KeyPair(),this.prologue=i??new Uint8Array(0)}secureOutbound(e,t,n){var s=this;return(0,B.Z)(function*(){const i=FZ(t,{lengthEncoder:Fg,lengthDecoder:zg,maxDataLength:D0}),o=yield s.performHandshake({connection:i,isInitiator:!0,localPeer:e,remotePeer:n});return{conn:yield s.createSecureConnection(i,o),remoteExtensions:o.remoteExtensions,remotePeer:o.remotePeer}})()}secureInbound(e,t,n){var s=this;return(0,B.Z)(function*(){const i=FZ(t,{lengthEncoder:Fg,lengthDecoder:zg,maxDataLength:D0}),o=yield s.performHandshake({connection:i,isInitiator:!1,localPeer:e,remotePeer:n});return{conn:yield s.createSecureConnection(i,o),remotePeer:o.remotePeer,remoteExtensions:o.remoteExtensions}})()}performHandshake(e){var t=this;return(0,B.Z)(function*(){const n=yield function drt(r,e,t){return YA.apply(this,arguments)}(e.localPeer,t.staticKeys.publicKey,t.extensions);return yield t.performXXHandshake(e,n)})()}performXXHandshake(e,t){var n=this;return(0,B.Z)(function*(){const{isInitiator:s,remotePeer:i,connection:o}=e,a=new Srt(s,t,n.prologue,n.crypto,n.staticKeys,o,i);try{var c;yield a.propose(),yield a.exchange(),yield a.finish(),null===(c=n.metrics)||void 0===c||c.xxHandshakeSuccesses.increment()}catch(f){var u;if(null===(u=n.metrics)||void 0===u||u.xxHandshakeErrors.increment(),f instanceof Error)throw f.message=`Error occurred during XX handshake: ${f.message}`,f}return a})()}createSecureConnection(e,t){var n=this;return(0,B.Z)(function*(){const[s,i]=function Tet(){const r=zZ(),e=zZ();return[{source:r.source,sink:e.sink},{source:e.source,sink:r.sink}]}(),o=e.unwrap();return yield _t(s,function Uet(r,e){return function(){var t=Ee(function*(n){var o,s=!1,i=!1;try{for(var c,a=be(n);s=!(c=yield X(a.next())).done;s=!1){const u=c.value;for(let f=0;f<u.length;f+=65519){let E=f+65519;E>u.length&&(E=u.length);const T=r.encrypt(u.subarray(f,E),r.session);e?.encryptedPackets.increment(),yield Fg(T.byteLength),yield T}}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}});return function(n){return t.apply(this,arguments)}}()}(t,n.metrics),o,Fs({lengthDecoder:zg}),function Met(r,e){return function(){var t=Ee(function*(n){var o,s=!1,i=!1;try{for(var c,a=be(n);s=!(c=yield X(a.next())).done;s=!1){const u=c.value;for(let f=0;f<u.length;f+=D0){let E=f+D0;E>u.length&&(E=u.length);const{plaintext:T,valid:U}=r.decrypt(u.subarray(f,E),r.session);if(!U)throw e?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");e?.decryptedPackets.increment(),yield T}}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}});return function(n){return t.apply(this,arguments)}}()}(t,n.metrics),s),i})()}}function Crt(r={}){return()=>new Trt(r)}const Irt=Sr.bind({ignoreUndefined:!0,concatArrays:!0});function qA({options:r={},peerId:e,multiaddrs:t=[],repo:n,keychainConfig:s={},config:i={}}){const{datastore:o}=n,a=function Rrt({options:r,config:e,datastore:t,keychainConfig:n,peerId:s,multiaddrs:i}){const a={datastore:t,peerId:s},c={addresses:{listen:i.map(M=>M.toString()),announce:Ot(r,"addresses.announce",Ot(e,"Addresses.Announce",[])),noAnnounce:Ot(r,"addresses.noAnnounce",Ot(e,"Addresses.NoAnnounce",[]))},connectionManager:Ot(r,"connectionManager",{maxConnections:Ot(r,"config.Swarm.ConnMgr.HighWater",Ot(e,"Swarm.ConnMgr.HighWater")),minConnections:Ot(r,"config.Swarm.ConnMgr.LowWater",Ot(e,"Swarm.ConnMgr.LowWater"))}),keychain:n,identify:{host:{agentVersion:`js-ipfs/${Sy}`}},contentRouters:[],peerRouters:[],peerDiscovery:[],transports:[],streamMuxers:[Aet({maxInboundStreams:256,maxOutboundStreams:1024})],connectionEncryption:[Crt()],relay:{enabled:Ot(r,"relay.enabled",Ot(e,"relay.enabled",!0)),hop:{enabled:Ot(r,"relay.hop.enabled",Ot(e,"relay.hop.enabled",!1)),active:Ot(r,"relay.hop.active",Ot(e,"relay.hop.active",!1))}},nat:{enabled:!Ot(e,"Swarm.DisableNatPortMap",!1)}};Ot(r,"config.Pubsub.Enabled",Ot(e,"Pubsub.Enabled",!0))&&(c.pubsub=(()=>{const M=Ot(e,"Pubsub.Router")||"gossipsub",H={gossipsub:r=>{const e=new kF({allowPublishToZeroPeers:!0,fallbackToFloodsub:!0,emitSelf:!0,maxInboundStreams:64,maxOutboundStreams:128});return e.init({getPeerId:()=>r.peerId,getPeerStore:()=>r.peerStore,getRegistrar:()=>r.registrar,getConnectionManager:()=>r.connectionManager}),e}};if(!H[M])throw ee(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${M} router.`),"ERR_NOT_SUPPORTED");return H[M]})()),"none"!==Ot(e,"Routing.Type","dhtclient")&&(c.dht=function OQe(r){return e=>new DQe(e,r)}({clientMode:"dhtserver"!==Ot(e,"Routing.Type","dht"),kBucketSize:Ot(r,"dht.kBucketSize",20),validators:{ipns:X8},selectors:{ipns:vP}}));const u=Ot(r,"config.Bootstrap",Ot(e,"Bootstrap",[]));var f;u.length>0&&(null===(f=c.peerDiscovery)||void 0===f||f.push(function UQe(r){return e=>new kQe(e,r)}({list:u})));let E=Ot(r,"libp2p",void 0);"function"==typeof E&&(E=void 0);const T=Irt(a,function _Fe(){const r=function bFe(r={}){const e=new gFe(r);return{transport:t=>(e.peerId=t.peerId,e),discovery:e.discovery}}();return{transports:[r.transport],peerDiscovery:[r.discovery],connectionManager:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4,autoDial:!0},nat:{enabled:!1},metrics:{enabled:!0}}}(),c,E),U=Ot(r,"config.Addresses.Delegates",Ot(e,"Addresses.Delegates",[]));if(U.length>0){var b,P;const H=at(U[Math.floor(Math.random()*U.length)]).toOptions(),V=function XBe(r={}){const e={name:ux.name,code:ux.code,encode:u=>u,decode:u=>u},t=Object.values(fx);(r.ipld&&r.ipld.bases?r.ipld.bases:[]).forEach(u=>t.push(u));const n=new GF({bases:t,loadBase:r.ipld&&r.ipld.loadBase}),s=Object.values(ZOe);[w,d,S,I,e].concat(r.ipld&&r.ipld.codecs||[]).forEach(u=>s.push(u));const i=new WF({codecs:s,loadCodec:r.ipld&&r.ipld.loadCodec}),o=Object.values(KOe);(r.ipld&&r.ipld.hashers?r.ipld.hashers:[]).forEach(u=>o.push(u));const a=new YF({hashers:o,loadHasher:r.ipld&&r.ipld.loadHasher});return{add:kBe(r),addAll:Dz(r),bitswap:iPe(r),block:pPe(r),bootstrap:vPe(r),cat:UBe(r),commands:MBe(r),config:DPe(r),dag:LPe(i,r),dht:QPe(r),diag:eNe(r),dns:FBe(r),files:hNe(r),get:VBe(r),getEndpointConfig:zBe(r),id:Oz(r),isOnline:jBe(r),key:wNe(r),log:ANe(r),ls:$Be(r),mount:ZBe(r),name:PNe(r),object:KNe(i,r),pin:aBe(r),ping:HBe(r),pubsub:mBe(r),refs:wBe(r),repo:SBe(r),resolve:GBe(r),start:WBe(r),stats:TBe(r),stop:YBe(r),swarm:PBe(r),version:QBe(r),bases:n,codecs:i,hashers:a}}({host:H.host,protocol:443===parseInt(H.port)?"https":"http",port:H.port});null===(b=T.contentRouters)||void 0===b||b.push(function yDe(r){return()=>new pDe(r)}(V)),null===(P=T.peerRouters)||void 0===P||P.push(function dDe(r){return()=>new uDe(r)}(V))}var F;return Ot(r,"config.Discovery.MDNS.Enabled",Ot(e,"Discovery.MDNS.Enabled",!0))||(T.peerDiscovery=null===(F=T.peerDiscovery)||void 0===F?void 0:F.filter(M=>{try{if("function"==typeof M)return"@libp2p/mdns"!==M({})[Symbol.toStringTag]}catch{}return!0})),null==T.transports&&(T.transports=[]),null==T.transports.find(M=>{try{if("function"==typeof M)return"@libp2p/websockets"===M({})[Symbol.toStringTag]}catch{}return!1})&&T.transports.push(function OXe(r={}){return()=>new DXe(r)}()),T}({options:r,config:i,datastore:o,keychainConfig:s,peerId:e,multiaddrs:t});return"function"==typeof r.libp2p?r.libp2p({libp2pOptions:a,options:r,config:i,datastore:o,peerId:e}):function vHe(r){return qS.apply(this,arguments)}(a)}const _H=Sr.bind({ignoreUndefined:!0}),B0=Be("ipfs:components:peer:storage");class eT{constructor(e,t,n,s,i){this.print=s,this.peerId=e,this.keychain=t,this.repo=n,this.print=s,this.isNew=i}static start(e,t,n){return(0,B.Z)(function*(){const{repoAutoMigrate:s,repo:i,onMigrationProgress:o}=n,a="string"==typeof i||null==i?function pTe(r,e,t){const n=t.path||"ipfs";return function _Ae(r,e,t,n){return new bAe(r,e,t,n)}(n,s=>e.getCodec(s),{root:new zh(n,{prefix:"",version:2}),blocks:new hTe(new zh(`${n}/blocks`,{prefix:"",version:2})),datastore:new zh(`${n}/datastore`,{prefix:"",version:2}),keys:new zh(`${n}/keys`,{prefix:"",version:2}),pins:new zh(`${n}/pins`,{prefix:"",version:2})},{autoMigrate:t.autoMigrate,onMigrationProgress:t.onMigrationProgress||r,repoLock:zM})}(e,t,{path:i,autoMigrate:s,onMigrationProgress:o}):i,{peerId:c,keychain:u,isNew:f}=yield Drt(e,a,n);return new eT(c,u,a,e,f)})()}}const Drt=function(){var r=(0,B.Z)(function*(e,t,n){if(!t.closed)return{...yield mH(t,n),isNew:!1};try{return yield t.open(),{...yield mH(t,n),isNew:!1}}catch(s){if(s.code!==kh)throw s;if(n.init&&!1===n.init.allowNew)throw new D6("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...yield Ort(e,t,n),isNew:!0}}});return function(t,n,s){return r.apply(this,arguments)}}(),Ort=function(){var r=(0,B.Z)(function*(e,t,n){const s=n.init||{},i=yield t.exists();if(B0("repo exists?",i),!0===i)throw new Error("repo already exists");const o=s.privateKey?yield Prt(s.privateKey):yield Nrt(e,s),a=Brt(o);B0("peer identity: %s",a.PeerID);const c={..._H(vH({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}},s.profiles),n.config),Identity:a};yield t.init(c),yield t.open(),B0("repo opened");const u={pass:n.pass};try{u.dek=yield t.config.get("Keychain.DEK")}catch(E){if("ERR_NOT_FOUND"!==E.code)throw E}const f=yield qA({options:void 0,multiaddrs:void 0,peerId:o,repo:t,config:c,keychainConfig:u});return(yield t.datastore.has(new ft("/info/self")))||(yield f.keychain.importPeer("self",o)),yield t.config.set("Keychain",{DEK:f.keychain.init.dek}),{peerId:o,keychain:f.keychain}});return function(t,n,s){return r.apply(this,arguments)}}(),Prt=function(){var r=(0,B.Z)(function*(e){if(B0("using user-supplied private-key"),Tc(e))return e;const t=va(e,"base64pad"),n=yield Oo(t);return yield Ti(n.public.bytes,n.bytes)});return function(t){return r.apply(this,arguments)}}(),Nrt=(r,{algorithm:e="Ed25519",bits:t=2048})=>{if(r("generating %s keypair...",e),"Ed25519"===e)return $$();if("RSA"===e)return cHe({bits:t});throw ee(new Error("Unknown PeerId algorithm"),"ERR_UNKNOWN_PEER_ID_ALGORITHM")},Brt=r=>{if(null==r.privateKey)throw ee(new Error("Private key missing"),"ERR_MISSING_PRIVATE_KEY");return{PeerID:r.toString(),PrivKey:ts(r.privateKey,"base64pad")}},mH=function(){var r=(0,B.Z)(function*(e,t){const n=t.config,s=t.init&&t.init.profiles||[],i=t.pass,o=yield e.config.getAll(),a=Lrt(vH(o,s),n);if(o!==a&&(yield e.config.replace(a)),!a.Identity||!a.Identity.PrivKey)throw new WC("No private key was found in the config, please intialize the repo");const c=va(a.Identity.PrivKey,"base64pad"),u=yield Oo(c),f=yield Ti(u.public.bytes,u.bytes);return{peerId:f,keychain:(yield qA({options:void 0,multiaddrs:void 0,peerId:f,repo:e,config:a,keychainConfig:{pass:i,...a.Keychain}})).keychain}});return function(t,n){return r.apply(this,arguments)}}(),Lrt=(r,e)=>e?_H(r,e):r,vH=(r,e)=>(e||[]).reduce((t,n)=>{const s=Ay[n];if(!s)throw new Error(`Could not find profile with name '${n}'`);return B0("applying profile %s",n),s.transform(t)},r);var Frt=Math.pow(2,31),jrt=Math.pow(2,7),$rt=Math.pow(2,14),Krt=Math.pow(2,21),Zrt=Math.pow(2,28),Hrt=Math.pow(2,35),Grt=Math.pow(2,42),Wrt=Math.pow(2,49),Yrt=Math.pow(2,56),Qrt=Math.pow(2,63),Xrt={encode:function EH(r,e,t){e=e||[];for(var n=t=t||0;r>=Frt;)e[t++]=255&r|128,r/=128;for(;-128&r;)e[t++]=255&r|128,r>>>=7;return e[t]=0|r,EH.bytes=t-n+1,e},decode:function tT(r,n){var o,t=0,s=0,i=n=n||0,a=r.length;do{if(i>=a)throw tT.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(127&o)<<s:(127&o)*Math.pow(2,s),s+=7}while(o>=128);return tT.bytes=i-n,t},encodingLength:function(r){return r<jrt?1:r<$rt?2:r<Krt?3:r<Zrt?4:r<Hrt?5:r<Grt?6:r<Wrt?7:r<Yrt?8:r<Qrt?9:10}};const Gg=Xrt,rT=(r,e=0)=>[Gg.decode(r,e),Gg.decode.bytes],Wg=(r,e,t=0)=>(Gg.encode(r,e,t),e),Yg=r=>Gg.encodingLength(r),Mu=(new Uint8Array(0),r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}),Qg=(r,e)=>{const t=e.byteLength,n=Yg(r),s=n+Yg(t),i=new Uint8Array(s+t);return Wg(r,i,0),Wg(t,i,n),i.set(e,s),new nT(r,t,e,i)};class nT{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const lnt=function ont(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};class unt{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class dnt{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return SH(this,e)}}class fnt{constructor(e){this.decoders=e}or(e){return SH(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const SH=(r,e)=>new fnt({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class hnt{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new unt(e,t,n),this.decoder=new dnt(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Jg=({name:r,prefix:e,encode:t,decode:n})=>new hnt(r,e,t,n),L0=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=lnt(t,e);return Jg({prefix:r,name:e,encode:n,decode:i=>Mu(s(i))})},Jn=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Jg({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)}),fr=L0({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),gnt=L0({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),k0=Jn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bnt=Jn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_nt=Jn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),mnt=Jn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),vnt=Jn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),wnt=Jn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ent=Jn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),xnt=Jn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Snt=Jn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),AH=new WeakMap,sT=r=>{const e=AH.get(r);if(null==e){const t=new Map;return AH.set(r,t),t}return e};class cr{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==U0)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Rnt)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return cr.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=Qg(e,t);return cr.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return cr.equals(this,e)}static equals(e,t){return t&&e.code===t.code&&e.version===t.version&&((r,e)=>{if(r===e)return!0;{const t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&((r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0})(r.bytes,t.bytes)}})(e.multihash,t.multihash)}toString(e){return((r,e)=>{const{bytes:t,version:n}=r;return 0===n?Cnt(t,sT(r),e||fr.encoder):Int(t,sT(r),e||k0.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof cr)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:n,code:s,multihash:i,bytes:o}=t;return new cr(n,s,i,o||TH(n,s,i.bytes))}if(!0===t[Dnt]){const{version:n,multihash:s,code:i}=t,o=(r=>{const e=Mu(r),[t,n]=rT(e),[s,i]=rT(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new nT(t,s,o,e)})(s);return cr.create(n,i,o)}return null}static create(e,t,n){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==U0)throw new Error(`Version 0 CID must use dag-pb (code: ${U0}) block encoding`);return new cr(e,t,n,n.bytes);case 1:{const s=TH(e,t,n.bytes);return new cr(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return cr.create(0,U0,e)}static createV1(e,t){return cr.create(1,e,t)}static decode(e){const[t,n]=cr.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=cr.inspectBytes(e),n=t.size-t.multihashSize,s=Mu(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=s.subarray(t.multihashSize-t.digestSize),o=new nT(t.multihashCode,t.digestSize,i,s);return[0===t.version?cr.createV0(o):cr.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[E,T]=rT(e.subarray(t));return t+=T,E};let s=n(),i=U0;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),u=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u-o,size:u}}static parse(e,t){const[n,s]=Tnt(e,t),i=cr.decode(s);return sT(i).set(n,e),i}}const Tnt=(r,e)=>{switch(r[0]){case"Q":return[fr.prefix,(e||fr).decode(`${fr.prefix}${r}`)];case fr.prefix:return[fr.prefix,(e||fr).decode(r)];case k0.prefix:return[k0.prefix,(e||k0).decode(r)];default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}},Cnt=(r,e,t)=>{const{prefix:n}=t;if(n!==fr.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const s=e.get(n);if(null==s){const i=t.encode(r).slice(1);return e.set(n,i),i}return s},Int=(r,e,t)=>{const{prefix:n}=t,s=e.get(n);if(null==s){const i=t.encode(r);return e.set(n,i),i}return s},U0=112,Rnt=18,TH=(r,e,t)=>{const n=Yg(r),s=n+Yg(e),i=new Uint8Array(s+t.byteLength);return Wg(r,i,0),Wg(e,i,n),i.set(t,s),i},Dnt=Symbol.for("@ipld/js-cid/CID"),CH=({name:r,code:e,encode:t})=>new Ont(r,e,t);class Ont{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Qg(this.code,t):t.then(n=>Qg(this.code,n))}throw Error("Unknown type, must be binary type")}}const IH=r=>function(){var e=(0,B.Z)(function*(t){return new Uint8Array(yield crypto.subtle.digest(r,t))});return function(t){return e.apply(this,arguments)}}(),Xg=CH({name:"sha2-256",code:18,encode:IH("SHA-256")}),Pnt=CH({name:"sha2-512",code:19,encode:IH("SHA-512")});var Nnt=p(99802);const Lnt=function Bnt(r){let e=new Uint8Array(r.reduce((n,s)=>n+vt.encodingLength(s),0)),t=0;for(const n of r)e=vt.encode(n,e,t),t+=vt.encodingLength(n);return e};function knt(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}class RH{constructor(e,t,n){this._refCounter=1,this.cid=e,this.priority=t||1,this.wantType=n}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(fr)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}}var yo=p(45951);const go=yo.Reader,M0=yo.Writer,Mt=yo.util,Pt=yo.roots["ipfs-bitswap"]||(yo.roots["ipfs-bitswap"]={}),Vi=Pt.Message=(()=>{function r(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return r.prototype.wantlist=null,r.prototype.blocks=Mt.emptyArray,r.prototype.payload=Mt.emptyArray,r.prototype.blockPresences=Mt.emptyArray,r.prototype.pendingBytes=0,r.encode=function(t,n){if(n||(n=M0.create()),null!=t.wantlist&&Object.hasOwnProperty.call(t,"wantlist")&&Pt.Message.Wantlist.encode(t.wantlist,n.uint32(10).fork()).ldelim(),null!=t.blocks&&t.blocks.length)for(var s=0;s<t.blocks.length;++s)n.uint32(18).bytes(t.blocks[s]);if(null!=t.payload&&t.payload.length)for(s=0;s<t.payload.length;++s)Pt.Message.Block.encode(t.payload[s],n.uint32(26).fork()).ldelim();if(null!=t.blockPresences&&t.blockPresences.length)for(s=0;s<t.blockPresences.length;++s)Pt.Message.BlockPresence.encode(t.blockPresences[s],n.uint32(34).fork()).ldelim();return null!=t.pendingBytes&&Object.hasOwnProperty.call(t,"pendingBytes")&&n.uint32(40).int32(t.pendingBytes),n},r.decode=function(t,n){t instanceof go||(t=go.create(t));for(var s=void 0===n?t.len:t.pos+n,i=new Pt.Message;t.pos<s;){var o=t.uint32();switch(o>>>3){case 1:i.wantlist=Pt.Message.Wantlist.decode(t,t.uint32());break;case 2:i.blocks&&i.blocks.length||(i.blocks=[]),i.blocks.push(t.bytes());break;case 3:i.payload&&i.payload.length||(i.payload=[]),i.payload.push(Pt.Message.Block.decode(t,t.uint32()));break;case 4:i.blockPresences&&i.blockPresences.length||(i.blockPresences=[]),i.blockPresences.push(Pt.Message.BlockPresence.decode(t,t.uint32()));break;case 5:i.pendingBytes=t.int32();break;default:t.skipType(7&o)}}return i},r.fromObject=function(t){if(t instanceof Pt.Message)return t;var n=new Pt.Message;if(null!=t.wantlist){if("object"!=typeof t.wantlist)throw TypeError(".Message.wantlist: object expected");n.wantlist=Pt.Message.Wantlist.fromObject(t.wantlist)}if(t.blocks){if(!Array.isArray(t.blocks))throw TypeError(".Message.blocks: array expected");n.blocks=[];for(var s=0;s<t.blocks.length;++s)"string"==typeof t.blocks[s]?Mt.base64.decode(t.blocks[s],n.blocks[s]=Mt.newBuffer(Mt.base64.length(t.blocks[s])),0):t.blocks[s].length>=0&&(n.blocks[s]=t.blocks[s])}if(t.payload){if(!Array.isArray(t.payload))throw TypeError(".Message.payload: array expected");for(n.payload=[],s=0;s<t.payload.length;++s){if("object"!=typeof t.payload[s])throw TypeError(".Message.payload: object expected");n.payload[s]=Pt.Message.Block.fromObject(t.payload[s])}}if(t.blockPresences){if(!Array.isArray(t.blockPresences))throw TypeError(".Message.blockPresences: array expected");for(n.blockPresences=[],s=0;s<t.blockPresences.length;++s){if("object"!=typeof t.blockPresences[s])throw TypeError(".Message.blockPresences: object expected");n.blockPresences[s]=Pt.Message.BlockPresence.fromObject(t.blockPresences[s])}}return null!=t.pendingBytes&&(n.pendingBytes=0|t.pendingBytes),n},r.toObject=function(t,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.blocks=[],s.payload=[],s.blockPresences=[]),n.defaults&&(s.wantlist=null,s.pendingBytes=0),null!=t.wantlist&&t.hasOwnProperty("wantlist")&&(s.wantlist=Pt.Message.Wantlist.toObject(t.wantlist,n)),t.blocks&&t.blocks.length){s.blocks=[];for(var i=0;i<t.blocks.length;++i)s.blocks[i]=n.bytes===String?Mt.base64.encode(t.blocks[i],0,t.blocks[i].length):n.bytes===Array?Array.prototype.slice.call(t.blocks[i]):t.blocks[i]}if(t.payload&&t.payload.length)for(s.payload=[],i=0;i<t.payload.length;++i)s.payload[i]=Pt.Message.Block.toObject(t.payload[i],n);if(t.blockPresences&&t.blockPresences.length)for(s.blockPresences=[],i=0;i<t.blockPresences.length;++i)s.blockPresences[i]=Pt.Message.BlockPresence.toObject(t.blockPresences[i],n);return null!=t.pendingBytes&&t.hasOwnProperty("pendingBytes")&&(s.pendingBytes=t.pendingBytes),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,yo.util.toJSONOptions)},r.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/Message"},r.Wantlist=function(){function e(t){if(this.entries=[],t)for(var n=Object.keys(t),s=0;s<n.length;++s)null!=t[n[s]]&&(this[n[s]]=t[n[s]])}return e.prototype.entries=Mt.emptyArray,e.prototype.full=!1,e.encode=function(n,s){if(s||(s=M0.create()),null!=n.entries&&n.entries.length)for(var i=0;i<n.entries.length;++i)Pt.Message.Wantlist.Entry.encode(n.entries[i],s.uint32(10).fork()).ldelim();return null!=n.full&&Object.hasOwnProperty.call(n,"full")&&s.uint32(16).bool(n.full),s},e.decode=function(n,s){n instanceof go||(n=go.create(n));for(var i=void 0===s?n.len:n.pos+s,o=new Pt.Message.Wantlist;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:o.entries&&o.entries.length||(o.entries=[]),o.entries.push(Pt.Message.Wantlist.Entry.decode(n,n.uint32()));break;case 2:o.full=n.bool();break;default:n.skipType(7&a)}}return o},e.fromObject=function(n){if(n instanceof Pt.Message.Wantlist)return n;var s=new Pt.Message.Wantlist;if(n.entries){if(!Array.isArray(n.entries))throw TypeError(".Message.Wantlist.entries: array expected");s.entries=[];for(var i=0;i<n.entries.length;++i){if("object"!=typeof n.entries[i])throw TypeError(".Message.Wantlist.entries: object expected");s.entries[i]=Pt.Message.Wantlist.Entry.fromObject(n.entries[i])}}return null!=n.full&&(s.full=Boolean(n.full)),s},e.toObject=function(n,s){s||(s={});var i={};if((s.arrays||s.defaults)&&(i.entries=[]),s.defaults&&(i.full=!1),n.entries&&n.entries.length){i.entries=[];for(var o=0;o<n.entries.length;++o)i.entries[o]=Pt.Message.Wantlist.Entry.toObject(n.entries[o],s)}return null!=n.full&&n.hasOwnProperty("full")&&(i.full=n.full),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,yo.util.toJSONOptions)},e.getTypeUrl=function(n){return void 0===n&&(n="type.googleapis.com"),n+"/Message.Wantlist"},e.WantType=function(){const t={},n=Object.create(t);return n[t[0]="Block"]=0,n[t[1]="Have"]=1,n}(),e.Entry=function(){function t(n){if(n)for(var s=Object.keys(n),i=0;i<s.length;++i)null!=n[s[i]]&&(this[s[i]]=n[s[i]])}return t.prototype.block=Mt.newBuffer([]),t.prototype.priority=0,t.prototype.cancel=!1,t.prototype.wantType=0,t.prototype.sendDontHave=!1,t.encode=function(s,i){return i||(i=M0.create()),null!=s.block&&Object.hasOwnProperty.call(s,"block")&&i.uint32(10).bytes(s.block),null!=s.priority&&Object.hasOwnProperty.call(s,"priority")&&i.uint32(16).int32(s.priority),null!=s.cancel&&Object.hasOwnProperty.call(s,"cancel")&&i.uint32(24).bool(s.cancel),null!=s.wantType&&Object.hasOwnProperty.call(s,"wantType")&&i.uint32(32).int32(s.wantType),null!=s.sendDontHave&&Object.hasOwnProperty.call(s,"sendDontHave")&&i.uint32(40).bool(s.sendDontHave),i},t.decode=function(s,i){s instanceof go||(s=go.create(s));for(var o=void 0===i?s.len:s.pos+i,a=new Pt.Message.Wantlist.Entry;s.pos<o;){var c=s.uint32();switch(c>>>3){case 1:a.block=s.bytes();break;case 2:a.priority=s.int32();break;case 3:a.cancel=s.bool();break;case 4:a.wantType=s.int32();break;case 5:a.sendDontHave=s.bool();break;default:s.skipType(7&c)}}return a},t.fromObject=function(s){if(s instanceof Pt.Message.Wantlist.Entry)return s;var i=new Pt.Message.Wantlist.Entry;switch(null!=s.block&&("string"==typeof s.block?Mt.base64.decode(s.block,i.block=Mt.newBuffer(Mt.base64.length(s.block)),0):s.block.length>=0&&(i.block=s.block)),null!=s.priority&&(i.priority=0|s.priority),null!=s.cancel&&(i.cancel=Boolean(s.cancel)),s.wantType){case"Block":case 0:i.wantType=0;break;case"Have":case 1:i.wantType=1}return null!=s.sendDontHave&&(i.sendDontHave=Boolean(s.sendDontHave)),i},t.toObject=function(s,i){i||(i={});var o={};return i.defaults&&(i.bytes===String?o.block="":(o.block=[],i.bytes!==Array&&(o.block=Mt.newBuffer(o.block))),o.priority=0,o.cancel=!1,o.wantType=i.enums===String?"Block":0,o.sendDontHave=!1),null!=s.block&&s.hasOwnProperty("block")&&(o.block=i.bytes===String?Mt.base64.encode(s.block,0,s.block.length):i.bytes===Array?Array.prototype.slice.call(s.block):s.block),null!=s.priority&&s.hasOwnProperty("priority")&&(o.priority=s.priority),null!=s.cancel&&s.hasOwnProperty("cancel")&&(o.cancel=s.cancel),null!=s.wantType&&s.hasOwnProperty("wantType")&&(o.wantType=i.enums===String?Pt.Message.Wantlist.WantType[s.wantType]:s.wantType),null!=s.sendDontHave&&s.hasOwnProperty("sendDontHave")&&(o.sendDontHave=s.sendDontHave),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,yo.util.toJSONOptions)},t.getTypeUrl=function(s){return void 0===s&&(s="type.googleapis.com"),s+"/Message.Wantlist.Entry"},t}(),e}(),r.Block=function(){function e(t){if(t)for(var n=Object.keys(t),s=0;s<n.length;++s)null!=t[n[s]]&&(this[n[s]]=t[n[s]])}return e.prototype.prefix=Mt.newBuffer([]),e.prototype.data=Mt.newBuffer([]),e.encode=function(n,s){return s||(s=M0.create()),null!=n.prefix&&Object.hasOwnProperty.call(n,"prefix")&&s.uint32(10).bytes(n.prefix),null!=n.data&&Object.hasOwnProperty.call(n,"data")&&s.uint32(18).bytes(n.data),s},e.decode=function(n,s){n instanceof go||(n=go.create(n));for(var i=void 0===s?n.len:n.pos+s,o=new Pt.Message.Block;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:o.prefix=n.bytes();break;case 2:o.data=n.bytes();break;default:n.skipType(7&a)}}return o},e.fromObject=function(n){if(n instanceof Pt.Message.Block)return n;var s=new Pt.Message.Block;return null!=n.prefix&&("string"==typeof n.prefix?Mt.base64.decode(n.prefix,s.prefix=Mt.newBuffer(Mt.base64.length(n.prefix)),0):n.prefix.length>=0&&(s.prefix=n.prefix)),null!=n.data&&("string"==typeof n.data?Mt.base64.decode(n.data,s.data=Mt.newBuffer(Mt.base64.length(n.data)),0):n.data.length>=0&&(s.data=n.data)),s},e.toObject=function(n,s){s||(s={});var i={};return s.defaults&&(s.bytes===String?i.prefix="":(i.prefix=[],s.bytes!==Array&&(i.prefix=Mt.newBuffer(i.prefix))),s.bytes===String?i.data="":(i.data=[],s.bytes!==Array&&(i.data=Mt.newBuffer(i.data)))),null!=n.prefix&&n.hasOwnProperty("prefix")&&(i.prefix=s.bytes===String?Mt.base64.encode(n.prefix,0,n.prefix.length):s.bytes===Array?Array.prototype.slice.call(n.prefix):n.prefix),null!=n.data&&n.hasOwnProperty("data")&&(i.data=s.bytes===String?Mt.base64.encode(n.data,0,n.data.length):s.bytes===Array?Array.prototype.slice.call(n.data):n.data),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,yo.util.toJSONOptions)},e.getTypeUrl=function(n){return void 0===n&&(n="type.googleapis.com"),n+"/Message.Block"},e}(),r.BlockPresenceType=function(){const e={},t=Object.create(e);return t[e[0]="Have"]=0,t[e[1]="DontHave"]=1,t}(),r.BlockPresence=function(){function e(t){if(t)for(var n=Object.keys(t),s=0;s<n.length;++s)null!=t[n[s]]&&(this[n[s]]=t[n[s]])}return e.prototype.cid=Mt.newBuffer([]),e.prototype.type=0,e.encode=function(n,s){return s||(s=M0.create()),null!=n.cid&&Object.hasOwnProperty.call(n,"cid")&&s.uint32(10).bytes(n.cid),null!=n.type&&Object.hasOwnProperty.call(n,"type")&&s.uint32(16).int32(n.type),s},e.decode=function(n,s){n instanceof go||(n=go.create(n));for(var i=void 0===s?n.len:n.pos+s,o=new Pt.Message.BlockPresence;n.pos<i;){var a=n.uint32();switch(a>>>3){case 1:o.cid=n.bytes();break;case 2:o.type=n.int32();break;default:n.skipType(7&a)}}return o},e.fromObject=function(n){if(n instanceof Pt.Message.BlockPresence)return n;var s=new Pt.Message.BlockPresence;switch(null!=n.cid&&("string"==typeof n.cid?Mt.base64.decode(n.cid,s.cid=Mt.newBuffer(Mt.base64.length(n.cid)),0):n.cid.length>=0&&(s.cid=n.cid)),n.type){case"Have":case 0:s.type=0;break;case"DontHave":case 1:s.type=1}return s},e.toObject=function(n,s){s||(s={});var i={};return s.defaults&&(s.bytes===String?i.cid="":(i.cid=[],s.bytes!==Array&&(i.cid=Mt.newBuffer(i.cid))),i.type=s.enums===String?"Have":0),null!=n.cid&&n.hasOwnProperty("cid")&&(i.cid=s.bytes===String?Mt.base64.encode(n.cid,0,n.cid.length):s.bytes===Array?Array.prototype.slice.call(n.cid):n.cid),null!=n.type&&n.hasOwnProperty("type")&&(i.type=s.enums===String?Pt.Message.BlockPresenceType[n.type]:n.type),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,yo.util.toJSONOptions)},e.getTypeUrl=function(n){return void 0===n&&(n="type.googleapis.com"),n+"/Message.BlockPresence"},e}(),r})(),DH_Block=Vi.Wantlist.WantType.Block,DH_Have=Vi.Wantlist.WantType.Have;let qg=(()=>{class r{constructor(t,n){this.set=n?rl({system:"ipfs",component:"bitswap",metric:"wantlist",metrics:n.metrics}):new Map,this._stats=t}get length(){return this.set.size}add(t,n,s){const i=t.toString(fr),o=this.set.get(i);o?(o.inc(),o.priority=n,o.wantType===DH_Have&&s===DH_Block&&(o.wantType=s)):(this.set.set(i,new RH(t,n,s)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(t){const n=t.toString(fr),s=this.set.get(n);!s||(s.dec(),!s.hasRefs()&&(this.set.delete(n),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(t){this.set.has(t)&&this.set.delete(t)}forEach(t){return this.set.forEach(t)}entries(){return this.set.entries()}sortedEntries(){return new Map(((r,e)=>Array.prototype.slice.call(e,0).sort((t,n)=>{const s=r(t),i=r(n);return s<i?-1:s>i?1:0}))(t=>t[1].key,Array.from(this.set.entries())))}contains(t){const n=t.toString(fr);return this.set.has(n)}get(t){const n=t.toString(fr);return this.set.get(n)}}return r.Entry=RH,r})();const Mnt=qg.Entry;class eb{constructor(e,t,n,s,i){this.entry=new Mnt(e,t,n),this.cancel=Boolean(s),this.sendDontHave=Boolean(i)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(fr)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}const Fu=(r,e)=>{const t=["bitswap"];return e&&t.push(e),r&&t.push(`${r.toString().slice(0,8)}`),Object.assign(Br(t.join(":")),{error:Br(t.concat(["error"]).join(":"))})},iT=(r,e)=>{if(r.size!==e.size)return!1;for(const[t,n]of r){const s=e.get(t);if(void 0===s||n instanceof Uint8Array&&s instanceof Uint8Array&&!knt(n,s)||n instanceof eb&&s instanceof eb&&!n.equals(s))return!1}return!0};class Er{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return 0===this.blocks.size&&0===this.wantlist.size&&0===this.blockPresences.size}addEntry(e,t,n,s,i){null==n&&(n=Er.WantType.Block);const o=e.toString(fr),a=this.wantlist.get(o);a?(a.wantType===n&&(a.priority=t),s&&(a.cancel=Boolean(s)),i&&(a.sendDontHave=Boolean(i)),n===Er.WantType.Block&&a.wantType===Er.WantType.Have&&(a.wantType=n)):this.wantlist.set(o,new eb(e,t,n,s,i))}addBlock(e,t){const n=e.toString(fr);this.blocks.set(n,t)}addHave(e){const t=e.toString(fr);this.blockPresences.has(t)||this.blockPresences.set(t,Er.BlockPresenceType.Have)}addDontHave(e){const t=e.toString(fr);this.blockPresences.has(t)||this.blockPresences.set(t,Er.BlockPresenceType.DontHave)}cancel(e){const t=e.toString(fr);this.wantlist.delete(t),this.addEntry(e,0,Er.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),cancel:Boolean(t.cancel)})),full:!!this.full||void 0},blocks:Array.from(this.blocks.values())};return Vi.encode(e).finish()}serializeToBitswap110(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),wantType:t.wantType,cancel:Boolean(t.cancel),sendDontHave:Boolean(t.sendDontHave)})),full:!!this.full||void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(const[t,n]of this.blocks.entries()){const s=cr.parse(t),u=Lnt([s.version,s.code,s.multihash.code,s.multihash.digest.length]);e.payload.push(new Vi.Block({prefix:u,data:n}))}for(const[t,n]of this.blockPresences)e.blockPresences.push(new Vi.BlockPresence({cid:cr.parse(t).bytes,type:n}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),Vi.encode(e).finish()}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!iT(this.wantlist,e.wantlist)||!iT(this.blocks,e.blocks)||!iT(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){const e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}}Er.deserialize=function(){var r=(0,B.Z)(function*(e,t){const n=Vi.decode(e),i=new Er(n.wantlist&&n.wantlist.full||!1);return n.wantlist&&n.wantlist.entries&&n.wantlist.entries.forEach(o=>{if(!o.block)return;const a=cr.decode(o.block);i.addEntry(a,o.priority||0,o.wantType,Boolean(o.cancel),Boolean(o.sendDontHave))}),n.blockPresences&&n.blockPresences.forEach(o=>{if(!o.cid)return;const a=cr.decode(o.cid);o.type===Er.BlockPresenceType.Have?i.addHave(a):i.addDontHave(a)}),n.blocks.length>0?(yield Promise.all(n.blocks.map(function(){var o=(0,B.Z)(function*(a){const c=yield Xg.digest(a),u=cr.createV0(c);i.addBlock(u,a)});return function(a){return o.apply(this,arguments)}}())),i):(n.payload.length>0&&(yield Promise.all(n.payload.map(function(){var o=(0,B.Z)(function*(a){if(!a.prefix||!a.data)return;const c=Nnt(a.prefix),u=c[0],f=c[1],E=c[2],T=E===Xg.code?Xg:t&&(yield t.getHasher(E));if(!T)throw ee(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");const U=yield T.digest(a.data),b=cr.create(u,f,U);i.addBlock(b,a.data)});return function(a){return o.apply(this,arguments)}}())),i.setPendingBytes(n.pendingBytes)),i)});return function(e,t){return r.apply(this,arguments)}}(),Er.blockPresenceSize=r=>r.bytes.length+1,Er.Entry=eb,Er.WantType={Block:Vi.Wantlist.WantType.Block,Have:Vi.Wantlist.WantType.Have},Er.BlockPresenceType={Have:Vi.BlockPresenceType.Have,DontHave:Vi.BlockPresenceType.DontHave};const znt=Math.pow(2,31)-1;class Znt{constructor(e,t,n){this.peerId=t,this.network=n,this.refcnt=1,this._entries=[],this._log=Fu(e,"msgqueue"),this.sendEntries=function Knt(r,e,t){var n=null,s=null,i=function(){n&&(clearTimeout(n),s=null,n=null)},a=function(){if(!e)return r.apply(this,arguments);var c=this,u=arguments,f=t&&!n;return i(),s=function(){r.apply(c,u)},n=setTimeout(function(){if(n=null,!f){var E=s;return s=null,E()}},e),f?s():void 0};return a.cancel=i,a.flush=function(){var c=s;i(),c&&c()},a}(this._sendEntries.bind(this),1)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;const e=new Er(!1);this._entries.forEach(t=>{t.cancel?e.cancel(t.cid):e.addEntry(t.cid,t.priority)}),this._entries=[],this.addMessage(e)}send(e){var t=this;return(0,B.Z)(function*(){try{yield t.network.connectTo(t.peerId)}catch(n){return void t._log.error("cant connect to peer %s: %s",t.peerId.toString(),n.message)}t._log("sending message to peer %s",t.peerId.toString()),t.network.sendMessage(t.peerId,e).catch(n=>{t._log.error("send error: %s",n.message)})})()}}class Hnt{constructor(e,t,n,s){this.peers=rl({system:"ipfs",component:"bitswap",metric:"want-manager-peers",metrics:s.metrics}),this.wantlist=new qg(n,s),this.network=t,this._stats=n,this._peerId=e,this._log=Fu(e,"want")}_addEntries(e,t,n){const s=e.map((i,o)=>new Er.Entry(i,znt-o,Er.WantType.Block,t));s.forEach(i=>{i.cancel?n?this.wantlist.removeForce(i.cid.toString(fr)):this.wantlist.remove(i.cid):(this._log("adding to wl"),this.wantlist.add(i.cid,i.priority))});for(const i of this.peers.values())i.addEntries(s)}_startPeerHandler(e){let t=this.peers.get(e.toString());if(t)return void t.refcnt++;t=new Znt(this._peerId,e,this.network);const n=new Er(!0);for(const s of this.wantlist.entries())n.addEntry(s[1].cid,s[1].priority);return t.addMessage(n),this.peers.set(e.toString(),t),t}_stopPeerHandler(e){const t=this.peers.get(e.toString());!t||(t.refcnt--,!(t.refcnt>0)&&this.peers.delete(e.toString()))}wantBlocks(e,t={}){this._addEntries(e,!1),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>this.disconnected(e.peerId))}}const aT="/ipfs/bitswap/1.0.0",cT="/ipfs/bitswap/1.1.0",lT="/ipfs/bitswap/1.2.0";class Qnt{constructor(e,t,n,s={}){var i,o,a;this._log=Fu(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[aT],s.b100Only||(this._protocols.unshift(cT),this._protocols.unshift(lT)),this._stats=n,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=s.hashLoader,this._maxInboundStreams=null!==(i=s.maxInboundStreams)&&void 0!==i?i:32,this._maxOutboundStreams=null!==(o=s.maxOutboundStreams)&&void 0!==o?o:128,this._incomingStreamTimeout=null!==(a=s.incomingStreamTimeout)&&void 0!==a?a:3e4}start(){var e=this;return(0,B.Z)(function*(){e._running=!0,yield e._libp2p.handle(e._protocols,e._onConnection,{maxInboundStreams:e._maxInboundStreams,maxOutboundStreams:e._maxOutboundStreams});const t=V9({onConnect:e._onPeerConnect,onDisconnect:e._onPeerDisconnect});e._registrarIds=[];for(const n of e._protocols)e._registrarIds.push(yield e._libp2p.registrar.register(n,t));e._libp2p.getConnections().forEach(n=>{e._onPeerConnect(n.remotePeer)})})()}stop(){var e=this;return(0,B.Z)(function*(){if(e._running=!1,yield e._libp2p.unhandle(e._protocols),null!=e._registrarIds){for(const t of e._registrarIds)e._libp2p.registrar.unregister(t);e._registrarIds=[]}})()}_onConnection({stream:e,connection:t}){var n=this;if(!this._running)return;const s=new Ar.TimeoutController(this._incomingStreamTimeout);Promise.resolve().then((0,B.Z)(function*(){n._log("incoming new bitswap %s connection from %p",e.stat.protocol,t.remotePeer),yield _t(Ms(e.source,s.signal),Fs(),function(){var i=(0,B.Z)(function*(o){var u,a=!1,c=!1;try{for(var E,f=be(o);a=!(E=yield f.next()).done;a=!1){const T=E.value;try{const U=yield Er.deserialize(T.subarray(),n._hashLoader);yield n._bitswap._receiveMessage(t.remotePeer,U)}catch(U){n._bitswap._receiveError(U);break}s.reset()}}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield f.return())}finally{if(c)throw u}}});return function(o){return i.apply(this,arguments)}}())})).catch(i=>{this._log(i),e.abort(i)}).finally(()=>{s.clear(),e.close()})}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t={}){return this._libp2p.contentRouting.findProviders(e,t)}findAndConnect(e,t){var n=this;return(0,B.Z)(function*(){const s=[];let i=0;var c,o=!1,a=!1;try{for(var f,u=be(n.findProviders(e,t));o=!(f=yield u.next()).done;o=!1){const E=f.value;if(n._log(`connecting to provider ${E.id}`),s.push(n.connectTo(E.id,t).catch(T=>{n._log.error(T)})),i++,3===i)break}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield u.return())}finally{if(a)throw c}}yield Promise.all(s)})()}provide(e,t){var n=this;return(0,B.Z)(function*(){yield n._libp2p.contentRouting.provide(e,t)})()}sendMessage(e,t){var n=this;return(0,B.Z)(function*(){if(!n._running)throw new Error("network isn't running");const s=e.toString();n._log("sendMessage to %s",s,t);const o=yield(yield n._libp2p.dial(e)).newStream([lT,cT,aT]);yield function Jnt(r,e,t){return uT.apply(this,arguments)}(o,t,n._log),n._updateSentStats(e,t.blocks)})()}connectTo(e,t){var n=this;return(0,B.Z)(function*(){if(!n._running)throw new Error("network isn't running");return n._libp2p.dial(e,t)})()}_updateSentStats(e,t){const n=e.toString();if(this._stats){for(const s of t.values())this._stats.push(n,"dataSent",s.length);this._stats.push(n,"blocksSent",t.size)}}}function uT(){return uT=(0,B.Z)(function*(r,e,t){try{let n;switch(r.stat.protocol){case aT:n=e.serializeToBitswap100();break;case cT:case lT:n=e.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+r.stat.protocol)}yield _t([n],ei(),r)}catch(n){t(n)}finally{r.close()}}),uT.apply(this,arguments)}class Xnt{constructor(e){this.partner=e,this.wantlist=new qg,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesRecv+=e}wants(e,t,n){this.wantlist.add(e,t,n)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}class PH extends Map{constructor(e,t){super(),this._cmp=t||this._defaultSort,this._keys=[];for(const[n,s]of e||[])this.set(n,s)}update(e){if(e<0||e>=this._keys.length)return;const t=this._keys[e];this._keys.splice(e,1);const n=this._find(t);this._keys.splice(n,0,t)}set(e,t){if(this.has(e)){const s=this.indexOf(e);this._keys.splice(s,1)}super.set(e,t);const n=this._find(e);return this._keys.splice(n,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;const t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;const t=this._find(e);if(this._keys[t]===e)return t;for(let n=1;n<this._keys.length;n++){if(this._keys[t+n]===e)return t+n;if(this._keys[t-n]===e)return t-n}return-1}_find(e){let t=0,n=this._keys.length;for(;t<n;){const s=t+n>>>1,i=this._kCmp(this._keys[s],e);if(i<0)t=s+1;else{if(!(i>0))return s;n=s}}return t}*keys(){for(const e of this._keys)yield e}*values(){for(const e of this._keys)yield this.get(e)}*entries(){for(const e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t){if(e)for(const n of this._keys)e.apply(t,[[n,this.get(n)]])}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}}const qnt={hasNewInfo:()=>!1,merge(){}};class est{constructor(e=qnt){this._taskMerger=e,this._byPeer=new PH([],NH.compare)}pushTasks(e,t){let n=this._byPeer.get(e.toString());n||(n=new NH(e,this._taskMerger)),n.pushTasks(t),this._byPeer.set(e.toString(),n)}popTasks(e){const t=this._head();if(void 0===t)return{tasks:[],pendingSize:0};const{tasks:n,pendingSize:s}=t.popTasks(e);if(0===n.length)return{tasks:n,pendingSize:s};const i=t.peerId;return t.isIdle()?this._byPeer.delete(i.toString()):this._byPeer.update(0),{peerId:i,tasks:n,pendingSize:s}}_head(){if(0!==this._byPeer.size)for(const[,e]of this._byPeer)return e}remove(e,t){const n=this._byPeer.get(t.toString());n&&n.remove(e)}tasksDone(e,t){const n=this._byPeer.get(e.toString());if(!n)return;const s=this._byPeer.indexOf(e.toString());for(const i of t)n.taskDone(i);this._byPeer.update(s)}}class NH{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new tst,this._active=new Set}pushTasks(e){for(const t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;const t=this._pending.get(e.topic);if(t)return e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),void this._taskMerger.merge(e,t);this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){const t=[];for(const n of this._active)n.topic===e.topic&&t.push(n);return 0===t.length||this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0;const n=[],s=this._pending.tasks();for(let i=0;i<s.length&&t<e;i++){const o=s[i];n.push(o),t+=o.size,this._pending.delete(o.topic),this._activeTotalSize+=o.size,this._active.add(o)}return{tasks:n,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return 0===this._pending.length&&0===this._active.size}static compare(e,t){return 0===e[1]._pending.length?1:0===t[1]._pending.length?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}}class tst{constructor(){this._tasks=new PH([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,t)=>e+t.task.size,0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,t){const n=this._tasks.get(e);if(!n)return;const s=this._tasks.indexOf(e);n.task.priority=t,this._tasks.update(s)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}}const rst={hasNewInfo(r,e){let t=!1,n=!1;for(const s of e)s.data.haveBlock&&(t=!0),s.data.isWantBlock&&(n=!0);return!!(!n&&r.data.isWantBlock||!t&&r.data.haveBlock)},merge(r,e){const t=r.data,n=e.data;!n.haveBlock&&t.haveBlock&&(n.haveBlock=t.haveBlock,n.blockSize=t.blockSize),!n.isWantBlock&&t.isWantBlock&&(n.isWantBlock=!0,(!n.haveBlock||t.haveBlock)&&(n.haveBlock=t.haveBlock,e.size=r.size)),n.isWantBlock&&n.haveBlock&&(e.size=n.blockSize)}},BH=Er.WantType;class ist{constructor(e,t,n,s,i,o={}){this._log=Fu(e,"engine"),this.blockstore=t,this.network=n,this._stats=s,this._opts=this._processOpts(o),this.ledgerMap=rl({system:"ipfs",component:"bitswap",metric:"ledger-map",metrics:i.metrics}),this._running=!1,this._requestQueue=new est(rst)}_processOpts(e){return{maxSizeReplaceHasWithBlock:1024,targetMessageSize:16384,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}_processTasks(){var e=this;return(0,B.Z)(function*(){if(!e._running)return;const{peerId:t,tasks:n,pendingSize:s}=e._requestQueue.popTasks(e._opts.targetMessageSize);if(0===n.length)return;const i=new Er(!1);i.setPendingBytes(s);const o=[],a=new Map;for(const u of n){const f=cr.parse(u.topic);u.data.haveBlock?u.data.isWantBlock?(o.push(f),a.set(u.topic,u.data)):i.addHave(f):i.addDontHave(f)}const c=yield e._getBlocks(o);for(const[u,f]of a){const E=cr.parse(u),T=c.get(u);T?i.addBlock(E,T):f.sendDontHave&&i.addDontHave(E)}if(i.empty)return t&&e._requestQueue.tasksDone(t,n),void e._scheduleProcessTasks();try{t&&(yield e.network.sendMessage(t,i));for(const[u,f]of c.entries())t&&e.messageSent(t,cr.parse(u),f)}catch(u){e._log.error(u)}t&&e._requestQueue.tasksDone(t,n),e._scheduleProcessTasks()})()}wantlistForPeer(e){const t=e.toString(),n=this.ledgerMap.get(t);return n?n.wantlist.sortedEntries():new Map}ledgerForPeer(e){const t=e.toString(),n=this.ledgerMap.get(t);return n?{peer:n.partner,value:n.debtRatio(),sent:n.accounting.bytesSent,recv:n.accounting.bytesRecv,exchanged:n.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(e.length){for(const t of this.ledgerMap.values())for(const n of e){const s=t.wantlistContains(n.cid);if(!s)continue;const i=n.data.length,o=this._sendAsBlock(s.wantType,i);let a=i;o||(a=Er.blockPresenceSize(s.cid)),this._requestQueue.pushTasks(t.partner,[{topic:s.cid.toString(fr),priority:s.priority,size:a,data:{blockSize:i,isWantBlock:o,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}messageReceived(e,t){var n=this;return(0,B.Z)(function*(){const s=n._findOrCreate(e);if(t.empty)return;if(t.full&&(s.wantlist=new qg),n._updateBlockAccounting(t.blocks,s),0===t.wantlist.size)return void n._scheduleProcessTasks();const i=[],o=[];t.wantlist.forEach(a=>{a.cancel?(s.cancelWant(a.cid),i.push(a.cid)):(s.wants(a.cid,a.priority,a.wantType),o.push(a))}),n._cancelWants(e,i),yield n._addWants(e,o),n._scheduleProcessTasks()})()}_cancelWants(e,t){for(const n of t)this._requestQueue.remove(n.toString(fr),e)}_addWants(e,t){var n=this;return(0,B.Z)(function*(){const s=yield n._getBlockSizes(t.map(o=>o.cid)),i=[];for(const o of t){const a=o.cid.toString(fr),c=s.get(a);if(null==c)o.sendDontHave&&i.push({topic:a,priority:o.priority,size:Er.blockPresenceSize(o.cid),data:{isWantBlock:o.wantType===BH.Block,blockSize:0,haveBlock:!1,sendDontHave:o.sendDontHave}});else{const u=n._sendAsBlock(o.wantType,c);let f=c;u||(f=Er.blockPresenceSize(o.cid)),i.push({topic:a,priority:o.priority,size:f,data:{isWantBlock:u,blockSize:c,haveBlock:!0,sendDontHave:o.sendDontHave}})}n._requestQueue.pushTasks(e,i)}})()}_sendAsBlock(e,t){return e===BH.Block||t<=this._opts.maxSizeReplaceHasWithBlock}_getBlockSizes(e){var t=this;return(0,B.Z)(function*(){const n=yield t._getBlocks(e);return new Map([...n].map(([s,i])=>[s,i.length]))})()}_getBlocks(e){var t=this;return(0,B.Z)(function*(){const n=new Map;return yield Promise.all(e.map(function(){var s=(0,B.Z)(function*(i){try{const o=yield t.blockstore.get(i);n.set(i.toString(fr),o)}catch(o){"ERR_NOT_FOUND"!==o.code&&t._log.error("failed to query blockstore for %s: %s",i,o)}});return function(i){return s.apply(this,arguments)}}())),n})()}_updateBlockAccounting(e,t){for(const n of e.values())this._log("got block (%s bytes)",n.length),t.receivedBytes(n.length)}messageSent(e,t,n){const s=this._findOrCreate(e);s.sentBytes(n.length),s.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toString())}_findOrCreate(e){const t=e.toString(),n=this.ledgerMap.get(t);if(n)return n;const s=new Xnt(e);return this.ledgerMap.set(t,s),this._stats&&this._stats.push(t,"peerCount",1),s}start(){this._running=!0}stop(){this._running=!1}}const ost=Jg({prefix:"\0",name:"identity",encode:r=>(r=>(new TextDecoder).decode(r))(r),decode:r=>(r=>(new TextEncoder).encode(r))(r)}),ast=Jn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),cst=Jn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),lst=L0({prefix:"9",name:"base10",alphabet:"0123456789"}),ust=Jn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),dst=Jn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),fst=L0({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),hst=L0({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),pst=Jn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),yst=Jn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),gst=Jn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),bst=Jn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),LH=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),_st=LH.reduce((r,e,t)=>(r[t]=e,r),[]),mst=LH.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]),Est=Jg({prefix:"\u{1f680}",name:"base256emoji",encode:function vst(r){return r.reduce((e,t)=>e+_st[t],"")},decode:function wst(r){const e=[];for(const t of r){const n=mst[t.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}}),UH=Mu,Sst={code:0,name:"identity",encode:UH,digest:r=>Qg(0,UH(r))},Ast="raw",Tst=85,Cst=r=>Mu(r),Ist=r=>Mu(r),Rst=new TextEncoder,Dst=new TextDecoder,Ost="json",Pst=512,Nst=r=>Rst.encode(JSON.stringify(r)),Bst=r=>JSON.parse(Dst.decode(r)),MH={...A3,...T3,...C3,...I3,...R3,...x3,...D3,...E3,...O3,...P3};function FH(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const zH=FH("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>(new TextEncoder).encode(r.substring(1))),dT=FH("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{const e=function kst(r=0){var e;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?function Lst(r){return null!=globalThis.Buffer?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}((r=r.substring(1)).length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Ust={utf8:zH,"utf-8":zH,hex:MH.base16,latin1:dT,ascii:dT,binary:dT,...MH};function VH(r,e="utf8"){const t=Ust[e];if(null==t)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?t.encoder.encode(r).substring(1):globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8")}const jH=r=>`unwant:${VH(r.multihash.bytes,"base64")}`,$H=r=>`block:${VH(r.multihash.bytes,"base64")}`;class Mst extends rt.EventEmitter{constructor(e){super(),this.setMaxListeners(1e3),this._log=Fu(e,"notif")}hasBlock(e,t){const n=$H(e);this._log(n),this.emit(n,t)}wantBlock(e,t={}){if(!e)throw new Error("Not a valid cid");const n=$H(e),s=jH(e);return this._log(`wantBlock:${e}`),new Promise((i,o)=>{const a=()=>{this.removeListener(n,c),o(new Error(`Block for ${e} unwanted`))},c=u=>{this.removeListener(s,a),i(u)};this.once(s,a),this.once(n,c),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.removeListener(n,c),this.removeListener(s,a),o(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){const t=jH(e);this._log(t),this.emit(t)}}var KH=p(48568);class ZH extends rt.EventEmitter{constructor(e,t){super(),this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(n=>{this._stats[n]=BigInt(0),this._movingAverages[n]={},this._options.movingAverageIntervals.forEach(s=>{(this._movingAverages[n][s]=KH(s)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){return Math.max(this._options.computeThrottleTimeout*(1-this._queue.length/this._options.computeThrottleMaxQueueSize),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){const t=e=this._queue.shift();t&&this._applyOp(t)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){const t=e-this._frequencyLastTime;t&&Object.keys(this._stats).forEach(n=>{this._updateFrequencyFor(n,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,n){const s=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;const i=s/t*1e3;let o=this._movingAverages[e];o||(o=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let c=o[a];c||(c=o[a]=KH(a)),c.push(n,i)})}_applyOp(e){const t=e[0],n=e[1];if("number"!=typeof n)throw new Error(`invalid increment number: ${n}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(n),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=n}}const HH={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[6e4,3e5,9e5]};class Fst extends rt.EventEmitter{constructor(e,t=[],n=HH){super();const s=Object.assign({},HH,n);if("number"!=typeof s.computeThrottleTimeout)throw new Error("need computeThrottleTimeout");if("number"!=typeof s.computeThrottleMaxQueueSize)throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=t,this._options=s,this._enabled=this._options.enabled,this._global=new ZH(t,s),this._global.on("update",i=>this.emit("update",i)),this._peers=rl({system:"ipfs",component:"bitswap",metric:"stats-peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(const e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){const t="string"!=typeof e&&e.toString?e.toString():`${e}`;return this._peers.get(t)}push(e,t,n){if(this._enabled&&(this._global.push(t,n),e)){let s=this._peers.get(e);s||(s=new ZH(this._initialCounters,this._options),this._peers.set(e,s)),s.push(t,n)}}disconnected(e){const t=e.toString(),n=this._peers.get(t);n&&(n.stop(),this._peers.delete(t))}}const zst={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},Vst=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"];class jst extends B9{constructor(e,t,n={}){super(),this._libp2p=e,this._log=Fu(this.peerId),this._options=Object.assign({},zst,n),this._stats=new Fst(e,Vst,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new Qnt(e,this,this._stats,{hashLoader:n.hashLoader,maxInboundStreams:n.maxInboundStreams,maxOutboundStreams:n.maxOutboundStreams,incomingStreamTimeout:n.incomingStreamTimeout}),this.blockstore=t,this.engine=new ist(this.peerId,t,this.network,this._stats,e),this.wm=new Hnt(this.peerId,this.network,this._stats,e),this.notifications=new Mst(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}_receiveMessage(e,t){var n=this;return(0,B.Z)(function*(){try{yield n.engine.messageReceived(e,t)}catch{n._log("failed to receive message",t)}if(0===t.blocks.size)return;const s=[];for(const[i,o]of t.blocks.entries()){const a=cr.parse(i);s.push({wasWanted:n.wm.wantlist.contains(a),cid:a,data:o})}n.wm.cancelWants(s.filter(({wasWanted:i})=>i).map(({cid:i})=>i)),yield Promise.all(s.map(({cid:i,wasWanted:o,data:a})=>n._handleReceivedBlock(e,i,a,o)))})()}_handleReceivedBlock(e,t,n,s){var i=this;return(0,B.Z)(function*(){i._log("received block");const o=yield i.blockstore.has(t);i._updateReceiveCounters(e.toString(),t,n,o),s&&(yield i.put(t,n))})()}_updateReceiveCounters(e,t,n,s){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",n.length),s&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",n.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}get(e,t={}){var n=this;return(0,B.Z)(function*(){let i=!1;const o=function(){var u=(0,B.Z)(function*(f,E){try{return yield n.blockstore.get(f,E)}catch(T){if("ERR_NOT_FOUND"!==T.code)throw T;return i||(i=!0,n.network.findAndConnect(f,E).catch(U=>n._log.error(U))),((u,f)=>(n.wm.wantBlocks([u],f),n.notifications.wantBlock(u,f)))(f,E)}});return function(E,T){return u.apply(this,arguments)}}(),a=new AbortController,c=t.signal?(0,wn.anySignal)([t.signal,a.signal]):a.signal;try{return yield Promise.race([n.notifications.wantBlock(e,{signal:c}),o(e,{signal:c})])}finally{a.abort()}})()}getMany(e,t={}){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(e);s=!(c=yield X(a.next())).done;s=!1){const u=c.value;yield n.get(u,t)}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()}unwant(e){const t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach(n=>this.notifications.unwantBlock(n))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}put(e,t,n){var s=this;return(0,B.Z)(function*(){yield s.blockstore.put(e,t),s._sendHaveBlockNotifications(e,t)})()}putMany(e,t){var n=this;return Ee(function*(){var o,s=!1,i=!1;try{for(var c,a=be(n.blockstore.putMany(e,t));s=!(c=yield X(a.next())).done;s=!1){const{key:u,value:f}=c.value;n._sendHaveBlockNotifications(u,f),yield{key:u,value:f}}}catch(u){i=!0,o=u}finally{try{s&&null!=a.return&&(yield X(a.return()))}finally{if(i)throw o}}})()}_sendHaveBlockNotifications(e,t){this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,data:t}]),this.network.provide(e).catch(n=>{this._log.error("Failed to provide: %s",n.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}start(){var e=this;return(0,B.Z)(function*(){e.wm.start(),yield e.network.start(),e.engine.start(),e.started=!0})()}stop(){var e=this;return(0,B.Z)(function*(){e._stats.stop(),e.wm.stop(),yield e.network.stop(),e.engine.stop(),e.started=!1})()}unwrap(){return this.blockstore}}function Kst(r){return r=r||new Error("Not Found"),ee(r,"ERR_NOT_FOUND")}function Zst(r){return r=r||new Error("Aborted"),ee(r,"ERR_ABORTED")}const Yst=function Hst(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function T(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var P=0;if(" "!==b[P]){for(var F=0,M=0;b[P]===c;)F++,P++;for(var H=(b.length-P)*u+1>>>0,$=new Uint8Array(H);b[P];){var V=t[b.charCodeAt(P)];if(255===V)return;for(var W=0,ne=H-1;(0!==V||W<M)&&-1!==ne;ne--,W++)$[ne]=(V+=a*$[ne]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");M=W,P++}if(" "!==b[P]){for(var Y=H-M;Y!==H&&0===$[Y];)Y++;for(var q=new Uint8Array(F+(H-Y)),ge=F;Y!==H;)q[ge++]=$[Y++];return q}}}return{encode:function E(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var P=0,F=0,M=0,H=b.length;M!==H&&0===b[M];)M++,P++;for(var $=(H-M)*f+1>>>0,V=new Uint8Array($);M!==H;){for(var W=b[M],ne=0,Y=$-1;(0!==W||ne<F)&&-1!==Y;Y--,ne++)V[Y]=(W+=256*V[Y]>>>0)%a>>>0,W=W/a>>>0;if(0!==W)throw new Error("Non-zero carry");F=ne,M++}for(var q=$-F;q!==$&&0===V[q];)q++;for(var ge=c.repeat(P);q<$;++q)ge+=r.charAt(V[q]);return ge},decodeUnsafe:T,decode:function U(b){var P=T(b);if(P)return P;throw new Error(`Non-${e} character`)}}};new Uint8Array(0);class Xst{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class qst{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return GH(this,e)}}class eit{constructor(e){this.decoders=e}or(e){return GH(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const GH=(r,e)=>new eit({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class tit{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new Xst(e,t,n),this.decoder=new qst(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const WH=({name:r,prefix:e,encode:t,decode:n})=>new tit(r,e,t,n),YH=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=Yst(t,e);return WH({prefix:r,name:e,encode:n,decode:i=>(r=>{if(r instanceof Uint8Array&&"Uint8Array"===r.constructor.name)return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")})(s(i))})},la=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>WH({prefix:e,name:r,encode:s=>((r,e,t)=>{const n="="===e[e.length-1],s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i})(s,n,t),decode:s=>((r,e,t,n)=>{const s={};for(let f=0;f<e.length;++f)s[e[f]]=f;let i=r.length;for(;"="===r[i-1];)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let f=0;f<i;++f){const E=s[r[f]];if(void 0===E)throw new SyntaxError(`Non-${n} character`);c=c<<t|E,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(s,n,t,r)});la({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),la({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),la({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),la({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),la({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),la({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),la({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),la({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),la({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Math.pow(2,31),Math.pow(2,7),Math.pow(2,14),Math.pow(2,21),Math.pow(2,28),Math.pow(2,35),Math.pow(2,42),Math.pow(2,49),Math.pow(2,56),Math.pow(2,63),YH({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),YH({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Symbol,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");class Tit extends B9{constructor(e,t){super(),this.child=e,this.bitswap=t}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}put(e,t,n={}){var s=this;return(0,B.Z)(function*(){(yield s.has(e))||(s.bitswap.isStarted()?yield s.bitswap.put(e,t,n):yield s.child.put(e,t,n))})()}putMany(e,t={}){var n=this;return Ee(function*(){const s=Js(e,function(){var i=(0,B.Z)(function*({key:o}){return!(yield n.has(o))});return function(o){return i.apply(this,arguments)}}());n.bitswap.isStarted()?yield*Fe(be(n.bitswap.putMany(s,t)),X):yield*Fe(be(n.child.putMany(s,t)),X)})()}get(e,t={}){var n=this;return(0,B.Z)(function*(){return!(yield n.has(e))&&n.bitswap.isStarted()?n.bitswap.get(e,t):n.child.get(e,t)})()}getMany(e,t={}){var n=this;return Ee(function*(){const s=ss({objectMode:!0}),i=ss({objectMode:!0});Promise.resolve().then((0,B.Z)(function*(){var c,o=!1,a=!1;try{for(var f,u=be(e);o=!(f=yield u.next()).done;o=!1){const E=f.value;!(yield n.has(E))&&n.bitswap.isStarted()?s.push(E):i.push(E)}}catch(E){a=!0,c=E}finally{try{o&&null!=u.return&&(yield u.return())}finally{if(a)throw c}}s.end(),i.end()})),yield*Fe(be(Xs(n.bitswap.getMany(s,t),n.child.getMany(i,t))),X)})()}delete(e,t){var n=this;return(0,B.Z)(function*(){yield n.child.delete(e,t)})()}deleteMany(e,t){var n=this;return Ee(function*(){yield*Fe(be(n.child.deleteMany(e,t)),X)})()}has(e,t={}){var n=this;return(0,B.Z)(function*(){return n.child.has(e,t)})()}query(e,t={}){var n=this;return Ee(function*(){yield*Fe(be(n.child.query(e,t)),X)})()}queryKeys(e,t={}){var n=this;return Ee(function*(){yield*Fe(be(n.child.queryKeys(e,t)),X)})()}}class pT{constructor(e,t,n,s,i){this.peerId=e,this.libp2p=t,this.bitswap=n,this.repo=s,this.blockstore=i}static start({peerId:e,repo:t,print:n,hashers:s,options:i}){return(0,B.Z)(function*(){t.closed&&(yield t.open());const o=yield t.config.getAll(),a=yield qA({options:i,repo:t,peerId:e,multiaddrs:Cit(e,o),config:o,keychainConfig:void 0});yield a.start();for(const f of a.getMultiaddrs())n(`Swarm listening on ${f.toString()}`);const c=((r,e,t={})=>new jst(r,e,t))(a,t.blocks,{statsEnabled:!0,hashLoader:s,maxInboundStreams:1024,maxOutboundStreams:1024});yield c.start();const u=new Tit(t.blocks,c);return t.blocks=u,t.pins.blockstore=u,new pT(e,a,c,t,u)})()}static stop(e){return(0,B.Z)(function*(){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),yield e.bitswap.stop(),yield e.libp2p.stop()})()}}const Cit=(r,e)=>{const t=r.toString(),n=[],s=e.Addresses&&e.Addresses.Swarm||[];for(const i of s){let o=at(i);if(o.protoCodes().includes(Iit))throw ee(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");const a=o.getPeerId();a&&a!==t&&(o=o.encapsulate(`/p2p/${t}`)),n.push(o)}return n},Iit=479;class Bit{constructor({network:e}){this.addrs=function Rit({network:r}){function t(){return(t=(0,B.Z)(function*(n={}){const s=[],{libp2p:i}=yield r.use(n);return yield i.peerStore.forEach(o=>{s.push({id:o.id,addrs:o.addresses.map(a=>a.multiaddr)})}),s})).apply(this,arguments)}return ze(function e(){return t.apply(this,arguments)})}({network:e}),this.connect=function Dit({network:r}){function t(){return(t=(0,B.Z)(function*(n,s={}){const{libp2p:i}=yield r.use(s);yield i.dial(n,s)})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}({network:e}),this.disconnect=function Oit({network:r}){function t(){return(t=(0,B.Z)(function*(n,s={}){const{libp2p:i}=yield r.use(s);yield i.hangUp(n)})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}({network:e}),this.localAddrs=function Pit({network:r}){function t(){return(t=(0,B.Z)(function*(n={}){const{libp2p:s}=yield r.use(n);return s.getMultiaddrs()})).apply(this,arguments)}return ze(function e(){return t.apply(this,arguments)})}({network:e}),this.peers=function Nit({network:r}){function t(){return(t=(0,B.Z)(function*(n={}){const{libp2p:s}=yield r.use(n);if(n.verbose){const o=[];for(const a of s.getConnections()){const c={addr:a.remoteAddr,peer:a.remotePeer};(n.verbose||n.direction)&&(c.direction=a.stat.direction),n.verbose&&(c.muxer=a.stat.multiplexer,c.latency="n/a",c.streams=[]),o.push(c)}return o}const i=new Map;for(const o of s.getConnections()){const a={addr:o.remoteAddr,peer:o.remotePeer};i.set(o.remotePeer.toString(),a)}return Array.from(i.values())})).apply(this,arguments)}return ze(function e(){return t.apply(this,arguments)})}({network:e})}}const z0={success:!0,time:0,text:""},yT="/ipns/";function rG(r){let e;if(r.startsWith(yT)&&(r=r.substring(yT.length)),("1"===r[0]||"Q"===r[0])&&(r=`z${r}`),"z"===r[0]&&(e=Hs.decode(r)),"k"===r[0]&&(e=mp.decode(r)),!e)throw new Error("Could not parse string");if(1!==e[0]&&114!==e[1]&&(e=zf([[1,114],e])),40!==e.length)throw new Error("Incorrect length "+e.length);return zf([va(yT),e.subarray(2)])}const zu=function(){var r=(0,B.Z)(function*(e,t,n){const s=yield e.use(n);if(null!=s.libp2p.dht)return s;{const i=function(){var o=Ee(function*(){yield{from:t,name:"QUERY_ERROR",type:3,error:new D6("dht not enabled")}});return function(){return o.apply(this,arguments)}}();return{libp2p:{dht:{get:i,put:i,findProviders:i,findPeer:i,provide:i,getClosestPeers:i}}}}});return function(t,n,s){return r.apply(this,arguments)}}(),V0=function(){var r=(0,B.Z)(function*(){throw new D6("pubsub not enabled")});return function(){return r.apply(this,arguments)}}();var Mit=p(28069);const Fit=Sr.bind({ignoreUndefined:!0}),hc=Be("ipfs");class Vit{constructor({print:e,storage:t,codecs:n,options:s}){const{peerId:i,repo:o,keychain:a}=t,c=Ei.create(pT),u=function fwe(r={}){if(r.enabled=Boolean(r.enabled),r.addresses=r.addresses||[],r.cache=r.cache||1e3,!r.enabled||!r.addresses.length)return Th("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let e=!0,t=[];const n=r.addresses.map(o=>zE(o)),s=cf(r.cache),i=function(){var o=(0,B.Z)(function*(a){try{if(e)throw new Error(`preload ${a} but preloader is not started`);const c=a.toString();if(s.has(c))return;s.set(c,!0);const u=function awe(r){if(!Array.isArray(r))throw new TypeError("Expected an array, got "+typeof r);for(let e=(r=[...r]).length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[r[e],r[t]]=[r[t],r[e]]}return r}(n);let f=!1;const E=Date.now();for(const T of u){if(e)throw new Error(`preload aborted for ${c}`);let U;try{U=new AbortController,t=t.concat(U),yield dwe(`${T}/api/v0/refs?r=true&arg=${encodeURIComponent(c)}`,{signal:U.signal}),f=!0}catch(b){"aborted"!==b.type&&Th.error(b)}finally{t=t.filter(b=>b!==U)}if(f)break}Th(`${f?"":"un"}successfully preloaded ${c} in ${Date.now()-E}ms`)}catch(c){Th.error(c)}});return function(c){return o.apply(this,arguments)}}();return i.start=()=>{e=!1},i.stop=()=>{e=!0,Th(`aborting ${t.length} pending preload request(s)`),t.forEach(o=>o.abort()),t=[]},i}(s.preload),f=function Voe(){return ze(function(){var e=(0,B.Z)(function*(t,n={recursive:!0}){if("string"!=typeof t)throw new Error("Invalid arguments, domain must be a string");return function Foe(r,e){return _5.apply(this,arguments)}(t=function zoe(r){return r.endsWith(".eth")&&(r=r.replace(/.eth$/,".eth.link")),r}(t),n)});return function(n){return e.apply(this,arguments)}}())}(),E=function joe({network:r}){return()=>{const e=r.try();return null!=e&&Boolean(e.libp2p.isStarted())}}({network:c}),T=new ppe(s),U=Object.values(Jq);(s.ipld&&s.ipld.hashers?s.ipld.hashers:[]).forEach(gt=>U.push(gt)),this.hashers=new YF({hashers:U,loadHasher:s.ipld&&s.ipld.loadHasher});const b=Object.values(I6);(s.ipld&&s.ipld.bases?s.ipld.bases:[]).forEach(gt=>b.push(gt)),this.bases=new GF({bases:b,loadBase:s.ipld&&s.ipld.loadBase});const P=new wce({repo:o,codecs:n}),F=new Ype({codecs:n,hashers:this.hashers,preload:u,repo:o}),M=new Ape({dns:f,ipns:T,repo:o,codecs:n,peerId:i,isOnline:E,keychain:a,options:s}),H=function pce({repo:r,codecs:e,bases:t,name:n}){function i(){return(i=(0,B.Z)(function*(o,a={}){if(!r5(o))throw new Error("invalid argument "+o);if(fR(o)){var f,c=!1,u=!1;try{for(var T,E=be(n.resolve(o,a));c=!(T=yield E.next()).done;c=!1)o=T.value}catch(De){u=!0,f=De}finally{try{c&&null!=E.return&&(yield E.return())}finally{if(u)throw f}}}const[,U,b,...P]=o.split("/"),F=a.cidBase?yield t.getBase(a.cidBase):void 0,M=yce(b);if(0===P.length)return`/${U}/${F?F.encoder.encode(M):b}`;const H=qe.decode(M);o=P.join("/");const $=af(H,o,e,r,a);let V=H,W=o;var q,ne=!1,Y=!1;try{for(var Ce,ge=be($);ne=!(Ce=yield ge.next()).done;ne=!1){const De=Ce.value;qe.asCID(De.value)&&(V=De.value,W=De.remainderPath)}}catch(De){Y=!0,q=De}finally{try{ne&&null!=ge.return&&(yield ge.return())}finally{if(Y)throw q}}return`/ipfs/${V.toString(F&&F.encoder)}${W?"/"+W:""}`})).apply(this,arguments)}return ze(function s(o){return i.apply(this,arguments)})}({repo:o,codecs:n,bases:this.bases,name:M}),$=new swe({repo:o,codecs:n,hashers:this.hashers,preload:u}),V=Object.assign(function Cpe({repo:r,codecs:e,resolve:t,preload:n}){function i(){return(i=Ee(function*(o,a={}){if(0===a.maxDepth)return;if(a.edges&&a.format&&"<dst>"!==a.format)throw new Error("Cannot set edges to true and also specify format");if(a.format=a.edges?"<src> -> <dst>":a.format,"number"!=typeof a.maxDepth&&(a.maxDepth=a.recursive?1/0:1),a.timeout){const E=[new Ar.TimeoutController(a.timeout).signal];a.signal&&E.push(a.signal),a.signal=(0,wn.anySignal)(E)}const u=(Array.isArray(o)?o:[o]).map(f=>Ipe(n,f,a));for(const f of u)try{yield*Fe(be(Rpe(t,r,e,f,a)),X)}catch(E){yield{ref:"",err:E.message}}})).apply(this,arguments)}return function s(o){return i.apply(this,arguments)}}({repo:o,codecs:n,resolve:H,preload:u}),{local:Npe({repo:t.repo})}),{add:W,addAll:ne,cat:Y,get:q,ls:ge}=new U8e({preload:u,repo:o,options:s.EXPERIMENTAL,hashers:this.hashers}),Ce=function DEe({repo:r,preload:e,hashers:t,options:n}){const s=function REe(r){const{repoOwner:e}=Object.assign({},IEe||{},r),t=KE(e),i={};return RU({options:r,mfs:i,operations:TEe,lock:o=>t.readLock(o)}),RU({options:r,mfs:i,operations:CEe,lock:o=>t.writeLock(o)}),Object.keys(IU).forEach(o=>{i[o]=IU[o](r)}),i}({repo:r,repoOwner:!1!==n.repoOwner,hashers:t}),i=o=>(...c)=>{const u=c.filter(f=>(r=>qd(r,Jd))(f)||Xd(f));if(u.length){const f=c[c.length-1];f&&!1!==f.preload&&u.forEach(E=>e(E))}return o(...c)};return{...s,chmod:s.chmod,cp:i(s.cp),mkdir:s.mkdir,stat:i(s.stat),rm:s.rm,read:i(s.read),touch:s.touch,write:s.write,mv:i(s.mv),flush:s.flush,ls:i(Ee(function*(...o){var u,a=!1,c=!1;try{for(var E,f=be(s.ls(...o));a=!(E=yield X(f.next())).done;a=!1){const T=E.value;yield{...T,size:T.size||0}}}catch(T){c=!0,u=T}finally{try{a&&null!=f.return&&(yield X(f.return()))}finally{if(c)throw u}}}))}}({repo:o,preload:u,hashers:this.hashers,options:s}),De=function hwe({preload:r,files:e,options:t={}}){if(t.interval=t.interval||3e4,!t.enabled){ky("MFS preload disabled");const o=function(){var a=(0,B.Z)(function*(){});return function(){return a.apply(this,arguments)}}();return{start:o,stop:o}}let s,n="";const i=function(){var o=(0,B.Z)(function*(){try{const a=yield e.stat("/"),c=a.cid.toString();n!==c&&(ky(`preloading updated MFS root ${n} -> ${a.cid}`),yield r(a.cid),n=c)}catch(a){ky.error("failed to preload MFS root",a)}finally{s=setTimeout(i,t.interval)}});return function(){return o.apply(this,arguments)}}();return{start:()=>(0,B.Z)(function*(){const o=yield e.stat("/");n=o.cid.toString(),ky(`monitoring MFS root ${o.cid}`),s=setTimeout(i,t.interval)})(),stop(){clearTimeout(s)}}}({files:Ce,preload:u,options:s.preload});this.preload=u,this.name=M,this.ipns=T,this.pin=P,this.resolve=H,this.block=F,this.refs=V,this.start=function Toe({network:r,preload:e,peerId:t,keychain:n,repo:s,ipns:i,mfsPreload:o,print:a,hashers:c,options:u}){return function(){var E=(0,B.Z)(function*(){const{libp2p:T}=yield Ei.start(r,{peerId:t,repo:s,print:a,hashers:c,options:u});yield Promise.all([i.startOnline({keychain:n,libp2p:T,peerId:t,repo:s}),e.start(),o.start()])});return function(){return E.apply(this,arguments)}}()}({network:c,peerId:i,repo:o,preload:u,ipns:T,mfsPreload:De,print:e,keychain:a,hashers:this.hashers,options:s}),this.stop=function Coe({network:r,preload:e,ipns:t,repo:n,mfsPreload:s}){return function(){var o=(0,B.Z)(function*(){yield Promise.all([e.stop(),t.stop(),s.stop()]),yield Ei.stop(r),yield n.close()});return function(){return o.apply(this,arguments)}}()}({network:c,preload:u,mfsPreload:De,ipns:T,repo:o}),this.dht=function kit({network:r,repo:e,peerId:t}){const{get:n,put:s,findProvs:i,findPeer:o,provide:a,query:c}={get:(u,f={})=>Ee(function*(){const{libp2p:E}=yield X(zu(r,t,f)),T=u instanceof Uint8Array?u:rG(u);if(null==E.dht)throw ee(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*Fe(be(E.dht.get(T,f)),X)})(),put:(u,f,E)=>Ee(function*(){const{libp2p:T}=yield X(zu(r,t,E)),U=u instanceof Uint8Array?u:rG(u);if(null==T.dht)throw ee(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*Fe(be(T.dht.put(U,f,E)),X)})(),findProvs:(u,f={})=>Ee(function*(){const{libp2p:E}=yield X(zu(r,t,f));if(null==E.dht)throw ee(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*Fe(be(E.dht.findProviders(u,{signal:f.signal})),X)})(),findPeer:(u,f={})=>Ee(function*(){const{libp2p:E}=yield X(zu(r,t,f));if(null==E.dht)throw ee(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*Fe(be(E.dht.findPeer(u,{signal:f.signal})),X)})(),provide:(u,f={recursive:!1})=>Ee(function*(){const{libp2p:E}=yield X(zu(r,t,f));if(!(yield X(e.blocks.has(u))))throw ee(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(f.recursive)throw ee(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");if(null==E.dht)throw ee(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*Fe(be(E.dht.provide(u)),X)})(),query:(u,f={})=>Ee(function*(){const{libp2p:E}=yield X(zu(r,t,f));let T;const U=qe.asCID(u);if(T=null!=U?U.multihash.bytes:bt(u.toString()).toBytes(),null==E.dht)throw ee(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*Fe(be(E.dht.getClosestPeers(T,f)),X)})()};return{get:ze(n),put:ze(s),findProvs:ze(i),findPeer:ze(o),provide:ze(a),query:ze(c)}}({network:c,repo:o,peerId:i}),this.pubsub=function Uit({network:r,config:e}){const t=Ot(e||{},"Pubsub.Enabled",!0),n={};let s;return{subscribe:t?ze(function i(P,F){return o.apply(this,arguments)}):V0,unsubscribe:t?ze(function a(P,F){return c.apply(this,arguments)}):V0,publish:t?ze(function u(P,F){return f.apply(this,arguments)}):V0,ls:t?ze(function E(){return T.apply(this,arguments)}):V0,peers:t?ze(function U(P){return b.apply(this,arguments)}):V0};function o(){return(o=(0,B.Z)(function*(P,F,M={}){const{libp2p:H}=yield r.use(M);H.pubsub.subscribe(P),null==s&&(s=$=>{const V=$.detail;n[V.topic]&&n[V.topic].forEach(W=>{"function"!=typeof W?null!=W&&null!=W.handleEvent&&W.handleEvent(V):W(V)})},H.pubsub.addEventListener("message",s)),null!=F&&(null==n[P]&&(n[P]=[]),n[P].push(F))})).apply(this,arguments)}function c(){return(c=(0,B.Z)(function*(P,F,M={}){const{libp2p:H}=yield r.use(M);null!=F&&null!=n[P]&&(n[P]=n[P].filter($=>$!==F),0===n[P].length&&delete n[P]),"function"!=typeof F&&delete n[P],null==n[P]&&H.pubsub.unsubscribe(P),0===Object.keys(n).length&&(H.pubsub.removeEventListener("message",s),s=void 0)})).apply(this,arguments)}function f(){return(f=(0,B.Z)(function*(P,F,M={}){const{libp2p:H}=yield r.use(M);if(!F)throw ee(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");yield H.pubsub.publish(P,F)})).apply(this,arguments)}function T(){return(T=(0,B.Z)(function*(P={}){const{libp2p:F}=yield r.use(P);return F.pubsub.getTopics()})).apply(this,arguments)}function b(){return(b=(0,B.Z)(function*(P,F={}){const{libp2p:M}=yield r.use(F);return M.pubsub.getSubscribers(P)})).apply(this,arguments)}}({network:c,config:s.config}),this.dns=f,this.isOnline=E,this.id=function j8e({peerId:r,network:e}){function n(){return(n=(0,B.Z)(function*(s={}){const i=e.try();if(!i){if(s.peerId)throw new YC;if(null==r.publicKey)throw ee(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");return{id:r,publicKey:ts(r.publicKey,"base64pad"),addresses:[],agentVersion:`js-ipfs/${Sy}`,protocolVersion:"9000",protocols:[]}}const{libp2p:o}=i,a=s.peerId?s.peerId:r,c=yield $8e(a,o,s),u=ts(c.metadata.get("AgentVersion")||new Uint8Array),f=ts(c.metadata.get("ProtocolVersion")||new Uint8Array),E=c.id.toString();return{id:a,publicKey:c.publicKey?ts(c.publicKey,"base64pad"):"",addresses:(c.addresses||[]).map(U=>{const b=U.toString();return b.endsWith(`/p2p/${E}`)?b:`${b}/p2p/${E}`}).sort().map(U=>at(U)),agentVersion:u,protocolVersion:f,protocols:(c.protocols||[]).sort()}})).apply(this,arguments)}return ze(function t(){return n.apply(this,arguments)})}({network:c,peerId:i}),this.version=function z8e({repo:r}){function t(){return(t=(0,B.Z)(function*(n={}){const s=yield r.version.get();return{version:Sy,commit:M8e,repo:`${s}`,"ipfs-core":Sy,"interface-ipfs-core":"^0.157.0"}})).apply(this,arguments)}return ze(function e(){return t.apply(this,arguments)})}({repo:o}),this.bitswap=new Upe({network:c}),this.bootstrap=new $pe({repo:o}),this.config=function G8e({repo:r}){return{getAll:ze(function e(){return t.apply(this,arguments)}),get:ze(function n(E,T){return s.apply(this,arguments)}),set:ze(function i(E,T,U){return o.apply(this,arguments)}),replace:ze(function a(E,T){return c.apply(this,arguments)}),profiles:{apply:ze(function u(E){return f.apply(this,arguments)}),list:ze(W8e)}};function t(){return(t=(0,B.Z)(function*(E={}){return r.config.getAll(E)})).apply(this,arguments)}function s(){return(s=(0,B.Z)(function*(E,T){return E?r.config.get(E,T):Promise.reject(new Error("key argument is required"))})).apply(this,arguments)}function o(){return(o=(0,B.Z)(function*(E,T,U){return r.config.set(E,T,U)})).apply(this,arguments)}function c(){return(c=(0,B.Z)(function*(E,T){return r.config.replace(E,T)})).apply(this,arguments)}function f(){return(f=(0,B.Z)(function*(E,T={dryRun:!1}){const{dryRun:U}=T,b=Ay[E];if(!b)throw new Error(`No profile with name '${E}' exists`);try{const P=yield r.config.getAll(T);let F=JSON.parse(JSON.stringify(P));return F=b.transform(F),U||(yield r.config.replace(F,T)),delete P.Identity.PrivKey,delete F.Identity.PrivKey,{original:P,updated:F}}catch(P){throw H8e(P),new Error(`Could not apply profile '${E}' to config: ${P.message}`)}})).apply(this,arguments)}}({repo:o}),this.ping=function Lit({network:r}){function t(){return(t=Ee(function*(n,s={}){const{libp2p:i}=yield X(r.use());s.count=s.count||10;const o=yield X(i.peerStore.get(n));let a=o&&o.id;if(!a){yield{...z0,text:`Looking up peer ${n}`};const f=yield X(i.peerRouting.findPeer(n));a=f&&f.id}if(!a)throw new Error("Peer was not found");yield{...z0,text:`PING ${a.toString()}`};let c=0,u=0;for(let f=0;f<s.count;f++)try{const E=yield X(i.ping(a));u+=E,c++,yield{...z0,time:E}}catch(E){yield{...z0,success:!1,text:E.toString()}}if(c){const f=u/c;yield{...z0,text:`Average latency: ${f}ms`}}})).apply(this,arguments)}return ze(function e(n){return t.apply(this,arguments)})}({network:c}),this.add=W,this.addAll=ne,this.cat=Y,this.get=q,this.ls=ge,this.dag=$,this.files=Ce,this.key=new MEe({keychain:a}),this.object=new WEe({preload:u,codecs:n,repo:o}),this.repo=new XEe({repo:o,hashers:this.hashers}),this.stats=new e7e({repo:o,network:c}),this.swarm=new Bit({network:c}),Object.defineProperty(this,"libp2p",{get(){const gt=c.try();return gt?gt.libp2p:void 0}});const Je=()=>Promise.reject(ee(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),Xe=function(){var gt=Ee(function*(){throw ee(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});return function(){return gt.apply(this,arguments)}}();this.commands=Je,this.diag={cmds:Je,net:Je,sys:Je},this.log={level:Je,ls:Je,tail:Xe},this.mount=Je,this.codecs=n}init(){return(0,B.Z)(function*(){throw new R6})()}}const jit=function(){var r=(0,B.Z)(function*(e){const t=ir({Data:new ur({type:"directory"}).marshal(),Links:[]}),n=yield e.block.put(t,{mhtype:"sha2-256",format:"dag-pb"});return yield e.pin.add(n),n});return function(t){return r.apply(this,arguments)}}(),$it=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!fa.isTest,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}});function gT(){return gT=(0,B.Z)(function*(r={}){const e=(r=Fit($it(),r)).init||{},t={name:A6.name,code:A6.code,encode:u=>u,decode:u=>u},n=Object.values(Xq);[w,d,S,I,t].concat(r.ipld&&r.ipld.codecs||[]).forEach(u=>n.push(u));const s=new WF({codecs:n,loadCodec:r.ipld&&r.ipld.loadCodec}),i=r.silent?hc:Mit.log;hc("creating repo");const o=yield eT.start(i,s,r);hc("getting repo config");const a=yield o.repo.config.getAll(),c=new Vit({storage:o,print:i,codecs:s,options:{...r,config:a}});if(hc("starting preload"),yield c.preload.start(),hc("starting storage"),c.ipns.startOffline(o),o.isNew&&!e.emptyRepo){const u=yield jit(c);if(hc("adding default assets"),yield,hc("initializing IPNS keyspace"),null==o.peerId.publicKey)throw ee(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");const f=new Ar.TimeoutController(3e4);try{yield c.ipns.initializeKeyspace(o.peerId,va(`/ipfs/${u}`),{signal:f.signal})}finally{f.clear()}}return!1!==r.start&&(hc("starting node"),yield c.start()),c}),gT.apply(this,arguments)}var Zit=p(52596);const Hit=function Kit(){return gT.apply(this,arguments)},Git=Zit,Wit=JBe},78753:(re,J,p)=>{"use strict";var w=p(21778).default,d=p(40226).default;re.exports=function(){var I=w(function*(m){var y,l=!1,h=!1;try{for(var _=d(m);l=!(yield _.next()).done;l=!1);}catch(O){h=!0,y=O}finally{try{l&&null!=_.return&&(yield _.return())}finally{if(h)throw y}}});return function(l){return I.apply(this,arguments)}}()},91635:(re,J,p)=>{"use strict";var w=p(21778).default,d=p(40226).default;re.exports=function(){var I=w(function*(m){var y,l=!1,h=!1;try{for(var A,_=d(m);l=!(A=yield _.next()).done;l=!1)return A.value}catch(O){h=!0,y=O}finally{try{l&&null!=_.return&&(yield _.return())}finally{if(h)throw y}}});return function(l){return I.apply(this,arguments)}}()},99948:(re,J,p)=>{"use strict";var w=p(21778).default,d=p(73671).default,S=p(14997).default,I=p(40226).default,m=p(63983).default;const l=p(83939);re.exports=function(){var y=d(function*(..._){const A=l();setTimeout(w(function*(){try{yield Promise.all(_.map(function(){var O=w(function*(x){var R,g=!1,v=!1;try{for(var D,N=I(x);g=!(D=yield N.next()).done;g=!1)A.push(D.value)}catch(k){v=!0,R=k}finally{try{g&&null!=N.return&&(yield N.return())}finally{if(v)throw R}}});return function(x){return O.apply(this,arguments)}}())),A.end()}catch(O){A.end(O)}}),0),yield*m(I(A),S)});return function(){return y.apply(this,arguments)}}()},83939:(re,J,p)=>{const w=p(30766);re.exports=d=>{let S;"function"==typeof(d=d||{})?(S=d,d={}):S=d.onEnd;let m,l,h,I=new w;const _=N=>l?l(N):(I.push(N),m),O=N=>h?m:_({done:!1,value:N}),x=N=>h?m:(h=!0,N?(N=>(I=new w,l?l({error:N}):(I.push({error:N}),m)))(N):_({done:!0}));if(m={[Symbol.asyncIterator](){return this},next:()=>{if(!I.isEmpty()){if(d.writev){let D;const k=[];for(;!I.isEmpty();){if(D=I.shift(),D.error)throw D.error;k.push(D.value)}return{done:D.done,value:k}}const N=I.shift();if(N.error)throw N.error;return N}return h?{done:!0}:new Promise((N,D)=>{l=k=>(l=null,k.error?D(k.error):N(d.writev&&!k.done?{done:k.done,value:[k.value]}:k),m)})},return:()=>(I=new w,x(),{done:!0}),throw:N=>(x(N),{done:!0}),push:O,end:x},!S)return m;const R=m;return m={[Symbol.asyncIterator](){return this},next:()=>R.next(),throw:N=>(R.throw(N),S&&(S(N),S=null),{done:!0}),return:()=>(R.return(),S&&(S(),S=null),{done:!0}),push:O,end:N=>(R.end(N),S&&(S(N),S=null),m)},m}},47286:(re,J,p)=>{"use strict";var w=p(21778).default,d=p(40226).default;re.exports=function(){var I=w(function*(m){const l=[];var _,h=!1,y=!1;try{for(var O,A=d(m);h=!(O=yield A.next()).done;h=!1)l.push(O.value)}catch(x){y=!0,_=x}finally{try{h&&null!=A.return&&(yield A.return())}finally{if(y)throw _}}return l});return function(l){return I.apply(this,arguments)}}()},52107:(re,J,p)=>{"use strict";var w=p(14997).default,d=p(73671).default,S=p(40226).default;re.exports=function(){var m=d(function*(l,h){var A,y=!1,_=!1;try{for(var x,O=S(l);y=!(x=yield w(O.next())).done;y=!1){const g=x.value;(yield w(h(g)))&&(yield g)}}catch(g){_=!0,A=g}finally{try{y&&null!=O.return&&(yield w(O.return()))}finally{if(_)throw A}}});return function(h,y){return m.apply(this,arguments)}}()},66499:(re,J,p)=>{"use strict";var w=p(14997).default,d=p(73671).default,S=p(40226).default;re.exports=function(){var m=d(function*(l,h){var A,y=!1,_=!1;try{for(var x,O=S(l);y=!(x=yield w(O.next())).done;y=!1){const g=x.value;yield w(h(g)),yield g}}catch(g){_=!0,A=g}finally{try{y&&null!=O.return&&(yield w(O.return()))}finally{if(_)throw A}}});return function(h,y){return m.apply(this,arguments)}}()},45156:(re,J,p)=>{"use strict";var w=p(14997).default,d=p(73671).default,S=p(40226).default;re.exports=function(){var m=d(function*(l,h){var A,y=!1,_=!1;try{for(var x,O=S(l);y=!(x=yield w(O.next())).done;y=!1){const g=x.value;yield h(g)}}catch(g){_=!0,A=g}finally{try{y&&null!=O.return&&(yield w(O.return()))}finally{if(_)throw A}}});return function(h,y){return m.apply(this,arguments)}}()},18791:re=>{"use strict";re.exports=function J(p,w){for(var d=new Array(arguments.length-1),S=0,I=2,m=!0;I<arguments.length;)d[S++]=arguments[I++];return new Promise(function(h,y){d[S]=function(A){if(m)if(m=!1,A)y(A);else{for(var O=new Array(arguments.length-1),x=0;x<O.length;)O[x++]=arguments[x];h.apply(null,O)}};try{p.apply(w||null,d)}catch(_){m&&(m=!1,y(_))}})}},5985:(re,J)=>{"use strict";var p=J;p.length=function(l){var h=l.length;if(!h)return 0;for(var y=0;--h%4>1&&"="===l.charAt(h);)++y;return Math.ceil(3*l.length)/4-y};for(var w=new Array(64),d=new Array(123),S=0;S<64;)d[w[S]=S<26?S+65:S<52?S+71:S<62?S-4:S-59|43]=S++;p.encode=function(l,h,y){for(var g,_=null,A=[],O=0,x=0;h<y;){var v=l[h++];switch(x){case 0:A[O++]=w[v>>2],g=(3&v)<<4,x=1;break;case 1:A[O++]=w[g|v>>4],g=(15&v)<<2,x=2;break;case 2:A[O++]=w[g|v>>6],A[O++]=w[63&v],x=0}O>8191&&((_||(_=[])).push(String.fromCharCode.apply(String,A)),O=0)}return x&&(A[O++]=w[g],A[O++]=61,1===x&&(A[O++]=61)),_?(O&&_.push(String.fromCharCode.apply(String,A.slice(0,O))),_.join("")):String.fromCharCode.apply(String,A.slice(0,O))};var I="invalid encoding";p.decode=function(l,h,y){for(var O,_=y,A=0,x=0;x<l.length;){var g=l.charCodeAt(x++);if(61===g&&A>1)break;if(void 0===(g=d[g]))throw Error(I);switch(A){case 0:O=g,A=1;break;case 1:h[y++]=O<<2|(48&g)>>4,O=g,A=2;break;case 2:h[y++]=(15&O)<<4|(60&g)>>2,O=g,A=3;break;case 3:h[y++]=(3&O)<<6|g,A=0}}if(1===A)throw Error(I);return y-_},p.test=function(l){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(l)}},68074:re=>{"use strict";function J(){this._listeners={}}re.exports=J,J.prototype.on=function(w,d,S){return(this._listeners[w]||(this._listeners[w]=[])).push({fn:d,ctx:S||this}),this},J.prototype.off=function(w,d){if(void 0===w)this._listeners={};else if(void 0===d)this._listeners[w]=[];else for(var S=this._listeners[w],I=0;I<S.length;)S[I].fn===d?S.splice(I,1):++I;return this},J.prototype.emit=function(w){var d=this._listeners[w];if(d){for(var S=[],I=1;I<arguments.length;)S.push(arguments[I++]);for(I=0;I<d.length;)d[I].fn.apply(d[I++].ctx,S)}return this}},48170:re=>{"use strict";function J(I){return typeof Float32Array<"u"?function(){var m=new Float32Array([-0]),l=new Uint8Array(m.buffer),h=128===l[3];function y(x,g,v){m[0]=x,g[v]=l[0],g[v+1]=l[1],g[v+2]=l[2],g[v+3]=l[3]}function _(x,g,v){m[0]=x,g[v]=l[3],g[v+1]=l[2],g[v+2]=l[1],g[v+3]=l[0]}function A(x,g){return l[0]=x[g],l[1]=x[g+1],l[2]=x[g+2],l[3]=x[g+3],m[0]}function O(x,g){return l[3]=x[g],l[2]=x[g+1],l[1]=x[g+2],l[0]=x[g+3],m[0]}I.writeFloatLE=h?y:_,I.writeFloatBE=h?_:y,I.readFloatLE=h?A:O,I.readFloatBE=h?O:A}():function(){function m(h,y,_,A){var O=y<0?1:0;if(O&&(y=-y),0===y)h(1/y>0?0:2147483648,_,A);else if(isNaN(y))h(2143289344,_,A);else if(y>34028234663852886e22)h((O<<31|2139095040)>>>0,_,A);else if(y<11754943508222875e-54)h((O<<31|Math.round(y/1401298464324817e-60))>>>0,_,A);else{var x=Math.floor(Math.log(y)/Math.LN2);h((O<<31|x+127<<23|8388607&Math.round(y*Math.pow(2,-x)*8388608))>>>0,_,A)}}function l(h,y,_){var A=h(y,_),O=2*(A>>31)+1,x=A>>>23&255,g=8388607&A;return 255===x?g?NaN:O*(1/0):0===x?1401298464324817e-60*O*g:O*Math.pow(2,x-150)*(g+8388608)}I.writeFloatLE=m.bind(null,p),I.writeFloatBE=m.bind(null,w),I.readFloatLE=l.bind(null,d),I.readFloatBE=l.bind(null,S)}(),typeof Float64Array<"u"?function(){var m=new Float64Array([-0]),l=new Uint8Array(m.buffer),h=128===l[7];function y(x,g,v){m[0]=x,g[v]=l[0],g[v+1]=l[1],g[v+2]=l[2],g[v+3]=l[3],g[v+4]=l[4],g[v+5]=l[5],g[v+6]=l[6],g[v+7]=l[7]}function _(x,g,v){m[0]=x,g[v]=l[7],g[v+1]=l[6],g[v+2]=l[5],g[v+3]=l[4],g[v+4]=l[3],g[v+5]=l[2],g[v+6]=l[1],g[v+7]=l[0]}function A(x,g){return l[0]=x[g],l[1]=x[g+1],l[2]=x[g+2],l[3]=x[g+3],l[4]=x[g+4],l[5]=x[g+5],l[6]=x[g+6],l[7]=x[g+7],m[0]}function O(x,g){return l[7]=x[g],l[6]=x[g+1],l[5]=x[g+2],l[4]=x[g+3],l[3]=x[g+4],l[2]=x[g+5],l[1]=x[g+6],l[0]=x[g+7],m[0]}I.writeDoubleLE=h?y:_,I.writeDoubleBE=h?_:y,I.readDoubleLE=h?A:O,I.readDoubleBE=h?O:A}():function(){function m(h,y,_,A,O,x){var g=A<0?1:0;if(g&&(A=-A),0===A)h(0,O,x+y),h(1/A>0?0:2147483648,O,x+_);else if(isNaN(A))h(0,O,x+y),h(2146959360,O,x+_);else if(A>17976931348623157e292)h(0,O,x+y),h((g<<31|2146435072)>>>0,O,x+_);else{var v;if(A<22250738585072014e-324)h((v=A/5e-324)>>>0,O,x+y),h((g<<31|v/4294967296)>>>0,O,x+_);else{var R=Math.floor(Math.log(A)/Math.LN2);1024===R&&(R=1023),h(4503599627370496*(v=A*Math.pow(2,-R))>>>0,O,x+y),h((g<<31|R+1023<<20|1048576*v&1048575)>>>0,O,x+_)}}}function l(h,y,_,A,O){var x=h(A,O+y),g=h(A,O+_),v=2*(g>>31)+1,R=g>>>20&2047,N=4294967296*(1048575&g)+x;return 2047===R?N?NaN:v*(1/0):0===R?5e-324*v*N:v*Math.pow(2,R-1075)*(N+4503599627370496)}I.writeDoubleLE=m.bind(null,p,0,4),I.writeDoubleBE=m.bind(null,w,4,0),I.readDoubleLE=l.bind(null,d,0,4),I.readDoubleBE=l.bind(null,S,4,0)}(),I}function p(I,m,l){m[l]=255&I,m[l+1]=I>>>8&255,m[l+2]=I>>>16&255,m[l+3]=I>>>24}function w(I,m,l){m[l]=I>>>24,m[l+1]=I>>>16&255,m[l+2]=I>>>8&255,m[l+3]=255&I}function d(I,m){return(I[m]|I[m+1]<<8|I[m+2]<<16|I[m+3]<<24)>>>0}function S(I,m){return(I[m]<<24|I[m+1]<<16|I[m+2]<<8|I[m+3])>>>0}re.exports=J(J)},91248:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(re){}return null}module.exports=inquire},15759:re=>{"use strict";re.exports=function J(p,w,d){var S=d||8192,I=S>>>1,m=null,l=S;return function(y){if(y<1||y>I)return p(y);l+y>S&&(m=p(S),l=0);var _=w.call(m,l,l+=y);return 7&l&&(l=1+(7|l)),_}}},88178:(re,J)=>{"use strict";var p=J;p.length=function(d){for(var S=0,I=0,m=0;m<d.length;++m)(I=d.charCodeAt(m))<128?S+=1:I<2048?S+=2:55296==(64512&I)&&56320==(64512&d.charCodeAt(m+1))?(++m,S+=4):S+=3;return S},p.read=function(d,S,I){if(I-S<1)return"";for(var _,l=null,h=[],y=0;S<I;)(_=d[S++])<128?h[y++]=_:_>191&&_<224?h[y++]=(31&_)<<6|63&d[S++]:_>239&&_<365?(_=((7&_)<<18|(63&d[S++])<<12|(63&d[S++])<<6|63&d[S++])-65536,h[y++]=55296+(_>>10),h[y++]=56320+(1023&_)):h[y++]=(15&_)<<12|(63&d[S++])<<6|63&d[S++],y>8191&&((l||(l=[])).push(String.fromCharCode.apply(String,h)),y=0);return l?(y&&l.push(String.fromCharCode.apply(String,h.slice(0,y))),l.join("")):String.fromCharCode.apply(String,h.slice(0,y))},p.write=function(d,S,I){for(var l,h,m=I,y=0;y<d.length;++y)(l=d.charCodeAt(y))<128?S[I++]=l:l<2048?(S[I++]=l>>6|192,S[I++]=63&l|128):55296==(64512&l)&&56320==(64512&(h=d.charCodeAt(y+1)))?(++y,S[I++]=(l=65536+((1023&l)<<10)+(1023&h))>>18|240,S[I++]=l>>12&63|128,S[I++]=l>>6&63|128,S[I++]=63&l|128):(S[I++]=l>>12|224,S[I++]=l>>6&63|128,S[I++]=63&l|128);return I-m}},92186:(re,J,p)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});var w=p(30714);function l(fe,ae,pe){return void 0===ae&&(ae=new Uint8Array(2)),void 0===pe&&(pe=0),ae[pe+0]=fe>>>8,ae[pe+1]=fe>>>0,ae}function h(fe,ae,pe){return void 0===ae&&(ae=new Uint8Array(2)),void 0===pe&&(pe=0),ae[pe+0]=fe>>>0,ae[pe+1]=fe>>>8,ae}function y(fe,ae){return void 0===ae&&(ae=0),fe[ae]<<24|fe[ae+1]<<16|fe[ae+2]<<8|fe[ae+3]}function _(fe,ae){return void 0===ae&&(ae=0),(fe[ae]<<24|fe[ae+1]<<16|fe[ae+2]<<8|fe[ae+3])>>>0}function A(fe,ae){return void 0===ae&&(ae=0),fe[ae+3]<<24|fe[ae+2]<<16|fe[ae+1]<<8|fe[ae]}function O(fe,ae){return void 0===ae&&(ae=0),(fe[ae+3]<<24|fe[ae+2]<<16|fe[ae+1]<<8|fe[ae])>>>0}function x(fe,ae,pe){return void 0===ae&&(ae=new Uint8Array(4)),void 0===pe&&(pe=0),ae[pe+0]=fe>>>24,ae[pe+1]=fe>>>16,ae[pe+2]=fe>>>8,ae[pe+3]=fe>>>0,ae}function g(fe,ae,pe){return void 0===ae&&(ae=new Uint8Array(4)),void 0===pe&&(pe=0),ae[pe+0]=fe>>>0,ae[pe+1]=fe>>>8,ae[pe+2]=fe>>>16,ae[pe+3]=fe>>>24,ae}function k(fe,ae,pe){return void 0===ae&&(ae=new Uint8Array(8)),void 0===pe&&(pe=0),x(fe/4294967296>>>0,ae,pe),x(fe>>>0,ae,pe+4),ae}function j(fe,ae,pe){return void 0===ae&&(ae=new Uint8Array(8)),void 0===pe&&(pe=0),g(fe>>>0,ae,pe),g(fe/4294967296>>>0,ae,pe+4),ae}J.readInt16BE=function d(fe,ae){return void 0===ae&&(ae=0),(fe[ae+0]<<8|fe[ae+1])<<16>>16},J.readUint16BE=function S(fe,ae){return void 0===ae&&(ae=0),(fe[ae+0]<<8|fe[ae+1])>>>0},J.readInt16LE=function I(fe,ae){return void 0===ae&&(ae=0),(fe[ae+1]<<8|fe[ae])<<16>>16},J.readUint16LE=function m(fe,ae){return void 0===ae&&(ae=0),(fe[ae+1]<<8|fe[ae])>>>0},J.writeUint16BE=l,J.writeInt16BE=l,J.writeUint16LE=h,J.writeInt16LE=h,J.readInt32BE=y,J.readUint32BE=_,J.readInt32LE=A,J.readUint32LE=O,J.writeUint32BE=x,J.writeInt32BE=x,J.writeUint32LE=g,J.writeInt32LE=g,J.readInt64BE=function v(fe,ae){void 0===ae&&(ae=0);var pe=y(fe,ae),ce=y(fe,ae+4);return 4294967296*pe+ce-4294967296*(ce>>31)},J.readUint64BE=function R(fe,ae){return void 0===ae&&(ae=0),4294967296*_(fe,ae)+_(fe,ae+4)},J.readInt64LE=function N(fe,ae){void 0===ae&&(ae=0);var pe=A(fe,ae);return 4294967296*A(fe,ae+4)+pe-4294967296*(pe>>31)},J.readUint64LE=function D(fe,ae){void 0===ae&&(ae=0);var pe=O(fe,ae);return 4294967296*O(fe,ae+4)+pe},J.writeUint64BE=k,J.writeInt64BE=k,J.writeUint64LE=j,J.writeInt64LE=j,J.readUintBE=function Q(fe,ae,pe){if(void 0===pe&&(pe=0),fe%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(fe/8>ae.length-pe)throw new Error("readUintBE: array is too short for the given bitLength");for(var ce=0,_e=1,de=fe/8+pe-1;de>=pe;de--)ce+=ae[de]*_e,_e*=256;return ce},J.readUintLE=function L(fe,ae,pe){if(void 0===pe&&(pe=0),fe%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(fe/8>ae.length-pe)throw new Error("readUintLE: array is too short for the given bitLength");for(var ce=0,_e=1,de=pe;de<pe+fe/8;de++)ce+=ae[de]*_e,_e*=256;return ce},J.writeUintBE=function K(fe,ae,pe,ce){if(void 0===pe&&(pe=new Uint8Array(fe/8)),void 0===ce&&(ce=0),fe%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!w.isSafeInteger(ae))throw new Error("writeUintBE value must be an integer");for(var _e=1,de=fe/8+ce-1;de>=ce;de--)pe[de]=ae/_e&255,_e*=256;return pe},J.writeUintLE=function G(fe,ae,pe,ce){if(void 0===pe&&(pe=new Uint8Array(fe/8)),void 0===ce&&(ce=0),fe%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!w.isSafeInteger(ae))throw new Error("writeUintLE value must be an integer");for(var _e=1,de=ce;de<ce+fe/8;de++)pe[de]=ae/_e&255,_e*=256;return pe},J.readFloat32BE=function C(fe,ae){return void 0===ae&&(ae=0),new DataView(fe.buffer,fe.byteOffset,fe.byteLength).getFloat32(ae)},J.readFloat32LE=function z(fe,ae){return void 0===ae&&(ae=0),new DataView(fe.buffer,fe.byteOffset,fe.byteLength).getFloat32(ae,!0)},J.readFloat64BE=function te(fe,ae){return void 0===ae&&(ae=0),new DataView(fe.buffer,fe.byteOffset,fe.byteLength).getFloat64(ae)},J.readFloat64LE=function Z(fe,ae){return void 0===ae&&(ae=0),new DataView(fe.buffer,fe.byteOffset,fe.byteLength).getFloat64(ae,!0)},J.writeFloat32BE=function se(fe,ae,pe){return void 0===ae&&(ae=new Uint8Array(4)),void 0===pe&&(pe=0),new DataView(ae.buffer,ae.byteOffset,ae.byteLength).setFloat32(pe,fe),ae},J.writeFloat32LE=function ue(fe,ae,pe){return void 0===ae&&(ae=new Uint8Array(4)),void 0===pe&&(pe=0),new DataView(ae.buffer,ae.byteOffset,ae.byteLength).setFloat32(pe,fe,!0),ae},J.writeFloat64BE=function oe(fe,ae,pe){return void 0===ae&&(ae=new Uint8Array(8)),void 0===pe&&(pe=0),new DataView(ae.buffer,ae.byteOffset,ae.byteLength).setFloat64(pe,fe),ae},J.writeFloat64LE=function me(fe,ae,pe){return void 0===ae&&(ae=new Uint8Array(8)),void 0===pe&&(pe=0),new DataView(ae.buffer,ae.byteOffset,ae.byteLength).setFloat64(pe,fe,!0),ae}},47932:(re,J,p)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});var w=p(92186),d=p(60661);function I(y,_,A){for(var O=1634760805,x=857760878,g=2036477234,v=1797285236,R=A[3]<<24|A[2]<<16|A[1]<<8|A[0],N=A[7]<<24|A[6]<<16|A[5]<<8|A[4],D=A[11]<<24|A[10]<<16|A[9]<<8|A[8],k=A[15]<<24|A[14]<<16|A[13]<<8|A[12],j=A[19]<<24|A[18]<<16|A[17]<<8|A[16],Q=A[23]<<24|A[22]<<16|A[21]<<8|A[20],L=A[27]<<24|A[26]<<16|A[25]<<8|A[24],K=A[31]<<24|A[30]<<16|A[29]<<8|A[28],G=_[3]<<24|_[2]<<16|_[1]<<8|_[0],C=_[7]<<24|_[6]<<16|_[5]<<8|_[4],z=_[11]<<24|_[10]<<16|_[9]<<8|_[8],te=_[15]<<24|_[14]<<16|_[13]<<8|_[12],Z=O,se=x,ue=g,oe=v,me=R,fe=N,ae=D,pe=k,ce=j,_e=Q,de=L,ye=K,we=G,xe=C,Ae=z,Re=te,ve=0;ve<20;ve+=2)me=(me^=ce=ce+(we=(we^=Z=Z+me|0)>>>16|we<<16)|0)>>>20|me<<12,fe=(fe^=_e=_e+(xe=(xe^=se=se+fe|0)>>>16|xe<<16)|0)>>>20|fe<<12,ae=(ae^=de=de+(Ae=(Ae^=ue=ue+ae|0)>>>16|Ae<<16)|0)>>>20|ae<<12,pe=(pe^=ye=ye+(Re=(Re^=oe=oe+pe|0)>>>16|Re<<16)|0)>>>20|pe<<12,ae=(ae^=de=de+(Ae=(Ae^=ue=ue+ae|0)>>>24|Ae<<8)|0)>>>25|ae<<7,pe=(pe^=ye=ye+(Re=(Re^=oe=oe+pe|0)>>>24|Re<<8)|0)>>>25|pe<<7,fe=(fe^=_e=_e+(xe=(xe^=se=se+fe|0)>>>24|xe<<8)|0)>>>25|fe<<7,me=(me^=ce=ce+(we=(we^=Z=Z+me|0)>>>24|we<<8)|0)>>>25|me<<7,fe=(fe^=de=de+(Re=(Re^=Z=Z+fe|0)>>>16|Re<<16)|0)>>>20|fe<<12,ae=(ae^=ye=ye+(we=(we^=se=se+ae|0)>>>16|we<<16)|0)>>>20|ae<<12,pe=(pe^=ce=ce+(xe=(xe^=ue=ue+pe|0)>>>16|xe<<16)|0)>>>20|pe<<12,me=(me^=_e=_e+(Ae=(Ae^=oe=oe+me|0)>>>16|Ae<<16)|0)>>>20|me<<12,pe=(pe^=ce=ce+(xe=(xe^=ue=ue+pe|0)>>>24|xe<<8)|0)>>>25|pe<<7,me=(me^=_e=_e+(Ae=(Ae^=oe=oe+me|0)>>>24|Ae<<8)|0)>>>25|me<<7,ae=(ae^=ye=ye+(we=(we^=se=se+ae|0)>>>24|we<<8)|0)>>>25|ae<<7,fe=(fe^=de=de+(Re=(Re^=Z=Z+fe|0)>>>24|Re<<8)|0)>>>25|fe<<7;w.writeUint32LE(Z+O|0,y,0),w.writeUint32LE(se+x|0,y,4),w.writeUint32LE(ue+g|0,y,8),w.writeUint32LE(oe+v|0,y,12),w.writeUint32LE(me+R|0,y,16),w.writeUint32LE(fe+N|0,y,20),w.writeUint32LE(ae+D|0,y,24),w.writeUint32LE(pe+k|0,y,28),w.writeUint32LE(ce+j|0,y,32),w.writeUint32LE(_e+Q|0,y,36),w.writeUint32LE(de+L|0,y,40),w.writeUint32LE(ye+K|0,y,44),w.writeUint32LE(we+G|0,y,48),w.writeUint32LE(xe+C|0,y,52),w.writeUint32LE(Ae+z|0,y,56),w.writeUint32LE(Re+te|0,y,60)}function m(y,_,A,O,x){if(void 0===x&&(x=0),32!==y.length)throw new Error("ChaCha: key size must be 32 bytes");if(O.length<A.length)throw new Error("ChaCha: destination is shorter than source");var g,v;if(0===x){if(8!==_.length&&12!==_.length)throw new Error("ChaCha nonce must be 8 or 12 bytes");(g=new Uint8Array(16)).set(_,v=g.length-_.length)}else{if(16!==_.length)throw new Error("ChaCha nonce with counter must be 16 bytes");g=_,v=x}for(var R=new Uint8Array(64),N=0;N<A.length;N+=64){I(R,g,y);for(var D=N;D<N+64&&D<A.length;D++)O[D]=A[D]^R[D-N];h(g,0,v)}return d.wipe(R),0===x&&d.wipe(g),O}function h(y,_,A){for(var O=1;A--;)y[_]=255&(O=O+(255&y[_])|0),O>>>=8,_++;if(O>0)throw new Error("ChaCha: counter overflow")}J.streamXOR=m,J.stream=function l(y,_,A,O){return void 0===O&&(O=0),d.wipe(A),m(y,_,A,A,O)}},90250:(re,J,p)=>{"use strict";var d=p(47932),S=p(3142),I=p(60661),m=p(92186),l=p(39644);J.Cv=32,J.WH=12,J.pg=16;var h=new Uint8Array(16),y=function(){function _(A){if(this.nonceLength=J.WH,this.tagLength=J.pg,A.length!==J.Cv)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(A)}return _.prototype.seal=function(A,O,x,g){if(A.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var v=new Uint8Array(16);v.set(A,v.length-A.length);var R=new Uint8Array(32);d.stream(this._key,v,R,4);var D,N=O.length+this.tagLength;if(g){if(g.length!==N)throw new Error("ChaCha20Poly1305: incorrect destination length");D=g}else D=new Uint8Array(N);return d.streamXOR(this._key,v,O,D,4),this._authenticate(D.subarray(D.length-this.tagLength,D.length),R,D.subarray(0,D.length-this.tagLength),x),I.wipe(v),D},_.prototype.open=function(A,O,x,g){if(A.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(O.length<this.tagLength)return null;var v=new Uint8Array(16);v.set(A,v.length-A.length);var R=new Uint8Array(32);d.stream(this._key,v,R,4);var N=new Uint8Array(this.tagLength);if(this._authenticate(N,R,O.subarray(0,O.length-this.tagLength),x),!l.equal(N,O.subarray(O.length-this.tagLength,O.length)))return null;var k,D=O.length-this.tagLength;if(g){if(g.length!==D)throw new Error("ChaCha20Poly1305: incorrect destination length");k=g}else k=new Uint8Array(D);return d.streamXOR(this._key,v,O.subarray(0,O.length-this.tagLength),k,4),I.wipe(v),k},_.prototype.clean=function(){return I.wipe(this._key),this},_.prototype._authenticate=function(A,O,x,g){var v=new S.Poly1305(O);g&&(v.update(g),g.length%16>0&&v.update(h.subarray(g.length%16))),v.update(x),x.length%16>0&&v.update(h.subarray(x.length%16));var R=new Uint8Array(8);g&&m.writeUint64LE(g.length,R),v.update(R),m.writeUint64LE(x.length,R),v.update(R);for(var N=v.digest(),D=0;D<N.length;D++)A[D]=N[D];v.clean(),I.wipe(N),I.wipe(R)},_}();J.OK=y},39644:(re,J)=>{"use strict";function d(I,m){if(I.length!==m.length)return 0;for(var l=0,h=0;h<I.length;h++)l|=I[h]^m[h];return 1&l-1>>>8}Object.defineProperty(J,"__esModule",{value:!0}),J.select=function p(I,m,l){return~(I-1)&m|I-1&l},J.lessOrEqual=function w(I,m){return(0|I)-(0|m)-1>>>31&1},J.compare=d,J.equal=function S(I,m){return 0!==I.length&&0!==m.length&&0!==d(I,m)}},81550:(re,J)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.isSerializableHash=function p(w){return typeof w.saveState<"u"&&typeof w.restoreState<"u"&&typeof w.cleanSavedState<"u"}},87510:(re,J,p)=>{"use strict";var d=p(85893),S=p(60661),I=function(){function m(l,h,y,_){void 0===y&&(y=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=l,this._info=_;var A=d.hmac(this._hash,y,h);this._hmac=new d.HMAC(l,A),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return m.prototype._fillBuffer=function(){this._counter[0]++;var l=this._counter[0];if(0===l)throw new Error("hkdf: cannot expand more");this._hmac.reset(),l>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},m.prototype.expand=function(l){for(var h=new Uint8Array(l),y=0;y<h.length;y++)this._bufpos===this._buffer.length&&this._fillBuffer(),h[y]=this._buffer[this._bufpos++];return h},m.prototype.clean=function(){this._hmac.clean(),S.wipe(this._buffer),S.wipe(this._counter),this._bufpos=0},m}();J.t=I},85893:(re,J,p)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});var w=p(81550),d=p(39644),S=p(60661),I=function(){function l(h,y){this._finished=!1,this._inner=new h,this._outer=new h,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var _=new Uint8Array(this.blockSize);y.length>this.blockSize?this._inner.update(y).finish(_).clean():_.set(y);for(var A=0;A<_.length;A++)_[A]^=54;for(this._inner.update(_),A=0;A<_.length;A++)_[A]^=106;this._outer.update(_),w.isSerializableHash(this._inner)&&w.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),S.wipe(_)}return l.prototype.reset=function(){if(!w.isSerializableHash(this._inner)||!w.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},l.prototype.clean=function(){w.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),w.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},l.prototype.update=function(h){return this._inner.update(h),this},l.prototype.finish=function(h){return this._finished?(this._outer.finish(h),this):(this._inner.finish(h),this._outer.update(h.subarray(0,this.digestLength)).finish(h),this._finished=!0,this)},l.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},l.prototype.saveState=function(){if(!w.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},l.prototype.restoreState=function(h){if(!w.isSerializableHash(this._inner)||!w.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(h),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},l.prototype.cleanSavedState=function(h){if(!w.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(h)},l}();J.HMAC=I,J.hmac=function m(l,h,y){var _=new I(l,h);_.update(y);var A=_.digest();return _.clean(),A},J.equal=d.equal},30714:(re,J)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.mul=Math.imul||function p(l,h){var _=65535&l,O=65535&h;return _*O+((l>>>16&65535)*O+_*(h>>>16&65535)<<16>>>0)|0},J.add=function w(l,h){return l+h|0},J.sub=function d(l,h){return l-h|0},J.rotl=function S(l,h){return l<<h|l>>>32-h},J.rotr=function I(l,h){return l<<32-h|l>>>h},J.isInteger=Number.isInteger||function m(l){return"number"==typeof l&&isFinite(l)&&Math.floor(l)===l},J.MAX_SAFE_INTEGER=9007199254740991,J.isSafeInteger=function(l){return J.isInteger(l)&&l>=-J.MAX_SAFE_INTEGER&&l<=J.MAX_SAFE_INTEGER}},3142:(re,J,p)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});var w=p(39644),d=p(60661);J.DIGEST_LENGTH=16;var S=function(){function l(h){this.digestLength=J.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var y=h[0]|h[1]<<8;this._r[0]=8191&y;var _=h[2]|h[3]<<8;this._r[1]=8191&(y>>>13|_<<3);var A=h[4]|h[5]<<8;this._r[2]=7939&(_>>>10|A<<6);var O=h[6]|h[7]<<8;this._r[3]=8191&(A>>>7|O<<9);var x=h[8]|h[9]<<8;this._r[4]=255&(O>>>4|x<<12),this._r[5]=x>>>1&8190;var g=h[10]|h[11]<<8;this._r[6]=8191&(x>>>14|g<<2);var v=h[12]|h[13]<<8;this._r[7]=8065&(g>>>11|v<<5);var R=h[14]|h[15]<<8;this._r[8]=8191&(v>>>8|R<<8),this._r[9]=R>>>5&127,this._pad[0]=h[16]|h[17]<<8,this._pad[1]=h[18]|h[19]<<8,this._pad[2]=h[20]|h[21]<<8,this._pad[3]=h[22]|h[23]<<8,this._pad[4]=h[24]|h[25]<<8,this._pad[5]=h[26]|h[27]<<8,this._pad[6]=h[28]|h[29]<<8,this._pad[7]=h[30]|h[31]<<8}return l.prototype._blocks=function(h,y,_){for(var A=this._fin?0:2048,O=this._h[0],x=this._h[1],g=this._h[2],v=this._h[3],R=this._h[4],N=this._h[5],D=this._h[6],k=this._h[7],j=this._h[8],Q=this._h[9],L=this._r[0],K=this._r[1],G=this._r[2],C=this._r[3],z=this._r[4],te=this._r[5],Z=this._r[6],se=this._r[7],ue=this._r[8],oe=this._r[9];_>=16;){var me=h[y+0]|h[y+1]<<8,fe=h[y+2]|h[y+3]<<8,ae=h[y+4]|h[y+5]<<8,pe=h[y+6]|h[y+7]<<8,ce=h[y+8]|h[y+9]<<8,_e=h[y+10]|h[y+11]<<8,de=h[y+12]|h[y+13]<<8,ye=h[y+14]|h[y+15]<<8,we=0,xe=we;xe+=(O+=8191&me)*L,xe+=(x+=8191&(me>>>13|fe<<3))*(5*oe),xe+=(g+=8191&(fe>>>10|ae<<6))*(5*ue),xe+=(v+=8191&(ae>>>7|pe<<9))*(5*se),we=(xe+=(R+=8191&(pe>>>4|ce<<12))*(5*Z))>>>13,xe&=8191,xe+=(N+=ce>>>1&8191)*(5*te),xe+=(D+=8191&(ce>>>14|_e<<2))*(5*z),xe+=(k+=8191&(_e>>>11|de<<5))*(5*C),xe+=(j+=8191&(de>>>8|ye<<8))*(5*G);var Ae=we+=(xe+=(Q+=ye>>>5|A)*(5*K))>>>13;Ae+=O*K,Ae+=x*L,Ae+=g*(5*oe),Ae+=v*(5*ue),we=(Ae+=R*(5*se))>>>13,Ae&=8191,Ae+=N*(5*Z),Ae+=D*(5*te),Ae+=k*(5*z),Ae+=j*(5*C),we+=(Ae+=Q*(5*G))>>>13,Ae&=8191;var Re=we;Re+=O*G,Re+=x*K,Re+=g*L,Re+=v*(5*oe),we=(Re+=R*(5*ue))>>>13,Re&=8191,Re+=N*(5*se),Re+=D*(5*Z),Re+=k*(5*te),Re+=j*(5*z);var ve=we+=(Re+=Q*(5*C))>>>13;ve+=O*C,ve+=x*G,ve+=g*K,ve+=v*L,we=(ve+=R*(5*oe))>>>13,ve&=8191,ve+=N*(5*ue),ve+=D*(5*se),ve+=k*(5*Z),ve+=j*(5*te);var Oe=we+=(ve+=Q*(5*z))>>>13;Oe+=O*z,Oe+=x*C,Oe+=g*G,Oe+=v*K,we=(Oe+=R*L)>>>13,Oe&=8191,Oe+=N*(5*oe),Oe+=D*(5*ue),Oe+=k*(5*se),Oe+=j*(5*Z);var Ve=we+=(Oe+=Q*(5*te))>>>13;Ve+=O*te,Ve+=x*z,Ve+=g*C,Ve+=v*G,we=(Ve+=R*K)>>>13,Ve&=8191,Ve+=N*L,Ve+=D*(5*oe),Ve+=k*(5*ue),Ve+=j*(5*se);var Ue=we+=(Ve+=Q*(5*Z))>>>13;Ue+=O*Z,Ue+=x*te,Ue+=g*z,Ue+=v*C,we=(Ue+=R*G)>>>13,Ue&=8191,Ue+=N*K,Ue+=D*L,Ue+=k*(5*oe),Ue+=j*(5*ue);var je=we+=(Ue+=Q*(5*se))>>>13;je+=O*se,je+=x*Z,je+=g*te,je+=v*z,we=(je+=R*C)>>>13,je&=8191,je+=N*G,je+=D*K,je+=k*L,je+=j*(5*oe);var Ke=we+=(je+=Q*(5*ue))>>>13;Ke+=O*ue,Ke+=x*se,Ke+=g*Z,Ke+=v*te,we=(Ke+=R*z)>>>13,Ke&=8191,Ke+=N*C,Ke+=D*G,Ke+=k*K,Ke+=j*L;var nt=we+=(Ke+=Q*(5*oe))>>>13;nt+=O*oe,nt+=x*ue,nt+=g*se,nt+=v*Z,we=(nt+=R*te)>>>13,nt&=8191,nt+=N*z,nt+=D*C,nt+=k*G,nt+=j*K,O=xe=8191&(we=(we=((we+=(nt+=Q*L)>>>13)<<2)+we|0)+(xe&=8191)|0),x=Ae+=we>>>=13,g=Re&=8191,v=ve&=8191,R=Oe&=8191,N=Ve&=8191,D=Ue&=8191,k=je&=8191,j=Ke&=8191,Q=nt&=8191,y+=16,_-=16}this._h[0]=O,this._h[1]=x,this._h[2]=g,this._h[3]=v,this._h[4]=R,this._h[5]=N,this._h[6]=D,this._h[7]=k,this._h[8]=j,this._h[9]=Q},l.prototype.finish=function(h,y){void 0===y&&(y=0);var A,O,x,g,_=new Uint16Array(10);if(this._leftover){for(g=this._leftover,this._buffer[g++]=1;g<16;g++)this._buffer[g]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(A=this._h[1]>>>13,this._h[1]&=8191,g=2;g<10;g++)this._h[g]+=A,A=this._h[g]>>>13,this._h[g]&=8191;for(this._h[0]+=5*A,A=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=A,A=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=A,_[0]=this._h[0]+5,A=_[0]>>>13,_[0]&=8191,g=1;g<10;g++)_[g]=this._h[g]+A,A=_[g]>>>13,_[g]&=8191;for(_[9]-=8192,O=(1^A)-1,g=0;g<10;g++)_[g]&=O;for(O=~O,g=0;g<10;g++)this._h[g]=this._h[g]&O|_[g];for(this._h[0]=65535&(this._h[0]|this._h[1]<<13),this._h[1]=65535&(this._h[1]>>>3|this._h[2]<<10),this._h[2]=65535&(this._h[2]>>>6|this._h[3]<<7),this._h[3]=65535&(this._h[3]>>>9|this._h[4]<<4),this._h[4]=65535&(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14),this._h[5]=65535&(this._h[6]>>>2|this._h[7]<<11),this._h[6]=65535&(this._h[7]>>>5|this._h[8]<<8),this._h[7]=65535&(this._h[8]>>>8|this._h[9]<<5),this._h[0]=65535&(x=this._h[0]+this._pad[0]),g=1;g<8;g++)this._h[g]=65535&(x=(this._h[g]+this._pad[g]|0)+(x>>>16)|0);return h[y+0]=this._h[0]>>>0,h[y+1]=this._h[0]>>>8,h[y+2]=this._h[1]>>>0,h[y+3]=this._h[1]>>>8,h[y+4]=this._h[2]>>>0,h[y+5]=this._h[2]>>>8,h[y+6]=this._h[3]>>>0,h[y+7]=this._h[3]>>>8,h[y+8]=this._h[4]>>>0,h[y+9]=this._h[4]>>>8,h[y+10]=this._h[5]>>>0,h[y+11]=this._h[5]>>>8,h[y+12]=this._h[6]>>>0,h[y+13]=this._h[6]>>>8,h[y+14]=this._h[7]>>>0,h[y+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(h){var A,y=0,_=h.length;if(this._leftover){(A=16-this._leftover)>_&&(A=_);for(var O=0;O<A;O++)this._buffer[this._leftover+O]=h[y+O];if(_-=A,y+=A,this._leftover+=A,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(_>=16&&(this._blocks(h,y,A=_-_%16),y+=A,_-=A),_){for(O=0;O<_;O++)this._buffer[this._leftover+O]=h[y+O];this._leftover+=_}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var h=new Uint8Array(16);return this.finish(h),h},l.prototype.clean=function(){return d.wipe(this._buffer),d.wipe(this._r),d.wipe(this._h),d.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();J.Poly1305=S,J.oneTimeAuth=function I(l,h){var y=new S(l);y.update(h);var _=y.digest();return y.clean(),_},J.equal=function m(l,h){return l.length===J.DIGEST_LENGTH&&h.length===J.DIGEST_LENGTH&&w.equal(l,h)}},57799:(re,J,p)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.randomStringForEntropy=J.randomString=J.randomUint32=J.randomBytes=J.defaultRandomSource=void 0;const w=p(89023),d=p(92186),S=p(60661);function I(_,A=J.defaultRandomSource){return A.randomBytes(_)}J.defaultRandomSource=new w.SystemRandomSource,J.randomBytes=I,J.randomUint32=function m(_=J.defaultRandomSource){const A=I(4,_),O=(0,d.readUint32LE)(A);return(0,S.wipe)(A),O};const l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function h(_,A=l,O=J.defaultRandomSource){if(A.length<2)throw new Error("randomString charset is too short");if(A.length>256)throw new Error("randomString charset is too long");let x="";const g=A.length,v=256-256%g;for(;_>0;){const R=I(Math.ceil(256*_/v),O);for(let N=0;N<R.length&&_>0;N++){const D=R[N];D<v&&(x+=A.charAt(D%g),_--)}(0,S.wipe)(R)}return x}J.randomString=h,J.randomStringForEntropy=function y(_,A=l,O=J.defaultRandomSource){return h(Math.ceil(_/(Math.log(A.length)/Math.LN2)),A,O)}},93040:(re,J)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.BrowserRandomSource=void 0,J.BrowserRandomSource=class w{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const S=typeof self<"u"?self.crypto||self.msCrypto:null;S&&void 0!==S.getRandomValues&&(this._crypto=S,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(S){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const I=new Uint8Array(S);for(let m=0;m<I.length;m+=65536)this._crypto.getRandomValues(I.subarray(m,m+Math.min(I.length-m,65536)));return I}}},66203:(re,J,p)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.NodeRandomSource=void 0;const w=p(60661);J.NodeRandomSource=class d{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{const I=p(35883);I&&I.randomBytes&&(this._crypto=I,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(I){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let m=this._crypto.randomBytes(I);if(m.length!==I)throw new Error("NodeRandomSource: got fewer bytes than requested");const l=new Uint8Array(I);for(let h=0;h<l.length;h++)l[h]=m[h];return(0,w.wipe)(m),l}}},89023:(re,J,p)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.SystemRandomSource=void 0;const w=p(93040),d=p(66203);J.SystemRandomSource=class S{constructor(){return this.isAvailable=!1,this.name="",this._source=new w.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new d.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}randomBytes(m){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(m)}}},41122:(re,J,p)=>{"use strict";var d=p(92186),S=p(60661);J.k=32,J.cn=64;var I=function(){function y(){this.digestLength=J.k,this.blockSize=J.cn,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return y.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},y.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},y.prototype.clean=function(){S.wipe(this._buffer),S.wipe(this._temp),this.reset()},y.prototype.update=function(_,A){if(void 0===A&&(A=_.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var O=0;if(this._bytesHashed+=A,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&A>0;)this._buffer[this._bufferLength++]=_[O++],A--;this._bufferLength===this.blockSize&&(l(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(A>=this.blockSize&&(O=l(this._temp,this._state,_,O,A),A%=this.blockSize);A>0;)this._buffer[this._bufferLength++]=_[O++],A--;return this},y.prototype.finish=function(_){if(!this._finished){var A=this._bytesHashed,O=this._bufferLength,x=A/536870912|0,g=A<<3,v=A%64<56?64:128;this._buffer[O]=128;for(var R=O+1;R<v-8;R++)this._buffer[R]=0;d.writeUint32BE(x,this._buffer,v-8),d.writeUint32BE(g,this._buffer,v-4),l(this._temp,this._state,this._buffer,0,v),this._finished=!0}for(R=0;R<this.digestLength/4;R++)d.writeUint32BE(this._state[R],_,4*R);return this},y.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},y.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},y.prototype.restoreState=function(_){return this._state.set(_.state),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},y.prototype.cleanSavedState=function(_){S.wipe(_.state),_.buffer&&S.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},y}();J.mE=I;var m=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function l(y,_,A,O,x){for(;x>=64;){for(var g=_[0],v=_[1],R=_[2],N=_[3],D=_[4],k=_[5],j=_[6],Q=_[7],L=0;L<16;L++)y[L]=d.readUint32BE(A,O+4*L);for(L=16;L<64;L++){var G=y[L-2];y[L]=((C=(G>>>17|G<<15)^(G>>>19|G<<13)^G>>>10)+y[L-7]|0)+((z=((G=y[L-15])>>>7|G<<25)^(G>>>18|G<<14)^G>>>3)+y[L-16]|0)}for(L=0;L<64;L++){var C=(((D>>>6|D<<26)^(D>>>11|D<<21)^(D>>>25|D<<7))+(D&k^~D&j)|0)+(Q+(m[L]+y[L]|0)|0)|0,z=((g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10))+(g&v^g&R^v&R)|0;Q=j,j=k,k=D,D=N+C|0,N=R,R=v,v=g,g=C+z|0}_[0]+=g,_[1]+=v,_[2]+=R,_[3]+=N,_[4]+=D,_[5]+=k,_[6]+=j,_[7]+=Q,O+=64,x-=64}return O}J.vp=function h(y){var _=new I;_.update(y);var A=_.digest();return _.clean(),A}},60661:(re,J)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.wipe=function p(w){for(var d=0;d<w.length;d++)w[d]=0;return w}},43747:(re,J,p)=>{"use strict";J.gi=J.Au=J._w=J.KS=J.kz=void 0;const d=p(57799),S=p(60661);function I(L){const K=new Float64Array(16);if(L)for(let G=0;G<L.length;G++)K[G]=L[G];return K}J.kz=32,J.KS=32;const m=new Uint8Array(32);m[0]=9;const l=I([56129,1]);function h(L){let K=1;for(let G=0;G<16;G++){let C=L[G]+K+65535;K=Math.floor(C/65536),L[G]=C-65536*K}L[0]+=K-1+37*(K-1)}function y(L,K,G){const C=~(G-1);for(let z=0;z<16;z++){const te=C&(L[z]^K[z]);L[z]^=te,K[z]^=te}}function O(L,K,G){for(let C=0;C<16;C++)L[C]=K[C]+G[C]}function x(L,K,G){for(let C=0;C<16;C++)L[C]=K[C]-G[C]}function g(L,K,G){let C,z,te=0,Z=0,se=0,ue=0,oe=0,me=0,fe=0,ae=0,pe=0,ce=0,_e=0,de=0,ye=0,we=0,xe=0,Ae=0,Re=0,ve=0,Oe=0,Ve=0,Ue=0,je=0,Ke=0,nt=0,dt=0,pt=0,Xt=0,Ft=0,Ht=0,Kt=0,xr=0,Zt=G[0],qt=G[1],lr=G[2],hr=G[3],pr=G[4],Dt=G[5],Tt=G[6],yr=G[7],Ye=G[8],tt=G[9],st=G[10],ot=G[11],ht=G[12],St=G[13],zt=G[14],er=G[15];C=K[0],te+=C*Zt,Z+=C*qt,se+=C*lr,ue+=C*hr,oe+=C*pr,me+=C*Dt,fe+=C*Tt,ae+=C*yr,pe+=C*Ye,ce+=C*tt,_e+=C*st,de+=C*ot,ye+=C*ht,we+=C*St,xe+=C*zt,Ae+=C*er,C=K[1],Z+=C*Zt,se+=C*qt,ue+=C*lr,oe+=C*hr,me+=C*pr,fe+=C*Dt,ae+=C*Tt,pe+=C*yr,ce+=C*Ye,_e+=C*tt,de+=C*st,ye+=C*ot,we+=C*ht,xe+=C*St,Ae+=C*zt,Re+=C*er,C=K[2],se+=C*Zt,ue+=C*qt,oe+=C*lr,me+=C*hr,fe+=C*pr,ae+=C*Dt,pe+=C*Tt,ce+=C*yr,_e+=C*Ye,de+=C*tt,ye+=C*st,we+=C*ot,xe+=C*ht,Ae+=C*St,Re+=C*zt,ve+=C*er,C=K[3],ue+=C*Zt,oe+=C*qt,me+=C*lr,fe+=C*hr,ae+=C*pr,pe+=C*Dt,ce+=C*Tt,_e+=C*yr,de+=C*Ye,ye+=C*tt,we+=C*st,xe+=C*ot,Ae+=C*ht,Re+=C*St,ve+=C*zt,Oe+=C*er,C=K[4],oe+=C*Zt,me+=C*qt,fe+=C*lr,ae+=C*hr,pe+=C*pr,ce+=C*Dt,_e+=C*Tt,de+=C*yr,ye+=C*Ye,we+=C*tt,xe+=C*st,Ae+=C*ot,Re+=C*ht,ve+=C*St,Oe+=C*zt,Ve+=C*er,C=K[5],me+=C*Zt,fe+=C*qt,ae+=C*lr,pe+=C*hr,ce+=C*pr,_e+=C*Dt,de+=C*Tt,ye+=C*yr,we+=C*Ye,xe+=C*tt,Ae+=C*st,Re+=C*ot,ve+=C*ht,Oe+=C*St,Ve+=C*zt,Ue+=C*er,C=K[6],fe+=C*Zt,ae+=C*qt,pe+=C*lr,ce+=C*hr,_e+=C*pr,de+=C*Dt,ye+=C*Tt,we+=C*yr,xe+=C*Ye,Ae+=C*tt,Re+=C*st,ve+=C*ot,Oe+=C*ht,Ve+=C*St,Ue+=C*zt,je+=C*er,C=K[7],ae+=C*Zt,pe+=C*qt,ce+=C*lr,_e+=C*hr,de+=C*pr,ye+=C*Dt,we+=C*Tt,xe+=C*yr,Ae+=C*Ye,Re+=C*tt,ve+=C*st,Oe+=C*ot,Ve+=C*ht,Ue+=C*St,je+=C*zt,Ke+=C*er,C=K[8],pe+=C*Zt,ce+=C*qt,_e+=C*lr,de+=C*hr,ye+=C*pr,we+=C*Dt,xe+=C*Tt,Ae+=C*yr,Re+=C*Ye,ve+=C*tt,Oe+=C*st,Ve+=C*ot,Ue+=C*ht,je+=C*St,Ke+=C*zt,nt+=C*er,C=K[9],ce+=C*Zt,_e+=C*qt,de+=C*lr,ye+=C*hr,we+=C*pr,xe+=C*Dt,Ae+=C*Tt,Re+=C*yr,ve+=C*Ye,Oe+=C*tt,Ve+=C*st,Ue+=C*ot,je+=C*ht,Ke+=C*St,nt+=C*zt,dt+=C*er,C=K[10],_e+=C*Zt,de+=C*qt,ye+=C*lr,we+=C*hr,xe+=C*pr,Ae+=C*Dt,Re+=C*Tt,ve+=C*yr,Oe+=C*Ye,Ve+=C*tt,Ue+=C*st,je+=C*ot,Ke+=C*ht,nt+=C*St,dt+=C*zt,pt+=C*er,C=K[11],de+=C*Zt,ye+=C*qt,we+=C*lr,xe+=C*hr,Ae+=C*pr,Re+=C*Dt,ve+=C*Tt,Oe+=C*yr,Ve+=C*Ye,Ue+=C*tt,je+=C*st,Ke+=C*ot,nt+=C*ht,dt+=C*St,pt+=C*zt,Xt+=C*er,C=K[12],ye+=C*Zt,we+=C*qt,xe+=C*lr,Ae+=C*hr,Re+=C*pr,ve+=C*Dt,Oe+=C*Tt,Ve+=C*yr,Ue+=C*Ye,je+=C*tt,Ke+=C*st,nt+=C*ot,dt+=C*ht,pt+=C*St,Xt+=C*zt,Ft+=C*er,C=K[13],we+=C*Zt,xe+=C*qt,Ae+=C*lr,Re+=C*hr,ve+=C*pr,Oe+=C*Dt,Ve+=C*Tt,Ue+=C*yr,je+=C*Ye,Ke+=C*tt,nt+=C*st,dt+=C*ot,pt+=C*ht,Xt+=C*St,Ft+=C*zt,Ht+=C*er,C=K[14],xe+=C*Zt,Ae+=C*qt,Re+=C*lr,ve+=C*hr,Oe+=C*pr,Ve+=C*Dt,Ue+=C*Tt,je+=C*yr,Ke+=C*Ye,nt+=C*tt,dt+=C*st,pt+=C*ot,Xt+=C*ht,Ft+=C*St,Ht+=C*zt,Kt+=C*er,C=K[15],Ae+=C*Zt,Re+=C*qt,ve+=C*lr,Oe+=C*hr,Ve+=C*pr,Ue+=C*Dt,je+=C*Tt,Ke+=C*yr,nt+=C*Ye,dt+=C*tt,pt+=C*st,Xt+=C*ot,Ft+=C*ht,Ht+=C*St,Kt+=C*zt,xr+=C*er,te+=38*Re,Z+=38*ve,se+=38*Oe,ue+=38*Ve,oe+=38*Ue,me+=38*je,fe+=38*Ke,ae+=38*nt,pe+=38*dt,ce+=38*pt,_e+=38*Xt,de+=38*Ft,ye+=38*Ht,we+=38*Kt,xe+=38*xr,z=1,C=te+z+65535,z=Math.floor(C/65536),te=C-65536*z,C=Z+z+65535,z=Math.floor(C/65536),Z=C-65536*z,C=se+z+65535,z=Math.floor(C/65536),se=C-65536*z,C=ue+z+65535,z=Math.floor(C/65536),ue=C-65536*z,C=oe+z+65535,z=Math.floor(C/65536),oe=C-65536*z,C=me+z+65535,z=Math.floor(C/65536),me=C-65536*z,C=fe+z+65535,z=Math.floor(C/65536),fe=C-65536*z,C=ae+z+65535,z=Math.floor(C/65536),ae=C-65536*z,C=pe+z+65535,z=Math.floor(C/65536),pe=C-65536*z,C=ce+z+65535,z=Math.floor(C/65536),ce=C-65536*z,C=_e+z+65535,z=Math.floor(C/65536),_e=C-65536*z,C=de+z+65535,z=Math.floor(C/65536),de=C-65536*z,C=ye+z+65535,z=Math.floor(C/65536),ye=C-65536*z,C=we+z+65535,z=Math.floor(C/65536),we=C-65536*z,C=xe+z+65535,z=Math.floor(C/65536),xe=C-65536*z,C=Ae+z+65535,z=Math.floor(C/65536),Ae=C-65536*z,te+=z-1+37*(z-1),z=1,C=te+z+65535,z=Math.floor(C/65536),te=C-65536*z,C=Z+z+65535,z=Math.floor(C/65536),Z=C-65536*z,C=se+z+65535,z=Math.floor(C/65536),se=C-65536*z,C=ue+z+65535,z=Math.floor(C/65536),ue=C-65536*z,C=oe+z+65535,z=Math.floor(C/65536),oe=C-65536*z,C=me+z+65535,z=Math.floor(C/65536),me=C-65536*z,C=fe+z+65535,z=Math.floor(C/65536),fe=C-65536*z,C=ae+z+65535,z=Math.floor(C/65536),ae=C-65536*z,C=pe+z+65535,z=Math.floor(C/65536),pe=C-65536*z,C=ce+z+65535,z=Math.floor(C/65536),ce=C-65536*z,C=_e+z+65535,z=Math.floor(C/65536),_e=C-65536*z,C=de+z+65535,z=Math.floor(C/65536),de=C-65536*z,C=ye+z+65535,z=Math.floor(C/65536),ye=C-65536*z,C=we+z+65535,z=Math.floor(C/65536),we=C-65536*z,C=xe+z+65535,z=Math.floor(C/65536),xe=C-65536*z,C=Ae+z+65535,z=Math.floor(C/65536),Ae=C-65536*z,te+=z-1+37*(z-1),L[0]=te,L[1]=Z,L[2]=se,L[3]=ue,L[4]=oe,L[5]=me,L[6]=fe,L[7]=ae,L[8]=pe,L[9]=ce,L[10]=_e,L[11]=de,L[12]=ye,L[13]=we,L[14]=xe,L[15]=Ae}function v(L,K){g(L,K,K)}function N(L,K){const G=new Uint8Array(32),C=new Float64Array(80),z=I(),te=I(),Z=I(),se=I(),ue=I(),oe=I();for(let pe=0;pe<31;pe++)G[pe]=L[pe];G[31]=127&L[31]|64,G[0]&=248,function A(L,K){for(let G=0;G<16;G++)L[G]=K[2*G]+(K[2*G+1]<<8);L[15]&=32767}(C,K);for(let pe=0;pe<16;pe++)te[pe]=C[pe];z[0]=se[0]=1;for(let pe=254;pe>=0;--pe){const ce=G[pe>>>3]>>>(7&pe)&1;y(z,te,ce),y(Z,se,ce),O(ue,z,Z),x(z,z,Z),O(Z,te,se),x(te,te,se),v(se,ue),v(oe,z),g(z,Z,z),g(Z,te,ue),O(ue,z,Z),x(z,z,Z),v(te,z),x(Z,se,oe),g(z,Z,l),O(z,z,se),g(Z,Z,z),g(z,se,oe),g(se,te,C),v(te,ue),y(z,te,ce),y(Z,se,ce)}for(let pe=0;pe<16;pe++)C[pe+16]=z[pe],C[pe+32]=Z[pe],C[pe+48]=te[pe],C[pe+64]=se[pe];const me=C.subarray(32),fe=C.subarray(16);(function R(L,K){const G=I();for(let C=0;C<16;C++)G[C]=K[C];for(let C=253;C>=0;C--)v(G,G),2!==C&&4!==C&&g(G,G,K);for(let C=0;C<16;C++)L[C]=G[C]})(me,me),g(fe,fe,me);const ae=new Uint8Array(32);return function _(L,K){const G=I(),C=I();for(let z=0;z<16;z++)C[z]=K[z];h(C),h(C),h(C);for(let z=0;z<2;z++){G[0]=C[0]-65517;for(let Z=1;Z<15;Z++)G[Z]=C[Z]-65535-(G[Z-1]>>16&1),G[Z-1]&=65535;G[15]=C[15]-32767-(G[14]>>16&1);const te=G[15]>>16&1;G[14]&=65535,y(C,G,1-te)}for(let z=0;z<16;z++)L[2*z]=255&C[z],L[2*z+1]=C[z]>>8}(ae,fe),ae}function D(L){return N(L,m)}function k(L){if(L.length!==J.KS)throw new Error(`x25519: seed must be ${J.KS} bytes`);const K=new Uint8Array(L);return{publicKey:D(K),secretKey:K}}J._w=k,J.Au=function j(L){const K=(0,d.randomBytes)(32,L),G=k(K);return(0,S.wipe)(K),G},J.gi=function Q(L,K,G=!1){if(L.length!==J.kz)throw new Error("X25519: incorrect secret key length");if(K.length!==J.kz)throw new Error("X25519: incorrect public key length");const C=N(L,K);if(G){let z=0;for(let te=0;te<C.length;te++)z|=C[te];if(0===z)throw new Error("X25519: invalid shared key")}return C}},48568:(re,J)=>{"use strict";const p=Math.exp;re.exports=function(d){if("number"!=typeof d)throw new Error("must provide a timespan to the moving average constructor");if(d<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let S,h,I=0,m=0,l=0,y={push:function(O,x){if(h){const g=function _(A,O){return 1-p(-(A-O)/d)}(O,h),v=x-S;S=g*x+(1-g)*S,I=(1-g)*(I+v*(g*v)),m=Math.sqrt(I),l=S+g*v}else S=x;h=O},movingAverage:function(){return S},variance:function(){return I},deviation:function(){return m},forecast:function(){return l}};return y}},54805:(re,J,p)=>{"use strict";const{fromCallback:w}=p(49989),d=p(67004),{getCallback:S,getOptions:I}=p(86653),m=Symbol("promise"),l=Symbol("status"),h=Symbol("operations"),y=Symbol("finishClose"),_=Symbol("closeCallbacks");J.AbstractChainedBatch=class A{constructor(x){if("object"!=typeof x||null===x)throw new TypeError("The first argument must be an abstract-level database, received "+(null===x?"null":typeof x));this[h]=[],this[_]=[],this[l]="open",this[y]=this[y].bind(this),this.db=x,this.db.attachResource(this),this.nextTick=x.nextTick}get length(){return this[h].length}put(x,g,v){if("open"!==this[l])throw new d("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const R=this.db._checkKey(x)||this.db._checkValue(g);if(R)throw R;const N=v&&null!=v.sublevel?v.sublevel:this.db,D=v,k=N.keyEncoding(v&&v.keyEncoding),j=N.valueEncoding(v&&v.valueEncoding),Q=k.format;v={...v,keyEncoding:Q,valueEncoding:j.format},N!==this.db&&(v.sublevel=null);const L=N.prefixKey(k.encode(x),Q),K=j.encode(g);return this._put(L,K,v),this[h].push({...D,type:"put",key:x,value:g}),this}_put(x,g,v){}del(x,g){if("open"!==this[l])throw new d("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const v=this.db._checkKey(x);if(v)throw v;const R=g&&null!=g.sublevel?g.sublevel:this.db,N=g,D=R.keyEncoding(g&&g.keyEncoding),k=D.format;return g={...g,keyEncoding:k},R!==this.db&&(g.sublevel=null),this._del(R.prefixKey(D.encode(x),k),g),this[h].push({...N,type:"del",key:x}),this}_del(x,g){}clear(){if("open"!==this[l])throw new d("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[h]=[],this}_clear(){}write(x,g){return g=S(x,g),g=w(g,m),x=I(x),"open"!==this[l]?this.nextTick(g,new d("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):0===this.length?this.close(g):(this[l]="writing",this._write(x,v=>{this[l]="closing",this[_].push(()=>g(v)),v||this.db.emit("batch",this[h]),this._close(this[y])})),g[m]}_write(x,g){}close(x){return x=w(x,m),"closing"===this[l]?this[_].push(x):"closed"===this[l]?this.nextTick(x):(this[_].push(x),"writing"!==this[l]&&(this[l]="closing",this._close(this[y]))),x[m]}_close(x){this.nextTick(x)}[y](){this[l]="closed",this.db.detachResource(this);const x=this[_];this[_]=[];for(const g of x)g()}}},57074:(re,J,p)=>{"use strict";var w=p(28069),d=p(14997).default,S=p(73671).default;const{fromCallback:I}=p(49989),m=p(67004),{getOptions:l,getCallback:h}=p(86653),y=Symbol("promise"),_=Symbol("callback"),A=Symbol("working"),O=Symbol("handleOne"),x=Symbol("handleMany"),g=Symbol("autoClose"),v=Symbol("finishWork"),R=Symbol("returnMany"),N=Symbol("closing"),D=Symbol("handleClose"),k=Symbol("closed"),j=Symbol("closeCallbacks"),Q=Symbol("keyEncoding"),L=Symbol("valueEncoding"),K=Symbol("abortOnClose"),G=Symbol("legacy"),C=Symbol("keys"),z=Symbol("values"),te=Symbol("limit"),Z=Symbol("count"),se=Object.freeze({}),ue=()=>{};let oe=!1;class me{constructor(de,ye,we){if("object"!=typeof de||null===de)throw new TypeError("The first argument must be an abstract-level database, received "+(null===de?"null":typeof de));if("object"!=typeof ye||null===ye)throw new TypeError("The second argument must be an options object");this[k]=!1,this[j]=[],this[A]=!1,this[N]=!1,this[g]=!1,this[_]=null,this[O]=this[O].bind(this),this[x]=this[x].bind(this),this[D]=this[D].bind(this),this[Q]=ye[Q],this[L]=ye[L],this[G]=we,this[te]=Number.isInteger(ye.limit)&&ye.limit>=0?ye.limit:1/0,this[Z]=0,this[K]=!!ye.abortOnClose,this.db=de,this.db.attachResource(this),this.nextTick=de.nextTick}get count(){return this[Z]}get limit(){return this[te]}next(de){let ye;if(void 0===de)ye=new Promise((we,xe)=>{de=(Ae,Re,ve)=>{Ae?xe(Ae):this[G]?void 0===Re&&void 0===ve?we():we([Re,ve]):we(Re)}});else if("function"!=typeof de)throw new TypeError("Callback must be a function");return this[N]?this.nextTick(de,new m("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[A]?this.nextTick(de,new m("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[A]=!0,this[_]=de,this[Z]>=this[te]?this.nextTick(this[O],null):this._next(this[O])),ye}_next(de){this.nextTick(de)}nextv(de,ye,we){return we=h(ye,we),we=I(we,y),ye=l(ye,se),Number.isInteger(de)?(this[N]?this.nextTick(we,new m("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[A]?this.nextTick(we,new m("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(de<1&&(de=1),this[te]<1/0&&(de=Math.min(de,this[te]-this[Z])),this[A]=!0,this[_]=we,de<=0?this.nextTick(this[x],null,[]):this._nextv(de,ye,this[x])),we[y]):(this.nextTick(we,new TypeError("The first argument 'size' must be an integer")),we[y])}_nextv(de,ye,we){const xe=[],Ae=(Re,ve,Oe)=>Re?we(Re):(this[G]?void 0===ve&&void 0===Oe:void 0===ve)?we(null,xe):(xe.push(this[G]?[ve,Oe]:ve),void(xe.length===de?we(null,xe):this._next(Ae)));this._next(Ae)}all(de,ye){return ye=h(de,ye),ye=I(ye,y),de=l(de,se),this[N]?this.nextTick(ye,new m("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[A]?this.nextTick(ye,new m("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[A]=!0,this[_]=ye,this[g]=!0,this[Z]>=this[te]?this.nextTick(this[x],null,[]):this._all(de,this[x])),ye[y]}_all(de,ye){let we=this[Z];const xe=[],Ae=()=>{const ve=this[te]<1/0?Math.min(1e3,this[te]-we):1e3;ve<=0?this.nextTick(ye,null,xe):this._nextv(ve,se,Re)},Re=(ve,Oe)=>{ve?ye(ve):0===Oe.length?ye(null,xe):(xe.push.apply(xe,Oe),we+=Oe.length,Ae())};Ae()}[v](){const de=this[_];return this[K]&&null===de?ue:(this[A]=!1,this[_]=null,this[N]&&this._close(this[D]),de)}[R](de,ye,we){this[g]?this.close(de.bind(null,ye,we)):de(ye,we)}seek(de,ye){if(ye=l(ye,se),!this[N]){if(this[A])throw new m("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const we=this.db.keyEncoding(ye.keyEncoding||this[Q]),xe=we.format;ye.keyEncoding!==xe&&(ye={...ye,keyEncoding:xe});const Ae=this.db.prefixKey(we.encode(de),xe);this._seek(Ae,ye)}}}_seek(de,ye){throw new m("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(de){return de=I(de,y),this[k]?this.nextTick(de):this[N]?this[j].push(de):(this[N]=!0,this[j].push(de),this[A]?this[K]&&this[v]()(new m("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[D])),de[y]}_close(de){this.nextTick(de)}[D](){this[k]=!0,this.db.detachResource(this);const de=this[j];this[j]=[];for(const ye of de)ye()}[Symbol.asyncIterator](){var de=this;return S(function*(){try{let ye;for(;void 0!==(ye=yield d(de.next()));)yield ye}finally{de[k]||(yield d(de.close()))}})()}}class fe extends me{constructor(de,ye){super(de,ye,!0),this[C]=!1!==ye.keys,this[z]=!1!==ye.values}[O](de,ye,we){const xe=this[v]();if(de)return xe(de);try{ye=this[C]&&void 0!==ye?this[Q].decode(ye):void 0,we=this[z]&&void 0!==we?this[L].decode(we):void 0}catch(Ae){return xe(new ce("entry",Ae))}void 0===ye&&void 0===we||this[Z]++,xe(null,ye,we)}[x](de,ye){const we=this[v]();if(de)return this[R](we,de);try{for(const xe of ye){const Ae=xe[0],Re=xe[1];xe[0]=this[C]&&void 0!==Ae?this[Q].decode(Ae):void 0,xe[1]=this[z]&&void 0!==Re?this[L].decode(Re):void 0}}catch(xe){return this[R](we,new ce("entries",xe))}this[Z]+=ye.length,this[R](we,null,ye)}end(de){return!oe&&typeof w<"u"&&(oe=!0,w.warn(new m("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(de)}}class ce extends m{constructor(de,ye){super(`Iterator could not decode ${de}`,{code:"LEVEL_DECODE_ERROR",cause:ye})}}for(const _e of["_ended property","_nexting property","_end method"])Object.defineProperty(fe.prototype,_e.split(" ")[0],{get(){throw new m(`The ${_e} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new m(`The ${_e} has been removed`,{code:"LEVEL_LEGACY"})}});fe.keyEncoding=Q,fe.valueEncoding=L,J.AbstractIterator=fe,J.AbstractKeyIterator=class ae extends me{constructor(de,ye){super(de,ye,!1)}[O](de,ye){const we=this[v]();if(de)return we(de);try{ye=void 0!==ye?this[Q].decode(ye):void 0}catch(xe){return we(new ce("key",xe))}void 0!==ye&&this[Z]++,we(null,ye)}[x](de,ye){const we=this[v]();if(de)return this[R](we,de);try{for(let xe=0;xe<ye.length;xe++){const Ae=ye[xe];ye[xe]=void 0!==Ae?this[Q].decode(Ae):void 0}}catch(xe){return this[R](we,new ce("keys",xe))}this[Z]+=ye.length,this[R](we,null,ye)}},J.AbstractValueIterator=class pe extends me{constructor(de,ye){super(de,ye,!1)}[O](de,ye){const we=this[v]();if(de)return we(de);try{ye=void 0!==ye?this[L].decode(ye):void 0}catch(xe){return we(new ce("value",xe))}void 0!==ye&&this[Z]++,we(null,ye)}[x](de,ye){const we=this[v]();if(de)return this[R](we,de);try{for(let xe=0;xe<ye.length;xe++){const Ae=ye[xe];ye[xe]=void 0!==Ae?this[L].decode(Ae):void 0}}catch(xe){return this[R](we,new ce("values",xe))}this[Z]+=ye.length,this[R](we,null,ye)}}},87526:(re,J,p)=>{"use strict";const{supports:w}=p(21130),{Transcoder:d}=p(2849),{EventEmitter:S}=p(83358),{fromCallback:I}=p(49989),m=p(67004),{AbstractIterator:l}=p(57074),{DefaultKeyIterator:h,DefaultValueIterator:y}=p(98623),{DeferredIterator:_,DeferredKeyIterator:A,DeferredValueIterator:O}=p(97891),{DefaultChainedBatch:x}=p(81076),{getCallback:g,getOptions:v}=p(86653),R=p(13352),N=Symbol("promise"),D=Symbol("landed"),k=Symbol("resources"),j=Symbol("closeResources"),Q=Symbol("operations"),L=Symbol("undefer"),K=Symbol("deferOpen"),G=Symbol("options"),C=Symbol("status"),z=Symbol("defaultOptions"),te=Symbol("transcoder"),Z=Symbol("keyEncoding"),se=Symbol("valueEncoding"),ue=()=>{};class oe extends S{constructor(ce,_e){if(super(),"object"!=typeof ce||null===ce)throw new TypeError("The first argument 'manifest' must be an object");_e=v(_e);const{keyEncoding:de,valueEncoding:ye,passive:we,...xe}=_e;this[k]=new Set,this[Q]=[],this[K]=!0,this[G]=xe,this[C]="opening",this.supports=w(ce,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:!1!==ce.snapshots,permanence:!1!==ce.permanence,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:ce.encodings||{},events:Object.assign({},ce.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[te]=new d(ae(this)),this[Z]=this[te].encoding(de||"utf8"),this[se]=this[te].encoding(ye||"utf8");for(const Ae of this[te].encodings())this.supports.encodings[Ae.commonName]||(this.supports.encodings[Ae.commonName]=!0);this[z]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[Z].commonName,valueEncoding:this[se].commonName}),key:Object.freeze({keyEncoding:this[Z].commonName})},this.nextTick(()=>{this[K]&&this.open({passive:!1},ue)})}get status(){return this[C]}keyEncoding(ce){return this[te].encoding(ce??this[Z])}valueEncoding(ce){return this[te].encoding(ce??this[se])}open(ce,_e){_e=g(ce,_e),_e=I(_e,N),(ce={...this[G],...v(ce)}).createIfMissing=!1!==ce.createIfMissing,ce.errorIfExists=!!ce.errorIfExists;const de=ye=>{"closing"===this[C]||"opening"===this[C]?this.once(D,ye?()=>de(ye):de):"open"!==this[C]?_e(new m("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:ye})):_e()};return ce.passive?"opening"===this[C]?this.once(D,de):this.nextTick(de):"closed"===this[C]||this[K]?(this[K]=!1,this[C]="opening",this.emit("opening"),this._open(ce,ye=>{if(ye)return this[C]="closed",this[j](()=>{this.emit(D),de(ye)}),void this[L]();this[C]="open",this[L](),this.emit(D),"open"===this[C]&&this.emit("open"),"open"===this[C]&&this.emit("ready"),de()})):"open"===this[C]?this.nextTick(de):this.once(D,()=>this.open(ce,_e)),_e[N]}_open(ce,_e){this.nextTick(_e)}close(ce){ce=I(ce,N);const _e=de=>{"opening"===this[C]||"closing"===this[C]?this.once(D,de?_e(de):_e):"closed"!==this[C]?ce(new m("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:de})):ce()};if("open"===this[C]){this[C]="closing",this.emit("closing");const de=ye=>{this[C]="open",this[L](),this.emit(D),_e(ye)};this[j](()=>{this._close(ye=>{if(ye)return de(ye);this[C]="closed",this[L](),this.emit(D),"closed"===this[C]&&this.emit("closed"),_e()})})}else"closed"===this[C]?this.nextTick(_e):this.once(D,()=>this.close(ce));return ce[N]}[j](ce){if(0===this[k].size)return this.nextTick(ce);let _e=this[k].size,de=!0;const ye=()=>{0==--_e&&(de?this.nextTick(ce):ce())};for(const we of this[k])we.close(ye);de=!1,this[k].clear()}_close(ce){this.nextTick(ce)}get(ce,_e,de){if(de=g(_e,de),de=I(de,N),_e=v(_e,this[z].entry),"opening"===this[C])return this.defer(()=>this.get(ce,_e,de)),de[N];if(fe(this,de))return de[N];const ye=this._checkKey(ce);if(ye)return this.nextTick(de,ye),de[N];const we=this.keyEncoding(_e.keyEncoding),xe=this.valueEncoding(_e.valueEncoding),Ae=we.format,Re=xe.format;return(_e.keyEncoding!==Ae||_e.valueEncoding!==Re)&&(_e=Object.assign({},_e,{keyEncoding:Ae,valueEncoding:Re})),this._get(this.prefixKey(we.encode(ce),Ae),_e,(ve,Oe)=>{if(ve)return("LEVEL_NOT_FOUND"===ve.code||ve.notFound||/NotFound/i.test(ve))&&(ve.code||(ve.code="LEVEL_NOT_FOUND"),ve.notFound||(ve.notFound=!0),ve.status||(ve.status=404)),de(ve);try{Oe=xe.decode(Oe)}catch(Ve){return de(new m("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:Ve}))}de(null,Oe)}),de[N]}_get(ce,_e,de){this.nextTick(de,new Error("NotFound"))}getMany(ce,_e,de){if(de=g(_e,de),de=I(de,N),_e=v(_e,this[z].entry),"opening"===this[C])return this.defer(()=>this.getMany(ce,_e,de)),de[N];if(fe(this,de))return de[N];if(!Array.isArray(ce))return this.nextTick(de,new TypeError("The first argument 'keys' must be an array")),de[N];if(0===ce.length)return this.nextTick(de,null,[]),de[N];const ye=this.keyEncoding(_e.keyEncoding),we=this.valueEncoding(_e.valueEncoding),xe=ye.format,Ae=we.format;(_e.keyEncoding!==xe||_e.valueEncoding!==Ae)&&(_e=Object.assign({},_e,{keyEncoding:xe,valueEncoding:Ae}));const Re=new Array(ce.length);for(let ve=0;ve<ce.length;ve++){const Oe=ce[ve],Ve=this._checkKey(Oe);if(Ve)return this.nextTick(de,Ve),de[N];Re[ve]=this.prefixKey(ye.encode(Oe),xe)}return this._getMany(Re,_e,(ve,Oe)=>{if(ve)return de(ve);try{for(let Ve=0;Ve<Oe.length;Ve++)void 0!==Oe[Ve]&&(Oe[Ve]=we.decode(Oe[Ve]))}catch(Ve){return de(new m(`Could not decode one or more of ${Oe.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:Ve}))}de(null,Oe)}),de[N]}_getMany(ce,_e,de){this.nextTick(de,null,new Array(ce.length).fill(void 0))}put(ce,_e,de,ye){if(ye=g(de,ye),ye=I(ye,N),de=v(de,this[z].entry),"opening"===this[C])return this.defer(()=>this.put(ce,_e,de,ye)),ye[N];if(fe(this,ye))return ye[N];const we=this._checkKey(ce)||this._checkValue(_e);if(we)return this.nextTick(ye,we),ye[N];const xe=this.keyEncoding(de.keyEncoding),Ae=this.valueEncoding(de.valueEncoding),Re=xe.format,ve=Ae.format;(de.keyEncoding!==Re||de.valueEncoding!==ve)&&(de=Object.assign({},de,{keyEncoding:Re,valueEncoding:ve}));const Oe=this.prefixKey(xe.encode(ce),Re),Ve=Ae.encode(_e);return this._put(Oe,Ve,de,Ue=>{if(Ue)return ye(Ue);this.emit("put",ce,_e),ye()}),ye[N]}_put(ce,_e,de,ye){this.nextTick(ye)}del(ce,_e,de){if(de=g(_e,de),de=I(de,N),_e=v(_e,this[z].key),"opening"===this[C])return this.defer(()=>this.del(ce,_e,de)),de[N];if(fe(this,de))return de[N];const ye=this._checkKey(ce);if(ye)return this.nextTick(de,ye),de[N];const we=this.keyEncoding(_e.keyEncoding),xe=we.format;return _e.keyEncoding!==xe&&(_e=Object.assign({},_e,{keyEncoding:xe})),this._del(this.prefixKey(we.encode(ce),xe),_e,Ae=>{if(Ae)return de(Ae);this.emit("del",ce),de()}),de[N]}_del(ce,_e,de){this.nextTick(de)}batch(ce,_e,de){if(!arguments.length){if("opening"===this[C])return new x(this);if("open"!==this[C])throw new m("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(de="function"==typeof ce?ce:g(_e,de),de=I(de,N),_e=v(_e,this[z].empty),"opening"===this[C])return this.defer(()=>this.batch(ce,_e,de)),de[N];if(fe(this,de))return de[N];if(!Array.isArray(ce))return this.nextTick(de,new TypeError("The first argument 'operations' must be an array")),de[N];if(0===ce.length)return this.nextTick(de),de[N];const ye=new Array(ce.length),{keyEncoding:we,valueEncoding:xe,...Ae}=_e;for(let Re=0;Re<ce.length;Re++){if("object"!=typeof ce[Re]||null===ce[Re])return this.nextTick(de,new TypeError("A batch operation must be an object")),de[N];const ve=Object.assign({},ce[Re]);if("put"!==ve.type&&"del"!==ve.type)return this.nextTick(de,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),de[N];const Oe=this._checkKey(ve.key);if(Oe)return this.nextTick(de,Oe),de[N];const Ve=null!=ve.sublevel?ve.sublevel:this,Ue=Ve.keyEncoding(ve.keyEncoding||we),je=Ue.format;if(ve.key=Ve.prefixKey(Ue.encode(ve.key),je),ve.keyEncoding=je,"put"===ve.type){const Ke=this._checkValue(ve.value);if(Ke)return this.nextTick(de,Ke),de[N];const nt=Ve.valueEncoding(ve.valueEncoding||xe);ve.value=nt.encode(ve.value),ve.valueEncoding=nt.format}Ve!==this&&(ve.sublevel=null),ye[Re]=ve}return this._batch(ye,Ae,Re=>{if(Re)return de(Re);this.emit("batch",ce),de()}),de[N]}_batch(ce,_e,de){this.nextTick(de)}sublevel(ce,_e){return this._sublevel(ce,me.defaults(_e))}_sublevel(ce,_e){return new me(this,ce,_e)}prefixKey(ce,_e){return ce}clear(ce,_e){if(_e=g(ce,_e),_e=I(_e,N),ce=v(ce,this[z].empty),"opening"===this[C])return this.defer(()=>this.clear(ce,_e)),_e[N];if(fe(this,_e))return _e[N];const de=ce,ye=this.keyEncoding(ce.keyEncoding);return(ce=R(ce,ye)).keyEncoding=ye.format,0===ce.limit?this.nextTick(_e):this._clear(ce,we=>{if(we)return _e(we);this.emit("clear",de),_e()}),_e[N]}_clear(ce,_e){this.nextTick(_e)}iterator(ce){const _e=this.keyEncoding(ce&&ce.keyEncoding),de=this.valueEncoding(ce&&ce.valueEncoding);if((ce=R(ce,_e)).keys=!1!==ce.keys,ce.values=!1!==ce.values,ce[l.keyEncoding]=_e,ce[l.valueEncoding]=de,ce.keyEncoding=_e.format,ce.valueEncoding=de.format,"opening"===this[C])return new _(this,ce);if("open"!==this[C])throw new m("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(ce)}_iterator(ce){return new l(this,ce)}keys(ce){const _e=this.keyEncoding(ce&&ce.keyEncoding),de=this.valueEncoding(ce&&ce.valueEncoding);if((ce=R(ce,_e))[l.keyEncoding]=_e,ce[l.valueEncoding]=de,ce.keyEncoding=_e.format,ce.valueEncoding=de.format,"opening"===this[C])return new A(this,ce);if("open"!==this[C])throw new m("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(ce)}_keys(ce){return new h(this,ce)}values(ce){const _e=this.keyEncoding(ce&&ce.keyEncoding),de=this.valueEncoding(ce&&ce.valueEncoding);if((ce=R(ce,_e))[l.keyEncoding]=_e,ce[l.valueEncoding]=de,ce.keyEncoding=_e.format,ce.valueEncoding=de.format,"opening"===this[C])return new O(this,ce);if("open"!==this[C])throw new m("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(ce)}_values(ce){return new y(this,ce)}defer(ce){if("function"!=typeof ce)throw new TypeError("The first argument must be a function");this[Q].push(ce)}[L](){if(0===this[Q].length)return;const ce=this[Q];this[Q]=[];for(const _e of ce)_e()}attachResource(ce){if("object"!=typeof ce||null===ce||"function"!=typeof ce.close)throw new TypeError("The first argument must be a resource object");this[k].add(ce)}detachResource(ce){this[k].delete(ce)}_chainedBatch(){return new x(this)}_checkKey(ce){if(null==ce)return new m("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(ce){if(null==ce)return new m("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}}oe.prototype.nextTick=p(61521);const{AbstractSublevel:me}=p(48044)({AbstractLevel:oe});J.AbstractLevel=oe,J.AbstractSublevel=me;const fe=function(pe,ce){return"open"!==pe[C]&&(pe.nextTick(ce,new m("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0)},ae=function(pe){return Object.keys(pe.supports.encodings).filter(ce=>!!pe.supports.encodings[ce])}},49473:(re,J,p)=>{"use strict";J.AbstractLevel=p(87526).AbstractLevel,J.AbstractSublevel=p(87526).AbstractSublevel,J.AbstractIterator=p(57074).AbstractIterator,J.AbstractKeyIterator=p(57074).AbstractKeyIterator,J.AbstractValueIterator=p(57074).AbstractValueIterator,J.AbstractChainedBatch=p(54805).AbstractChainedBatch},58377:(re,J,p)=>{"use strict";const{AbstractIterator:w,AbstractKeyIterator:d,AbstractValueIterator:S}=p(57074),I=Symbol("unfix"),m=Symbol("iterator"),l=Symbol("handleOne"),h=Symbol("handleMany"),y=Symbol("callback");class _ extends w{constructor(g,v,R,N){super(g,v),this[m]=R,this[I]=N,this[l]=this[l].bind(this),this[h]=this[h].bind(this),this[y]=null}[l](g,v,R){const N=this[y];if(g)return N(g);void 0!==v&&(v=this[I](v)),N(g,v,R)}[h](g,v){const R=this[y];if(g)return R(g);for(const N of v){const D=N[0];void 0!==D&&(N[0]=this[I](D))}R(g,v)}}class A extends d{constructor(g,v,R,N){super(g,v),this[m]=R,this[I]=N,this[l]=this[l].bind(this),this[h]=this[h].bind(this),this[y]=null}[l](g,v){const R=this[y];if(g)return R(g);void 0!==v&&(v=this[I](v)),R(g,v)}[h](g,v){const R=this[y];if(g)return R(g);for(let N=0;N<v.length;N++){const D=v[N];void 0!==D&&(v[N]=this[I](D))}R(g,v)}}class O extends S{constructor(g,v,R){super(g,v),this[m]=R}}for(const x of[_,A])x.prototype._next=function(g){this[y]=g,this[m].next(this[l])},x.prototype._nextv=function(g,v,R){this[y]=R,this[m].nextv(g,v,this[h])},x.prototype._all=function(g,v){this[y]=v,this[m].all(g,this[h])};for(const x of[O])x.prototype._next=function(g){this[m].next(g)},x.prototype._nextv=function(g,v,R){this[m].nextv(g,v,R)},x.prototype._all=function(g,v){this[m].all(g,v)};for(const x of[_,A,O])x.prototype._seek=function(g,v){this[m].seek(g,v)},x.prototype._close=function(g){this[m].close(g)};J.AbstractSublevelIterator=_,J.AbstractSublevelKeyIterator=A,J.AbstractSublevelValueIterator=O},48044:(re,J,p)=>{"use strict";const w=p(67004),{Buffer:d}=p(13195)||{},{AbstractSublevelIterator:S,AbstractSublevelKeyIterator:I,AbstractSublevelValueIterator:m}=p(58377),l=Symbol("prefix"),h=Symbol("upperBound"),y=Symbol("prefixRange"),_=Symbol("parent"),A=Symbol("unfix"),O=new TextEncoder,x={separator:"!"};re.exports=function({AbstractLevel:k}){class j extends k{static defaults(L){if("string"==typeof L)throw new w("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(L&&L.open)throw new w("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return null==L?x:L.separator?L:{...L,separator:"!"}}constructor(L,K,G){const{separator:C,manifest:z,...te}=j.defaults(G);K=D(K,C);const Z=C.charCodeAt(0)+1,se=L[_]||L;if(!O.encode(K).every(me=>me>Z&&me<127))throw new w(`Prefix must use bytes > ${Z} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(g(se,z),te);const ue=(L.prefix||"")+C+K+C,oe=ue.slice(0,-1)+String.fromCharCode(Z);this[_]=se,this[l]=new R(ue),this[h]=new R(oe),this[A]=new N,this.nextTick=se.nextTick}prefixKey(L,K){if("utf8"===K)return this[l].utf8+L;if(0===L.byteLength)return this[l][K];if("view"===K){const G=this[l].view,C=new Uint8Array(G.byteLength+L.byteLength);return C.set(G,0),C.set(L,G.byteLength),C}{const G=this[l].buffer;return d.concat([G,L],G.byteLength+L.byteLength)}}[y](L,K){void 0!==L.gte?L.gte=this.prefixKey(L.gte,K):void 0!==L.gt?L.gt=this.prefixKey(L.gt,K):L.gte=this[l][K],void 0!==L.lte?L.lte=this.prefixKey(L.lte,K):void 0!==L.lt?L.lt=this.prefixKey(L.lt,K):L.lte=this[h][K]}get prefix(){return this[l].utf8}get db(){return this[_]}_open(L,K){this[_].open({passive:!0},K)}_put(L,K,G,C){this[_].put(L,K,G,C)}_get(L,K,G){this[_].get(L,K,G)}_getMany(L,K,G){this[_].getMany(L,K,G)}_del(L,K,G){this[_].del(L,K,G)}_batch(L,K,G){this[_].batch(L,K,G)}_clear(L,K){this[y](L,L.keyEncoding),this[_].clear(L,K)}_iterator(L){this[y](L,L.keyEncoding);const K=this[_].iterator(L),G=this[A].get(this[l].utf8.length,L.keyEncoding);return new S(this,L,K,G)}_keys(L){this[y](L,L.keyEncoding);const K=this[_].keys(L),G=this[A].get(this[l].utf8.length,L.keyEncoding);return new I(this,L,K,G)}_values(L){this[y](L,L.keyEncoding);const K=this[_].values(L);return new m(this,L,K)}}return{AbstractSublevel:j}};const g=function(k,j){return{...k.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...j,encodings:{utf8:v(k,"utf8"),buffer:v(k,"buffer"),view:v(k,"view")}}},v=function(k,j){return!!k.supports.encodings[j]&&k.keyEncoding(j).name===j};class R{constructor(j){this.utf8=j,this.view=O.encode(j),this.buffer=d?d.from(this.view.buffer,0,this.view.byteLength):{}}}class N{constructor(){this.cache=new Map}get(j,Q){let L=this.cache.get(Q);return void 0===L&&(L="view"===Q?function(K,G){return G.subarray(K)}.bind(null,j):function(K,G){return G.slice(K)}.bind(null,j),this.cache.set(Q,L)),L}}const D=function(k,j){let Q=0,L=k.length;for(;Q<L&&k[Q]===j;)Q++;for(;L>Q&&k[L-1]===j;)L--;return k.slice(Q,L)}},86653:(re,J)=>{"use strict";J.getCallback=function(p,w){return"function"==typeof p?p:w},J.getOptions=function(p,w){return"object"==typeof p&&null!==p?p:void 0!==w?w:{}}},81076:(re,J,p)=>{"use strict";const{AbstractChainedBatch:w}=p(54805),d=p(67004),S=Symbol("encoded");J.DefaultChainedBatch=class I extends w{constructor(l){super(l),this[S]=[]}_put(l,h,y){this[S].push({...y,type:"put",key:l,value:h})}_del(l,h){this[S].push({...h,type:"del",key:l})}_clear(){this[S]=[]}_write(l,h){"opening"===this.db.status?this.db.defer(()=>this._write(l,h)):"open"===this.db.status?0===this[S].length?this.nextTick(h):this.db._batch(this[S],l,h):this.nextTick(h,new d("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}}},98623:(re,J,p)=>{"use strict";const{AbstractKeyIterator:w,AbstractValueIterator:d}=p(57074),S=Symbol("iterator"),I=Symbol("callback"),m=Symbol("handleOne"),l=Symbol("handleMany");class h extends w{constructor(A,O){super(A,O),this[S]=A.iterator({...O,keys:!0,values:!1}),this[m]=this[m].bind(this),this[l]=this[l].bind(this)}}class y extends d{constructor(A,O){super(A,O),this[S]=A.iterator({...O,keys:!1,values:!0}),this[m]=this[m].bind(this),this[l]=this[l].bind(this)}}for(const _ of[h,y]){const A=_===h,O=A?x=>x[0]:x=>x[1];_.prototype._next=function(x){this[I]=x,this[S].next(this[m])},_.prototype[m]=function(x,g,v){const R=this[I];x?R(x):R(null,A?g:v)},_.prototype._nextv=function(x,g,v){this[I]=v,this[S].nextv(x,g,this[l])},_.prototype._all=function(x,g){this[I]=g,this[S].all(x,this[l])},_.prototype[l]=function(x,g){const v=this[I];x?v(x):v(null,g.map(O))},_.prototype._seek=function(x,g){this[S].seek(x,g)},_.prototype._close=function(x){this[S].close(x)}}J.DefaultKeyIterator=h,J.DefaultValueIterator=y},97891:(re,J,p)=>{"use strict";const{AbstractIterator:w,AbstractKeyIterator:d,AbstractValueIterator:S}=p(57074),I=p(67004),m=Symbol("nut"),l=Symbol("undefer"),h=Symbol("factory");class y extends w{constructor(x,g){super(x,g),this[m]=null,this[h]=()=>x.iterator(g),this.db.defer(()=>this[l]())}}class _ extends d{constructor(x,g){super(x,g),this[m]=null,this[h]=()=>x.keys(g),this.db.defer(()=>this[l]())}}class A extends S{constructor(x,g){super(x,g),this[m]=null,this[h]=()=>x.values(g),this.db.defer(()=>this[l]())}}for(const O of[y,_,A])O.prototype[l]=function(){"open"===this.db.status&&(this[m]=this[h]())},O.prototype._next=function(x){null!==this[m]?this[m].next(x):"opening"===this.db.status?this.db.defer(()=>this._next(x)):this.nextTick(x,new I("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},O.prototype._nextv=function(x,g,v){null!==this[m]?this[m].nextv(x,g,v):"opening"===this.db.status?this.db.defer(()=>this._nextv(x,g,v)):this.nextTick(v,new I("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},O.prototype._all=function(x,g){null!==this[m]?this[m].all(g):"opening"===this.db.status?this.db.defer(()=>this._all(x,g)):this.nextTick(g,new I("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},O.prototype._seek=function(x,g){null!==this[m]?this[m]._seek(x,g):"opening"===this.db.status&&this.db.defer(()=>this._seek(x,g))},O.prototype._close=function(x){null!==this[m]?this[m].close(x):"opening"===this.db.status?this.db.defer(()=>this._close(x)):this.nextTick(x)};J.DeferredIterator=y,J.DeferredKeyIterator=_,J.DeferredValueIterator=A},61521:(re,J,p)=>{"use strict";const w=p(12097);re.exports=function(d,...S){w(0===S.length?d:()=>d(...S))}},13352:(re,J,p)=>{"use strict";const w=p(67004),d=Object.prototype.hasOwnProperty,S=new Set(["lt","lte","gt","gte"]);re.exports=function(I,m){const l={};for(const h in I)if(d.call(I,h)&&"keyEncoding"!==h&&"valueEncoding"!==h){if("start"===h||"end"===h)throw new w(`The legacy range option '${h}' has been removed`,{code:"LEVEL_LEGACY"});if("encoding"===h)throw new w("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});l[h]=S.has(h)?m.encode(I[h]):I[h]}return l.reverse=!!l.reverse,l.limit=Number.isInteger(l.limit)&&l.limit>=0?l.limit:-1,l}},78196:re=>{function J(p){const w=new globalThis.AbortController;function d(){w.abort();for(const S of p)!S||!S.removeEventListener||S.removeEventListener("abort",d)}for(const S of p)if(S&&S.addEventListener){if(S.aborted){d();break}S.addEventListener("abort",d)}return w.signal}re.exports=J,re.exports.anySignal=J},64972:(re,J,p)=>{"use strict";var w=p(21778).default,d=p(40226).default;re.exports=function(){var I=w(function*(m){const l=[];var _,h=!1,y=!1;try{for(var O,A=d(m);h=!(O=yield A.next()).done;h=!1)l.push(O.value)}catch(x){y=!0,_=x}finally{try{h&&null!=A.return&&(yield A.return())}finally{if(y)throw _}}return l});return function(l){return I.apply(this,arguments)}}()},73921:(re,J,p)=>{"use strict";var w=p(21778).default,d=p(40226).default;re.exports=function(){var I=w(function*(m){var y,l=!1,h=!1;try{for(var _=d(m);l=!(yield _.next()).done;l=!1);}catch(O){h=!0,y=O}finally{try{l&&null!=_.return&&(yield _.return())}finally{if(h)throw y}}});return function(l){return I.apply(this,arguments)}}()},53036:(re,J,p)=>{"use strict";var w=p(14997).default,d=p(73671).default,S=p(40226).default;re.exports=function(){var m=d(function*(l,h){var A,y=!1,_=!1;try{for(var x,O=S(l);y=!(x=yield w(O.next())).done;y=!1){const g=x.value;(yield w(h(g)))&&(yield g)}}catch(g){_=!0,A=g}finally{try{y&&null!=O.return&&(yield w(O.return()))}finally{if(_)throw A}}});return function(h,y){return m.apply(this,arguments)}}()},23974:(re,J,p)=>{"use strict";var w=p(14997).default,d=p(73671).default,S=p(40226).default;re.exports=function(){var m=d(function*(l,h){let y=0;if(!(h<1)){var O,_=!1,A=!1;try{for(var g,x=S(l);_=!(g=yield w(x.next())).done;_=!1)if(yield g.value,y++,y===h)return}catch(v){A=!0,O=v}finally{try{_&&null!=x.return&&(yield w(x.return()))}finally{if(A)throw O}}}});return function(h,y){return m.apply(this,arguments)}}()},34208:(re,J,p)=>{"use strict";const{AbstractLevel:w}=p(49473),d=p(67004),S=p(97729),{fromCallback:I}=p(49989),{Iterator:m}=p(47900),l=p(24435),h=p(34391),y=p(13472),_="level-js-",A=Symbol("idb"),O=Symbol("namePrefix"),x=Symbol("location"),g=Symbol("version"),v=Symbol("store"),R=Symbol("onComplete"),N=Symbol("promise");J.BrowserLevel=(()=>{class k extends w{constructor(Q,L,K){if("function"==typeof L||"function"==typeof K)throw new d("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:G,version:C,...z}=L||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},z),"string"!=typeof Q)throw new Error("constructor requires a location string argument");this[x]=Q,this[O]=G??_,this[g]=parseInt(C||1,10),this[A]=null}get location(){return this[x]}get namePrefix(){return this[O]}get version(){return this[g]}get db(){return this[A]}get type(){return"browser-level"}_open(Q,L){const K=indexedDB.open(this[O]+this[x],this[g]);K.onerror=function(){L(K.error||new Error("unknown error"))},K.onsuccess=()=>{this[A]=K.result,L()},K.onupgradeneeded=G=>{const C=G.target.result;C.objectStoreNames.contains(this[x])||C.createObjectStore(this[x])}}[v](Q){return this[A].transaction([this[x]],Q).objectStore(this[x])}[R](Q,L){const K=Q.transaction;K.onabort=function(){L(K.error||new Error("aborted by user"))},K.oncomplete=function(){L(null,Q.result)}}_get(Q,L,K){const G=this[v]("readonly");let C;try{C=G.get(Q)}catch(z){return this.nextTick(K,z)}this[R](C,function(z,te){return z?K(z):void 0===te?K(new d("Entry not found",{code:"LEVEL_NOT_FOUND"})):void K(null,l(te))})}_getMany(Q,L,K){const G=this[v]("readonly"),C=Q.map(z=>te=>{let Z;try{Z=G.get(z)}catch(se){return te(se)}Z.onsuccess=()=>{const se=Z.result;te(null,void 0===se?se:l(se))},Z.onerror=se=>{se.stopPropagation(),te(Z.error)}});S(C,16,K)}_del(Q,L,K){const G=this[v]("readwrite");let C;try{C=G.delete(Q)}catch(z){return this.nextTick(K,z)}this[R](C,K)}_put(Q,L,K,G){const C=this[v]("readwrite");let z;try{z=C.put(L,Q)}catch(te){return this.nextTick(G,te)}this[R](z,G)}_iterator(Q){return new m(this,this[x],Q)}_batch(Q,L,K){const G=this[v]("readwrite"),C=G.transaction;let te,z=0;C.onabort=function(){K(te||C.error||new Error("aborted by user"))},C.oncomplete=function(){K()},function Z(){const se=Q[z++],ue=se.key;let oe;try{oe="del"===se.type?G.delete(ue):G.put(se.value,ue)}catch(me){return te=me,void C.abort()}z<Q.length?oe.onsuccess=Z:"function"==typeof C.commit&&C.commit()}()}_clear(Q,L){let K,G;try{K=y(Q)}catch{return this.nextTick(L)}if(Q.limit>=0)return h(this,this[x],K,Q,L);try{const C=this[v]("readwrite");G=K?C.delete(K):C.clear()}catch(C){return this.nextTick(L,C)}this[R](G,L)}_close(Q){this[A].close(),this.nextTick(Q)}}return k.destroy=function(j,Q,L){"function"==typeof Q&&(L=Q,Q=_),L=I(L,N);const K=indexedDB.deleteDatabase(Q+j);return K.onsuccess=function(){L()},K.onerror=function(G){L(G)},L[N]},k})()},47900:(re,J,p)=>{"use strict";const{AbstractIterator:w}=p(49473),d=p(13472),S=p(24435),I=Symbol("cache"),m=Symbol("finished"),l=Symbol("options"),h=Symbol("currentOptions"),y=Symbol("position"),_=Symbol("location"),A=Symbol("first"),O={};function g(v){"function"==typeof v.commit&&v.commit()}J.Iterator=class x extends w{constructor(R,N,D){super(R,D),this[I]=[],this[m]=0===this.limit,this[l]=D,this[h]={...D},this[y]=void 0,this[_]=N,this[A]=!0}_nextv(R,N,D){if(this[A]=!1,this[m])return this.nextTick(D,null,[]);if(this[I].length>0)return R=Math.min(R,this[I].length),this.nextTick(D,null,this[I].splice(0,R));let k;void 0!==this[y]&&(this[l].reverse?(this[h].lt=this[y],this[h].lte=void 0):(this[h].gt=this[y],this[h].gte=void 0));try{k=d(this[h])}catch{return this[m]=!0,this.nextTick(D,null,[])}const j=this.db.db.transaction([this[_]],"readonly"),Q=j.objectStore(this[_]),L=[];if(this[l].reverse)Q[!this[l].values&&Q.openKeyCursor?"openKeyCursor":"openCursor"](k,"prev").onsuccess=G=>{const C=G.target.result;if(C){const{key:z,value:te}=C;this[y]=z,L.push([this[l].keys&&void 0!==z?S(z):void 0,this[l].values&&void 0!==te?S(te):void 0]),L.length<R?C.continue():g(j)}else this[m]=!0};else{let K,G;const C=()=>{if(void 0===K||void 0===G)return;const z=Math.max(K.length,G.length);0===z||R===1/0?this[m]=!0:this[y]=K[z-1],L.length=z;for(let te=0;te<z;te++){const Z=K[te],se=G[te];L[te]=[this[l].keys&&void 0!==Z?S(Z):void 0,this[l].values&&void 0!==se?S(se):void 0]}g(j)};this[l].keys||R<1/0?Q.getAllKeys(k,R<1/0?R:void 0).onsuccess=z=>{K=z.target.result,C()}:(K=[],this.nextTick(C)),this[l].values?Q.getAll(k,R<1/0?R:void 0).onsuccess=z=>{G=z.target.result,C()}:(G=[],this.nextTick(C))}j.onabort=()=>{D(j.error||new Error("aborted by user")),D=null},j.oncomplete=()=>{D(null,L),D=null}}_next(R){if(this[I].length>0){const[N,D]=this[I].shift();this.nextTick(R,null,N,D)}else if(this[m])this.nextTick(R);else{let N=Math.min(100,this.limit-this.count);this[A]&&(this[A]=!1,N=1),this._nextv(N,O,(D,k)=>{if(D)return R(D);this[I]=k,this._next(R)})}}_all(R,N){this[A]=!1;const D=this[I].splice(0,this[I].length),k=this.limit-this.count-D.length;if(k<=0)return this.nextTick(N,null,D);this._nextv(k,O,(j,Q)=>{if(j)return N(j);D.length>0&&(Q=D.concat(Q)),N(null,Q)})}_seek(R,N){let D;this[A]=!0,this[I]=[],this[m]=!1,this[y]=void 0,this[h]={...this[l]};try{D=d(this[l])}catch{return void(this[m]=!0)}null===D||D.includes(R)?this[l].reverse?this[h].lte=R:this[h].gte=R:this[m]=!0}}},34391:re=>{"use strict";re.exports=function(p,w,d,S,I){if(0===S.limit)return p.nextTick(I);const m=p.db.transaction([w],"readwrite"),l=m.objectStore(w);let h=0;m.oncomplete=function(){I()},m.onabort=function(){I(m.error||new Error("aborted by user"))},l[l.openKeyCursor?"openKeyCursor":"openCursor"](d,S.reverse?"prev":"next").onsuccess=function(A){const O=A.target.result;O&&(l.delete(O.key).onsuccess=function(){(S.limit<=0||++h<S.limit)&&O.continue()})}}},24435:re=>{"use strict";const J=new TextEncoder;re.exports=function(p){return p instanceof Uint8Array?p:p instanceof ArrayBuffer?new Uint8Array(p):J.encode(p)}},13472:re=>{"use strict";re.exports=function(p){const w=void 0!==p.gte?p.gte:void 0!==p.gt?p.gt:void 0,d=void 0!==p.lte?p.lte:void 0!==p.lt?p.lt:void 0,S=void 0===p.gte,I=void 0===p.lte;return void 0!==w&&void 0!==d?IDBKeyRange.bound(w,d,S,I):void 0!==w?IDBKeyRange.lowerBound(w,S):void 0!==d?IDBKeyRange.upperBound(d,I):null}},49989:(re,J,p)=>{"use strict";var w=p(26552);J.fromCallback=function(d,S){if(void 0===d){var I=new Promise(function(m,l){d=function(h,y){h?l(h):m(y)}});d[void 0!==S?S:"promise"]=I}else if("function"!=typeof d)throw new TypeError("Callback must be a function");return d},J.fromPromise=function(d,S){if(void 0===S)return d;d.then(function(I){w(()=>S(null,I))}).catch(function(I){w(()=>S(I))})}},26552:re=>{re.exports="function"==typeof queueMicrotask?queueMicrotask:J=>Promise.resolve().then(J)},32062:(re,J,p)=>{"use strict";var w=p(21778).default,d=p(40226).default;re.exports=function(){var I=w(function*(m){const l=[];var _,h=!1,y=!1;try{for(var O,A=d(m);h=!(O=yield A.next()).done;h=!1)l.push(O.value)}catch(x){y=!0,_=x}finally{try{h&&null!=A.return&&(yield A.return())}finally{if(y)throw _}}return l});return function(l){return I.apply(this,arguments)}}()},74817:(re,J,p)=>{"use strict";var w=p(21778).default,d=p(40226).default;re.exports=function(){var I=w(function*(m){var y,l=!1,h=!1;try{for(var _=d(m);l=!(yield _.next()).done;l=!1);}catch(O){h=!0,y=O}finally{try{l&&null!=_.return&&(yield _.return())}finally{if(h)throw y}}});return function(l){return I.apply(this,arguments)}}()},62785:(re,J,p)=>{"use strict";var w=p(14997).default,d=p(73671).default,S=p(40226).default;re.exports=function(){var m=d(function*(l,h){var A,y=!1,_=!1;try{for(var x,O=S(l);y=!(x=yield w(O.next())).done;y=!1){const g=x.value;(yield w(h(g)))&&(yield g)}}catch(g){_=!0,A=g}finally{try{y&&null!=O.return&&(yield w(O.return()))}finally{if(_)throw A}}});return function(h,y){return m.apply(this,arguments)}}()},49072:(re,J,p)=>{"use strict";var w=p(14997).default,d=p(73671).default,S=p(40226).default;re.exports=function(){var m=d(function*(l,h){var A,y=!1,_=!1;try{for(var x,O=S(l);y=!(x=yield w(O.next())).done;y=!1){const g=x.value;yield h(g)}}catch(g){_=!0,A=g}finally{try{y&&null!=O.return&&(yield w(O.return()))}finally{if(_)throw A}}});return function(h,y){return m.apply(this,arguments)}}()},61700:(re,J,p)=>{"use strict";var w=p(21778).default,d=p(73671).default,S=p(14997).default,I=p(40226).default,m=p(63983).default;const l=p(63702);re.exports=function(){var y=d(function*(..._){const A=l();setTimeout(w(function*(){try{yield Promise.all(_.map(function(){var O=w(function*(x){var R,g=!1,v=!1;try{for(var D,N=I(x);g=!(D=yield N.next()).done;g=!1)A.push(D.value)}catch(k){v=!0,R=k}finally{try{g&&null!=N.return&&(yield N.return())}finally{if(v)throw R}}});return function(x){return O.apply(this,arguments)}}())),A.end()}catch(O){A.end(O)}}),0),yield*m(I(A),S)});return function(){return y.apply(this,arguments)}}()},63702:(re,J,p)=>{const w=p(30766);re.exports=d=>{let S;"function"==typeof(d=d||{})?(S=d,d={}):S=d.onEnd;let m,l,h,I=new w;const _=N=>l?l(N):(I.push(N),m),O=N=>h?m:_({done:!1,value:N}),x=N=>h?m:(h=!0,N?(N=>(I=new w,l?l({error:N}):(I.push({error:N}),m)))(N):_({done:!0}));if(m={[Symbol.asyncIterator](){return this},next:()=>{if(!I.isEmpty()){if(d.writev){let D;const k=[];for(;!I.isEmpty();){if(D=I.shift(),D.error)throw D.error;k.push(D.value)}return{done:D.done,value:k}}const N=I.shift();if(N.error)throw N.error;return N}return h?{done:!0}:new Promise((N,D)=>{l=k=>(l=null,k.error?D(k.error):N(d.writev&&!k.done?{done:k.done,value:[k.value]}:k),m)})},return:()=>(I=new w,x(),{done:!0}),throw:N=>(x(N),{done:!0}),push:O,end:x},!S)return m;const R=m;return m={[Symbol.asyncIterator](){return this},next:()=>R.next(),throw:N=>(R.throw(N),S&&(S(N),S=null),{done:!0}),return:()=>(R.return(),S&&(S(),S=null),{done:!0}),push:O,end:N=>(R.end(N),S&&(S(N),S=null),m)},m}},93445:(re,J,p)=>{"use strict";var w=p(14997).default,d=p(73671).default,S=p(40226).default;re.exports=function(){var m=d(function*(l,h){let y=0;if(!(h<1)){var O,_=!1,A=!1;try{for(var g,x=S(l);_=!(g=yield w(x.next())).done;_=!1)if(yield g.value,y++,y===h)return}catch(v){A=!0,O=v}finally{try{_&&null!=x.return&&(yield w(x.return()))}finally{if(A)throw O}}}});return function(h,y){return m.apply(this,arguments)}}()},33570:(re,J,p)=>{var w=p(28069),d=p(53217);J.formatArgs=function I(_){if(_[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+_[0]+(this.useColors?"%c ":" ")+"+"+re.exports.humanize(this.diff),!this.useColors)return;const A="color: "+this.color;_.splice(1,0,A,"color: inherit");let O=0,x=0;_[0].replace(/%[a-zA-Z%]/g,g=>{"%%"!==g&&(O++,"%c"===g&&(x=O))}),_.splice(x,0,A)},J.save=function m(_){try{_?J.storage.setItem("debug",_):J.storage.removeItem("debug")}catch{}},J.load=function l(){let _;try{_=J.storage.getItem("debug")}catch{}return!_&&typeof d<"u"&&"env"in d&&(_=d.env.DEBUG),_},J.useColors=function S(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},J.storage=function h(){try{return localStorage}catch{}}(),J.destroy=(()=>{let _=!1;return()=>{_||(_=!0,w.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),J.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],J.log=w.debug||w.log||(()=>{}),re.exports=p(92031)(J);const{formatters:y}=re.exports;y.j=function(_){try{return JSON.stringify(_)}catch(A){return"[UnexpectedJSONParseError]: "+A.message}}},92031:(re,J,p)=>{var w=p(28069);re.exports=function d(S){function m(g){let v,N,D,R=null;function k(...j){if(!k.enabled)return;const Q=k,L=Number(new Date);Q.diff=L-(v||L),Q.prev=v,Q.curr=L,v=L,j[0]=m.coerce(j[0]),"string"!=typeof j[0]&&j.unshift("%O");let G=0;j[0]=j[0].replace(/%([a-zA-Z%])/g,(z,te)=>{if("%%"===z)return"%";G++;const Z=m.formatters[te];return"function"==typeof Z&&(z=Z.call(Q,j[G]),j.splice(G,1),G--),z}),m.formatArgs.call(Q,j),(Q.log||m.log).apply(Q,j)}return k.namespace=g,k.useColors=m.useColors(),k.color=m.selectColor(g),k.extend=l,k.destroy=m.destroy,Object.defineProperty(k,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==R?R:(N!==m.namespaces&&(N=m.namespaces,D=m.enabled(g)),D),set:j=>{R=j}}),"function"==typeof m.init&&m.init(k),k}function l(g,v){const R=m(this.namespace+(typeof v>"u"?":":v)+g);return R.log=this.log,R}function A(g){return g.toString().substring(2,g.toString().length-2).replace(/\.\*\?$/,"*")}return m.debug=m,m.default=m,m.coerce=function O(g){return g instanceof Error?g.stack||g.message:g},m.disable=function y(){const g=[...m.names.map(A),...m.skips.map(A).map(v=>"-"+v)].join(",");return m.enable(""),g},m.enable=function h(g){let v;m.save(g),m.namespaces=g,m.names=[],m.skips=[];const R=("string"==typeof g?g:"").split(/[\s,]+/),N=R.length;for(v=0;v<N;v++)!R[v]||("-"===(g=R[v].replace(/\*/g,".*?"))[0]?m.skips.push(new RegExp("^"+g.slice(1)+"$")):m.names.push(new RegExp("^"+g+"$")))},m.enabled=function _(g){if("*"===g[g.length-1])return!0;let v,R;for(v=0,R=m.skips.length;v<R;v++)if(m.skips[v].test(g))return!1;for(v=0,R=m.names.length;v<R;v++)if(m.names[v].test(g))return!0;return!1},m.humanize=p(75592),m.destroy=function x(){w.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(S).forEach(g=>{m[g]=S[g]}),m.names=[],m.skips=[],m.formatters={},m.selectColor=function I(g){let v=0;for(let R=0;R<g.length;R++)v=(v<<5)-v+g.charCodeAt(R),v|=0;return m.colors[Math.abs(v)%m.colors.length]},m.enable(m.load()),m}},42961:re=>{"use strict";const p=()=>{const I=new Error("Delay aborted");return I.name="AbortError",I},w=({clearTimeout:I,setTimeout:m,willResolve:l})=>(h,{value:y,signal:_}={})=>{if(_&&_.aborted)return Promise.reject(p());let A,O,x;const g=I||clearTimeout,v=()=>{g(A),x(p())},N=new Promise((D,k)=>{O=()=>{_&&_.removeEventListener("abort",v),l?D(y):k(y)},x=k,A=(m||setTimeout)(O,h)});return _&&_.addEventListener("abort",v,{once:!0}),N.clear=()=>{g(A),A=null,O()},N},d=I=>{const m=w({...I,willResolve:!0});return m.reject=w({...I,willResolve:!1}),m.range=(l,h,y)=>m(((I,m)=>Math.floor(Math.random()*(m-I+1)+I))(l,h),y),m},S=d();S.createWithTimers=d,re.exports=S,re.exports.default=S},39755:re=>{"use strict";function J(p,d){d=d||{},this._head=0,this._tail=0,this._capacity=d.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(p)&&this._fromArray(p)}J.prototype.peekAt=function(w){var d=w;if(d===(0|d)){var S=this.size();if(!(d>=S||d<-S))return d<0&&(d+=S),this._list[d=this._head+d&this._capacityMask]}},J.prototype.get=function(w){return this.peekAt(w)},J.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},J.prototype.peekFront=function(){return this.peek()},J.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(J.prototype,"length",{get:function(){return this.size()}}),J.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},J.prototype.unshift=function(w){return void 0===w?this.size():(this._head=this._head-1+this._list.length&this._capacityMask,this._list[this._head]=w,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail))},J.prototype.shift=function(){var w=this._head;if(w!==this._tail){var d=this._list[w];return this._list[w]=void 0,this._head=w+1&this._capacityMask,w<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),d}},J.prototype.push=function(w){if(void 0===w)return this.size();var d=this._tail;return this._list[d]=w,this._tail=d+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},J.prototype.pop=function(){var w=this._tail;if(w!==this._head){var d=this._list.length;this._tail=w-1+d&this._capacityMask;var S=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&w>1e4&&w<=d>>>2&&this._shrinkArray(),S}},J.prototype.removeOne=function(w){var d=w;if(d===(0|d)&&this._head!==this._tail){var S=this.size(),I=this._list.length;if(!(d>=S||d<-S)){d<0&&(d+=S);var l,m=this._list[d=this._head+d&this._capacityMask];if(w<S/2){for(l=w;l>0;l--)this._list[d]=this._list[d=d-1+I&this._capacityMask];this._list[d]=void 0,this._head=this._head+1+I&this._capacityMask}else{for(l=S-1-w;l>0;l--)this._list[d]=this._list[d=d+1+I&this._capacityMask];this._list[d]=void 0,this._tail=this._tail-1+I&this._capacityMask}return m}}},J.prototype.remove=function(w,d){var I,S=w,m=d;if(S===(0|S)&&this._head!==this._tail){var l=this.size(),h=this._list.length;if(!(S>=l||S<-l||d<1)){if(S<0&&(S+=l),1===d||!d)return(I=new Array(1))[0]=this.removeOne(S),I;if(0===S&&S+d>=l)return I=this.toArray(),this.clear(),I;var y;for(S+d>l&&(d=l-S),I=new Array(d),y=0;y<d;y++)I[y]=this._list[this._head+S+y&this._capacityMask];if(S=this._head+S&this._capacityMask,w+d===l){for(this._tail=this._tail-d+h&this._capacityMask,y=d;y>0;y--)this._list[S=S+1+h&this._capacityMask]=void 0;return I}if(0===w){for(this._head=this._head+d+h&this._capacityMask,y=d-1;y>0;y--)this._list[S=S+1+h&this._capacityMask]=void 0;return I}if(S<l/2){for(this._head=this._head+w+d+h&this._capacityMask,y=w;y>0;y--)this.unshift(this._list[S=S-1+h&this._capacityMask]);for(S=this._head-1+h&this._capacityMask;m>0;)this._list[S=S-1+h&this._capacityMask]=void 0,m--;w<0&&(this._tail=S)}else{for(this._tail=S,S=S+d+h&this._capacityMask,y=l-(d+w);y>0;y--)this.push(this._list[S++]);for(S=this._tail;m>0;)this._list[S=S+1+h&this._capacityMask]=void 0,m--}return this._head<2&&this._tail>1e4&&this._tail<=h>>>2&&this._shrinkArray(),I}}},J.prototype.splice=function(w,d){var S=w;if(S===(0|S)){var I=this.size();if(S<0&&(S+=I),!(S>I)){if(arguments.length>2){var m,l,h,y=arguments.length,_=this._list.length,A=2;if(!I||S<I/2){for(l=new Array(S),m=0;m<S;m++)l[m]=this._list[this._head+m&this._capacityMask];for(0===d?(h=[],S>0&&(this._head=this._head+S+_&this._capacityMask)):(h=this.remove(S,d),this._head=this._head+S+_&this._capacityMask);y>A;)this.unshift(arguments[--y]);for(m=S;m>0;m--)this.unshift(l[m-1])}else{var O=(l=new Array(I-(S+d))).length;for(m=0;m<O;m++)l[m]=this._list[this._head+S+d+m&this._capacityMask];for(0===d?(h=[],S!=I&&(this._tail=this._head+S+_&this._capacityMask)):(h=this.remove(S,d),this._tail=this._tail-O+_&this._capacityMask);A<y;)this.push(arguments[A++]);for(m=0;m<O;m++)this.push(l[m])}return h}return this.remove(S,d)}}},J.prototype.clear=function(){this._head=0,this._tail=0},J.prototype.isEmpty=function(){return this._head===this._tail},J.prototype.toArray=function(){return this._copyArray(!1)},J.prototype._fromArray=function(w){for(var d=0;d<w.length;d++)this.push(w[d])},J.prototype._copyArray=function(w){var m,d=[],S=this._list,I=S.length;if(w||this._head>this._tail){for(m=this._head;m<I;m++)d.push(S[m]);for(m=0;m<this._tail;m++)d.push(S[m])}else for(m=this._head;m<this._tail;m++)d.push(S[m]);return d},J.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1},J.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},re.exports=J},79289:function(re){re.exports=function(w,d,S,I,m){for(d=d.split?d.split("."):d,I=0;I<d.length;I++)w=w?w[d[I]]:m;return w===m?S:w}},46436:re=>{"use strict";function J(w,d){for(const S in d)Object.defineProperty(w,S,{value:d[S],enumerable:!0,configurable:!0});return w}re.exports=function p(w,d,S){if(!w||"string"==typeof w)throw new TypeError("Please pass an Error to err-code");S||(S={}),"object"==typeof d&&(S=d,d=""),d&&(S.code=d);try{return J(w,S)}catch{S.message=w.message,S.stack=w.stack;const m=function(){};return m.prototype=Object.create(Object.getPrototypeOf(w)),J(new m,S)}}},36883:(re,J,p)=>{"use strict";const d=p(48686);J.zN=d.EventIterator},48686:(re,J,p)=>{"use strict";var w=p(28069);Object.defineProperty(J,"__esModule",{value:!0});class d{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(m){if(this.isStopped)return;const l={value:m,done:!1};if(this.pullQueue.length){const h=this.pullQueue.shift();h&&h.resolve(l)}else this.pushQueue.push(Promise.resolve(l)),void 0!==this.highWaterMark&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():w&&w.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(const m of this.pullQueue)m.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(m){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(const l of this.pullQueue)l.reject(m);this.pullQueue.length=0}else{const l=Promise.reject(m);l.catch(()=>{}),this.pushQueue.push(l)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:m=>{const l=this.pushQueue.shift();return l?(void 0!==this.lowWaterMark&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),l):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((h,y)=>{this.pullQueue.push({resolve:h,reject:y})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}}class S{constructor(m,{highWaterMark:l=100,lowWaterMark:h=1}={}){const y=new d;y.highWaterMark=l,y.lowWaterMark=h,y.removeCallback=m({push:_=>y.push(_),stop:()=>y.stop(),fail:_=>y.fail(_),on:(_,A)=>{y.eventHandlers[_]=A}})||(()=>{}),this[Symbol.asyncIterator]=()=>y[Symbol.asyncIterator](),Object.freeze(this)}}J.EventIterator=S,J.default=S},12375:re=>{"use strict";var J=Object.prototype.hasOwnProperty,p="~";function w(){}function d(l,h,y){this.fn=l,this.context=h,this.once=y||!1}function S(l,h,y,_,A){if("function"!=typeof y)throw new TypeError("The listener must be a function");var O=new d(y,_||l,A),x=p?p+h:h;return l._events[x]?l._events[x].fn?l._events[x]=[l._events[x],O]:l._events[x].push(O):(l._events[x]=O,l._eventsCount++),l}function I(l,h){0==--l._eventsCount?l._events=new w:delete l._events[h]}function m(){this._events=new w,this._eventsCount=0}Object.create&&(w.prototype=Object.create(null),(new w).__proto__||(p=!1)),m.prototype.eventNames=function(){var y,_,h=[];if(0===this._eventsCount)return h;for(_ in y=this._events)J.call(y,_)&&h.push(p?_.slice(1):_);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(y)):h},m.prototype.listeners=function(h){var _=this._events[p?p+h:h];if(!_)return[];if(_.fn)return[_.fn];for(var A=0,O=_.length,x=new Array(O);A<O;A++)x[A]=_[A].fn;return x},m.prototype.listenerCount=function(h){var _=this._events[p?p+h:h];return _?_.fn?1:_.length:0},m.prototype.emit=function(h,y,_,A,O,x){var g=p?p+h:h;if(!this._events[g])return!1;var N,D,v=this._events[g],R=arguments.length;if(v.fn){switch(v.once&&this.removeListener(h,v.fn,void 0,!0),R){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,y),!0;case 3:return v.fn.call(v.context,y,_),!0;case 4:return v.fn.call(v.context,y,_,A),!0;case 5:return v.fn.call(v.context,y,_,A,O),!0;case 6:return v.fn.call(v.context,y,_,A,O,x),!0}for(D=1,N=new Array(R-1);D<R;D++)N[D-1]=arguments[D];v.fn.apply(v.context,N)}else{var j,k=v.length;for(D=0;D<k;D++)switch(v[D].once&&this.removeListener(h,v[D].fn,void 0,!0),R){case 1:v[D].fn.call(v[D].context);break;case 2:v[D].fn.call(v[D].context,y);break;case 3:v[D].fn.call(v[D].context,y,_);break;case 4:v[D].fn.call(v[D].context,y,_,A);break;default:if(!N)for(j=1,N=new Array(R-1);j<R;j++)N[j-1]=arguments[j];v[D].fn.apply(v[D].context,N)}}return!0},m.prototype.on=function(h,y,_){return S(this,h,y,_,!1)},m.prototype.once=function(h,y,_){return S(this,h,y,_,!0)},m.prototype.removeListener=function(h,y,_,A){var O=p?p+h:h;if(!this._events[O])return this;if(!y)return I(this,O),this;var x=this._events[O];if(x.fn)x.fn===y&&(!A||x.once)&&(!_||x.context===_)&&I(this,O);else{for(var g=0,v=[],R=x.length;g<R;g++)(x[g].fn!==y||A&&!x[g].once||_&&x[g].context!==_)&&v.push(x[g]);v.length?this._events[O]=1===v.length?v[0]:v:I(this,O)}return this},m.prototype.removeAllListeners=function(h){var y;return h?this._events[y=p?p+h:h]&&I(this,y):(this._events=new w,this._eventsCount=0),this},m.prototype.off=m.prototype.removeListener,m.prototype.addListener=m.prototype.on,m.prefixed=p,m.EventEmitter=m,re.exports=m},47190:re=>{re.exports=class{constructor(p){if(!(p>0)||0!=(p-1&p))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(p),this.mask=p-1,this.top=0,this.btm=0,this.next=null}push(p){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=p,this.top=this.top+1&this.mask,!0)}shift(){const p=this.buffer[this.btm];if(void 0!==p)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,p}peek(){return this.buffer[this.btm]}isEmpty(){return void 0===this.buffer[this.btm]}}},30766:(re,J,p)=>{const w=p(47190);re.exports=class{constructor(S){this.hwm=S||16,this.head=new w(this.hwm),this.tail=this.head}push(S){this.head.push(S)||(this.head=this.head.next=new w(2*this.head.buffer.length),this.head.push(S))}shift(){const S=this.tail.shift();if(void 0===S&&this.tail.next){const I=this.tail.next;return this.tail.next=null,this.tail=I,this.tail.shift()}return S}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}},81828:(re,J)=>{"use strict";function p(w,d=p.BASE){const S=w.length;for(let I=0;I<S;I++)d^=w.charCodeAt(I),d+=(d<<1)+(d<<4)+(d<<7)+(d<<8)+(d<<24);return d>>>0}Object.defineProperty(J,"__esModule",{value:!0}),p.BASE=2166136261,J.default=p,re.exports=p},96156:re=>{re.exports=function(J){if(!J)throw Error("hashlru must have a max value, of type number, greater than 0");var p=0,w=Object.create(null),d=Object.create(null);function S(I,m){w[I]=m,++p>=J&&(p=0,d=w,w=Object.create(null))}return{has:function(I){return void 0!==w[I]||void 0!==d[I]},remove:function(I){void 0!==w[I]&&(w[I]=void 0),void 0!==d[I]&&(d[I]=void 0)},get:function(I){var m=w[I];return void 0!==m?m:void 0!==(m=d[I])?(S(I,m),m):void 0},set:function(I,m){void 0!==w[I]?w[I]=m:S(I,m)},clear:function(){w=Object.create(null),d=Object.create(null)}}}},8950:function(re){!function(J){"use strict";const p="(0?\\d+|0x[a-f0-9]+)",w={fourOctet:new RegExp(`^${p}\\.${p}\\.${p}\\.${p}$`,"i"),threeOctet:new RegExp(`^${p}\\.${p}\\.${p}$`,"i"),twoOctet:new RegExp(`^${p}\\.${p}$`,"i"),longValue:new RegExp(`^${p}$`,"i")},d=new RegExp("^0[0-7]+$","i"),S=new RegExp("^0x[a-f0-9]+$","i"),I="%[0-9a-z]{1,}",m="(?:[0-9a-f]+::?)+",l={zoneIndex:new RegExp(I,"i"),native:new RegExp(`^(::)?(${m})?([0-9a-f]+)?(::)?(${I})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${p}\\.${p}\\.${p}\\.${p}(${I})?)$`,"i"),transitional:new RegExp(`^((?:${m})|(?:::)(?:${m})?)${p}\\.${p}\\.${p}\\.${p}(${I})?$`,"i")};function h(x,g){if(x.indexOf("::")!==x.lastIndexOf("::"))return null;let D,k,v=0,R=-1,N=(x.match(l.zoneIndex)||[])[0];for(N&&(N=N.substring(1),x=x.replace(/%.+$/,""));(R=x.indexOf(":",R+1))>=0;)v++;if("::"===x.substr(0,2)&&v--,"::"===x.substr(-2,2)&&v--,v>g)return null;for(k=g-v,D=":";k--;)D+="0:";return":"===(x=x.replace("::",D))[0]&&(x=x.slice(1)),":"===x[x.length-1]&&(x=x.slice(0,-1)),{parts:g=function(){const j=x.split(":"),Q=[];for(let L=0;L<j.length;L++)Q.push(parseInt(j[L],16));return Q}(),zoneId:N}}function y(x,g,v,R){if(x.length!==g.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let D,N=0;for(;R>0;){if(D=v-R,D<0&&(D=0),x[N]>>D!=g[N]>>D)return!1;R-=v,N+=1}return!0}function _(x){if(S.test(x))return parseInt(x,16);if("0"===x[0]&&!isNaN(parseInt(x[1],10))){if(d.test(x))return parseInt(x,8);throw new Error(`ipaddr: cannot parse ${x} as octal`)}return parseInt(x,10)}function A(x,g){for(;x.length<g;)x=`0${x}`;return x}const O={};O.IPv4=function(){function x(g){if(4!==g.length)throw new Error("ipaddr: ipv4 octet count should be 4");let v,R;for(v=0;v<g.length;v++)if(R=g[v],!(0<=R&&R<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=g}return x.prototype.SpecialRanges={unspecified:[[new x([0,0,0,0]),8]],broadcast:[[new x([255,255,255,255]),32]],multicast:[[new x([224,0,0,0]),4]],linkLocal:[[new x([169,254,0,0]),16]],loopback:[[new x([127,0,0,0]),8]],carrierGradeNat:[[new x([100,64,0,0]),10]],private:[[new x([10,0,0,0]),8],[new x([172,16,0,0]),12],[new x([192,168,0,0]),16]],reserved:[[new x([192,0,0,0]),24],[new x([192,0,2,0]),24],[new x([192,88,99,0]),24],[new x([198,51,100,0]),24],[new x([203,0,113,0]),24],[new x([240,0,0,0]),4]]},x.prototype.kind=function(){return"ipv4"},x.prototype.match=function(g,v){let R;if(void 0===v&&(R=g,g=R[0],v=R[1]),"ipv4"!==g.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return y(this.octets,g.octets,8,v)},x.prototype.prefixLengthFromSubnetMask=function(){let g=0,v=!1;const R={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let N,D,k;for(N=3;N>=0;N-=1){if(D=this.octets[N],!(D in R))return null;if(k=R[D],v&&0!==k)return null;8!==k&&(v=!0),g+=k}return 32-g},x.prototype.range=function(){return O.subnetMatch(this,this.SpecialRanges)},x.prototype.toByteArray=function(){return this.octets.slice(0)},x.prototype.toIPv4MappedAddress=function(){return O.IPv6.parse(`::ffff:${this.toString()}`)},x.prototype.toNormalizedString=function(){return this.toString()},x.prototype.toString=function(){return this.octets.join(".")},x}(),O.IPv4.broadcastAddressFromCIDR=function(x){try{const g=this.parseCIDR(x),v=g[0].toByteArray(),R=this.subnetMaskFromPrefixLength(g[1]).toByteArray(),N=[];let D=0;for(;D<4;)N.push(parseInt(v[D],10)|255^parseInt(R[D],10)),D++;return new this(N)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},O.IPv4.isIPv4=function(x){return null!==this.parser(x)},O.IPv4.isValid=function(x){try{return new this(this.parser(x)),!0}catch{return!1}},O.IPv4.isValidFourPartDecimal=function(x){return!(!O.IPv4.isValid(x)||!x.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},O.IPv4.networkAddressFromCIDR=function(x){let g,v,R,N,D;try{for(g=this.parseCIDR(x),R=g[0].toByteArray(),D=this.subnetMaskFromPrefixLength(g[1]).toByteArray(),N=[],v=0;v<4;)N.push(parseInt(R[v],10)&parseInt(D[v],10)),v++;return new this(N)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},O.IPv4.parse=function(x){const g=this.parser(x);if(null===g)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(g)},O.IPv4.parseCIDR=function(x){let g;if(g=x.match(/^(.+)\/(\d+)$/)){const v=parseInt(g[2]);if(v>=0&&v<=32){const R=[this.parse(g[1]),v];return Object.defineProperty(R,"toString",{value:function(){return this.join("/")}}),R}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},O.IPv4.parser=function(x){let g,v,R;if(g=x.match(w.fourOctet))return function(){const N=g.slice(1,6),D=[];for(let k=0;k<N.length;k++)v=N[k],D.push(_(v));return D}();if(g=x.match(w.longValue)){if(R=_(g[1]),R>4294967295||R<0)throw new Error("ipaddr: address outside defined range");return function(){const N=[];let D;for(D=0;D<=24;D+=8)N.push(R>>D&255);return N}().reverse()}return(g=x.match(w.twoOctet))?function(){const N=g.slice(1,4),D=[];if(R=_(N[1]),R>16777215||R<0)throw new Error("ipaddr: address outside defined range");return D.push(_(N[0])),D.push(R>>16&255),D.push(R>>8&255),D.push(255&R),D}():(g=x.match(w.threeOctet))?function(){const N=g.slice(1,5),D=[];if(R=_(N[2]),R>65535||R<0)throw new Error("ipaddr: address outside defined range");return D.push(_(N[0])),D.push(_(N[1])),D.push(R>>8&255),D.push(255&R),D}():null},O.IPv4.subnetMaskFromPrefixLength=function(x){if((x=parseInt(x))<0||x>32)throw new Error("ipaddr: invalid IPv4 prefix length");const g=[0,0,0,0];let v=0;const R=Math.floor(x/8);for(;v<R;)g[v]=255,v++;return R<4&&(g[R]=Math.pow(2,x%8)-1<<8-x%8),new this(g)},O.IPv6=function(){function x(g,v){let R,N;if(16===g.length)for(this.parts=[],R=0;R<=14;R+=2)this.parts.push(g[R]<<8|g[R+1]);else{if(8!==g.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=g}for(R=0;R<this.parts.length;R++)if(N=this.parts[R],!(0<=N&&N<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");v&&(this.zoneId=v)}return x.prototype.SpecialRanges={unspecified:[new x([0,0,0,0,0,0,0,0]),128],linkLocal:[new x([65152,0,0,0,0,0,0,0]),10],multicast:[new x([65280,0,0,0,0,0,0,0]),8],loopback:[new x([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new x([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new x([0,0,0,0,0,65535,0,0]),96],rfc6145:[new x([0,0,0,0,65535,0,0,0]),96],rfc6052:[new x([100,65435,0,0,0,0,0,0]),96],"6to4":[new x([8194,0,0,0,0,0,0,0]),16],teredo:[new x([8193,0,0,0,0,0,0,0]),32],reserved:[[new x([8193,3512,0,0,0,0,0,0]),32]]},x.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},x.prototype.kind=function(){return"ipv6"},x.prototype.match=function(g,v){let R;if(void 0===v&&(R=g,g=R[0],v=R[1]),"ipv6"!==g.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return y(this.parts,g.parts,16,v)},x.prototype.prefixLengthFromSubnetMask=function(){let g=0,v=!1;const R={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let N,D;for(let k=7;k>=0;k-=1){if(N=this.parts[k],!(N in R))return null;if(D=R[N],v&&0!==D)return null;16!==D&&(v=!0),g+=D}return 128-g},x.prototype.range=function(){return O.subnetMatch(this,this.SpecialRanges)},x.prototype.toByteArray=function(){let g;const v=[],R=this.parts;for(let N=0;N<R.length;N++)g=R[N],v.push(g>>8),v.push(255&g);return v},x.prototype.toFixedLengthString=function(){const g=function(){const R=[];for(let N=0;N<this.parts.length;N++)R.push(A(this.parts[N].toString(16),4));return R}.call(this).join(":");let v="";return this.zoneId&&(v=`%${this.zoneId}`),g+v},x.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const g=this.parts.slice(-2),v=g[0],R=g[1];return new O.IPv4([v>>8,255&v,R>>8,255&R])},x.prototype.toNormalizedString=function(){const g=function(){const R=[];for(let N=0;N<this.parts.length;N++)R.push(this.parts[N].toString(16));return R}.call(this).join(":");let v="";return this.zoneId&&(v=`%${this.zoneId}`),g+v},x.prototype.toRFC5952String=function(){const g=/((^|:)(0(:|$)){2,})/g,v=this.toNormalizedString();let D,R=0,N=-1;for(;D=g.exec(v);)D[0].length>N&&(R=D.index,N=D[0].length);return N<0?v:`${v.substring(0,R)}::${v.substring(R+N)}`},x.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},x}(),O.IPv6.broadcastAddressFromCIDR=function(x){try{const g=this.parseCIDR(x),v=g[0].toByteArray(),R=this.subnetMaskFromPrefixLength(g[1]).toByteArray(),N=[];let D=0;for(;D<16;)N.push(parseInt(v[D],10)|255^parseInt(R[D],10)),D++;return new this(N)}catch(g){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${g})`)}},O.IPv6.isIPv6=function(x){return null!==this.parser(x)},O.IPv6.isValid=function(x){if("string"==typeof x&&-1===x.indexOf(":"))return!1;try{const g=this.parser(x);return new this(g.parts,g.zoneId),!0}catch{return!1}},O.IPv6.networkAddressFromCIDR=function(x){let g,v,R,N,D;try{for(g=this.parseCIDR(x),R=g[0].toByteArray(),D=this.subnetMaskFromPrefixLength(g[1]).toByteArray(),N=[],v=0;v<16;)N.push(parseInt(R[v],10)&parseInt(D[v],10)),v++;return new this(N)}catch(k){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${k})`)}},O.IPv6.parse=function(x){const g=this.parser(x);if(null===g.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(g.parts,g.zoneId)},O.IPv6.parseCIDR=function(x){let g,v,R;if((v=x.match(/^(.+)\/(\d+)$/))&&(g=parseInt(v[2]),g>=0&&g<=128))return R=[this.parse(v[1]),g],Object.defineProperty(R,"toString",{value:function(){return this.join("/")}}),R;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},O.IPv6.parser=function(x){let g,v,R,N,D,k;if(R=x.match(l.deprecatedTransitional))return this.parser(`::ffff:${R[1]}`);if(l.native.test(x))return h(x,8);if((R=x.match(l.transitional))&&(k=R[6]||"",g=h(R[1].slice(0,-1)+k,6),g.parts)){for(D=[parseInt(R[2]),parseInt(R[3]),parseInt(R[4]),parseInt(R[5])],v=0;v<D.length;v++)if(N=D[v],!(0<=N&&N<=255))return null;return g.parts.push(D[0]<<8|D[1]),g.parts.push(D[2]<<8|D[3]),{parts:g.parts,zoneId:g.zoneId}}return null},O.IPv6.subnetMaskFromPrefixLength=function(x){if((x=parseInt(x))<0||x>128)throw new Error("ipaddr: invalid IPv6 prefix length");const g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let v=0;const R=Math.floor(x/8);for(;v<R;)g[v]=255,v++;return R<16&&(g[R]=Math.pow(2,x%8)-1<<8-x%8),new this(g)},O.fromByteArray=function(x){const g=x.length;if(4===g)return new O.IPv4(x);if(16===g)return new O.IPv6(x);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},O.isValid=function(x){return O.IPv6.isValid(x)||O.IPv4.isValid(x)},O.parse=function(x){if(O.IPv6.isValid(x))return O.IPv6.parse(x);if(O.IPv4.isValid(x))return O.IPv4.parse(x);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},O.parseCIDR=function(x){try{return O.IPv6.parseCIDR(x)}catch{try{return O.IPv4.parseCIDR(x)}catch{throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},O.process=function(x){const g=this.parse(x);return"ipv6"===g.kind()&&g.isIPv4MappedAddress()?g.toIPv4Address():g},O.subnetMatch=function(x,g,v){let R,N,D,k;for(N in null==v&&(v="unicast"),g)if(Object.prototype.hasOwnProperty.call(g,N))for(D=g[N],D[0]&&!(D[0]instanceof Array)&&(D=[D]),R=0;R<D.length;R++)if(k=D[R],x.kind()===k[0].kind()&&x.match.apply(x,k))return N;return v},re.exports?re.exports=O:J.ipaddr=O}(this)},45951:(re,J,p)=>{"use strict";re.exports=p(39930)},39930:(re,J,p)=>{"use strict";var w=J;function d(){w.util._configure(),w.Writer._configure(w.BufferWriter),w.Reader._configure(w.BufferReader)}w.build="minimal",w.Writer=p(18790),w.BufferWriter=p(33544),w.Reader=p(3377),w.BufferReader=p(35858),w.util=p(60737),w.rpc=p(48802),w.roots=p(82227),w.configure=d,d()},3377:(re,J,p)=>{"use strict";re.exports=l;var d,w=p(60737),S=w.LongBits,I=w.utf8;function m(x,g){return RangeError("index out of range: "+x.pos+" + "+(g||1)+" > "+x.len)}function l(x){this.buf=x,this.pos=0,this.len=x.length}var g,h=typeof Uint8Array<"u"?function(g){if(g instanceof Uint8Array||Array.isArray(g))return new l(g);throw Error("illegal buffer")}:function(g){if(Array.isArray(g))return new l(g);throw Error("illegal buffer")},y=function(){return w.Buffer?function(v){return(l.create=function(N){return w.Buffer.isBuffer(N)?new d(N):h(N)})(v)}:h};function _(){var x=new S(0,0),g=0;if(!(this.len-this.pos>4)){for(;g<3;++g){if(this.pos>=this.len)throw m(this);if(x.lo=(x.lo|(127&this.buf[this.pos])<<7*g)>>>0,this.buf[this.pos++]<128)return x}return x.lo=(x.lo|(127&this.buf[this.pos++])<<7*g)>>>0,x}for(;g<4;++g)if(x.lo=(x.lo|(127&this.buf[this.pos])<<7*g)>>>0,this.buf[this.pos++]<128)return x;if(x.lo=(x.lo|(127&this.buf[this.pos])<<28)>>>0,x.hi=(x.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return x;if(g=0,this.len-this.pos>4){for(;g<5;++g)if(x.hi=(x.hi|(127&this.buf[this.pos])<<7*g+3)>>>0,this.buf[this.pos++]<128)return x}else for(;g<5;++g){if(this.pos>=this.len)throw m(this);if(x.hi=(x.hi|(127&this.buf[this.pos])<<7*g+3)>>>0,this.buf[this.pos++]<128)return x}throw Error("invalid varint encoding")}function A(x,g){return(x[g-4]|x[g-3]<<8|x[g-2]<<16|x[g-1]<<24)>>>0}function O(){if(this.pos+8>this.len)throw m(this,8);return new S(A(this.buf,this.pos+=4),A(this.buf,this.pos+=4))}l.create=y(),l.prototype._slice=w.Array.prototype.subarray||w.Array.prototype.slice,l.prototype.uint32=(g=4294967295,function(){if(g=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(g=(g|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(g=(g|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(g=(g|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(g=(g|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return g;if((this.pos+=5)>this.len)throw this.pos=this.len,m(this,10);return g}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var g=this.uint32();return g>>>1^-(1&g)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw m(this,4);return A(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw m(this,4);return 0|A(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw m(this,4);var g=w.float.readFloatLE(this.buf,this.pos);return this.pos+=4,g},l.prototype.double=function(){if(this.pos+8>this.len)throw m(this,4);var g=w.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,g},l.prototype.bytes=function(){var g=this.uint32(),v=this.pos,R=this.pos+g;if(R>this.len)throw m(this,g);return this.pos+=g,Array.isArray(this.buf)?this.buf.slice(v,R):v===R?new this.buf.constructor(0):this._slice.call(this.buf,v,R)},l.prototype.string=function(){var g=this.bytes();return I.read(g,0,g.length)},l.prototype.skip=function(g){if("number"==typeof g){if(this.pos+g>this.len)throw m(this,g);this.pos+=g}else do{if(this.pos>=this.len)throw m(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(x){switch(x){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(x=7&this.uint32());)this.skipType(x);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+x+" at offset "+this.pos)}return this},l._configure=function(x){d=x,l.create=y(),d._configure();var g=w.Long?"toLong":"toNumber";w.merge(l.prototype,{int64:function(){return _.call(this)[g](!1)},uint64:function(){return _.call(this)[g](!0)},sint64:function(){return _.call(this).zzDecode()[g](!1)},fixed64:function(){return O.call(this)[g](!0)},sfixed64:function(){return O.call(this)[g](!1)}})}},35858:(re,J,p)=>{"use strict";re.exports=S;var w=p(3377);(S.prototype=Object.create(w.prototype)).constructor=S;var d=p(60737);function S(I){w.call(this,I)}S._configure=function(){d.Buffer&&(S.prototype._slice=d.Buffer.prototype.slice)},S.prototype.string=function(){var m=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+m,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+m,this.len))},S._configure()},82227:re=>{"use strict";re.exports={}},48802:(re,J,p)=>{"use strict";J.Service=p(26051)},26051:(re,J,p)=>{"use strict";re.exports=d;var w=p(60737);function d(S,I,m){if("function"!=typeof S)throw TypeError("rpcImpl must be a function");w.EventEmitter.call(this),this.rpcImpl=S,this.requestDelimited=Boolean(I),this.responseDelimited=Boolean(m)}(d.prototype=Object.create(w.EventEmitter.prototype)).constructor=d,d.prototype.rpcCall=function S(I,m,l,h,y){if(!h)throw TypeError("request must be specified");var _=this;if(!y)return w.asPromise(S,_,I,m,l,h);if(_.rpcImpl)try{return _.rpcImpl(I,m[_.requestDelimited?"encodeDelimited":"encode"](h).finish(),function(O,x){if(O)return _.emit("error",O,I),y(O);if(null!==x){if(!(x instanceof l))try{x=l[_.responseDelimited?"decodeDelimited":"decode"](x)}catch(g){return _.emit("error",g,I),y(g)}return _.emit("data",x,I),y(null,x)}_.end(!0)})}catch(A){return _.emit("error",A,I),void setTimeout(function(){y(A)},0)}else setTimeout(function(){y(Error("already ended"))},0)},d.prototype.end=function(I){return this.rpcImpl&&(I||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},49532:(re,J,p)=>{"use strict";re.exports=d;var w=p(60737);function d(l,h){this.lo=l>>>0,this.hi=h>>>0}var S=d.zero=new d(0,0);S.toNumber=function(){return 0},S.zzEncode=S.zzDecode=function(){return this},S.length=function(){return 1};var I=d.zeroHash="\0\0\0\0\0\0\0\0";d.fromNumber=function(h){if(0===h)return S;var y=h<0;y&&(h=-h);var _=h>>>0,A=(h-_)/4294967296>>>0;return y&&(A=~A>>>0,_=~_>>>0,++_>4294967295&&(_=0,++A>4294967295&&(A=0))),new d(_,A)},d.from=function(h){if("number"==typeof h)return d.fromNumber(h);if(w.isString(h)){if(!w.Long)return d.fromNumber(parseInt(h,10));h=w.Long.fromString(h)}return h.low||h.high?new d(h.low>>>0,h.high>>>0):S},d.prototype.toNumber=function(h){if(!h&&this.hi>>>31){var y=1+~this.lo>>>0,_=~this.hi>>>0;return y||(_=_+1>>>0),-(y+4294967296*_)}return this.lo+4294967296*this.hi},d.prototype.toLong=function(h){return w.Long?new w.Long(0|this.lo,0|this.hi,Boolean(h)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(h)}};var m=String.prototype.charCodeAt;d.fromHash=function(h){return h===I?S:new d((m.call(h,0)|m.call(h,1)<<8|m.call(h,2)<<16|m.call(h,3)<<24)>>>0,(m.call(h,4)|m.call(h,5)<<8|m.call(h,6)<<16|m.call(h,7)<<24)>>>0)},d.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},d.prototype.zzEncode=function(){var h=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^h)>>>0,this.lo=(this.lo<<1^h)>>>0,this},d.prototype.zzDecode=function(){var h=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^h)>>>0,this.hi=(this.hi>>>1^h)>>>0,this},d.prototype.length=function(){var h=this.lo,y=(this.lo>>>28|this.hi<<4)>>>0,_=this.hi>>>24;return 0===_?0===y?h<16384?h<128?1:2:h<2097152?3:4:y<16384?y<128?5:6:y<2097152?7:8:_<128?9:10}},60737:function(re,J,p){"use strict";var w=p(40146),d=J;function S(m,l,h){for(var y=Object.keys(l),_=0;_<y.length;++_)(void 0===m[y[_]]||!h)&&(m[y[_]]=l[y[_]]);return m}function I(m){function l(h,y){if(!(this instanceof l))return new l(h,y);Object.defineProperty(this,"message",{get:function(){return h}}),Error.captureStackTrace?Error.captureStackTrace(this,l):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),y&&S(this,y)}return l.prototype=Object.create(Error.prototype,{constructor:{value:l,writable:!0,enumerable:!1,configurable:!0},name:{get:()=>m,set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),l}d.asPromise=p(18791),d.base64=p(5985),d.EventEmitter=p(68074),d.float=p(48170),d.inquire=p(91248),d.utf8=p(88178),d.pool=p(15759),d.LongBits=p(49532),d.isNode=Boolean(typeof w<"u"&&w&&w.process&&w.process.versions&&w.process.versions.node),d.global=d.isNode&&w||typeof window<"u"&&window||typeof self<"u"&&self||this,d.emptyArray=Object.freeze?Object.freeze([]):[],d.emptyObject=Object.freeze?Object.freeze({}):{},d.isInteger=Number.isInteger||function(l){return"number"==typeof l&&isFinite(l)&&Math.floor(l)===l},d.isString=function(l){return"string"==typeof l||l instanceof String},d.isObject=function(l){return l&&"object"==typeof l},d.isset=d.isSet=function(l,h){var y=l[h];return!(null==y||!l.hasOwnProperty(h))&&("object"!=typeof y||(Array.isArray(y)?y.length:Object.keys(y).length)>0)},d.Buffer=function(){try{var m=d.inquire("buffer").Buffer;return m.prototype.utf8Write?m:null}catch{return null}}(),d._Buffer_from=null,d._Buffer_allocUnsafe=null,d.newBuffer=function(l){return"number"==typeof l?d.Buffer?d._Buffer_allocUnsafe(l):new d.Array(l):d.Buffer?d._Buffer_from(l):typeof Uint8Array>"u"?l:new Uint8Array(l)},d.Array=typeof Uint8Array<"u"?Uint8Array:Array,d.Long=d.global.dcodeIO&&d.global.dcodeIO.Long||d.global.Long||d.inquire("long"),d.key2Re=/^true|false|0|1$/,d.key32Re=/^-?(?:0|[1-9][0-9]*)$/,d.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,d.longToHash=function(l){return l?d.LongBits.from(l).toHash():d.LongBits.zeroHash},d.longFromHash=function(l,h){var y=d.LongBits.fromHash(l);return d.Long?d.Long.fromBits(y.lo,y.hi,h):y.toNumber(Boolean(h))},d.merge=S,d.lcFirst=function(l){return l.charAt(0).toLowerCase()+l.substring(1)},d.newError=I,d.ProtocolError=I("ProtocolError"),d.oneOfGetter=function(l){for(var h={},y=0;y<l.length;++y)h[l[y]]=1;return function(){for(var _=Object.keys(this),A=_.length-1;A>-1;--A)if(1===h[_[A]]&&null!=this[_[A]])return _[A]}},d.oneOfSetter=function(l){return function(h){for(var y=0;y<l.length;++y)l[y]!==h&&delete this[l[y]]}},d.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},d._configure=function(){var m=d.Buffer;m?(d._Buffer_from=m.from!==Uint8Array.from&&m.from||function(h,y){return new m(h,y)},d._Buffer_allocUnsafe=m.allocUnsafe||function(h){return new m(h)}):d._Buffer_from=d._Buffer_allocUnsafe=null}},18790:(re,J,p)=>{"use strict";re.exports=_;var d,w=p(60737),S=w.LongBits,I=w.base64,m=w.utf8;function l(D,k,j){this.fn=D,this.len=k,this.next=void 0,this.val=j}function h(){}function y(D){this.head=D.head,this.tail=D.tail,this.len=D.len,this.next=D.states}function _(){this.len=0,this.head=new l(h,0,0),this.tail=this.head,this.states=null}var A=function(){return w.Buffer?function(){return(_.create=function(){return new d})()}:function(){return new _}};function O(D,k,j){k[j]=255&D}function g(D,k){this.len=D,this.next=void 0,this.val=k}function v(D,k,j){for(;D.hi;)k[j++]=127&D.lo|128,D.lo=(D.lo>>>7|D.hi<<25)>>>0,D.hi>>>=7;for(;D.lo>127;)k[j++]=127&D.lo|128,D.lo=D.lo>>>7;k[j++]=D.lo}function R(D,k,j){k[j]=255&D,k[j+1]=D>>>8&255,k[j+2]=D>>>16&255,k[j+3]=D>>>24}_.create=A(),_.alloc=function(k){return new w.Array(k)},w.Array!==Array&&(_.alloc=w.pool(_.alloc,w.Array.prototype.subarray)),_.prototype._push=function(k,j,Q){return this.tail=this.tail.next=new l(k,j,Q),this.len+=j,this},(g.prototype=Object.create(l.prototype)).fn=function x(D,k,j){for(;D>127;)k[j++]=127&D|128,D>>>=7;k[j]=D},_.prototype.uint32=function(k){return this.len+=(this.tail=this.tail.next=new g((k>>>=0)<128?1:k<16384?2:k<2097152?3:k<268435456?4:5,k)).len,this},_.prototype.int32=function(k){return k<0?this._push(v,10,S.fromNumber(k)):this.uint32(k)},_.prototype.sint32=function(k){return this.uint32((k<<1^k>>31)>>>0)},_.prototype.int64=_.prototype.uint64=function(k){var j=S.from(k);return this._push(v,j.length(),j)},_.prototype.sint64=function(k){var j=S.from(k).zzEncode();return this._push(v,j.length(),j)},_.prototype.bool=function(k){return this._push(O,1,k?1:0)},_.prototype.sfixed32=_.prototype.fixed32=function(k){return this._push(R,4,k>>>0)},_.prototype.sfixed64=_.prototype.fixed64=function(k){var j=S.from(k);return this._push(R,4,j.lo)._push(R,4,j.hi)},_.prototype.float=function(k){return this._push(w.float.writeFloatLE,4,k)},_.prototype.double=function(k){return this._push(w.float.writeDoubleLE,8,k)};var N=w.Array.prototype.set?function(k,j,Q){j.set(k,Q)}:function(k,j,Q){for(var L=0;L<k.length;++L)j[Q+L]=k[L]};_.prototype.bytes=function(k){var j=k.length>>>0;if(!j)return this._push(O,1,0);if(w.isString(k)){var Q=_.alloc(j=I.length(k));I.decode(k,Q,0),k=Q}return this.uint32(j)._push(N,j,k)},_.prototype.string=function(k){var j=m.length(k);return j?this.uint32(j)._push(m.write,j,k):this._push(O,1,0)},_.prototype.fork=function(){return this.states=new y(this),this.head=this.tail=new l(h,0,0),this.len=0,this},_.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(h,0,0),this.len=0),this},_.prototype.ldelim=function(){var k=this.head,j=this.tail,Q=this.len;return this.reset().uint32(Q),Q&&(this.tail.next=k.next,this.tail=j,this.len+=Q),this},_.prototype.finish=function(){for(var k=this.head.next,j=this.constructor.alloc(this.len),Q=0;k;)k.fn(k.val,j,Q),Q+=k.len,k=k.next;return j},_._configure=function(D){d=D,_.create=A(),d._configure()}},33544:(re,J,p)=>{"use strict";re.exports=S;var w=p(18790);(S.prototype=Object.create(w.prototype)).constructor=S;var d=p(60737);function S(){w.call(this)}function I(m,l,h){m.length<40?d.utf8.write(m,l,h):l.utf8Write?l.utf8Write(m,h):l.write(m,h)}S._configure=function(){S.alloc=d._Buffer_allocUnsafe,S.writeBytesBuffer=d.Buffer&&d.Buffer.prototype instanceof Uint8Array&&"set"===d.Buffer.prototype.set.name?function(l,h,y){h.set(l,y)}:function(l,h,y){if(l.copy)l.copy(h,y,0,l.length);else for(var _=0;_<l.length;)h[y++]=l[_++]}},S.prototype.bytes=function(l){d.isString(l)&&(l=d._Buffer_from(l,"base64"));var h=l.length>>>0;return this.uint32(h),h&&this._push(S.writeBytesBuffer,h,l),this},S.prototype.string=function(l){var h=d.Buffer.byteLength(l);return this.uint32(h),h&&this._push(I,h,l),this},S._configure()},35004:(re,J,p)=>{"use strict";re.exports=p(13946)},13946:(re,J,p)=>{"use strict";var w=J;function d(){w.util._configure(),w.Writer._configure(w.BufferWriter),w.Reader._configure(w.BufferReader)}w.build="minimal",w.Writer=p(64837),w.BufferWriter=p(94022),w.Reader=p(7359),w.BufferReader=p(37758),w.util=p(98462),w.rpc=p(11025),w.roots=p(76943),w.configure=d,d()},7359:(re,J,p)=>{"use strict";re.exports=l;var d,w=p(98462),S=w.LongBits,I=w.utf8;function m(x,g){return RangeError("index out of range: "+x.pos+" + "+(g||1)+" > "+x.len)}function l(x){this.buf=x,this.pos=0,this.len=x.length}var g,h=typeof Uint8Array<"u"?function(g){if(g instanceof Uint8Array||Array.isArray(g))return new l(g);throw Error("illegal buffer")}:function(g){if(Array.isArray(g))return new l(g);throw Error("illegal buffer")},y=function(){return w.Buffer?function(v){return(l.create=function(N){return w.Buffer.isBuffer(N)?new d(N):h(N)})(v)}:h};function _(){var x=new S(0,0),g=0;if(!(this.len-this.pos>4)){for(;g<3;++g){if(this.pos>=this.len)throw m(this);if(x.lo=(x.lo|(127&this.buf[this.pos])<<7*g)>>>0,this.buf[this.pos++]<128)return x}return x.lo=(x.lo|(127&this.buf[this.pos++])<<7*g)>>>0,x}for(;g<4;++g)if(x.lo=(x.lo|(127&this.buf[this.pos])<<7*g)>>>0,this.buf[this.pos++]<128)return x;if(x.lo=(x.lo|(127&this.buf[this.pos])<<28)>>>0,x.hi=(x.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return x;if(g=0,this.len-this.pos>4){for(;g<5;++g)if(x.hi=(x.hi|(127&this.buf[this.pos])<<7*g+3)>>>0,this.buf[this.pos++]<128)return x}else for(;g<5;++g){if(this.pos>=this.len)throw m(this);if(x.hi=(x.hi|(127&this.buf[this.pos])<<7*g+3)>>>0,this.buf[this.pos++]<128)return x}throw Error("invalid varint encoding")}function A(x,g){return(x[g-4]|x[g-3]<<8|x[g-2]<<16|x[g-1]<<24)>>>0}function O(){if(this.pos+8>this.len)throw m(this,8);return new S(A(this.buf,this.pos+=4),A(this.buf,this.pos+=4))}l.create=y(),l.prototype._slice=w.Array.prototype.subarray||w.Array.prototype.slice,l.prototype.uint32=(g=4294967295,function(){if(g=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(g=(g|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(g=(g|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(g=(g|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(g=(g|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return g;if((this.pos+=5)>this.len)throw this.pos=this.len,m(this,10);return g}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var g=this.uint32();return g>>>1^-(1&g)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw m(this,4);return A(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw m(this,4);return 0|A(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw m(this,4);var g=w.float.readFloatLE(this.buf,this.pos);return this.pos+=4,g},l.prototype.double=function(){if(this.pos+8>this.len)throw m(this,4);var g=w.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,g},l.prototype.bytes=function(){var g=this.uint32(),v=this.pos,R=this.pos+g;if(R>this.len)throw m(this,g);return this.pos+=g,Array.isArray(this.buf)?this.buf.slice(v,R):v===R?new this.buf.constructor(0):this._slice.call(this.buf,v,R)},l.prototype.string=function(){var g=this.bytes();return I.read(g,0,g.length)},l.prototype.skip=function(g){if("number"==typeof g){if(this.pos+g>this.len)throw m(this,g);this.pos+=g}else do{if(this.pos>=this.len)throw m(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(x){switch(x){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(x=7&this.uint32());)this.skipType(x);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+x+" at offset "+this.pos)}return this},l._configure=function(x){d=x,l.create=y(),d._configure();var g=w.Long?"toLong":"toNumber";w.merge(l.prototype,{int64:function(){return _.call(this)[g](!1)},uint64:function(){return _.call(this)[g](!0)},sint64:function(){return _.call(this).zzDecode()[g](!1)},fixed64:function(){return O.call(this)[g](!0)},sfixed64:function(){return O.call(this)[g](!1)}})}},37758:(re,J,p)=>{"use strict";re.exports=S;var w=p(7359);(S.prototype=Object.create(w.prototype)).constructor=S;var d=p(98462);function S(I){w.call(this,I)}S._configure=function(){d.Buffer&&(S.prototype._slice=d.Buffer.prototype.slice)},S.prototype.string=function(){var m=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+m,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+m,this.len))},S._configure()},76943:re=>{"use strict";re.exports={}},11025:(re,J,p)=>{"use strict";J.Service=p(94591)},94591:(re,J,p)=>{"use strict";re.exports=d;var w=p(98462);function d(S,I,m){if("function"!=typeof S)throw TypeError("rpcImpl must be a function");w.EventEmitter.call(this),this.rpcImpl=S,this.requestDelimited=Boolean(I),this.responseDelimited=Boolean(m)}(d.prototype=Object.create(w.EventEmitter.prototype)).constructor=d,d.prototype.rpcCall=function S(I,m,l,h,y){if(!h)throw TypeError("request must be specified");var _=this;if(!y)return w.asPromise(S,_,I,m,l,h);if(_.rpcImpl)try{return _.rpcImpl(I,m[_.requestDelimited?"encodeDelimited":"encode"](h).finish(),function(O,x){if(O)return _.emit("error",O,I),y(O);if(null!==x){if(!(x instanceof l))try{x=l[_.responseDelimited?"decodeDelimited":"decode"](x)}catch(g){return _.emit("error",g,I),y(g)}return _.emit("data",x,I),y(null,x)}_.end(!0)})}catch(A){return _.emit("error",A,I),void setTimeout(function(){y(A)},0)}else setTimeout(function(){y(Error("already ended"))},0)},d.prototype.end=function(I){return this.rpcImpl&&(I||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},77175:(re,J,p)=>{"use strict";re.exports=d;var w=p(98462);function d(l,h){this.lo=l>>>0,this.hi=h>>>0}var S=d.zero=new d(0,0);S.toNumber=function(){return 0},S.zzEncode=S.zzDecode=function(){return this},S.length=function(){return 1};var I=d.zeroHash="\0\0\0\0\0\0\0\0";d.fromNumber=function(h){if(0===h)return S;var y=h<0;y&&(h=-h);var _=h>>>0,A=(h-_)/4294967296>>>0;return y&&(A=~A>>>0,_=~_>>>0,++_>4294967295&&(_=0,++A>4294967295&&(A=0))),new d(_,A)},d.from=function(h){if("number"==typeof h)return d.fromNumber(h);if(w.isString(h)){if(!w.Long)return d.fromNumber(parseInt(h,10));h=w.Long.fromString(h)}return h.low||h.high?new d(h.low>>>0,h.high>>>0):S},d.prototype.toNumber=function(h){if(!h&&this.hi>>>31){var y=1+~this.lo>>>0,_=~this.hi>>>0;return y||(_=_+1>>>0),-(y+4294967296*_)}return this.lo+4294967296*this.hi},d.prototype.toLong=function(h){return w.Long?new w.Long(0|this.lo,0|this.hi,Boolean(h)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(h)}};var m=String.prototype.charCodeAt;d.fromHash=function(h){return h===I?S:new d((m.call(h,0)|m.call(h,1)<<8|m.call(h,2)<<16|m.call(h,3)<<24)>>>0,(m.call(h,4)|m.call(h,5)<<8|m.call(h,6)<<16|m.call(h,7)<<24)>>>0)},d.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},d.prototype.zzEncode=function(){var h=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^h)>>>0,this.lo=(this.lo<<1^h)>>>0,this},d.prototype.zzDecode=function(){var h=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^h)>>>0,this.hi=(this.hi>>>1^h)>>>0,this},d.prototype.length=function(){var h=this.lo,y=(this.lo>>>28|this.hi<<4)>>>0,_=this.hi>>>24;return 0===_?0===y?h<16384?h<128?1:2:h<2097152?3:4:y<16384?y<128?5:6:y<2097152?7:8:_<128?9:10}},98462:function(re,J,p){"use strict";var w=p(40146),d=J;function S(m,l,h){for(var y=Object.keys(l),_=0;_<y.length;++_)(void 0===m[y[_]]||!h)&&(m[y[_]]=l[y[_]]);return m}function I(m){function l(h,y){if(!(this instanceof l))return new l(h,y);Object.defineProperty(this,"message",{get:function(){return h}}),Error.captureStackTrace?Error.captureStackTrace(this,l):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),y&&S(this,y)}return l.prototype=Object.create(Error.prototype,{constructor:{value:l,writable:!0,enumerable:!1,configurable:!0},name:{get:()=>m,set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),l}d.asPromise=p(18791),d.base64=p(5985),d.EventEmitter=p(68074),d.float=p(48170),d.inquire=p(91248),d.utf8=p(88178),d.pool=p(15759),d.LongBits=p(77175),d.isNode=Boolean(typeof w<"u"&&w&&w.process&&w.process.versions&&w.process.versions.node),d.global=d.isNode&&w||typeof window<"u"&&window||typeof self<"u"&&self||this,d.emptyArray=Object.freeze?Object.freeze([]):[],d.emptyObject=Object.freeze?Object.freeze({}):{},d.isInteger=Number.isInteger||function(l){return"number"==typeof l&&isFinite(l)&&Math.floor(l)===l},d.isString=function(l){return"string"==typeof l||l instanceof String},d.isObject=function(l){return l&&"object"==typeof l},d.isset=d.isSet=function(l,h){var y=l[h];return!(null==y||!l.hasOwnProperty(h))&&("object"!=typeof y||(Array.isArray(y)?y.length:Object.keys(y).length)>0)},d.Buffer=function(){try{var m=d.inquire("buffer").Buffer;return m.prototype.utf8Write?m:null}catch{return null}}(),d._Buffer_from=null,d._Buffer_allocUnsafe=null,d.newBuffer=function(l){return"number"==typeof l?d.Buffer?d._Buffer_allocUnsafe(l):new d.Array(l):d.Buffer?d._Buffer_from(l):typeof Uint8Array>"u"?l:new Uint8Array(l)},d.Array=typeof Uint8Array<"u"?Uint8Array:Array,d.Long=d.global.dcodeIO&&d.global.dcodeIO.Long||d.global.Long||d.inquire("long"),d.key2Re=/^true|false|0|1$/,d.key32Re=/^-?(?:0|[1-9][0-9]*)$/,d.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,d.longToHash=function(l){return l?d.LongBits.from(l).toHash():d.LongBits.zeroHash},d.longFromHash=function(l,h){var y=d.LongBits.fromHash(l);return d.Long?d.Long.fromBits(y.lo,y.hi,h):y.toNumber(Boolean(h))},d.merge=S,d.lcFirst=function(l){return l.charAt(0).toLowerCase()+l.substring(1)},d.newError=I,d.ProtocolError=I("ProtocolError"),d.oneOfGetter=function(l){for(var h={},y=0;y<l.length;++y)h[l[y]]=1;return function(){for(var _=Object.keys(this),A=_.length-1;A>-1;--A)if(1===h[_[A]]&&null!=this[_[A]])return _[A]}},d.oneOfSetter=function(l){return function(h){for(var y=0;y<l.length;++y)l[y]!==h&&delete this[l[y]]}},d.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},d._configure=function(){var m=d.Buffer;m?(d._Buffer_from=m.from!==Uint8Array.from&&m.from||function(h,y){return new m(h,y)},d._Buffer_allocUnsafe=m.allocUnsafe||function(h){return new m(h)}):d._Buffer_from=d._Buffer_allocUnsafe=null}},64837:(re,J,p)=>{"use strict";re.exports=_;var d,w=p(98462),S=w.LongBits,I=w.base64,m=w.utf8;function l(D,k,j){this.fn=D,this.len=k,this.next=void 0,this.val=j}function h(){}function y(D){this.head=D.head,this.tail=D.tail,this.len=D.len,this.next=D.states}function _(){this.len=0,this.head=new l(h,0,0),this.tail=this.head,this.states=null}var A=function(){return w.Buffer?function(){return(_.create=function(){return new d})()}:function(){return new _}};function O(D,k,j){k[j]=255&D}function g(D,k){this.len=D,this.next=void 0,this.val=k}function v(D,k,j){for(;D.hi;)k[j++]=127&D.lo|128,D.lo=(D.lo>>>7|D.hi<<25)>>>0,D.hi>>>=7;for(;D.lo>127;)k[j++]=127&D.lo|128,D.lo=D.lo>>>7;k[j++]=D.lo}function R(D,k,j){k[j]=255&D,k[j+1]=D>>>8&255,k[j+2]=D>>>16&255,k[j+3]=D>>>24}_.create=A(),_.alloc=function(k){return new w.Array(k)},w.Array!==Array&&(_.alloc=w.pool(_.alloc,w.Array.prototype.subarray)),_.prototype._push=function(k,j,Q){return this.tail=this.tail.next=new l(k,j,Q),this.len+=j,this},(g.prototype=Object.create(l.prototype)).fn=function x(D,k,j){for(;D>127;)k[j++]=127&D|128,D>>>=7;k[j]=D},_.prototype.uint32=function(k){return this.len+=(this.tail=this.tail.next=new g((k>>>=0)<128?1:k<16384?2:k<2097152?3:k<268435456?4:5,k)).len,this},_.prototype.int32=function(k){return k<0?this._push(v,10,S.fromNumber(k)):this.uint32(k)},_.prototype.sint32=function(k){return this.uint32((k<<1^k>>31)>>>0)},_.prototype.int64=_.prototype.uint64=function(k){var j=S.from(k);return this._push(v,j.length(),j)},_.prototype.sint64=function(k){var j=S.from(k).zzEncode();return this._push(v,j.length(),j)},_.prototype.bool=function(k){return this._push(O,1,k?1:0)},_.prototype.sfixed32=_.prototype.fixed32=function(k){return this._push(R,4,k>>>0)},_.prototype.sfixed64=_.prototype.fixed64=function(k){var j=S.from(k);return this._push(R,4,j.lo)._push(R,4,j.hi)},_.prototype.float=function(k){return this._push(w.float.writeFloatLE,4,k)},_.prototype.double=function(k){return this._push(w.float.writeDoubleLE,8,k)};var N=w.Array.prototype.set?function(k,j,Q){j.set(k,Q)}:function(k,j,Q){for(var L=0;L<k.length;++L)j[Q+L]=k[L]};_.prototype.bytes=function(k){var j=k.length>>>0;if(!j)return this._push(O,1,0);if(w.isString(k)){var Q=_.alloc(j=I.length(k));I.decode(k,Q,0),k=Q}return this.uint32(j)._push(N,j,k)},_.prototype.string=function(k){var j=m.length(k);return j?this.uint32(j)._push(m.write,j,k):this._push(O,1,0)},_.prototype.fork=function(){return this.states=new y(this),this.head=this.tail=new l(h,0,0),this.len=0,this},_.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(h,0,0),this.len=0),this},_.prototype.ldelim=function(){var k=this.head,j=this.tail,Q=this.len;return this.reset().uint32(Q),Q&&(this.tail.next=k.next,this.tail=j,this.len+=Q),this},_.prototype.finish=function(){for(var k=this.head.next,j=this.constructor.alloc(this.len),Q=0;k;)k.fn(k.val,j,Q),Q+=k.len,k=k.next;return j},_._configure=function(D){d=D,_.create=A(),d._configure()}},94022:(re,J,p)=>{"use strict";re.exports=S;var w=p(64837);(S.prototype=Object.create(w.prototype)).constructor=S;var d=p(98462);function S(){w.call(this)}function I(m,l,h){m.length<40?d.utf8.write(m,l,h):l.utf8Write?l.utf8Write(m,h):l.write(m,h)}S._configure=function(){S.alloc=d._Buffer_allocUnsafe,S.writeBytesBuffer=d.Buffer&&d.Buffer.prototype instanceof Uint8Array&&"set"===d.Buffer.prototype.set.name?function(l,h,y){h.set(l,y)}:function(l,h,y){if(l.copy)l.copy(h,y,0,l.length);else for(var _=0;_<l.length;)h[y++]=l[_++]}},S.prototype.bytes=function(l){d.isString(l)&&(l=d._Buffer_from(l,"base64"));var h=l.length>>>0;return this.uint32(h),h&&this._push(S.writeBytesBuffer,h,l),this},S.prototype.string=function(l){var h=d.Buffer.byteLength(l);return this.uint32(h),h&&this._push(I,h,l),this},S._configure()},80300:re=>{"use strict";re.exports=function S(l,h){return"string"==typeof l?m(l):"number"==typeof l?I(l,h):null},re.exports.format=I,re.exports.parse=m;var J=/\B(?=(\d{3})+(?!\d))/g,p=/(?:\.0*|(\.[^0]+)0+)$/,w={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},d=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function I(l,h){if(!Number.isFinite(l))return null;var y=Math.abs(l),_=h&&h.thousandsSeparator||"",A=h&&h.unitSeparator||"",O=h&&void 0!==h.decimalPlaces?h.decimalPlaces:2,x=Boolean(h&&h.fixedDecimals),g=h&&h.unit||"";(!g||!w[g.toLowerCase()])&&(g=y>=w.pb?"PB":y>=w.tb?"TB":y>=w.gb?"GB":y>=w.mb?"MB":y>=w.kb?"KB":"B");var R=(l/w[g.toLowerCase()]).toFixed(O);return x||(R=R.replace(p,"$1")),_&&(R=R.split(".").map(function(N,D){return 0===D?N.replace(J,_):N}).join(".")),R+A+g}function m(l){if("number"==typeof l&&!isNaN(l))return l;if("string"!=typeof l)return null;var y,h=d.exec(l),_="b";return h?(y=parseFloat(h[1]),_=h[4].toLowerCase()):(y=parseInt(l,10),_="b"),isNaN(y)?null:Math.floor(w[_]*y)}},72158:(re,J,p)=>{"use strict";re.exports=p(37755)},37755:(re,J,p)=>{"use strict";var w=J;function d(){w.util._configure(),w.Writer._configure(w.BufferWriter),w.Reader._configure(w.BufferReader)}w.build="minimal",w.Writer=p(38938),w.BufferWriter=p(68775),w.Reader=p(22323),w.BufferReader=p(66574),w.util=p(66783),w.rpc=p(5617),w.roots=p(62053),w.configure=d,d()},22323:(re,J,p)=>{"use strict";re.exports=l;var d,w=p(66783),S=w.LongBits,I=w.utf8;function m(x,g){return RangeError("index out of range: "+x.pos+" + "+(g||1)+" > "+x.len)}function l(x){this.buf=x,this.pos=0,this.len=x.length}var g,h=typeof Uint8Array<"u"?function(g){if(g instanceof Uint8Array||Array.isArray(g))return new l(g);throw Error("illegal buffer")}:function(g){if(Array.isArray(g))return new l(g);throw Error("illegal buffer")},y=function(){return w.Buffer?function(v){return(l.create=function(N){return w.Buffer.isBuffer(N)?new d(N):h(N)})(v)}:h};function _(){var x=new S(0,0),g=0;if(!(this.len-this.pos>4)){for(;g<3;++g){if(this.pos>=this.len)throw m(this);if(x.lo=(x.lo|(127&this.buf[this.pos])<<7*g)>>>0,this.buf[this.pos++]<128)return x}return x.lo=(x.lo|(127&this.buf[this.pos++])<<7*g)>>>0,x}for(;g<4;++g)if(x.lo=(x.lo|(127&this.buf[this.pos])<<7*g)>>>0,this.buf[this.pos++]<128)return x;if(x.lo=(x.lo|(127&this.buf[this.pos])<<28)>>>0,x.hi=(x.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return x;if(g=0,this.len-this.pos>4){for(;g<5;++g)if(x.hi=(x.hi|(127&this.buf[this.pos])<<7*g+3)>>>0,this.buf[this.pos++]<128)return x}else for(;g<5;++g){if(this.pos>=this.len)throw m(this);if(x.hi=(x.hi|(127&this.buf[this.pos])<<7*g+3)>>>0,this.buf[this.pos++]<128)return x}throw Error("invalid varint encoding")}function A(x,g){return(x[g-4]|x[g-3]<<8|x[g-2]<<16|x[g-1]<<24)>>>0}function O(){if(this.pos+8>this.len)throw m(this,8);return new S(A(this.buf,this.pos+=4),A(this.buf,this.pos+=4))}l.create=y(),l.prototype._slice=w.Array.prototype.subarray||w.Array.prototype.slice,l.prototype.uint32=(g=4294967295,function(){if(g=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(g=(g|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(g=(g|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(g=(g|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(g=(g|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return g;if((this.pos+=5)>this.len)throw this.pos=this.len,m(this,10);return g}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var g=this.uint32();return g>>>1^-(1&g)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw m(this,4);return A(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw m(this,4);return 0|A(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw m(this,4);var g=w.float.readFloatLE(this.buf,this.pos);return this.pos+=4,g},l.prototype.double=function(){if(this.pos+8>this.len)throw m(this,4);var g=w.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,g},l.prototype.bytes=function(){var g=this.uint32(),v=this.pos,R=this.pos+g;if(R>this.len)throw m(this,g);return this.pos+=g,Array.isArray(this.buf)?this.buf.slice(v,R):v===R?new this.buf.constructor(0):this._slice.call(this.buf,v,R)},l.prototype.string=function(){var g=this.bytes();return I.read(g,0,g.length)},l.prototype.skip=function(g){if("number"==typeof g){if(this.pos+g>this.len)throw m(this,g);this.pos+=g}else do{if(this.pos>=this.len)throw m(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(x){switch(x){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(x=7&this.uint32());)this.skipType(x);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+x+" at offset "+this.pos)}return this},l._configure=function(x){d=x,l.create=y(),d._configure();var g=w.Long?"toLong":"toNumber";w.merge(l.prototype,{int64:function(){return _.call(this)[g](!1)},uint64:function(){return _.call(this)[g](!0)},sint64:function(){return _.call(this).zzDecode()[g](!1)},fixed64:function(){return O.call(this)[g](!0)},sfixed64:function(){return O.call(this)[g](!1)}})}},66574:(re,J,p)=>{"use strict";re.exports=S;var w=p(22323);(S.prototype=Object.create(w.prototype)).constructor=S;var d=p(66783);function S(I){w.call(this,I)}S._configure=function(){d.Buffer&&(S.prototype._slice=d.Buffer.prototype.slice)},S.prototype.string=function(){var m=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+m,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+m,this.len))},S._configure()},62053:re=>{"use strict";re.exports={}},5617:(re,J,p)=>{"use strict";J.Service=p(2121)},2121:(re,J,p)=>{"use strict";re.exports=d;var w=p(66783);function d(S,I,m){if("function"!=typeof S)throw TypeError("rpcImpl must be a function");w.EventEmitter.call(this),this.rpcImpl=S,this.requestDelimited=Boolean(I),this.responseDelimited=Boolean(m)}(d.prototype=Object.create(w.EventEmitter.prototype)).constructor=d,d.prototype.rpcCall=function S(I,m,l,h,y){if(!h)throw TypeError("request must be specified");var _=this;if(!y)return w.asPromise(S,_,I,m,l,h);if(_.rpcImpl)try{return _.rpcImpl(I,m[_.requestDelimited?"encodeDelimited":"encode"](h).finish(),function(O,x){if(O)return _.emit("error",O,I),y(O);if(null!==x){if(!(x instanceof l))try{x=l[_.responseDelimited?"decodeDelimited":"decode"](x)}catch(g){return _.emit("error",g,I),y(g)}return _.emit("data",x,I),y(null,x)}_.end(!0)})}catch(A){return _.emit("error",A,I),void setTimeout(function(){y(A)},0)}else setTimeout(function(){y(Error("already ended"))},0)},d.prototype.end=function(I){return this.rpcImpl&&(I||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},60077:(re,J,p)=>{"use strict";re.exports=d;var w=p(66783);function d(l,h){this.lo=l>>>0,this.hi=h>>>0}var S=d.zero=new d(0,0);S.toNumber=function(){return 0},S.zzEncode=S.zzDecode=function(){return this},S.length=function(){return 1};var I=d.zeroHash="\0\0\0\0\0\0\0\0";d.fromNumber=function(h){if(0===h)return S;var y=h<0;y&&(h=-h);var _=h>>>0,A=(h-_)/4294967296>>>0;return y&&(A=~A>>>0,_=~_>>>0,++_>4294967295&&(_=0,++A>4294967295&&(A=0))),new d(_,A)},d.from=function(h){if("number"==typeof h)return d.fromNumber(h);if(w.isString(h)){if(!w.Long)return d.fromNumber(parseInt(h,10));h=w.Long.fromString(h)}return h.low||h.high?new d(h.low>>>0,h.high>>>0):S},d.prototype.toNumber=function(h){if(!h&&this.hi>>>31){var y=1+~this.lo>>>0,_=~this.hi>>>0;return y||(_=_+1>>>0),-(y+4294967296*_)}return this.lo+4294967296*this.hi},d.prototype.toLong=function(h){return w.Long?new w.Long(0|this.lo,0|this.hi,Boolean(h)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(h)}};var m=String.prototype.charCodeAt;d.fromHash=function(h){return h===I?S:new d((m.call(h,0)|m.call(h,1)<<8|m.call(h,2)<<16|m.call(h,3)<<24)>>>0,(m.call(h,4)|m.call(h,5)<<8|m.call(h,6)<<16|m.call(h,7)<<24)>>>0)},d.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},d.prototype.zzEncode=function(){var h=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^h)>>>0,this.lo=(this.lo<<1^h)>>>0,this},d.prototype.zzDecode=function(){var h=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^h)>>>0,this.hi=(this.hi>>>1^h)>>>0,this},d.prototype.length=function(){var h=this.lo,y=(this.lo>>>28|this.hi<<4)>>>0,_=this.hi>>>24;return 0===_?0===y?h<16384?h<128?1:2:h<2097152?3:4:y<16384?y<128?5:6:y<2097152?7:8:_<128?9:10}},66783:function(re,J,p){"use strict";var w=p(40146),d=J;function S(m,l,h){for(var y=Object.keys(l),_=0;_<y.length;++_)(void 0===m[y[_]]||!h)&&(m[y[_]]=l[y[_]]);return m}function I(m){function l(h,y){if(!(this instanceof l))return new l(h,y);Object.defineProperty(this,"message",{get:function(){return h}}),Error.captureStackTrace?Error.captureStackTrace(this,l):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),y&&S(this,y)}return l.prototype=Object.create(Error.prototype,{constructor:{value:l,writable:!0,enumerable:!1,configurable:!0},name:{get:()=>m,set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),l}d.asPromise=p(18791),d.base64=p(5985),d.EventEmitter=p(68074),d.float=p(48170),d.inquire=p(91248),d.utf8=p(88178),d.pool=p(15759),d.LongBits=p(60077),d.isNode=Boolean(typeof w<"u"&&w&&w.process&&w.process.versions&&w.process.versions.node),d.global=d.isNode&&w||typeof window<"u"&&window||typeof self<"u"&&self||this,d.emptyArray=Object.freeze?Object.freeze([]):[],d.emptyObject=Object.freeze?Object.freeze({}):{},d.isInteger=Number.isInteger||function(l){return"number"==typeof l&&isFinite(l)&&Math.floor(l)===l},d.isString=function(l){return"string"==typeof l||l instanceof String},d.isObject=function(l){return l&&"object"==typeof l},d.isset=d.isSet=function(l,h){var y=l[h];return!(null==y||!l.hasOwnProperty(h))&&("object"!=typeof y||(Array.isArray(y)?y.length:Object.keys(y).length)>0)},d.Buffer=function(){try{var m=d.inquire("buffer").Buffer;return m.prototype.utf8Write?m:null}catch{return null}}(),d._Buffer_from=null,d._Buffer_allocUnsafe=null,d.newBuffer=function(l){return"number"==typeof l?d.Buffer?d._Buffer_allocUnsafe(l):new d.Array(l):d.Buffer?d._Buffer_from(l):typeof Uint8Array>"u"?l:new Uint8Array(l)},d.Array=typeof Uint8Array<"u"?Uint8Array:Array,d.Long=d.global.dcodeIO&&d.global.dcodeIO.Long||d.global.Long||d.inquire("long"),d.key2Re=/^true|false|0|1$/,d.key32Re=/^-?(?:0|[1-9][0-9]*)$/,d.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,d.longToHash=function(l){return l?d.LongBits.from(l).toHash():d.LongBits.zeroHash},d.longFromHash=function(l,h){var y=d.LongBits.fromHash(l);return d.Long?d.Long.fromBits(y.lo,y.hi,h):y.toNumber(Boolean(h))},d.merge=S,d.lcFirst=function(l){return l.charAt(0).toLowerCase()+l.substring(1)},d.newError=I,d.ProtocolError=I("ProtocolError"),d.oneOfGetter=function(l){for(var h={},y=0;y<l.length;++y)h[l[y]]=1;return function(){for(var _=Object.keys(this),A=_.length-1;A>-1;--A)if(1===h[_[A]]&&null!=this[_[A]])return _[A]}},d.oneOfSetter=function(l){return function(h){for(var y=0;y<l.length;++y)l[y]!==h&&delete this[l[y]]}},d.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},d._configure=function(){var m=d.Buffer;m?(d._Buffer_from=m.from!==Uint8Array.from&&m.from||function(h,y){return new m(h,y)},d._Buffer_allocUnsafe=m.allocUnsafe||function(h){return new m(h)}):d._Buffer_from=d._Buffer_allocUnsafe=null}},38938:(re,J,p)=>{"use strict";re.exports=_;var d,w=p(66783),S=w.LongBits,I=w.base64,m=w.utf8;function l(D,k,j){this.fn=D,this.len=k,this.next=void 0,this.val=j}function h(){}function y(D){this.head=D.head,this.tail=D.tail,this.len=D.len,this.next=D.states}function _(){this.len=0,this.head=new l(h,0,0),this.tail=this.head,this.states=null}var A=function(){return w.Buffer?function(){return(_.create=function(){return new d})()}:function(){return new _}};function O(D,k,j){k[j]=255&D}function g(D,k){this.len=D,this.next=void 0,this.val=k}function v(D,k,j){for(;D.hi;)k[j++]=127&D.lo|128,D.lo=(D.lo>>>7|D.hi<<25)>>>0,D.hi>>>=7;for(;D.lo>127;)k[j++]=127&D.lo|128,D.lo=D.lo>>>7;k[j++]=D.lo}function R(D,k,j){k[j]=255&D,k[j+1]=D>>>8&255,k[j+2]=D>>>16&255,k[j+3]=D>>>24}_.create=A(),_.alloc=function(k){return new w.Array(k)},w.Array!==Array&&(_.alloc=w.pool(_.alloc,w.Array.prototype.subarray)),_.prototype._push=function(k,j,Q){return this.tail=this.tail.next=new l(k,j,Q),this.len+=j,this},(g.prototype=Object.create(l.prototype)).fn=function x(D,k,j){for(;D>127;)k[j++]=127&D|128,D>>>=7;k[j]=D},_.prototype.uint32=function(k){return this.len+=(this.tail=this.tail.next=new g((k>>>=0)<128?1:k<16384?2:k<2097152?3:k<268435456?4:5,k)).len,this},_.prototype.int32=function(k){return k<0?this._push(v,10,S.fromNumber(k)):this.uint32(k)},_.prototype.sint32=function(k){return this.uint32((k<<1^k>>31)>>>0)},_.prototype.int64=_.prototype.uint64=function(k){var j=S.from(k);return this._push(v,j.length(),j)},_.prototype.sint64=function(k){var j=S.from(k).zzEncode();return this._push(v,j.length(),j)},_.prototype.bool=function(k){return this._push(O,1,k?1:0)},_.prototype.sfixed32=_.prototype.fixed32=function(k){return this._push(R,4,k>>>0)},_.prototype.sfixed64=_.prototype.fixed64=function(k){var j=S.from(k);return this._push(R,4,j.lo)._push(R,4,j.hi)},_.prototype.float=function(k){return this._push(w.float.writeFloatLE,4,k)},_.prototype.double=function(k){return this._push(w.float.writeDoubleLE,8,k)};var N=w.Array.prototype.set?function(k,j,Q){j.set(k,Q)}:function(k,j,Q){for(var L=0;L<k.length;++L)j[Q+L]=k[L]};_.prototype.bytes=function(k){var j=k.length>>>0;if(!j)return this._push(O,1,0);if(w.isString(k)){var Q=_.alloc(j=I.length(k));I.decode(k,Q,0),k=Q}return this.uint32(j)._push(N,j,k)},_.prototype.string=function(k){var j=m.length(k);return j?this.uint32(j)._push(m.write,j,k):this._push(O,1,0)},_.prototype.fork=function(){return this.states=new y(this),this.head=this.tail=new l(h,0,0),this.len=0,this},_.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(h,0,0),this.len=0),this},_.prototype.ldelim=function(){var k=this.head,j=this.tail,Q=this.len;return this.reset().uint32(Q),Q&&(this.tail.next=k.next,this.tail=j,this.len+=Q),this},_.prototype.finish=function(){for(var k=this.head.next,j=this.constructor.alloc(this.len),Q=0;k;)k.fn(k.val,j,Q),Q+=k.len,k=k.next;return j},_._configure=function(D){d=D,_.create=A(),d._configure()}},68775:(re,J,p)=>{"use strict";re.exports=S;var w=p(38938);(S.prototype=Object.create(w.prototype)).constructor=S;var d=p(66783);function S(){w.call(this)}function I(m,l,h){m.length<40?d.utf8.write(m,l,h):l.utf8Write?l.utf8Write(m,h):l.write(m,h)}S._configure=function(){S.alloc=d._Buffer_allocUnsafe,S.writeBytesBuffer=d.Buffer&&d.Buffer.prototype instanceof Uint8Array&&"set"===d.Buffer.prototype.set.name?function(l,h,y){h.set(l,y)}:function(l,h,y){if(l.copy)l.copy(h,y,0,l.length);else for(var _=0;_<l.length;)h[y++]=l[_++]}},S.prototype.bytes=function(l){d.isString(l)&&(l=d._Buffer_from(l,"base64"));var h=l.length>>>0;return this.uint32(h),h&&this._push(S.writeBytesBuffer,h,l),this},S.prototype.string=function(l){var h=d.Buffer.byteLength(l);return this.uint32(h),h&&this._push(I,h,l),this},S._configure()},77056:(re,J,p)=>{"use strict";re.exports=globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?{default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:{default:p(67885).default,Headers:p(67885).Headers,Request:p(67885).Request,Response:p(67885).Response}},67885:(re,J)=>{"use strict";var w=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof w<"u")return w;throw new Error("unable to locate global object")}();re.exports=J=w.fetch,w.fetch&&(J.default=w.fetch.bind(w)),J.Headers=w.Headers,J.Request=w.Request,J.Response=w.Response},67318:(re,J,p)=>{"use strict";var w=p(53217);const d=p(96480),S="object"==typeof window&&"object"==typeof document&&9===document.nodeType,I=d(),_="function"==typeof importScripts&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,O=typeof navigator<"u"&&"ReactNative"===navigator.product;re.exports={isTest:typeof w<"u"&&typeof w.env<"u"&&!1,isElectron:I,isElectronMain:I&&!S,isElectronRenderer:I&&S,isNode:typeof w<"u"&&typeof w.release<"u"&&"node"===w.release.name&&!I,isBrowser:S&&!I,isWebWorker:_,isEnvWithDom:S,isReactNative:O}},49545:(re,J,p)=>{"use strict";re.exports=p(77056)},51721:(re,J,p)=>{"use strict";var w=p(73671).default,d=p(14997).default,S=p(40226).default,I=p(63983).default;const m=p(69071);function h(_,A){return y.apply(this,arguments)}function y(){return(y=w(function*(_,A){const O=new m,x=yield d(O.get(_,A));yield*I(S(x.iterator()),d)})).apply(this,arguments)}re.exports=(_,A)=>({path:decodeURIComponent(new URL(_).pathname.split("/").pop()||""),content:h(_,A)})},69071:(re,J,p)=>{"use strict";var w=p(21778).default,d=p(73671).default,S=p(14997).default,I=p(40226).default,m=p(63983).default;const{fetch:l,Request:h,Headers:y}=p(39208),{TimeoutError:_,HTTPError:A}=p(66938),O=p(30954).bind({ignoreUndefined:!0}),{URL:x,URLSearchParams:g}=p(47634),v=p(78196),N={throwHttpErrors:!0,credentials:"same-origin"};class D{constructor(C={}){this.opts=O(N,C)}fetch(C,z={}){var te=this;return w(function*(){const Z=O(te.opts,z),se=new y(Z.headers);if("string"!=typeof C&&!(C instanceof x||C instanceof h))throw new TypeError("`resource` must be a string, URL, or Request");const ue=new x(C.toString(),Z.base),{searchParams:oe,transformSearchParams:me,json:fe}=Z;oe&&(ue.search="function"==typeof me?me(new g(Z.searchParams)):new g(Z.searchParams)),fe&&(Z.body=JSON.stringify(Z.json),se.set("content-type","application/json"));const ae=new AbortController,pe=v([ae.signal,Z.signal]),ce=yield((G,C,z)=>{if(void 0===C)return G;const te=Date.now(),Z=()=>Date.now()-te>=C;return new Promise((se,ue)=>{const oe=setTimeout(()=>{Z()&&(ue(new _),z.abort())},C),me=fe=>pe=>{clearTimeout(oe),Z()?ue(new _):fe(pe)};G.then(me(se),me(ue))})})(l(ue.toString(),{...Z,signal:pe,timeout:void 0,headers:se}),Z.timeout,ae);if(!ce.ok&&Z.throwHttpErrors)throw Z.handleError&&(yield Z.handleError(ce)),new A(ce);return ce.iterator=d(function*(){yield*m(I(j(ce.body)),S)}),ce.ndjson=d(function*(){var ye,_e=!1,de=!1;try{for(var xe,we=I(k(ce.iterator()));_e=!(xe=yield S(we.next())).done;_e=!1){const Ae=xe.value;z.transform?yield z.transform(Ae):yield Ae}}catch(Ae){de=!0,ye=Ae}finally{try{_e&&null!=we.return&&(yield S(we.return()))}finally{if(de)throw ye}}}),ce})()}post(C,z={}){return this.fetch(C,{...z,method:"POST"})}get(C,z={}){return this.fetch(C,{...z,method:"GET"})}put(C,z={}){return this.fetch(C,{...z,method:"PUT"})}delete(C,z={}){return this.fetch(C,{...z,method:"DELETE"})}options(C,z={}){return this.fetch(C,{...z,method:"OPTIONS"})}}const k=function(){var G=d(function*(C){const z=new TextDecoder;let te="";var ue,Z=!1,se=!1;try{for(var me,oe=I(C);Z=!(me=yield S(oe.next())).done;Z=!1){te+=z.decode(me.value,{stream:!0});const ae=te.split(/\r?\n/);for(let pe=0;pe<ae.length-1;pe++){const ce=ae[pe].trim();ce.length>0&&(yield JSON.parse(ce))}te=ae[ae.length-1]}}catch(fe){se=!0,ue=fe}finally{try{Z&&null!=oe.return&&(yield S(oe.return()))}finally{if(se)throw ue}}te+=z.decode(),te=te.trim(),0!==te.length&&(yield JSON.parse(te))});return function(z){return G.apply(this,arguments)}}(),j=G=>{if(K(G)){const C=G[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:C.next.bind(C),return:z=>(G.destroy(),"function"==typeof C.return?C.return():Promise.resolve({done:!0,value:z}))})}}if(L(G)){const C=G.getReader();return d(function*(){try{for(;;){const{done:z,value:te}=yield S(C.read());if(z)return;te&&(yield te)}}finally{C.releaseLock()}})()}if(Q(G))return G;throw new TypeError("Body can't be converted to AsyncIterable")},Q=G=>"object"==typeof G&&null!==G&&"function"==typeof G[Symbol.asyncIterator],L=G=>G&&"function"==typeof G.getReader,K=G=>Object.prototype.hasOwnProperty.call(G,"readable")&&Object.prototype.hasOwnProperty.call(G,"writable");D.HTTPError=A,D.TimeoutError=_,D.streamToAsyncIterator=j,D.post=(G,C)=>new D(C).post(G,C),D.get=(G,C)=>new D(C).get(G,C),D.put=(G,C)=>new D(C).put(G,C),D.delete=(G,C)=>new D(C).delete(G,C),D.options=(G,C)=>new D(C).options(G,C),re.exports=D},66938:(re,J)=>{"use strict";class p extends Error{constructor(I="Request timed out"){super(I),this.name="TimeoutError"}}J.TimeoutError=p;class w extends Error{constructor(I="The operation was aborted."){super(I),this.name="AbortError"}}J.AbortError=w;class d extends Error{constructor(I){super(I.statusText),this.name="HTTPError",this.response=I}}J.HTTPError=d},39208:(re,J,p)=>{"use strict";const{TimeoutError:w,AbortError:d}=p(66938),{Response:S,Request:I,Headers:m,default:l}=p(49545),y=l,A=x=>{const g=new m;for(const v of x.trim().split(/[\r\n]+/)){const R=v.indexOf(": ");R>0&&g.set(v.slice(0,R),v.slice(R+1))}return g};class O extends S{constructor(g,v,R){super(v,R),Object.defineProperty(this,"url",{value:g})}}re.exports={fetch:(x,g={})=>null!=g.onUploadProgress?((x,g={})=>{const v=new XMLHttpRequest;v.open(g.method||"GET",x.toString(),!0);const{timeout:R,headers:N}=g;if(R&&R>0&&R<1/0&&(v.timeout=R),null!=g.overrideMimeType&&v.overrideMimeType(g.overrideMimeType),N)for(const[D,k]of new m(N))v.setRequestHeader(D,k);return g.signal&&(g.signal.onabort=()=>v.abort()),g.onUploadProgress&&(v.upload.onprogress=g.onUploadProgress),v.responseType="arraybuffer",new Promise((D,k)=>{const j=Q=>{switch(Q.type){case"error":D(S.error());break;case"load":D(new O(v.responseURL,v.response,{status:v.status,statusText:v.statusText,headers:A(v.getAllResponseHeaders())}));break;case"timeout":k(new w);break;case"abort":k(new d)}};v.onerror=j,v.onload=j,v.ontimeout=j,v.onabort=j,v.send(g.body)})})(x,g):y(x,g),Request:I,Headers:m}},23919:re=>{"use strict";var J=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;re.exports=function(w,d){if(null==d&&(d=!1),w.length<2||w.length>255)return!1;var S=w[w.length-1];if(d){if("."!==S)return!1}else if("."===S)return!1;return J.test(w)}},96480:(re,J,p)=>{var w=p(53217);re.exports=function d(){return typeof window<"u"&&"object"==typeof window.process&&"renderer"===window.process.type||typeof w<"u"&&"object"==typeof w.versions&&!!w.versions.electron||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0}},32146:re=>{"use strict";re.exports=J=>{if("[object Object]"!==Object.prototype.toString.call(J))return!1;const p=Object.getPrototypeOf(J);return null===p||p===Object.prototype}},6743:re=>{"use strict";re.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:256,RTLD_LOCAL:0,RTLD_DEEPBIND:8,E2BIG:7,EACCES:13,EADDRINUSE:98,EADDRNOTAVAIL:99,EAFNOSUPPORT:97,EAGAIN:11,EALREADY:114,EBADF:9,EBADMSG:74,EBUSY:16,ECANCELED:125,ECHILD:10,ECONNABORTED:103,ECONNREFUSED:111,ECONNRESET:104,EDEADLK:35,EDESTADDRREQ:89,EDOM:33,EDQUOT:122,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:113,EIDRM:43,EILSEQ:84,EINPROGRESS:115,EINTR:4,EINVAL:22,EIO:5,EISCONN:106,EISDIR:21,ELOOP:40,EMFILE:24,EMLINK:31,EMSGSIZE:90,EMULTIHOP:72,ENAMETOOLONG:36,ENETDOWN:100,ENETRESET:102,ENETUNREACH:101,ENFILE:23,ENOBUFS:105,ENODATA:61,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:37,ENOLINK:67,ENOMEM:12,ENOMSG:42,ENOPROTOOPT:92,ENOSPC:28,ENOSR:63,ENOSTR:60,ENOSYS:38,ENOTCONN:107,ENOTDIR:20,ENOTEMPTY:39,ENOTSOCK:88,ENOTSUP:95,ENOTTY:25,ENXIO:6,EOPNOTSUPP:95,EOVERFLOW:75,EPERM:1,EPIPE:32,EPROTO:71,EPROTONOSUPPORT:93,EPROTOTYPE:91,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:116,ETIME:62,ETIMEDOUT:110,ETXTBSY:26,EWOULDBLOCK:11,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:7,SIGFPE:8,SIGKILL:9,SIGUSR1:10,SIGSEGV:11,SIGUSR2:12,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:17,SIGSTKFLT:16,SIGCONT:18,SIGSTOP:19,SIGTSTP:20,SIGTTIN:21,SIGTTOU:22,SIGURG:23,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:29,SIGPOLL:29,SIGPWR:30,SIGSYS:31,SIGUNUSED:31,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,UV_FS_O_FILEMAP:0,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DSYNC:4096,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488415,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},79782:re=>{"use strict";re.exports=function p(w){const d=new Uint8Array(w);let S=0;if(w>0)if(w>65536)for(;S<w;)S+65536>w?(crypto.getRandomValues(d.subarray(S,S+(w-S))),S+=w-S):(crypto.getRandomValues(d.subarray(S,S+65536)),S+=65536);else crypto.getRandomValues(d);return d}},47634:(re,J,p)=>{"use strict";const{URLWithLegacySupport:w,format:d,URLSearchParams:S,defaultBase:I}=p(89443),m=p(47673);re.exports={URL:w,URLSearchParams:S,format:d,relative:m,defaultBase:I}},47673:(re,J,p)=>{"use strict";const{URLWithLegacySupport:w,format:d}=p(89443);re.exports=(S,I={},m={},l)=>{let y,h=I.protocol?I.protocol.replace(":",""):"http";h=(m[h]||l||h)+":";try{y=new w(S)}catch{y={}}const _=Object.assign({},I,{protocol:h||y.protocol,host:I.host||y.host});return new w(S,d(_)).toString()}},89443:re=>{"use strict";const J=typeof navigator<"u"&&"ReactNative"===navigator.product,w=self.URL,d=function p(){return J?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}();re.exports={URLWithLegacySupport:class S{constructor(l="",h=d){this.super=new w(l,h),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(l){this.super.hash=l}set host(l){this.super.host=l}set hostname(l){this.super.hostname=l}set href(l){this.super.href=l}set password(l){this.super.password=l}set pathname(l){this.super.pathname=l}set port(l){this.super.port=l}set protocol(l){this.super.protocol=l}set search(l){this.super.search=l}set username(l){this.super.username=l}static createObjectURL(l){return w.createObjectURL(l)}static revokeObjectURL(l){w.revokeObjectURL(l)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:d,format:function I(m){if("string"==typeof m)return new w(m).toString();if(!(m instanceof w)){const h=m.auth?m.auth+"@":"",y=m.port?":"+m.port:"",O=m.hostname||"",x=m.search||(m.query?"?"+m.query:""),v=m.pathname||"";return`${m.protocol?m.protocol+"//":""}${(m.username&&m.password?`${m.username}:${m.password}@`:"")||h}${m.host||O+y}${m.path||v+x}${m.hash||""}`}}}},85273:(re,J,p)=>{"use strict";var w=p(21778).default,d=p(73671).default,S=p(14997).default,I=p(40226).default,m=p(63983).default;const l=p(39011);re.exports=function(){var y=d(function*(..._){const A=l();setTimeout(w(function*(){try{yield Promise.all(_.map(function(){var O=w(function*(x){var R,g=!1,v=!1;try{for(var D,N=I(x);g=!(D=yield N.next()).done;g=!1)A.push(D.value)}catch(k){v=!0,R=k}finally{try{g&&null!=N.return&&(yield N.return())}finally{if(v)throw R}}});return function(x){return O.apply(this,arguments)}}())),A.end()}catch(O){A.end(O)}}),0),yield*m(I(A),S)});return function(){return y.apply(this,arguments)}}()},39011:(re,J,p)=>{const w=p(30766);re.exports=d=>{let S;"function"==typeof(d=d||{})?(S=d,d={}):S=d.onEnd;let m,l,h,I=new w;const _=N=>l?l(N):(I.push(N),m),O=N=>h?m:_({done:!1,value:N}),x=N=>h?m:(h=!0,N?(N=>(I=new w,l?l({error:N}):(I.push({error:N}),m)))(N):_({done:!0}));if(m={[Symbol.asyncIterator](){return this},next:()=>{if(!I.isEmpty()){if(d.writev){let D;const k=[];for(;!I.isEmpty();){if(D=I.shift(),D.error)throw D.error;k.push(D.value)}return{done:D.done,value:k}}const N=I.shift();if(N.error)throw N.error;return N}return h?{done:!0}:new Promise((N,D)=>{l=k=>(l=null,k.error?D(k.error):N(d.writev&&!k.done?{done:k.done,value:[k.value]}:k),m)})},return:()=>(I=new w,x(),{done:!0}),throw:N=>(x(N),{done:!0}),push:O,end:x},!S)return m;const R=m;return m={[Symbol.asyncIterator](){return this},next:()=>R.next(),throw:N=>(R.throw(N),S&&(S(N),S=null),{done:!0}),return:()=>(R.return(),S&&(S(),S=null),{done:!0}),push:O,end:N=>(R.end(N),S&&(S(N),S=null),m)},m}},96151:(re,J,p)=>{"use strict";var w=p(21778).default,d=p(40226).default;const{concat:S}=p(49330);function m(){return(m=w(function*(l){let h=new Uint8Array(0);var A,y=!1,_=!1;try{for(var x,O=d(l);y=!(x=yield O.next()).done;y=!1){const g=x.value;h=S([h,g],h.length+g.length)}}catch(g){_=!0,A=g}finally{try{y&&null!=O.return&&(yield O.return())}finally{if(_)throw A}}return h})).apply(this,arguments)}re.exports=function I(l){return m.apply(this,arguments)}},17395:(re,J,p)=>{"use strict";const w=p(51186),{EventEmitter:d}=p(83358);function S(h,y){if(h===y)return!0;if(h.length!==y.length)return!1;for(let _=0,A=h.length;_<A;++_)if(h[_]!==y[_])return!1;return!0}function m(h,y){if(!(y instanceof Uint8Array))throw new TypeError(h+" is not a Uint8Array")}class l extends d{constructor(y={}){super(),this.localNodeId=y.localNodeId||w(20),this.numberOfNodesPerKBucket=y.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=y.numberOfNodesToPing||3,this.distance=y.distance||l.distance,this.arbiter=y.arbiter||l.arbiter,this.metadata=Object.assign({},y.metadata),m("option.localNodeId as parameter 1",this.localNodeId),this.root={contacts:[],dontSplit:!1,left:null,right:null}}static arbiter(y,_){return y.vectorClock>_.vectorClock?y:_}static distance(y,_){let A=0,O=0;const x=Math.min(y.length,_.length),g=Math.max(y.length,_.length);for(;O<x;++O)A=256*A+(y[O]^_[O]);for(;O<g;++O)A=256*A+255;return A}add(y){m("contact.id",(y||{}).id);let _=0,A=this.root;for(;null===A.contacts;)A=this._determineNode(A,y.id,_++);const O=this._indexOf(A,y.id);return O>=0?(this._update(A,O,y),this):A.contacts.length<this.numberOfNodesPerKBucket?(A.contacts.push(y),this.emit("added",y),this):A.dontSplit?(this.emit("ping",A.contacts.slice(0,this.numberOfNodesToPing),y),this):(this._split(A,_),this.add(y))}closest(y,_=1/0){if(m("id",y),!Number.isInteger(_)&&_!==1/0||_<=0)throw new TypeError("n is not positive number");let A=[];for(let O=[this.root],x=0;O.length>0&&A.length<_;){const g=O.pop();if(null===g.contacts){const v=this._determineNode(g,y,x++);O.push(g.left===v?g.right:g.left),O.push(v)}else A=A.concat(g.contacts)}return A.map(O=>[this.distance(O.id,y),O]).sort((O,x)=>O[0]-x[0]).slice(0,_).map(O=>O[1])}count(){let y=0;for(const _=[this.root];_.length>0;){const A=_.pop();null===A.contacts?_.push(A.right,A.left):y+=A.contacts.length}return y}_determineNode(y,_,A){const O=A>>3,x=A%8;return _.length<=O&&0!==x?y.left:_[O]&1<<7-x?y.right:y.left}get(y){m("id",y);let _=0,A=this.root;for(;null===A.contacts;)A=this._determineNode(A,y,_++);const O=this._indexOf(A,y);return O>=0?A.contacts[O]:null}_indexOf(y,_){for(let A=0;A<y.contacts.length;++A)if(S(y.contacts[A].id,_))return A;return-1}remove(y){m("the id as parameter 1",y);let _=0,A=this.root;for(;null===A.contacts;)A=this._determineNode(A,y,_++);const O=this._indexOf(A,y);if(O>=0){const x=A.contacts.splice(O,1)[0];this.emit("removed",x)}return this}_split(y,_){y.left={contacts:[],dontSplit:!1,left:null,right:null},y.right={contacts:[],dontSplit:!1,left:null,right:null};for(const x of y.contacts)this._determineNode(y,x.id,_).contacts.push(x);y.contacts=null;const A=this._determineNode(y,this.localNodeId,_);(y.left===A?y.right:y.left).dontSplit=!0}toArray(){let y=[];for(const _=[this.root];_.length>0;){const A=_.pop();null===A.contacts?_.push(A.right,A.left):y=y.concat(A.contacts)}return y}*toIterable(){for(const y=[this.root];y.length>0;){const _=y.pop();null===_.contacts?y.push(_.right,_.left):yield*_.contacts}}_update(y,_,A){if(!S(y.contacts[_].id,A.id))throw new Error("wrong index for _update");const O=y.contacts[_],x=this.arbiter(O,A);x===O&&O!==A||(y.contacts.splice(_,1),y.contacts.push(x),this.emit("updated",O,x))}}re.exports=l},21130:(re,J)=>{"use strict";J.supports=function(...w){const d=w.reduce((S,I)=>Object.assign(S,I),{});return Object.assign(d,{snapshots:d.snapshots||!1,permanence:d.permanence||!1,seek:d.seek||!1,clear:d.clear||!1,getMany:d.getMany||!1,keyIterator:d.keyIterator||!1,valueIterator:d.valueIterator||!1,iteratorNextv:d.iteratorNextv||!1,iteratorAll:d.iteratorAll||!1,status:d.status||!1,createIfMissing:d.createIfMissing||!1,errorIfExists:d.errorIfExists||!1,deferredOpen:d.deferredOpen||!1,promises:d.promises||!1,streams:d.streams||!1,encodings:Object.assign({},d.encodings),events:Object.assign({},d.events),additionalMethods:Object.assign({},d.additionalMethods)})}},2849:(re,J,p)=>{"use strict";const w=p(67004),d=p(94733),{Encoding:S}=p(86269),{BufferFormat:I,ViewFormat:m,UTF8Format:l}=p(22840),h=Symbol("formats"),y=Symbol("encodings"),_=new Set(["buffer","view","utf8"]);J.Transcoder=class A{constructor(D){if(!Array.isArray(D))throw new TypeError("The first argument 'formats' must be an array");if(!D.every(k=>_.has(k)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'");this[y]=new Map,this[h]=new Set(D);for(const k in d)try{this.encoding(k)}catch(j){if("LEVEL_ENCODING_NOT_SUPPORTED"!==j.code)throw j}}encodings(){return Array.from(new Set(this[y].values()))}encoding(D){let k=this[y].get(D);if(void 0===k){if("string"==typeof D&&""!==D){if(k=v[D],!k)throw new w(`Encoding '${D}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if("object"!=typeof D||null===D)throw new TypeError("First argument 'encoding' must be a string or object");k=function O(N){if(N instanceof S)return N;const k=N.name||("type"in N&&"string"==typeof N.type?N.type:void 0)||"anonymous-"+R++;switch(function x(N){return"format"in N&&void 0!==N.format?N.format:"buffer"in N&&"boolean"==typeof N.buffer?N.buffer?"buffer":"utf8":"code"in N&&Number.isInteger(N.code)?"view":"buffer"}(N)){case"view":return new m({...N,name:k});case"utf8":return new l({...N,name:k});case"buffer":return new I({...N,name:k});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}(D)}const{name:j,format:Q}=k;if(!this[h].has(Q))if(this[h].has("view"))k=k.createViewTranscoder();else if(this[h].has("buffer"))k=k.createBufferTranscoder();else{if(!this[h].has("utf8"))throw new w(`Encoding '${j}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});k=k.createUTF8Transcoder()}for(const L of[D,j,k.name,k.commonName])this[y].set(L,k)}return k}};const g={binary:d.buffer,"utf-8":d.utf8},v={...d,...g};let R=0},86269:(re,J,p)=>{"use strict";const w=p(67004),d=new Set(["buffer","view","utf8"]);J.Encoding=class S{constructor(m){if(this.encode=m.encode||this.encode,this.decode=m.decode||this.decode,this.name=m.name||this.name,this.format=m.format||this.format,"function"!=typeof this.encode)throw new TypeError("The 'encode' property must be a function");if("function"!=typeof this.decode)throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),"string"!=typeof this.name||""===this.name)throw new TypeError("The 'name' property must be a string");if("string"!=typeof this.format||!d.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");m.createViewTranscoder&&(this.createViewTranscoder=m.createViewTranscoder),m.createBufferTranscoder&&(this.createBufferTranscoder=m.createBufferTranscoder),m.createUTF8Transcoder&&(this.createUTF8Transcoder=m.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new w(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new w(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new w(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}}},94733:(re,J,p)=>{"use strict";const{Buffer:w}=p(13195)||{Buffer:{isBuffer:()=>!1}},{textEncoder:d,textDecoder:S}=p(73125)(),{BufferFormat:I,ViewFormat:m,UTF8Format:l}=p(22840),h=y=>y;J.utf8=new l({encode:function(y){return w.isBuffer(y)?y.toString("utf8"):ArrayBuffer.isView(y)?S.decode(y):String(y)},decode:h,name:"utf8",createViewTranscoder(){return new m({encode:function(y){return ArrayBuffer.isView(y)?y:d.encode(y)},decode:function(y){return S.decode(y)},name:`${this.name}+view`})},createBufferTranscoder(){return new I({encode:function(y){return w.isBuffer(y)?y:ArrayBuffer.isView(y)?w.from(y.buffer,y.byteOffset,y.byteLength):w.from(String(y),"utf8")},decode:function(y){return y.toString("utf8")},name:`${this.name}+buffer`})}}),J.json=new l({encode:JSON.stringify,decode:JSON.parse,name:"json"}),J.buffer=new I({encode:function(y){return w.isBuffer(y)?y:ArrayBuffer.isView(y)?w.from(y.buffer,y.byteOffset,y.byteLength):w.from(String(y),"utf8")},decode:h,name:"buffer",createViewTranscoder(){return new m({encode:function(y){return ArrayBuffer.isView(y)?y:w.from(String(y),"utf8")},decode:function(y){return w.from(y.buffer,y.byteOffset,y.byteLength)},name:`${this.name}+view`})}}),J.view=new m({encode:function(y){return ArrayBuffer.isView(y)?y:d.encode(y)},decode:h,name:"view",createBufferTranscoder(){return new I({encode:function(y){return w.isBuffer(y)?y:ArrayBuffer.isView(y)?w.from(y.buffer,y.byteOffset,y.byteLength):w.from(String(y),"utf8")},decode:h,name:`${this.name}+buffer`})}}),J.hex=new I({encode:function(y){return w.isBuffer(y)?y:w.from(String(y),"hex")},decode:function(y){return y.toString("hex")},name:"hex"}),J.base64=new I({encode:function(y){return w.isBuffer(y)?y:w.from(String(y),"base64")},decode:function(y){return y.toString("base64")},name:"base64"})},22840:(re,J,p)=>{"use strict";const{Buffer:w}=p(13195)||{},{Encoding:d}=p(86269),S=p(73125);class I extends d{constructor(y){super({...y,format:"buffer"})}createViewTranscoder(){return new m({encode:this.encode,decode:y=>this.decode(w.from(y.buffer,y.byteOffset,y.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}}class m extends d{constructor(y){super({...y,format:"view"})}createBufferTranscoder(){return new I({encode:y=>{const _=this.encode(y);return w.from(_.buffer,_.byteOffset,_.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}}J.BufferFormat=I,J.ViewFormat=m,J.UTF8Format=class l extends d{constructor(y){super({...y,format:"utf8"})}createBufferTranscoder(){return new I({encode:y=>w.from(this.encode(y),"utf8"),decode:y=>this.decode(y.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:y,textDecoder:_}=S();return new m({encode:A=>y.encode(this.encode(A)),decode:A=>this.decode(_.decode(A)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}}},73125:re=>{"use strict";let J=null;re.exports=function(){return null===J&&(J={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),J}},24466:(re,J,p)=>{J.Level=p(34208).BrowserLevel},30954:function(re,J,p){"use strict";const w=p(32146),{hasOwnProperty:d}=Object.prototype,{propertyIsEnumerable:S}=Object,I=(v,R,N)=>Object.defineProperty(v,R,{value:N,writable:!0,enumerable:!0,configurable:!0}),m=this,l={concatArrays:!1,ignoreUndefined:!1},h=v=>{const R=[];for(const N in v)d.call(v,N)&&R.push(N);if(Object.getOwnPropertySymbols){const N=Object.getOwnPropertySymbols(v);for(const D of N)S.call(v,D)&&R.push(D)}return R};function y(v){return Array.isArray(v)?function _(v){const R=v.slice(0,0);return h(v).forEach(N=>{I(R,N,y(v[N]))}),R}(v):w(v)?function A(v){const R=null===Object.getPrototypeOf(v)?Object.create(null):{};return h(v).forEach(N=>{I(R,N,y(v[N]))}),R}(v):v}const O=(v,R,N,D)=>(N.forEach(k=>{typeof R[k]>"u"&&D.ignoreUndefined||(k in v&&v[k]!==Object.getPrototypeOf(v)?I(v,k,g(v[k],R[k],D)):I(v,k,y(R[k])))}),v);function g(v,R,N){return N.concatArrays&&Array.isArray(v)&&Array.isArray(R)?((v,R,N)=>{let D=v.slice(0,0),k=0;return[v,R].forEach(j=>{const Q=[];for(let L=0;L<j.length;L++)!d.call(j,L)||(Q.push(String(L)),I(D,k++,j===v?j[L]:y(j[L])));D=O(D,j,h(j).filter(L=>!Q.includes(L)),N)}),D})(v,R,N):w(R)&&w(v)?O(v,R,h(R),N):y(R)}re.exports=function(...v){const R=g(y(l),this!==m&&this||{},l);let N={_:{}};for(const D of v)if(void 0!==D){if(!w(D))throw new TypeError("`"+D+"` is not an Option Object");N=g(N,{_:D},R)}return N._}},67004:re=>{"use strict";re.exports=class extends Error{constructor(p,w){super(p||""),"object"==typeof w&&null!==w&&(w.code&&(this.code=String(w.code)),w.expected&&(this.expected=!0),w.transient&&(this.transient=!0),w.cause&&(this.cause=w.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}},75592:re=>{var J=1e3,p=60*J,w=60*p,d=24*w;function y(_,A,O,x){var g=A>=1.5*O;return Math.round(_/O)+" "+x+(g?"s":"")}re.exports=function(_,A){A=A||{};var O=typeof _;if("string"===O&&_.length>0)return function m(_){if(!((_=String(_)).length>100)){var A=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(_);if(A){var O=parseFloat(A[1]);switch((A[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*O;case"weeks":case"week":case"w":return 6048e5*O;case"days":case"day":case"d":return O*d;case"hours":case"hour":case"hrs":case"hr":case"h":return O*w;case"minutes":case"minute":case"mins":case"min":case"m":return O*p;case"seconds":case"second":case"secs":case"sec":case"s":return O*J;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return O;default:return}}}}(_);if("number"===O&&isFinite(_))return A.long?function h(_){var A=Math.abs(_);return A>=d?y(_,A,d,"day"):A>=w?y(_,A,w,"hour"):A>=p?y(_,A,p,"minute"):A>=J?y(_,A,J,"second"):_+" ms"}(_):function l(_){var A=Math.abs(_);return A>=d?Math.round(_/d)+"d":A>=w?Math.round(_/w)+"h":A>=p?Math.round(_/p)+"m":A>=J?Math.round(_/J)+"s":_+"ms"}(_);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(_))}},48019:(re,J,p)=>{re.exports=p(42702)},42702:function(re,J){!function(p,w){"use strict";var d={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function S(g){if(!Array.isArray(g)&&!ArrayBuffer.isView(g))return!1;for(var v=0;v<g.length;v++)if(!Number.isInteger(g[v])||g[v]<0||g[v]>255)return!1;return!0}function I(g,v){return(65535&g)*v+(((g>>>16)*v&65535)<<16)}function m(g,v){return g<<v|g>>>32-v}function l(g){return g=I(g^=g>>>16,2246822507),(g=I(g^=g>>>13,3266489909))^g>>>16}function h(g,v){var R=[0,0,0,0];return R[3]+=(g=[g[0]>>>16,65535&g[0],g[1]>>>16,65535&g[1]])[3]+(v=[v[0]>>>16,65535&v[0],v[1]>>>16,65535&v[1]])[3],R[2]+=R[3]>>>16,R[3]&=65535,R[2]+=g[2]+v[2],R[1]+=R[2]>>>16,R[2]&=65535,R[1]+=g[1]+v[1],R[0]+=R[1]>>>16,R[1]&=65535,R[0]+=g[0]+v[0],R[0]&=65535,[R[0]<<16|R[1],R[2]<<16|R[3]]}function y(g,v){var R=[0,0,0,0];return R[3]+=(g=[g[0]>>>16,65535&g[0],g[1]>>>16,65535&g[1]])[3]*(v=[v[0]>>>16,65535&v[0],v[1]>>>16,65535&v[1]])[3],R[2]+=R[3]>>>16,R[3]&=65535,R[2]+=g[2]*v[3],R[1]+=R[2]>>>16,R[2]&=65535,R[2]+=g[3]*v[2],R[1]+=R[2]>>>16,R[2]&=65535,R[1]+=g[1]*v[3],R[0]+=R[1]>>>16,R[1]&=65535,R[1]+=g[2]*v[2],R[0]+=R[1]>>>16,R[1]&=65535,R[1]+=g[3]*v[1],R[0]+=R[1]>>>16,R[1]&=65535,R[0]+=g[0]*v[3]+g[1]*v[2]+g[2]*v[1]+g[3]*v[0],R[0]&=65535,[R[0]<<16|R[1],R[2]<<16|R[3]]}function _(g,v){return 32==(v%=64)?[g[1],g[0]]:v<32?[g[0]<<v|g[1]>>>32-v,g[1]<<v|g[0]>>>32-v]:[g[1]<<(v-=32)|g[0]>>>32-v,g[0]<<v|g[1]>>>32-v]}function A(g,v){return 0==(v%=64)?g:v<32?[g[0]<<v|g[1]>>>32-v,g[1]<<v]:[g[1]<<v-32,0]}function O(g,v){return[g[0]^v[0],g[1]^v[1]]}function x(g){return g=O(g,[0,g[0]>>>1]),g=O(g=y(g,[4283543511,3981806797]),[0,g[0]>>>1]),O(g=y(g,[3301882366,444984403]),[0,g[0]>>>1])}d.x86.hash32=function(g,v){if(d.inputValidation&&!S(g))return w;for(var R=g.length%4,N=g.length-R,D=v=v||0,k=0,j=3432918353,Q=461845907,L=0;L<N;L+=4)k=I(k=g[L]|g[L+1]<<8|g[L+2]<<16|g[L+3]<<24,j),k=I(k=m(k,15),Q),D=I(D=m(D^=k,13),5)+3864292196;switch(k=0,R){case 3:k^=g[L+2]<<16;case 2:k^=g[L+1]<<8;case 1:k=I(k^=g[L],j),D^=k=I(k=m(k,15),Q)}return(D=l(D^=g.length))>>>0},d.x86.hash128=function(g,v){if(d.inputValidation&&!S(g))return w;for(var R=g.length%16,N=g.length-R,D=v=v||0,k=v,j=v,Q=v,L=0,K=0,G=0,C=0,z=597399067,te=2869860233,Z=951274213,se=2716044179,ue=0;ue<N;ue+=16)K=g[ue+4]|g[ue+5]<<8|g[ue+6]<<16|g[ue+7]<<24,G=g[ue+8]|g[ue+9]<<8|g[ue+10]<<16|g[ue+11]<<24,C=g[ue+12]|g[ue+13]<<8|g[ue+14]<<16|g[ue+15]<<24,L=m(L=I(L=g[ue]|g[ue+1]<<8|g[ue+2]<<16|g[ue+3]<<24,z),15),D=m(D^=L=I(L,te),19),D=I(D+=k,5)+1444728091,K=m(K=I(K,te),16),k=m(k^=K=I(K,Z),17),k=I(k+=j,5)+197830471,G=m(G=I(G,Z),17),j=m(j^=G=I(G,se),15),j=I(j+=Q,5)+2530024501,C=m(C=I(C,se),18),Q=m(Q^=C=I(C,z),13),Q=I(Q+=D,5)+850148119;switch(L=0,K=0,G=0,C=0,R){case 15:C^=g[ue+14]<<16;case 14:C^=g[ue+13]<<8;case 13:C=I(C^=g[ue+12],se),Q^=C=I(C=m(C,18),z);case 12:G^=g[ue+11]<<24;case 11:G^=g[ue+10]<<16;case 10:G^=g[ue+9]<<8;case 9:G=I(G^=g[ue+8],Z),j^=G=I(G=m(G,17),se);case 8:K^=g[ue+7]<<24;case 7:K^=g[ue+6]<<16;case 6:K^=g[ue+5]<<8;case 5:K=I(K^=g[ue+4],te),k^=K=I(K=m(K,16),Z);case 4:L^=g[ue+3]<<24;case 3:L^=g[ue+2]<<16;case 2:L^=g[ue+1]<<8;case 1:L=I(L^=g[ue],z),D^=L=I(L=m(L,15),te)}return D^=g.length,D+=k^=g.length,D+=j^=g.length,k+=D+=Q^=g.length,j+=D,Q+=D,D=l(D),D+=k=l(k),D+=j=l(j),k+=D+=Q=l(Q),j+=D,Q+=D,("00000000"+(D>>>0).toString(16)).slice(-8)+("00000000"+(k>>>0).toString(16)).slice(-8)+("00000000"+(j>>>0).toString(16)).slice(-8)+("00000000"+(Q>>>0).toString(16)).slice(-8)},d.x64.hash128=function(g,v){if(d.inputValidation&&!S(g))return w;for(var R=g.length%16,N=g.length-R,D=[0,v=v||0],k=[0,v],j=[0,0],Q=[0,0],L=[2277735313,289559509],K=[1291169091,658871167],G=0;G<N;G+=16)Q=[g[G+12]|g[G+13]<<8|g[G+14]<<16|g[G+15]<<24,g[G+8]|g[G+9]<<8|g[G+10]<<16|g[G+11]<<24],j=_(j=y(j=[g[G+4]|g[G+5]<<8|g[G+6]<<16|g[G+7]<<24,g[G]|g[G+1]<<8|g[G+2]<<16|g[G+3]<<24],L),31),D=h(D=_(D=O(D,j=y(j,K)),27),k),D=h(y(D,[0,5]),[0,1390208809]),Q=_(Q=y(Q,K),33),k=h(k=_(k=O(k,Q=y(Q,L)),31),D),k=h(y(k,[0,5]),[0,944331445]);switch(j=[0,0],Q=[0,0],R){case 15:Q=O(Q,A([0,g[G+14]],48));case 14:Q=O(Q,A([0,g[G+13]],40));case 13:Q=O(Q,A([0,g[G+12]],32));case 12:Q=O(Q,A([0,g[G+11]],24));case 11:Q=O(Q,A([0,g[G+10]],16));case 10:Q=O(Q,A([0,g[G+9]],8));case 9:Q=y(Q=O(Q,[0,g[G+8]]),K),k=O(k,Q=y(Q=_(Q,33),L));case 8:j=O(j,A([0,g[G+7]],56));case 7:j=O(j,A([0,g[G+6]],48));case 6:j=O(j,A([0,g[G+5]],40));case 5:j=O(j,A([0,g[G+4]],32));case 4:j=O(j,A([0,g[G+3]],24));case 3:j=O(j,A([0,g[G+2]],16));case 2:j=O(j,A([0,g[G+1]],8));case 1:j=y(j=O(j,[0,g[G]]),L),D=O(D,j=y(j=_(j,31),K))}return D=h(D=O(D,[0,g.length]),k=O(k,[0,g.length])),k=h(k,D),D=h(D=x(D),k=x(k)),k=h(k,D),("00000000"+(D[0]>>>0).toString(16)).slice(-8)+("00000000"+(D[1]>>>0).toString(16)).slice(-8)+("00000000"+(k[0]>>>0).toString(16)).slice(-8)+("00000000"+(k[1]>>>0).toString(16)).slice(-8)},re.exports&&(J=re.exports=d),J.murmurHash3=d}()},35551:re=>{"use strict";function J(p){if(Array.isArray(p)){for(var w=0,d=Array(p.length);w<p.length;w++)d[w]=p[w];return d}return Array.from(p)}re.exports=function(w){var d=void 0,S=void 0;function I(h){if(!(h instanceof Object))throw new Error('Target "'+h+'" is not an object');S=h}function m(h){Object.keys(h).forEach(function(y){var _=h[y];if("function"!=typeof _)throw new Error('Trap "'+y+": "+_+'" is not a function');if(!Reflect[y])throw new Error('Trap "'+y+": "+_+'" is not a valid trap')}),d=h}I(function(){}),w&&I(w),m(Reflect);var l=new Proxy({},{get:function(y,_){return function(){for(var A=arguments.length,O=Array(A),x=0;x<A;x++)O[x]=arguments[x];return d[_].apply(null,[S].concat(J(O.slice(1))))}}});return{setTarget:I,setHandler:m,getTarget:function(){return S},getHandler:function(){return d},proxy:new Proxy(S,l)}}},63174:function(re,J){(function(){var p,w,d,S,I,m,l,h;h=function(y){return[(y&255<<24)>>>24,(y&255<<16)>>>16,(65280&y)>>>8,255&y].join(".")},l=function(y){var _,O,x,g,v;for(_=[],O=x=0;x<=3&&0!==y.length;O=++x){if(O>0){if("."!==y[0])throw new Error("Invalid IP");y=y.substring(1)}g=(v=w(y))[0],y=y.substring(v[1]),_.push(g)}if(0!==y.length)throw new Error("Invalid IP");switch(_.length){case 1:if(_[0]>4294967295)throw new Error("Invalid IP");return _[0]>>>0;case 2:if(_[0]>255||_[1]>16777215)throw new Error("Invalid IP");return(_[0]<<24|_[1])>>>0;case 3:if(_[0]>255||_[1]>255||_[2]>65535)throw new Error("Invalid IP");return(_[0]<<24|_[1]<<16|_[2])>>>0;case 4:if(_[0]>255||_[1]>255||_[2]>255||_[3]>255)throw new Error("Invalid IP");return(_[0]<<24|_[1]<<16|_[2]<<8|_[3])>>>0;default:throw new Error("Invalid IP")}},S=(d=function(y){return y.charCodeAt(0)})("0"),m=d("a"),I=d("A"),w=function(y){var _,A,O,x,g;for(x=0,_=10,A="9",O=0,y.length>1&&"0"===y[O]&&("x"===y[O+1]||"X"===y[O+1]?(O+=2,_=16):"0"<=y[O+1]&&y[O+1]<="9"&&(O++,_=8,A="7")),g=O;O<y.length;){if("0"<=y[O]&&y[O]<=A)x=x*_+(d(y[O])-S)>>>0;else{if(16!==_)break;if("a"<=y[O]&&y[O]<="f")x=x*_+(10+d(y[O])-m)>>>0;else{if(!("A"<=y[O]&&y[O]<="F"))break;x=x*_+(10+d(y[O])-I)>>>0}}if(x>4294967295)throw new Error("too large");O++}if(O===g)throw new Error("empty octet");return[x,O]},p=function(){function y(_,A){var x,g,v;if("string"!=typeof _)throw new Error("Missing `net' parameter");if(A||(v=_.split("/",2),_=v[0],A=v[1]),A||(A=32),"string"==typeof A&&A.indexOf(".")>-1){try{this.maskLong=l(A)}catch(R){throw new Error("Invalid mask: "+A)}for(x=g=32;g>=0;x=--g)if(this.maskLong===4294967295<<32-x>>>0){this.bitmask=x;break}}else{if(!A&&0!==A)throw new Error("Invalid mask: empty");this.bitmask=parseInt(A,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0)}try{this.netLong=(l(_)&this.maskLong)>>>0}catch(R){throw new Error("Invalid net address: "+_)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+A);this.size=Math.pow(2,32-this.bitmask),this.base=h(this.netLong),this.mask=h(this.maskLong),this.hostmask=h(~this.maskLong),this.first=this.bitmask<=30?h(this.netLong+1):this.base,this.last=h(this.bitmask<=30?this.netLong+this.size-2:this.netLong+this.size-1),this.broadcast=this.bitmask<=30?h(this.netLong+this.size-1):void 0}return y.prototype.contains=function(_){return"string"==typeof _&&(_.indexOf("/")>0||4!==_.split(".").length)&&(_=new y(_)),_ instanceof y?this.contains(_.base)&&this.contains(_.broadcast||_.last):(l(_)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},y.prototype.next=function(_){return null==_&&(_=1),new y(h(this.netLong+this.size*_),this.mask)},y.prototype.forEach=function(_){var A,O,x;for(x=l(this.first),O=l(this.last),A=0;x<=O;)_(h(x),x,A),A++,x++},y.prototype.toString=function(){return this.base+"/"+this.bitmask},y}(),J.ip2long=l,J.long2ip=h,J.Netmask=p}).call(this)},89690:(re,J,p)=>{var w=p(67779);function d(v,R){w.cipher.registerAlgorithm(v,function(){return new w.aes.Algorithm(v,R)})}p(236),p(50290),p(35813),re.exports=w.aes=w.aes||{},w.aes.startEncrypting=function(v,R,N,D){var k=g({key:v,output:N,decrypt:!1,mode:D});return k.start(R),k},w.aes.createEncryptionCipher=function(v,R){return g({key:v,output:null,decrypt:!1,mode:R})},w.aes.startDecrypting=function(v,R,N,D){var k=g({key:v,output:N,decrypt:!0,mode:D});return k.start(R),k},w.aes.createDecryptionCipher=function(v,R){return g({key:v,output:null,decrypt:!0,mode:R})},w.aes.Algorithm=function(v,R){S||A();var N=this;N.name=v,N.mode=new R({blockSize:16,cipher:{encrypt:function(D,k){return x(N._w,D,k,!1)},decrypt:function(D,k){return x(N._w,D,k,!0)}}}),N._init=!1},w.aes.Algorithm.prototype.initialize=function(v){if(!this._init){var N,R=v.key;if("string"!=typeof R||16!==R.length&&24!==R.length&&32!==R.length){if(w.util.isArray(R)&&(16===R.length||24===R.length||32===R.length)){N=R,R=w.util.createBuffer();for(var D=0;D<N.length;++D)R.putByte(N[D])}}else R=w.util.createBuffer(R);if(!w.util.isArray(R)){N=R,R=[];var k=N.length();if(16===k||24===k||32===k)for(k>>>=2,D=0;D<k;++D)R.push(N.getInt32())}if(!w.util.isArray(R)||4!==R.length&&6!==R.length&&8!==R.length)throw new Error("Invalid key parameter.");var Q=-1!==["CFB","OFB","CTR","GCM"].indexOf(this.mode.name);this._w=O(R,v.decrypt&&!Q),this._init=!0}},w.aes._expandKey=function(v,R){return S||A(),O(v,R)},w.aes._updateBlock=x,d("AES-ECB",w.cipher.modes.ecb),d("AES-CBC",w.cipher.modes.cbc),d("AES-CFB",w.cipher.modes.cfb),d("AES-OFB",w.cipher.modes.ofb),d("AES-CTR",w.cipher.modes.ctr),d("AES-GCM",w.cipher.modes.gcm);var m,l,h,y,_,S=!1;function A(){S=!0,h=[0,1,2,4,8,16,32,64,128,27,54];for(var v=new Array(256),R=0;R<128;++R)v[R]=R<<1,v[R+128]=R+128<<1^283;for(m=new Array(256),l=new Array(256),y=new Array(4),_=new Array(4),R=0;R<4;++R)y[R]=new Array(256),_[R]=new Array(256);var k,j,Q,L,K,G,C,N=0,D=0;for(R=0;R<256;++R){m[N]=L=(L=D^D<<1^D<<2^D<<3^D<<4)>>8^255&L^99,l[L]=N,G=(K=v[L])<<24^L<<16^L<<8^L^K,C=((k=v[N])^(j=v[k])^(Q=v[j]))<<24^(N^Q)<<16^(N^j^Q)<<8^N^k^Q;for(var z=0;z<4;++z)y[z][N]=G,_[z][L]=C,G=G<<24|G>>>8,C=C<<24|C>>>8;0===N?N=D=1:(N=k^v[v[v[k^Q]]],D^=v[v[D]])}}function O(v,R){for(var D,N=v.slice(0),k=1,j=N.length,L=4*(j+6+1),K=j;K<L;++K)D=N[K-1],K%j==0?(D=m[D>>>16&255]<<24^m[D>>>8&255]<<16^m[255&D]<<8^m[D>>>24]^h[k]<<24,k++):j>6&&K%j==4&&(D=m[D>>>24]<<24^m[D>>>16&255]<<16^m[D>>>8&255]<<8^m[255&D]),N[K]=N[K-j]^D;if(R){for(var G,C=_[0],z=_[1],te=_[2],Z=_[3],se=N.slice(0),ue=(K=0,(L=N.length)-4);K<L;K+=4,ue-=4)if(0===K||K===L-4)se[K]=N[ue],se[K+1]=N[ue+3],se[K+2]=N[ue+2],se[K+3]=N[ue+1];else for(var oe=0;oe<4;++oe)se[K+(3&-oe)]=C[m[(G=N[ue+oe])>>>24]]^z[m[G>>>16&255]]^te[m[G>>>8&255]]^Z[m[255&G]];N=se}return N}function x(v,R,N,D){var j,Q,L,K,G,C,z,te,Z,se,ue,oe,k=v.length/4-1;D?(j=_[0],Q=_[1],L=_[2],K=_[3],G=l):(j=y[0],Q=y[1],L=y[2],K=y[3],G=m),C=R[0]^v[0],z=R[D?3:1]^v[1],te=R[2]^v[2],Z=R[D?1:3]^v[3];for(var me=3,fe=1;fe<k;++fe)se=j[C>>>24]^Q[z>>>16&255]^L[te>>>8&255]^K[255&Z]^v[++me],ue=j[z>>>24]^Q[te>>>16&255]^L[Z>>>8&255]^K[255&C]^v[++me],oe=j[te>>>24]^Q[Z>>>16&255]^L[C>>>8&255]^K[255&z]^v[++me],Z=j[Z>>>24]^Q[C>>>16&255]^L[z>>>8&255]^K[255&te]^v[++me],C=se,z=ue,te=oe;N[0]=G[C>>>24]<<24^G[z>>>16&255]<<16^G[te>>>8&255]<<8^G[255&Z]^v[++me],N[D?3:1]=G[z>>>24]<<24^G[te>>>16&255]<<16^G[Z>>>8&255]<<8^G[255&C]^v[++me],N[2]=G[te>>>24]<<24^G[Z>>>16&255]<<16^G[C>>>8&255]<<8^G[255&z]^v[++me],N[D?1:3]=G[Z>>>24]<<24^G[C>>>16&255]<<16^G[z>>>8&255]<<8^G[255&te]^v[++me]}function g(v){var D,N="AES-"+((v=v||{}).mode||"CBC").toUpperCase(),k=(D=v.decrypt?w.cipher.createDecipher(N,v.key):w.cipher.createCipher(N,v.key)).start;return D.start=function(j,Q){var L=null;Q instanceof w.util.ByteBuffer&&(L=Q,Q={}),(Q=Q||{}).output=L,Q.iv=j,k.call(D,Q)},D}},97238:(re,J,p)=>{var w=p(67779);p(35813),p(40072);var d=re.exports=w.asn1=w.asn1||{};function S(h,y,_){if(_>y){var A=new Error("Too few bytes to parse DER.");throw A.available=h.length(),A.remaining=y,A.requested=_,A}}function m(h,y,_,A){var O;S(h,y,2);var x=h.getByte();y--;var g=192&x,v=31&x;O=h.length();var R=function(h,y){var _=h.getByte();if(y--,128!==_){var A;if(128&_){var x=127&_;S(h,y,x),A=h.getInt(x<<3)}else A=_;if(A<0)throw new Error("Negative length: "+A);return A}}(h,y);if(y-=O-h.length(),void 0!==R&&R>y){if(A.strict){var N=new Error("Too few bytes to read ASN.1 value.");throw N.available=h.length(),N.remaining=y,N.requested=R,N}R=y}var D,k,j=32==(32&x);if(j)if(D=[],void 0===R)for(;;){if(S(h,y,2),h.bytes(2)===String.fromCharCode(0,0)){h.getBytes(2),y-=2;break}O=h.length(),D.push(m(h,y,_+1,A)),y-=O-h.length()}else for(;R>0;)O=h.length(),D.push(m(h,R,_+1,A)),y-=O-h.length(),R-=O-h.length();if(void 0===D&&g===d.Class.UNIVERSAL&&v===d.Type.BITSTRING&&(k=h.bytes(R)),void 0===D&&A.decodeBitStrings&&g===d.Class.UNIVERSAL&&v===d.Type.BITSTRING&&R>1){var Q=h.read,L=y,K=0;if(v===d.Type.BITSTRING&&(S(h,y,1),K=h.getByte(),y--),0===K)try{O=h.length();var C=m(h,y,_+1,{strict:!0,decodeBitStrings:!0}),z=O-h.length();y-=z,v==d.Type.BITSTRING&&z++;var te=C.tagClass;z===R&&(te===d.Class.UNIVERSAL||te===d.Class.CONTEXT_SPECIFIC)&&(D=[C])}catch{}void 0===D&&(h.read=Q,y=L)}if(void 0===D){if(void 0===R){if(A.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");R=y}if(v===d.Type.BMPSTRING)for(D="";R>0;R-=2)S(h,y,2),D+=String.fromCharCode(h.getInt16()),y-=2;else D=h.getBytes(R),y-=R}return d.create(g,v,j,D,void 0===k?null:{bitStringContents:k})}d.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},d.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},d.create=function(h,y,_,A,O){if(w.util.isArray(A)){for(var x=[],g=0;g<A.length;++g)void 0!==A[g]&&x.push(A[g]);A=x}var v={tagClass:h,type:y,constructed:_,composed:_||w.util.isArray(A),value:A};return O&&"bitStringContents"in O&&(v.bitStringContents=O.bitStringContents,v.original=d.copy(v)),v},d.copy=function(h,y){var _;if(w.util.isArray(h)){_=[];for(var A=0;A<h.length;++A)_.push(d.copy(h[A],y));return _}return"string"==typeof h?h:(_={tagClass:h.tagClass,type:h.type,constructed:h.constructed,composed:h.composed,value:d.copy(h.value,y)},y&&!y.excludeBitStringContents&&(_.bitStringContents=h.bitStringContents),_)},d.equals=function(h,y,_){if(w.util.isArray(h)){if(!w.util.isArray(y)||h.length!==y.length)return!1;for(var A=0;A<h.length;++A)if(!d.equals(h[A],y[A]))return!1;return!0}if(typeof h!=typeof y)return!1;if("string"==typeof h)return h===y;var O=h.tagClass===y.tagClass&&h.type===y.type&&h.constructed===y.constructed&&h.composed===y.composed&&d.equals(h.value,y.value);return _&&_.includeBitStringContents&&(O=O&&h.bitStringContents===y.bitStringContents),O},d.getBerValueLength=function(h){var y=h.getByte();if(128!==y)return 128&y?h.getInt((127&y)<<3):y},d.fromDer=function(h,y){void 0===y&&(y={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),"boolean"==typeof y&&(y={strict:y,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in y||(y.strict=!0),"parseAllBytes"in y||(y.parseAllBytes=!0),"decodeBitStrings"in y||(y.decodeBitStrings=!0),"string"==typeof h&&(h=w.util.createBuffer(h));var _=h.length(),A=m(h,h.length(),0,y);if(y.parseAllBytes&&0!==h.length()){var O=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw O.byteCount=_,O.remaining=h.length(),O}return A},d.toDer=function(h){var y=w.util.createBuffer(),_=h.tagClass|h.type,A=w.util.createBuffer(),O=!1;if("bitStringContents"in h&&(O=!0,h.original&&(O=d.equals(h,h.original))),O)A.putBytes(h.bitStringContents);else if(h.composed){h.constructed?_|=32:A.putByte(0);for(var x=0;x<h.value.length;++x)void 0!==h.value[x]&&A.putBuffer(d.toDer(h.value[x]))}else if(h.type===d.Type.BMPSTRING)for(x=0;x<h.value.length;++x)A.putInt16(h.value.charCodeAt(x));else h.type===d.Type.INTEGER&&h.value.length>1&&(0===h.value.charCodeAt(0)&&0==(128&h.value.charCodeAt(1))||255===h.value.charCodeAt(0)&&128==(128&h.value.charCodeAt(1)))?A.putBytes(h.value.substr(1)):A.putBytes(h.value);if(y.putByte(_),A.length()<=127)y.putByte(127&A.length());else{var g=A.length(),v="";do{v+=String.fromCharCode(255&g),g>>>=8}while(g>0);for(y.putByte(128|v.length),x=v.length-1;x>=0;--x)y.putByte(v.charCodeAt(x))}return y.putBuffer(A),y},d.oidToDer=function(h){var y=h.split("."),_=w.util.createBuffer();_.putByte(40*parseInt(y[0],10)+parseInt(y[1],10));for(var A,O,x,g,v=2;v<y.length;++v){A=!0,O=[],x=parseInt(y[v],10);do{g=127&x,x>>>=7,A||(g|=128),O.push(g),A=!1}while(x>0);for(var R=O.length-1;R>=0;--R)_.putByte(O[R])}return _},d.derToOid=function(h){var y;"string"==typeof h&&(h=w.util.createBuffer(h));var _=h.getByte();y=Math.floor(_/40)+"."+_%40;for(var A=0;h.length()>0;)A<<=7,128&(_=h.getByte())?A+=127&_:(y+="."+(A+_),A=0);return y},d.utcTimeToDate=function(h){var y=new Date,_=parseInt(h.substr(0,2),10);_=_>=50?1900+_:2e3+_;var A=parseInt(h.substr(2,2),10)-1,O=parseInt(h.substr(4,2),10),x=parseInt(h.substr(6,2),10),g=parseInt(h.substr(8,2),10),v=0;if(h.length>11){var R=h.charAt(10),N=10;"+"!==R&&"-"!==R&&(v=parseInt(h.substr(10,2),10),N+=2)}if(y.setUTCFullYear(_,A,O),y.setUTCHours(x,g,v,0),N&&("+"===(R=h.charAt(N))||"-"===R)){var j=60*parseInt(h.substr(N+1,2),10)+parseInt(h.substr(N+4,2),10);j*=6e4,y.setTime("+"===R?+y-j:+y+j)}return y},d.generalizedTimeToDate=function(h){var y=new Date,_=parseInt(h.substr(0,4),10),A=parseInt(h.substr(4,2),10)-1,O=parseInt(h.substr(6,2),10),x=parseInt(h.substr(8,2),10),g=parseInt(h.substr(10,2),10),v=parseInt(h.substr(12,2),10),R=0,N=0,D=!1;"Z"===h.charAt(h.length-1)&&(D=!0);var k=h.length-5,j=h.charAt(k);return"+"!==j&&"-"!==j||(N=60*parseInt(h.substr(k+1,2),10)+parseInt(h.substr(k+4,2),10),N*=6e4,"+"===j&&(N*=-1),D=!0),"."===h.charAt(14)&&(R=1e3*parseFloat(h.substr(14),10)),D?(y.setUTCFullYear(_,A,O),y.setUTCHours(x,g,v,R),y.setTime(+y+N)):(y.setFullYear(_,A,O),y.setHours(x,g,v,R)),y},d.dateToUtcTime=function(h){if("string"==typeof h)return h;var y="",_=[];_.push((""+h.getUTCFullYear()).substr(2)),_.push(""+(h.getUTCMonth()+1)),_.push(""+h.getUTCDate()),_.push(""+h.getUTCHours()),_.push(""+h.getUTCMinutes()),_.push(""+h.getUTCSeconds());for(var A=0;A<_.length;++A)_[A].length<2&&(y+="0"),y+=_[A];return y+"Z"},d.dateToGeneralizedTime=function(h){if("string"==typeof h)return h;var y="",_=[];_.push(""+h.getUTCFullYear()),_.push(""+(h.getUTCMonth()+1)),_.push(""+h.getUTCDate()),_.push(""+h.getUTCHours()),_.push(""+h.getUTCMinutes()),_.push(""+h.getUTCSeconds());for(var A=0;A<_.length;++A)_[A].length<2&&(y+="0"),y+=_[A];return y+"Z"},d.integerToDer=function(h){var y=w.util.createBuffer();if(h>=-128&&h<128)return y.putSignedInt(h,8);if(h>=-32768&&h<32768)return y.putSignedInt(h,16);if(h>=-8388608&&h<8388608)return y.putSignedInt(h,24);if(h>=-2147483648&&h<2147483648)return y.putSignedInt(h,32);var _=new Error("Integer too large; max is 32-bits.");throw _.integer=h,_},d.derToInteger=function(h){"string"==typeof h&&(h=w.util.createBuffer(h));var y=8*h.length();if(y>32)throw new Error("Integer too large; max is 32-bits.");return h.getSignedInt(y)},d.validate=function(h,y,_,A){var O=!1;if((h.tagClass===y.tagClass||typeof y.tagClass>"u")&&(h.type===y.type||typeof y.type>"u"))if(h.constructed===y.constructed||typeof y.constructed>"u"){if(O=!0,y.value&&w.util.isArray(y.value))for(var x=0,g=0;O&&g<y.value.length;++g)O=y.value[g].optional||!1,h.value[x]&&((O=d.validate(h.value[x],y.value[g],_,A))?++x:y.value[g].optional&&(O=!0)),!O&&A&&A.push("["+y.name+'] Tag class "'+y.tagClass+'", type "'+y.type+'" expected value length "'+y.value.length+'", got "'+h.value.length+'"');if(O&&_&&(y.capture&&(_[y.capture]=h.value),y.captureAsn1&&(_[y.captureAsn1]=h),y.captureBitStringContents&&"bitStringContents"in h&&(_[y.captureBitStringContents]=h.bitStringContents),y.captureBitStringValue&&"bitStringContents"in h))if(h.bitStringContents.length<2)_[y.captureBitStringValue]="";else{if(0!==h.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");_[y.captureBitStringValue]=h.bitStringContents.slice(1)}}else A&&A.push("["+y.name+'] Expected constructed "'+y.constructed+'", got "'+h.constructed+'"');else A&&(h.tagClass!==y.tagClass&&A.push("["+y.name+'] Expected tag class "'+y.tagClass+'", got "'+h.tagClass+'"'),h.type!==y.type&&A.push("["+y.name+'] Expected type "'+y.type+'", got "'+h.type+'"'));return O};var l=/[^\\u0000-\\u00ff]/;d.prettyPrint=function(h,y,_){var A="";_=_||2,(y=y||0)>0&&(A+="\n");for(var O="",x=0;x<y*_;++x)O+=" ";switch(A+=O+"Tag: ",h.tagClass){case d.Class.UNIVERSAL:A+="Universal:";break;case d.Class.APPLICATION:A+="Application:";break;case d.Class.CONTEXT_SPECIFIC:A+="Context-Specific:";break;case d.Class.PRIVATE:A+="Private:"}if(h.tagClass===d.Class.UNIVERSAL)switch(A+=h.type,h.type){case d.Type.NONE:A+=" (None)";break;case d.Type.BOOLEAN:A+=" (Boolean)";break;case d.Type.INTEGER:A+=" (Integer)";break;case d.Type.BITSTRING:A+=" (Bit string)";break;case d.Type.OCTETSTRING:A+=" (Octet string)";break;case d.Type.NULL:A+=" (Null)";break;case d.Type.OID:A+=" (Object Identifier)";break;case d.Type.ODESC:A+=" (Object Descriptor)";break;case d.Type.EXTERNAL:A+=" (External or Instance of)";break;case d.Type.REAL:A+=" (Real)";break;case d.Type.ENUMERATED:A+=" (Enumerated)";break;case d.Type.EMBEDDED:A+=" (Embedded PDV)";break;case d.Type.UTF8:A+=" (UTF8)";break;case d.Type.ROID:A+=" (Relative Object Identifier)";break;case d.Type.SEQUENCE:A+=" (Sequence)";break;case d.Type.SET:A+=" (Set)";break;case d.Type.PRINTABLESTRING:A+=" (Printable String)";break;case d.Type.IA5String:A+=" (IA5String (ASCII))";break;case d.Type.UTCTIME:A+=" (UTC time)";break;case d.Type.GENERALIZEDTIME:A+=" (Generalized time)";break;case d.Type.BMPSTRING:A+=" (BMP String)"}else A+=h.type;if(A+="\n",A+=O+"Constructed: "+h.constructed+"\n",h.composed){var g=0,v="";for(x=0;x<h.value.length;++x)void 0!==h.value[x]&&(g+=1,v+=d.prettyPrint(h.value[x],y+1,_),x+1<h.value.length&&(v+=","));A+=O+"Sub values: "+g+v}else{if(A+=O+"Value: ",h.type===d.Type.OID){var R=d.derToOid(h.value);A+=R,w.pki&&w.pki.oids&&R in w.pki.oids&&(A+=" ("+w.pki.oids[R]+") ")}if(h.type===d.Type.INTEGER)try{A+=d.derToInteger(h.value)}catch{A+="0x"+w.util.bytesToHex(h.value)}else if(h.type===d.Type.BITSTRING){if(A+=h.value.length>1?"0x"+w.util.bytesToHex(h.value.slice(1)):"(none)",h.value.length>0){var N=h.value.charCodeAt(0);1==N?A+=" (1 unused bit shown)":N>1&&(A+=" ("+N+" unused bits shown)")}}else if(h.type===d.Type.OCTETSTRING)l.test(h.value)||(A+="("+h.value+") "),A+="0x"+w.util.bytesToHex(h.value);else if(h.type===d.Type.UTF8)try{A+=w.util.decodeUtf8(h.value)}catch(D){if("URI malformed"!==D.message)throw D;A+="0x"+w.util.bytesToHex(h.value)+" (malformed UTF8)"}else h.type===d.Type.PRINTABLESTRING||h.type===d.Type.IA5String?A+=h.value:l.test(h.value)?A+="0x"+w.util.bytesToHex(h.value):A+=0===h.value.length?"[null]":h.value}return A}},29119:(re,J,p)=>{var w=p(13195).Buffer,d={};re.exports=d;var S={};d.encode=function(m,l,h){if("string"!=typeof l)throw new TypeError('"alphabet" must be a string.');if(void 0!==h&&"number"!=typeof h)throw new TypeError('"maxline" must be a number.');var y="";if(m instanceof Uint8Array){var _=0,A=l.length,O=l.charAt(0),x=[0];for(_=0;_<m.length;++_){for(var g=0,v=m[_];g<x.length;++g)x[g]=(v+=x[g]<<8)%A,v=v/A|0;for(;v>0;)x.push(v%A),v=v/A|0}for(_=0;0===m[_]&&_<m.length-1;++_)y+=O;for(_=x.length-1;_>=0;--_)y+=l[x[_]]}else y=function I(m,l){var h=0,y=l.length,_=l.charAt(0),A=[0];for(h=0;h<m.length();++h){for(var O=0,x=m.at(h);O<A.length;++O)A[O]=(x+=A[O]<<8)%y,x=x/y|0;for(;x>0;)A.push(x%y),x=x/y|0}var g="";for(h=0;0===m.at(h)&&h<m.length()-1;++h)g+=_;for(h=A.length-1;h>=0;--h)g+=l[A[h]];return g}(m,l);if(h){var R=new RegExp(".{1,"+h+"}","g");y=y.match(R).join("\r\n")}return y},d.decode=function(m,l){if("string"!=typeof m)throw new TypeError('"input" must be a string.');if("string"!=typeof l)throw new TypeError('"alphabet" must be a string.');var h=S[l];if(!h){h=S[l]=[];for(var y=0;y<l.length;++y)h[l.charCodeAt(y)]=y}m=m.replace(/\s/g,"");var _=l.length,A=l.charAt(0),O=[0];for(y=0;y<m.length;y++){var x=h[m.charCodeAt(y)];if(void 0===x)return;for(var g=0,v=x;g<O.length;++g)O[g]=255&(v+=O[g]*_),v>>=8;for(;v>0;)O.push(255&v),v>>=8}for(var R=0;m[R]===A&&R<m.length-1;++R)O.push(0);return typeof w<"u"?w.from(O.reverse()):new Uint8Array(O.reverse())}},236:(re,J,p)=>{var w=p(67779);p(35813),re.exports=w.cipher=w.cipher||{},w.cipher.algorithms=w.cipher.algorithms||{},w.cipher.createCipher=function(S,I){var m=S;if("string"==typeof m&&(m=w.cipher.getAlgorithm(m))&&(m=m()),!m)throw new Error("Unsupported algorithm: "+S);return new w.cipher.BlockCipher({algorithm:m,key:I,decrypt:!1})},w.cipher.createDecipher=function(S,I){var m=S;if("string"==typeof m&&(m=w.cipher.getAlgorithm(m))&&(m=m()),!m)throw new Error("Unsupported algorithm: "+S);return new w.cipher.BlockCipher({algorithm:m,key:I,decrypt:!0})},w.cipher.registerAlgorithm=function(S,I){S=S.toUpperCase(),w.cipher.algorithms[S]=I},w.cipher.getAlgorithm=function(S){return(S=S.toUpperCase())in w.cipher.algorithms?w.cipher.algorithms[S]:null};var d=w.cipher.BlockCipher=function(S){this.algorithm=S.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=S.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=S.decrypt,this.algorithm.initialize(S)};d.prototype.start=function(S){S=S||{};var I={};for(var m in S)I[m]=S[m];I.decrypt=this._decrypt,this._finish=!1,this._input=w.util.createBuffer(),this.output=S.output||w.util.createBuffer(),this.mode.start(I)},d.prototype.update=function(S){for(S&&this._input.putBuffer(S);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},d.prototype.finish=function(S){S&&("ECB"===this.mode.name||"CBC"===this.mode.name)&&(this.mode.pad=function(m){return S(this.blockSize,m,!1)},this.mode.unpad=function(m){return S(this.blockSize,m,!0)});var I={};return I.decrypt=this._decrypt,I.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,I)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,I))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,I))}},50290:(re,J,p)=>{var w=p(67779);p(35813),w.cipher=w.cipher||{};var d=re.exports=w.cipher.modes=w.cipher.modes||{};function S(l,h){if("string"==typeof l&&(l=w.util.createBuffer(l)),w.util.isArray(l)&&l.length>4){var y=l;l=w.util.createBuffer();for(var _=0;_<y.length;++_)l.putByte(y[_])}if(l.length()<h)throw new Error("Invalid IV length; got "+l.length()+" bytes and expected "+h+" bytes.");if(!w.util.isArray(l)){var A=[],O=h/4;for(_=0;_<O;++_)A.push(l.getInt32());l=A}return l}function I(l){l[l.length-1]=l[l.length-1]+1&4294967295}function m(l){return[l/4294967296|0,4294967295&l]}d.ecb=function(l){l=l||{},this.name="ECB",this.cipher=l.cipher,this.blockSize=l.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},d.ecb.prototype.start=function(l){},d.ecb.prototype.encrypt=function(l,h,y){if(l.length()<this.blockSize&&!(y&&l.length()>0))return!0;for(var _=0;_<this._ints;++_)this._inBlock[_]=l.getInt32();for(this.cipher.encrypt(this._inBlock,this._outBlock),_=0;_<this._ints;++_)h.putInt32(this._outBlock[_])},d.ecb.prototype.decrypt=function(l,h,y){if(l.length()<this.blockSize&&!(y&&l.length()>0))return!0;for(var _=0;_<this._ints;++_)this._inBlock[_]=l.getInt32();for(this.cipher.decrypt(this._inBlock,this._outBlock),_=0;_<this._ints;++_)h.putInt32(this._outBlock[_])},d.ecb.prototype.pad=function(l,h){var y=l.length()===this.blockSize?this.blockSize:this.blockSize-l.length();return l.fillWithByte(y,y),!0},d.ecb.prototype.unpad=function(l,h){if(h.overflow>0)return!1;var y=l.length(),_=l.at(y-1);return!(_>this.blockSize<<2||(l.truncate(_),0))},d.cbc=function(l){l=l||{},this.name="CBC",this.cipher=l.cipher,this.blockSize=l.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},d.cbc.prototype.start=function(l){if(null===l.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in l))throw new Error("Invalid IV parameter.");this._iv=S(l.iv,this.blockSize),this._prev=this._iv.slice(0)}},d.cbc.prototype.encrypt=function(l,h,y){if(l.length()<this.blockSize&&!(y&&l.length()>0))return!0;for(var _=0;_<this._ints;++_)this._inBlock[_]=this._prev[_]^l.getInt32();for(this.cipher.encrypt(this._inBlock,this._outBlock),_=0;_<this._ints;++_)h.putInt32(this._outBlock[_]);this._prev=this._outBlock},d.cbc.prototype.decrypt=function(l,h,y){if(l.length()<this.blockSize&&!(y&&l.length()>0))return!0;for(var _=0;_<this._ints;++_)this._inBlock[_]=l.getInt32();for(this.cipher.decrypt(this._inBlock,this._outBlock),_=0;_<this._ints;++_)h.putInt32(this._prev[_]^this._outBlock[_]);this._prev=this._inBlock.slice(0)},d.cbc.prototype.pad=function(l,h){var y=l.length()===this.blockSize?this.blockSize:this.blockSize-l.length();return l.fillWithByte(y,y),!0},d.cbc.prototype.unpad=function(l,h){if(h.overflow>0)return!1;var y=l.length(),_=l.at(y-1);return!(_>this.blockSize<<2||(l.truncate(_),0))},d.cfb=function(l){l=l||{},this.name="CFB",this.cipher=l.cipher,this.blockSize=l.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=w.util.createBuffer(),this._partialBytes=0},d.cfb.prototype.start=function(l){if(!("iv"in l))throw new Error("Invalid IV parameter.");this._iv=S(l.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},d.cfb.prototype.encrypt=function(l,h,y){var _=l.length();if(0===_)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&_>=this.blockSize)for(var A=0;A<this._ints;++A)this._inBlock[A]=l.getInt32()^this._outBlock[A],h.putInt32(this._inBlock[A]);else{var O=(this.blockSize-_)%this.blockSize;for(O>0&&(O=this.blockSize-O),this._partialOutput.clear(),A=0;A<this._ints;++A)this._partialBlock[A]=l.getInt32()^this._outBlock[A],this._partialOutput.putInt32(this._partialBlock[A]);if(O>0)l.read-=this.blockSize;else for(A=0;A<this._ints;++A)this._inBlock[A]=this._partialBlock[A];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),O>0&&!y)return h.putBytes(this._partialOutput.getBytes(O-this._partialBytes)),this._partialBytes=O,!0;h.putBytes(this._partialOutput.getBytes(_-this._partialBytes)),this._partialBytes=0}},d.cfb.prototype.decrypt=function(l,h,y){var _=l.length();if(0===_)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&_>=this.blockSize)for(var A=0;A<this._ints;++A)this._inBlock[A]=l.getInt32(),h.putInt32(this._inBlock[A]^this._outBlock[A]);else{var O=(this.blockSize-_)%this.blockSize;for(O>0&&(O=this.blockSize-O),this._partialOutput.clear(),A=0;A<this._ints;++A)this._partialBlock[A]=l.getInt32(),this._partialOutput.putInt32(this._partialBlock[A]^this._outBlock[A]);if(O>0)l.read-=this.blockSize;else for(A=0;A<this._ints;++A)this._inBlock[A]=this._partialBlock[A];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),O>0&&!y)return h.putBytes(this._partialOutput.getBytes(O-this._partialBytes)),this._partialBytes=O,!0;h.putBytes(this._partialOutput.getBytes(_-this._partialBytes)),this._partialBytes=0}},d.ofb=function(l){l=l||{},this.name="OFB",this.cipher=l.cipher,this.blockSize=l.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=w.util.createBuffer(),this._partialBytes=0},d.ofb.prototype.start=function(l){if(!("iv"in l))throw new Error("Invalid IV parameter.");this._iv=S(l.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},d.ofb.prototype.encrypt=function(l,h,y){var _=l.length();if(0===l.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&_>=this.blockSize)for(var A=0;A<this._ints;++A)h.putInt32(l.getInt32()^this._outBlock[A]),this._inBlock[A]=this._outBlock[A];else{var O=(this.blockSize-_)%this.blockSize;for(O>0&&(O=this.blockSize-O),this._partialOutput.clear(),A=0;A<this._ints;++A)this._partialOutput.putInt32(l.getInt32()^this._outBlock[A]);if(O>0)l.read-=this.blockSize;else for(A=0;A<this._ints;++A)this._inBlock[A]=this._outBlock[A];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),O>0&&!y)return h.putBytes(this._partialOutput.getBytes(O-this._partialBytes)),this._partialBytes=O,!0;h.putBytes(this._partialOutput.getBytes(_-this._partialBytes)),this._partialBytes=0}},d.ofb.prototype.decrypt=d.ofb.prototype.encrypt,d.ctr=function(l){l=l||{},this.name="CTR",this.cipher=l.cipher,this.blockSize=l.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=w.util.createBuffer(),this._partialBytes=0},d.ctr.prototype.start=function(l){if(!("iv"in l))throw new Error("Invalid IV parameter.");this._iv=S(l.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},d.ctr.prototype.encrypt=function(l,h,y){var _=l.length();if(0===_)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&_>=this.blockSize)for(var A=0;A<this._ints;++A)h.putInt32(l.getInt32()^this._outBlock[A]);else{var O=(this.blockSize-_)%this.blockSize;for(O>0&&(O=this.blockSize-O),this._partialOutput.clear(),A=0;A<this._ints;++A)this._partialOutput.putInt32(l.getInt32()^this._outBlock[A]);if(O>0&&(l.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),O>0&&!y)return h.putBytes(this._partialOutput.getBytes(O-this._partialBytes)),this._partialBytes=O,!0;h.putBytes(this._partialOutput.getBytes(_-this._partialBytes)),this._partialBytes=0}I(this._inBlock)},d.ctr.prototype.decrypt=d.ctr.prototype.encrypt,d.gcm=function(l){l=l||{},this.name="GCM",this.cipher=l.cipher,this.blockSize=l.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=w.util.createBuffer(),this._partialBytes=0,this._R=3774873600},d.gcm.prototype.start=function(l){if(!("iv"in l))throw new Error("Invalid IV parameter.");var y,h=w.util.createBuffer(l.iv);if(this._cipherLength=0,y="additionalData"in l?w.util.createBuffer(l.additionalData):w.util.createBuffer(),this._tagLength="tagLength"in l?l.tagLength:128,this._tag=null,l.decrypt&&(this._tag=w.util.createBuffer(l.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var _=h.length();if(12===_)this._j0=[h.getInt32(),h.getInt32(),h.getInt32(),1];else{for(this._j0=[0,0,0,0];h.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[h.getInt32(),h.getInt32(),h.getInt32(),h.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(m(8*_)))}this._inBlock=this._j0.slice(0),I(this._inBlock),this._partialBytes=0,y=w.util.createBuffer(y),this._aDataLength=m(8*y.length());var A=y.length()%this.blockSize;for(A&&y.fillWithByte(0,this.blockSize-A),this._s=[0,0,0,0];y.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[y.getInt32(),y.getInt32(),y.getInt32(),y.getInt32()])},d.gcm.prototype.encrypt=function(l,h,y){var _=l.length();if(0===_)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&_>=this.blockSize){for(var A=0;A<this._ints;++A)h.putInt32(this._outBlock[A]^=l.getInt32());this._cipherLength+=this.blockSize}else{var O=(this.blockSize-_)%this.blockSize;for(O>0&&(O=this.blockSize-O),this._partialOutput.clear(),A=0;A<this._ints;++A)this._partialOutput.putInt32(l.getInt32()^this._outBlock[A]);if(O<=0||y){if(y){var x=_%this.blockSize;this._cipherLength+=x,this._partialOutput.truncate(this.blockSize-x)}else this._cipherLength+=this.blockSize;for(A=0;A<this._ints;++A)this._outBlock[A]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),O>0&&!y)return l.read-=this.blockSize,h.putBytes(this._partialOutput.getBytes(O-this._partialBytes)),this._partialBytes=O,!0;h.putBytes(this._partialOutput.getBytes(_-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),I(this._inBlock)},d.gcm.prototype.decrypt=function(l,h,y){var _=l.length();if(_<this.blockSize&&!(y&&_>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),I(this._inBlock),this._hashBlock[0]=l.getInt32(),this._hashBlock[1]=l.getInt32(),this._hashBlock[2]=l.getInt32(),this._hashBlock[3]=l.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var A=0;A<this._ints;++A)h.putInt32(this._outBlock[A]^this._hashBlock[A]);this._cipherLength+=_<this.blockSize?_%this.blockSize:this.blockSize},d.gcm.prototype.afterFinish=function(l,h){var y=!0;h.decrypt&&h.overflow&&l.truncate(this.blockSize-h.overflow),this.tag=w.util.createBuffer();var _=this._aDataLength.concat(m(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,_);var A=[];this.cipher.encrypt(this._j0,A);for(var O=0;O<this._ints;++O)this.tag.putInt32(this._s[O]^A[O]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),h.decrypt&&this.tag.bytes()!==this._tag&&(y=!1),y},d.gcm.prototype.multiply=function(l,h){for(var y=[0,0,0,0],_=h.slice(0),A=0;A<128;++A)l[A/32|0]&1<<31-A%32&&(y[0]^=_[0],y[1]^=_[1],y[2]^=_[2],y[3]^=_[3]),this.pow(_,_);return y},d.gcm.prototype.pow=function(l,h){for(var y=1&l[3],_=3;_>0;--_)h[_]=l[_]>>>1|(1&l[_-1])<<31;h[0]=l[0]>>>1,y&&(h[0]^=this._R)},d.gcm.prototype.tableMultiply=function(l){for(var h=[0,0,0,0],y=0;y<32;++y){var O=this._m[y][l[y/8|0]>>>4*(7-y%8)&15];h[0]^=O[0],h[1]^=O[1],h[2]^=O[2],h[3]^=O[3]}return h},d.gcm.prototype.ghash=function(l,h,y){return h[0]^=y[0],h[1]^=y[1],h[2]^=y[2],h[3]^=y[3],this.tableMultiply(h)},d.gcm.prototype.generateHashTable=function(l,h){for(var y=8/h,_=4*y,A=16*y,O=new Array(A),x=0;x<A;++x){var g=[0,0,0,0];g[x/_|0]=1<<h-1<<(_-1-x%_)*h,O[x]=this.generateSubHashTable(this.multiply(g,l),h)}return O},d.gcm.prototype.generateSubHashTable=function(l,h){var y=1<<h,_=y>>>1,A=new Array(y);A[_]=l.slice(0);for(var O=_>>>1;O>0;)this.pow(A[2*O],A[O]=[]),O>>=1;for(O=2;O<_;){for(var x=1;x<O;++x){var g=A[O],v=A[x];A[O+x]=[g[0]^v[0],g[1]^v[1],g[2]^v[2],g[3]^v[3]]}O*=2}for(A[0]=[0,0,0,0],O=_+1;O<y;++O){var R=A[O^_];A[O]=[l[0]^R[0],l[1]^R[1],l[2]^R[2],l[3]^R[3]]}return A}},24590:(re,J,p)=>{var w=p(67779);function d(v,R){w.cipher.registerAlgorithm(v,function(){return new w.des.Algorithm(v,R)})}p(236),p(50290),p(35813),re.exports=w.des=w.des||{},w.des.startEncrypting=function(v,R,N,D){var k=g({key:v,output:N,decrypt:!1,mode:D||(null===R?"ECB":"CBC")});return k.start(R),k},w.des.createEncryptionCipher=function(v,R){return g({key:v,output:null,decrypt:!1,mode:R})},w.des.startDecrypting=function(v,R,N,D){var k=g({key:v,output:N,decrypt:!0,mode:D||(null===R?"ECB":"CBC")});return k.start(R),k},w.des.createDecryptionCipher=function(v,R){return g({key:v,output:null,decrypt:!0,mode:R})},w.des.Algorithm=function(v,R){var N=this;N.name=v,N.mode=new R({blockSize:8,cipher:{encrypt:function(D,k){return x(N._keys,D,k,!1)},decrypt:function(D,k){return x(N._keys,D,k,!0)}}}),N._init=!1},w.des.Algorithm.prototype.initialize=function(v){if(!this._init){var R=w.util.createBuffer(v.key);if(0===this.name.indexOf("3DES")&&24!==R.length())throw new Error("Invalid Triple-DES key size: "+8*R.length());this._keys=function O(v){for(var ae,R=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],N=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],D=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],k=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],j=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],Q=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],L=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],K=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],G=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],C=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],z=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],te=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],Z=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],se=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],ue=v.length()>8?3:1,oe=[],me=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],fe=0,pe=0;pe<ue;pe++){var ce=v.getInt32(),_e=v.getInt32();ce^=(ae=252645135&(ce>>>4^_e))<<4,ce^=ae=65535&((_e^=ae)>>>-16^ce),ce^=(ae=858993459&(ce>>>2^(_e^=ae<<-16)))<<2,ce^=ae=65535&((_e^=ae)>>>-16^ce),ce^=(ae=1431655765&(ce>>>1^(_e^=ae<<-16)))<<1,ce^=ae=16711935&((_e^=ae)>>>8^ce),ae=(ce^=(ae=1431655765&(ce>>>1^(_e^=ae<<8)))<<1)<<8|(_e^=ae)>>>20&240,ce=_e<<24|_e<<8&16711680|_e>>>8&65280|_e>>>24&240,_e=ae;for(var de=0;de<me.length;++de){me[de]?(ce=ce<<2|ce>>>26,_e=_e<<2|_e>>>26):(ce=ce<<1|ce>>>27,_e=_e<<1|_e>>>27);var ye=R[(ce&=-15)>>>28]|N[ce>>>24&15]|D[ce>>>20&15]|k[ce>>>16&15]|j[ce>>>12&15]|Q[ce>>>8&15]|L[ce>>>4&15],we=K[(_e&=-15)>>>28]|G[_e>>>24&15]|C[_e>>>20&15]|z[_e>>>16&15]|te[_e>>>12&15]|Z[_e>>>8&15]|se[_e>>>4&15];oe[fe++]=ye^(ae=65535&(we>>>16^ye)),oe[fe++]=we^ae<<16}}return oe}(R),this._init=!0}},d("DES-ECB",w.cipher.modes.ecb),d("DES-CBC",w.cipher.modes.cbc),d("DES-CFB",w.cipher.modes.cfb),d("DES-OFB",w.cipher.modes.ofb),d("DES-CTR",w.cipher.modes.ctr),d("3DES-ECB",w.cipher.modes.ecb),d("3DES-CBC",w.cipher.modes.cbc),d("3DES-CFB",w.cipher.modes.cfb),d("3DES-OFB",w.cipher.modes.ofb),d("3DES-CTR",w.cipher.modes.ctr);var S=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],I=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],m=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],l=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],y=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],_=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],A=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function x(v,R,N,D){var j,k=32===v.length?3:9;j=3===k?D?[30,-2,-2]:[0,32,2]:D?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var Q,L=R[0],K=R[1];L^=(Q=252645135&(L>>>4^K))<<4,L^=(Q=65535&(L>>>16^(K^=Q)))<<16,L^=Q=858993459&((K^=Q)>>>2^L),L^=Q=16711935&((K^=Q<<2)>>>8^L),L=(L^=(Q=1431655765&(L>>>1^(K^=Q<<8)))<<1)<<1|L>>>31,K=(K^=Q)<<1|K>>>31;for(var G=0;G<k;G+=3){for(var C=j[G+1],z=j[G+2],te=j[G];te!=C;te+=z){var Z=K^v[te],se=(K>>>4|K<<28)^v[te+1];Q=L,L=K,K=Q^(I[Z>>>24&63]|l[Z>>>16&63]|y[Z>>>8&63]|A[63&Z]|S[se>>>24&63]|m[se>>>16&63]|h[se>>>8&63]|_[63&se])}Q=L,L=K,K=Q}K=K>>>1|K<<31,K^=Q=1431655765&((L=L>>>1|L<<31)>>>1^K),K^=(Q=16711935&(K>>>8^(L^=Q<<1)))<<8,K^=(Q=858993459&(K>>>2^(L^=Q)))<<2,K^=Q=65535&((L^=Q)>>>16^K),K^=Q=252645135&((L^=Q<<16)>>>4^K),N[0]=L^=Q<<4,N[1]=K}function g(v){var D,N="DES-"+((v=v||{}).mode||"CBC").toUpperCase(),k=(D=v.decrypt?w.cipher.createDecipher(N,v.key):w.cipher.createCipher(N,v.key)).start;return D.start=function(j,Q){var L=null;Q instanceof w.util.ByteBuffer&&(L=Q,Q={}),(Q=Q||{}).output=L,Q.iv=j,k.call(D,Q)},D}},67779:re=>{re.exports={options:{usePureJavaScript:!1}}},16950:(re,J,p)=>{var w=p(67779);p(56101),p(35813),(re.exports=w.hmac=w.hmac||{}).create=function(){var S=null,I=null,m=null,l=null,h={start:function(y,_){if(null!==y)if("string"==typeof y){if(!((y=y.toLowerCase())in w.md.algorithms))throw new Error('Unknown hash algorithm "'+y+'"');I=w.md.algorithms[y].create()}else I=y;if(null===_)_=S;else{if("string"==typeof _)_=w.util.createBuffer(_);else if(w.util.isArray(_)){var A=_;_=w.util.createBuffer();for(var O=0;O<A.length;++O)_.putByte(A[O])}var x=_.length();for(x>I.blockLength&&(I.start(),I.update(_.bytes()),_=I.digest()),m=w.util.createBuffer(),l=w.util.createBuffer(),x=_.length(),O=0;O<x;++O)A=_.at(O),m.putByte(54^A),l.putByte(92^A);if(x<I.blockLength)for(A=I.blockLength-x,O=0;O<A;++O)m.putByte(54),l.putByte(92);S=_,m=m.bytes(),l=l.bytes()}I.start(),I.update(m)},update:function(y){I.update(y)},getMac:function(){var y=I.digest().bytes();return I.start(),I.update(l),I.update(y),I.digest()}};return h.digest=h.getMac,h}},53837:(re,J,p)=>{var d,w=p(67779);function m(ie,le,he){this.data=[],null!=ie&&("number"==typeof ie?this.fromNumber(ie,le,he):this.fromString(ie,null==le&&"string"!=typeof ie?256:le))}function l(){return new m(null)}function _(ie,le,he,Se,Ne,Le){for(var Ge=16383&le,Ze=le>>14;--Le>=0;){var Vt=16383&this.data[ie],Nr=this.data[ie++]>>14,Xn=Ze*Vt+Nr*Ge;Ne=((Vt=Ge*Vt+((16383&Xn)<<14)+he.data[Se]+Ne)>>28)+(Xn>>14)+Ze*Nr,he.data[Se++]=268435455&Vt}return Ne}re.exports=w.jsbn=w.jsbn||{},w.jsbn.BigInteger=m,typeof navigator>"u"?(m.prototype.am=_,d=28):"Microsoft Internet Explorer"==navigator.appName?(m.prototype.am=function y(ie,le,he,Se,Ne,Le){for(var Ge=32767&le,Ze=le>>15;--Le>=0;){var Vt=32767&this.data[ie],Nr=this.data[ie++]>>15,Xn=Ze*Vt+Nr*Ge;Ne=((Vt=Ge*Vt+((32767&Xn)<<15)+he.data[Se]+(1073741823&Ne))>>>30)+(Xn>>>15)+Ze*Nr+(Ne>>>30),he.data[Se++]=1073741823&Vt}return Ne},d=30):"Netscape"!=navigator.appName?(m.prototype.am=function h(ie,le,he,Se,Ne,Le){for(;--Le>=0;){var Ge=le*this.data[ie++]+he.data[Se]+Ne;Ne=Math.floor(Ge/67108864),he.data[Se++]=67108863&Ge}return Ne},d=26):(m.prototype.am=_,d=28),m.prototype.DB=d,m.prototype.DM=(1<<d)-1,m.prototype.DV=1<<d,m.prototype.FV=Math.pow(2,52),m.prototype.F1=52-d,m.prototype.F2=2*d-52;var g,v,x=new Array;for(g="0".charCodeAt(0),v=0;v<=9;++v)x[g++]=v;for(g="a".charCodeAt(0),v=10;v<36;++v)x[g++]=v;for(g="A".charCodeAt(0),v=10;v<36;++v)x[g++]=v;function R(ie){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(ie)}function N(ie,le){return x[ie.charCodeAt(le)]??-1}function j(ie){var le=l();return le.fromInt(ie),le}function te(ie){var he,le=1;return 0!=(he=ie>>>16)&&(ie=he,le+=16),0!=(he=ie>>8)&&(ie=he,le+=8),0!=(he=ie>>4)&&(ie=he,le+=4),0!=(he=ie>>2)&&(ie=he,le+=2),0!=(he=ie>>1)&&(ie=he,le+=1),le}function de(ie){this.m=ie}function Oe(ie){this.m=ie,this.mp=ie.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<ie.DB-15)-1,this.mt2=2*ie.t}function st(ie,le){return ie&le}function ht(ie,le){return ie|le}function zt(ie,le){return ie^le}function bo(ie,le){return ie&~le}function Ku(ie){if(0==ie)return-1;var le=0;return 0==(65535&ie)&&(ie>>=16,le+=16),0==(255&ie)&&(ie>>=8,le+=8),0==(15&ie)&&(ie>>=4,le+=4),0==(3&ie)&&(ie>>=2,le+=2),0==(1&ie)&&++le,le}function Hu(ie){for(var le=0;0!=ie;)ie&=ie-1,++le;return le}function _o(){}function ll(ie){return ie}function $i(ie){this.r2=l(),this.q3=l(),m.ONE.dlShiftTo(2*ie.t,this.r2),this.mu=this.r2.divide(ie),this.m=ie}de.prototype.convert=function ye(ie){return ie.s<0||ie.compareTo(this.m)>=0?ie.mod(this.m):ie},de.prototype.revert=function we(ie){return ie},de.prototype.reduce=function xe(ie){ie.divRemTo(this.m,null,ie)},de.prototype.mulTo=function Ae(ie,le,he){ie.multiplyTo(le,he),this.reduce(he)},de.prototype.sqrTo=function Re(ie,le){ie.squareTo(le),this.reduce(le)},Oe.prototype.convert=function Ve(ie){var le=l();return ie.abs().dlShiftTo(this.m.t,le),le.divRemTo(this.m,null,le),ie.s<0&&le.compareTo(m.ZERO)>0&&this.m.subTo(le,le),le},Oe.prototype.revert=function Ue(ie){var le=l();return ie.copyTo(le),this.reduce(le),le},Oe.prototype.reduce=function je(ie){for(;ie.t<=this.mt2;)ie.data[ie.t++]=0;for(var le=0;le<this.m.t;++le){var he=32767&ie.data[le],Se=he*this.mpl+((he*this.mph+(ie.data[le]>>15)*this.mpl&this.um)<<15)&ie.DM;for(ie.data[he=le+this.m.t]+=this.m.am(0,Se,ie,le,0,this.m.t);ie.data[he]>=ie.DV;)ie.data[he]-=ie.DV,ie.data[++he]++}ie.clamp(),ie.drShiftTo(this.m.t,ie),ie.compareTo(this.m)>=0&&ie.subTo(this.m,ie)},Oe.prototype.mulTo=function nt(ie,le,he){ie.multiplyTo(le,he),this.reduce(he)},Oe.prototype.sqrTo=function Ke(ie,le){ie.squareTo(le),this.reduce(le)},m.prototype.copyTo=function D(ie){for(var le=this.t-1;le>=0;--le)ie.data[le]=this.data[le];ie.t=this.t,ie.s=this.s},m.prototype.fromInt=function k(ie){this.t=1,this.s=ie<0?-1:0,ie>0?this.data[0]=ie:ie<-1?this.data[0]=ie+this.DV:this.t=0},m.prototype.fromString=function Q(ie,le){var he;if(16==le)he=4;else if(8==le)he=3;else if(256==le)he=8;else if(2==le)he=1;else if(32==le)he=5;else{if(4!=le)return void this.fromRadix(ie,le);he=2}this.t=0,this.s=0;for(var Se=ie.length,Ne=!1,Le=0;--Se>=0;){var Ge=8==he?255&ie[Se]:N(ie,Se);Ge<0?"-"==ie.charAt(Se)&&(Ne=!0):(Ne=!1,0==Le?this.data[this.t++]=Ge:Le+he>this.DB?(this.data[this.t-1]|=(Ge&(1<<this.DB-Le)-1)<<Le,this.data[this.t++]=Ge>>this.DB-Le):this.data[this.t-1]|=Ge<<Le,(Le+=he)>=this.DB&&(Le-=this.DB))}8==he&&0!=(128&ie[0])&&(this.s=-1,Le>0&&(this.data[this.t-1]|=(1<<this.DB-Le)-1<<Le)),this.clamp(),Ne&&m.ZERO.subTo(this,this)},m.prototype.clamp=function L(){for(var ie=this.s&this.DM;this.t>0&&this.data[this.t-1]==ie;)--this.t},m.prototype.dlShiftTo=function se(ie,le){var he;for(he=this.t-1;he>=0;--he)le.data[he+ie]=this.data[he];for(he=ie-1;he>=0;--he)le.data[he]=0;le.t=this.t+ie,le.s=this.s},m.prototype.drShiftTo=function ue(ie,le){for(var he=ie;he<this.t;++he)le.data[he-ie]=this.data[he];le.t=Math.max(this.t-ie,0),le.s=this.s},m.prototype.lShiftTo=function oe(ie,le){var Ze,he=ie%this.DB,Se=this.DB-he,Ne=(1<<Se)-1,Le=Math.floor(ie/this.DB),Ge=this.s<<he&this.DM;for(Ze=this.t-1;Ze>=0;--Ze)le.data[Ze+Le+1]=this.data[Ze]>>Se|Ge,Ge=(this.data[Ze]&Ne)<<he;for(Ze=Le-1;Ze>=0;--Ze)le.data[Ze]=0;le.data[Le]=Ge,le.t=this.t+Le+1,le.s=this.s,le.clamp()},m.prototype.rShiftTo=function me(ie,le){le.s=this.s;var he=Math.floor(ie/this.DB);if(he>=this.t)le.t=0;else{var Se=ie%this.DB,Ne=this.DB-Se,Le=(1<<Se)-1;le.data[0]=this.data[he]>>Se;for(var Ge=he+1;Ge<this.t;++Ge)le.data[Ge-he-1]|=(this.data[Ge]&Le)<<Ne,le.data[Ge-he]=this.data[Ge]>>Se;Se>0&&(le.data[this.t-he-1]|=(this.s&Le)<<Ne),le.t=this.t-he,le.clamp()}},m.prototype.subTo=function fe(ie,le){for(var he=0,Se=0,Ne=Math.min(ie.t,this.t);he<Ne;)Se+=this.data[he]-ie.data[he],le.data[he++]=Se&this.DM,Se>>=this.DB;if(ie.t<this.t){for(Se-=ie.s;he<this.t;)Se+=this.data[he],le.data[he++]=Se&this.DM,Se>>=this.DB;Se+=this.s}else{for(Se+=this.s;he<ie.t;)Se-=ie.data[he],le.data[he++]=Se&this.DM,Se>>=this.DB;Se-=ie.s}le.s=Se<0?-1:0,Se<-1?le.data[he++]=this.DV+Se:Se>0&&(le.data[he++]=Se),le.t=he,le.clamp()},m.prototype.multiplyTo=function ae(ie,le){var he=this.abs(),Se=ie.abs(),Ne=he.t;for(le.t=Ne+Se.t;--Ne>=0;)le.data[Ne]=0;for(Ne=0;Ne<Se.t;++Ne)le.data[Ne+he.t]=he.am(0,Se.data[Ne],le,Ne,0,he.t);le.s=0,le.clamp(),this.s!=ie.s&&m.ZERO.subTo(le,le)},m.prototype.squareTo=function pe(ie){for(var le=this.abs(),he=ie.t=2*le.t;--he>=0;)ie.data[he]=0;for(he=0;he<le.t-1;++he){var Se=le.am(he,le.data[he],ie,2*he,0,1);(ie.data[he+le.t]+=le.am(he+1,2*le.data[he],ie,2*he+1,Se,le.t-he-1))>=le.DV&&(ie.data[he+le.t]-=le.DV,ie.data[he+le.t+1]=1)}ie.t>0&&(ie.data[ie.t-1]+=le.am(he,le.data[he],ie,2*he,0,1)),ie.s=0,ie.clamp()},m.prototype.divRemTo=function ce(ie,le,he){var Se=ie.abs();if(!(Se.t<=0)){var Ne=this.abs();if(Ne.t<Se.t)return le?.fromInt(0),void(null!=he&&this.copyTo(he));null==he&&(he=l());var Le=l(),Ge=this.s,Ze=ie.s,Vt=this.DB-te(Se.data[Se.t-1]);Vt>0?(Se.lShiftTo(Vt,Le),Ne.lShiftTo(Vt,he)):(Se.copyTo(Le),Ne.copyTo(he));var Nr=Le.t,Xn=Le.data[Nr-1];if(0!=Xn){var pn=Xn*(1<<this.F1)+(Nr>1?Le.data[Nr-2]>>this.F2:0),js=this.FV/pn,ua=(1<<this.F1)/pn,Ss=1<<this.F2,As=he.t,da=As-Nr,ri=le??l();for(Le.dlShiftTo(da,ri),he.compareTo(ri)>=0&&(he.data[he.t++]=1,he.subTo(ri,he)),m.ONE.dlShiftTo(Nr,ri),ri.subTo(Le,Le);Le.t<Nr;)Le.data[Le.t++]=0;for(;--da>=0;){var pc=he.data[--As]==Xn?this.DM:Math.floor(he.data[As]*js+(he.data[As-1]+Ss)*ua);if((he.data[As]+=Le.am(0,pc,he,da,0,Nr))<pc)for(Le.dlShiftTo(da,ri),he.subTo(ri,he);he.data[As]<--pc;)he.subTo(ri,he)}null!=le&&(he.drShiftTo(Nr,le),Ge!=Ze&&m.ZERO.subTo(le,le)),he.t=Nr,he.clamp(),Vt>0&&he.rShiftTo(Vt,he),Ge<0&&m.ZERO.subTo(he,he)}}},m.prototype.invDigit=function ve(){if(this.t<1)return 0;var ie=this.data[0];if(0==(1&ie))return 0;var le=3&ie;return(le=(le=(le=(le=le*(2-(15&ie)*le)&15)*(2-(255&ie)*le)&255)*(2-((65535&ie)*le&65535))&65535)*(2-ie*le%this.DV)%this.DV)>0?this.DV-le:-le},m.prototype.isEven=function dt(){return 0==(this.t>0?1&this.data[0]:this.s)},m.prototype.exp=function pt(ie,le){if(ie>4294967295||ie<1)return m.ONE;var he=l(),Se=l(),Ne=le.convert(this),Le=te(ie)-1;for(Ne.copyTo(he);--Le>=0;)if(le.sqrTo(he,Se),(ie&1<<Le)>0)le.mulTo(Se,Ne,he);else{var Ge=he;he=Se,Se=Ge}return le.revert(he)},m.prototype.toString=function K(ie){if(this.s<0)return"-"+this.negate().toString(ie);var le;if(16==ie)le=4;else if(8==ie)le=3;else if(2==ie)le=1;else if(32==ie)le=5;else{if(4!=ie)return this.toRadix(ie);le=2}var Se,he=(1<<le)-1,Ne=!1,Le="",Ge=this.t,Ze=this.DB-Ge*this.DB%le;if(Ge-- >0)for(Ze<this.DB&&(Se=this.data[Ge]>>Ze)>0&&(Ne=!0,Le=R(Se));Ge>=0;)Ze<le?(Se=(this.data[Ge]&(1<<Ze)-1)<<le-Ze,Se|=this.data[--Ge]>>(Ze+=this.DB-le)):(Se=this.data[Ge]>>(Ze-=le)&he,Ze<=0&&(Ze+=this.DB,--Ge)),Se>0&&(Ne=!0),Ne&&(Le+=R(Se));return Ne?Le:"0"},m.prototype.negate=function G(){var ie=l();return m.ZERO.subTo(this,ie),ie},m.prototype.abs=function C(){return this.s<0?this.negate():this},m.prototype.compareTo=function z(ie){var le=this.s-ie.s;if(0!=le)return le;var he=this.t;if(0!=(le=he-ie.t))return this.s<0?-le:le;for(;--he>=0;)if(0!=(le=this.data[he]-ie.data[he]))return le;return 0},m.prototype.bitLength=function Z(){return this.t<=0?0:this.DB*(this.t-1)+te(this.data[this.t-1]^this.s&this.DM)},m.prototype.mod=function _e(ie){var le=l();return this.abs().divRemTo(ie,null,le),this.s<0&&le.compareTo(m.ZERO)>0&&ie.subTo(le,le),le},m.prototype.modPowInt=function Xt(ie,le){var he;return he=ie<256||le.isEven()?new de(le):new Oe(le),this.exp(ie,he)},m.ZERO=j(0),m.ONE=j(1),_o.prototype.convert=ll,_o.prototype.revert=ll,_o.prototype.mulTo=function cd(ie,le,he){ie.multiplyTo(le,he)},_o.prototype.sqrTo=function ld(ie,le){ie.squareTo(le)},$i.prototype.convert=function hd(ie){if(ie.s<0||ie.t>2*this.m.t)return ie.mod(this.m);if(ie.compareTo(this.m)<0)return ie;var le=l();return ie.copyTo(le),this.reduce(le),le},$i.prototype.revert=function pd(ie){return ie},$i.prototype.reduce=function yd(ie){for(ie.drShiftTo(this.m.t-1,this.r2),ie.t>this.m.t+1&&(ie.t=this.m.t+1,ie.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);ie.compareTo(this.r2)<0;)ie.dAddOffset(1,this.m.t+1);for(ie.subTo(this.r2,ie);ie.compareTo(this.m)>=0;)ie.subTo(this.m,ie)},$i.prototype.mulTo=function bd(ie,le,he){ie.multiplyTo(le,he),this.reduce(he)},$i.prototype.sqrTo=function gd(ie,le){ie.squareTo(le),this.reduce(le)};var xs=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Ed=(1<<26)/xs[xs.length-1];m.prototype.chunkSize=function Zt(ie){return Math.floor(Math.LN2*this.DB/Math.log(ie))},m.prototype.toRadix=function lr(ie){if(null==ie&&(ie=10),0==this.signum()||ie<2||ie>36)return"0";var le=this.chunkSize(ie),he=Math.pow(ie,le),Se=j(he),Ne=l(),Le=l(),Ge="";for(this.divRemTo(Se,Ne,Le);Ne.signum()>0;)Ge=(he+Le.intValue()).toString(ie).substr(1)+Ge,Ne.divRemTo(Se,Ne,Le);return Le.intValue().toString(ie)+Ge},m.prototype.fromRadix=function hr(ie,le){this.fromInt(0),null==le&&(le=10);for(var he=this.chunkSize(le),Se=Math.pow(le,he),Ne=!1,Le=0,Ge=0,Ze=0;Ze<ie.length;++Ze){var Vt=N(ie,Ze);Vt<0?"-"==ie.charAt(Ze)&&0==this.signum()&&(Ne=!0):(Ge=le*Ge+Vt,++Le>=he&&(this.dMultiply(Se),this.dAddOffset(Ge,0),Le=0,Ge=0))}Le>0&&(this.dMultiply(Math.pow(le,Le)),this.dAddOffset(Ge,0)),Ne&&m.ZERO.subTo(this,this)},m.prototype.fromNumber=function pr(ie,le,he){if("number"==typeof le)if(ie<2)this.fromInt(1);else for(this.fromNumber(ie,he),this.testBit(ie-1)||this.bitwiseTo(m.ONE.shiftLeft(ie-1),ht,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(le);)this.dAddOffset(2,0),this.bitLength()>ie&&this.subTo(m.ONE.shiftLeft(ie-1),this);else{var Se=new Array,Ne=7&ie;Se.length=1+(ie>>3),le.nextBytes(Se),Ne>0?Se[0]&=(1<<Ne)-1:Se[0]=0,this.fromString(Se,256)}},m.prototype.bitwiseTo=function tt(ie,le,he){var Se,Ne,Le=Math.min(ie.t,this.t);for(Se=0;Se<Le;++Se)he.data[Se]=le(this.data[Se],ie.data[Se]);if(ie.t<this.t){for(Ne=ie.s&this.DM,Se=Le;Se<this.t;++Se)he.data[Se]=le(this.data[Se],Ne);he.t=this.t}else{for(Ne=this.s&this.DM,Se=Le;Se<ie.t;++Se)he.data[Se]=le(Ne,ie.data[Se]);he.t=ie.t}he.s=le(this.s,ie.s),he.clamp()},m.prototype.changeBit=function Yu(ie,le){var he=m.ONE.shiftLeft(ie);return this.bitwiseTo(he,le,he),he},m.prototype.addTo=function qu(ie,le){for(var he=0,Se=0,Ne=Math.min(ie.t,this.t);he<Ne;)Se+=this.data[he]+ie.data[he],le.data[he++]=Se&this.DM,Se>>=this.DB;if(ie.t<this.t){for(Se+=ie.s;he<this.t;)Se+=this.data[he],le.data[he++]=Se&this.DM,Se>>=this.DB;Se+=this.s}else{for(Se+=this.s;he<ie.t;)Se+=ie.data[he],le.data[he++]=Se&this.DM,Se>>=this.DB;Se+=ie.s}le.s=Se<0?-1:0,Se>0?le.data[he++]=Se:Se<-1&&(le.data[he++]=this.DV+Se),le.t=he,le.clamp()},m.prototype.dMultiply=function od(ie){this.data[this.t]=this.am(0,ie-1,this,0,0,this.t),++this.t,this.clamp()},m.prototype.dAddOffset=function ad(ie,le){if(0!=ie){for(;this.t<=le;)this.data[this.t++]=0;for(this.data[le]+=ie;this.data[le]>=this.DV;)this.data[le]-=this.DV,++le>=this.t&&(this.data[this.t++]=0),++this.data[le]}},m.prototype.multiplyLowerTo=function dd(ie,le,he){var Ne,Se=Math.min(this.t+ie.t,le);for(he.s=0,he.t=Se;Se>0;)he.data[--Se]=0;for(Ne=he.t-this.t;Se<Ne;++Se)he.data[Se+this.t]=this.am(0,ie.data[Se],he,Se,0,this.t);for(Ne=Math.min(ie.t,le);Se<Ne;++Se)this.am(0,ie.data[Se],he,Se,0,le-Se);he.clamp()},m.prototype.multiplyUpperTo=function fd(ie,le,he){--le;var Se=he.t=this.t+ie.t-le;for(he.s=0;--Se>=0;)he.data[Se]=0;for(Se=Math.max(le-this.t,0);Se<ie.t;++Se)he.data[this.t+Se-le]=this.am(le-Se,ie.data[Se],he,0,0,this.t+Se-le);he.clamp(),he.drShiftTo(1,he)},m.prototype.modInt=function vd(ie){if(ie<=0)return 0;var le=this.DV%ie,he=this.s<0?ie-1:0;if(this.t>0)if(0==le)he=this.data[0]%ie;else for(var Se=this.t-1;Se>=0;--Se)he=(le*he+this.data[Se])%ie;return he},m.prototype.millerRabin=function Sd(ie){var le=this.subtract(m.ONE),he=le.getLowestSetBit();if(he<=0)return!1;for(var Le,Se=le.shiftRight(he),Ne=function Ad(){return{nextBytes:function(ie){for(var le=0;le<ie.length;++le)ie[le]=Math.floor(256*Math.random())}}}(),Ge=0;Ge<ie;++Ge){do{Le=new m(this.bitLength(),Ne)}while(Le.compareTo(m.ONE)<=0||Le.compareTo(le)>=0);var Ze=Le.modPow(Se,this);if(0!=Ze.compareTo(m.ONE)&&0!=Ze.compareTo(le)){for(var Vt=1;Vt++<he&&0!=Ze.compareTo(le);)if(0==(Ze=Ze.modPowInt(2,this)).compareTo(m.ONE))return!1;if(0!=Ze.compareTo(le))return!1}}return!0},m.prototype.clone=function Ft(){var ie=l();return this.copyTo(ie),ie},m.prototype.intValue=function Ht(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},m.prototype.byteValue=function Kt(){return 0==this.t?this.s:this.data[0]<<24>>24},m.prototype.shortValue=function xr(){return 0==this.t?this.s:this.data[0]<<16>>16},m.prototype.signum=function qt(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},m.prototype.toByteArray=function Dt(){var ie=this.t,le=new Array;le[0]=this.s;var Se,he=this.DB-ie*this.DB%8,Ne=0;if(ie-- >0)for(he<this.DB&&(Se=this.data[ie]>>he)!=(this.s&this.DM)>>he&&(le[Ne++]=Se|this.s<<this.DB-he);ie>=0;)he<8?(Se=(this.data[ie]&(1<<he)-1)<<8-he,Se|=this.data[--ie]>>(he+=this.DB-8)):(Se=this.data[ie]>>(he-=8)&255,he<=0&&(he+=this.DB,--ie)),0!=(128&Se)&&(Se|=-256),0==Ne&&(128&this.s)!=(128&Se)&&++Ne,(Ne>0||Se!=this.s)&&(le[Ne++]=Se);return le},m.prototype.equals=function Tt(ie){return 0==this.compareTo(ie)},m.prototype.min=function yr(ie){return this.compareTo(ie)<0?this:ie},m.prototype.max=function Ye(ie){return this.compareTo(ie)>0?this:ie},m.prototype.and=function ot(ie){var le=l();return this.bitwiseTo(ie,st,le),le},m.prototype.or=function St(ie){var le=l();return this.bitwiseTo(ie,ht,le),le},m.prototype.xor=function er(ie){var le=l();return this.bitwiseTo(ie,zt,le),le},m.prototype.andNot=function ji(ie){var le=l();return this.bitwiseTo(ie,bo,le),le},m.prototype.not=function Vu(){for(var ie=l(),le=0;le<this.t;++le)ie.data[le]=this.DM&~this.data[le];return ie.t=this.t,ie.s=~this.s,ie},m.prototype.shiftLeft=function ju(ie){var le=l();return ie<0?this.rShiftTo(-ie,le):this.lShiftTo(ie,le),le},m.prototype.shiftRight=function $u(ie){var le=l();return ie<0?this.lShiftTo(-ie,le):this.rShiftTo(ie,le),le},m.prototype.getLowestSetBit=function Zu(){for(var ie=0;ie<this.t;++ie)if(0!=this.data[ie])return ie*this.DB+Ku(this.data[ie]);return this.s<0?this.t*this.DB:-1},m.prototype.bitCount=function Gu(){for(var ie=0,le=this.s&this.DM,he=0;he<this.t;++he)ie+=Hu(this.data[he]^le);return ie},m.prototype.testBit=function Wu(ie){var le=Math.floor(ie/this.DB);return le>=this.t?0!=this.s:0!=(this.data[le]&1<<ie%this.DB)},m.prototype.setBit=function Qu(ie){return this.changeBit(ie,ht)},m.prototype.clearBit=function Ju(ie){return this.changeBit(ie,bo)},m.prototype.flipBit=function Xu(ie){return this.changeBit(ie,zt)},m.prototype.add=function ed(ie){var le=l();return this.addTo(ie,le),le},m.prototype.subtract=function td(ie){var le=l();return this.subTo(ie,le),le},m.prototype.multiply=function rd(ie){var le=l();return this.multiplyTo(ie,le),le},m.prototype.divide=function nd(ie){var le=l();return this.divRemTo(ie,le,null),le},m.prototype.remainder=function sd(ie){var le=l();return this.divRemTo(ie,null,le),le},m.prototype.divideAndRemainder=function id(ie){var le=l(),he=l();return this.divRemTo(ie,le,he),new Array(le,he)},m.prototype.modPow=function _d(ie,le){var Se,Le,he=ie.bitLength(),Ne=j(1);if(he<=0)return Ne;Se=he<18?1:he<48?3:he<144?4:he<768?5:6,Le=he<8?new de(le):le.isEven()?new $i(le):new Oe(le);var Ge=new Array,Ze=3,Vt=Se-1,Nr=(1<<Se)-1;if(Ge[1]=Le.convert(this),Se>1){var Xn=l();for(Le.sqrTo(Ge[1],Xn);Ze<=Nr;)Ge[Ze]=l(),Le.mulTo(Xn,Ge[Ze-2],Ge[Ze]),Ze+=2}var js,As,pn=ie.t-1,ua=!0,Ss=l();for(he=te(ie.data[pn])-1;pn>=0;){for(he>=Vt?js=ie.data[pn]>>he-Vt&Nr:(js=(ie.data[pn]&(1<<he+1)-1)<<Vt-he,pn>0&&(js|=ie.data[pn-1]>>this.DB+he-Vt)),Ze=Se;0==(1&js);)js>>=1,--Ze;if((he-=Ze)<0&&(he+=this.DB,--pn),ua)Ge[js].copyTo(Ne),ua=!1;else{for(;Ze>1;)Le.sqrTo(Ne,Ss),Le.sqrTo(Ss,Ne),Ze-=2;Ze>0?Le.sqrTo(Ne,Ss):(As=Ne,Ne=Ss,Ss=As),Le.mulTo(Ss,Ge[js],Ne)}for(;pn>=0&&0==(ie.data[pn]&1<<he);)Le.sqrTo(Ne,Ss),As=Ne,Ne=Ss,Ss=As,--he<0&&(he=this.DB-1,--pn)}return Le.revert(Ne)},m.prototype.modInverse=function wd(ie){var le=ie.isEven();if(this.isEven()&&le||0==ie.signum())return m.ZERO;for(var he=ie.clone(),Se=this.clone(),Ne=j(1),Le=j(0),Ge=j(0),Ze=j(1);0!=he.signum();){for(;he.isEven();)he.rShiftTo(1,he),le?((!Ne.isEven()||!Le.isEven())&&(Ne.addTo(this,Ne),Le.subTo(ie,Le)),Ne.rShiftTo(1,Ne)):Le.isEven()||Le.subTo(ie,Le),Le.rShiftTo(1,Le);for(;Se.isEven();)Se.rShiftTo(1,Se),le?((!Ge.isEven()||!Ze.isEven())&&(Ge.addTo(this,Ge),Ze.subTo(ie,Ze)),Ge.rShiftTo(1,Ge)):Ze.isEven()||Ze.subTo(ie,Ze),Ze.rShiftTo(1,Ze);he.compareTo(Se)>=0?(he.subTo(Se,he),le&&Ne.subTo(Ge,Ne),Le.subTo(Ze,Le)):(Se.subTo(he,Se),le&&Ge.subTo(Ne,Ge),Ze.subTo(Le,Ze))}return 0!=Se.compareTo(m.ONE)?m.ZERO:Ze.compareTo(ie)>=0?Ze.subtract(ie):Ze.signum()<0?(Ze.addTo(ie,Ze),Ze.signum()<0?Ze.add(ie):Ze):Ze},m.prototype.pow=function ud(ie){return this.exp(ie,new _o)},m.prototype.gcd=function md(ie){var le=this.s<0?this.negate():this.clone(),he=ie.s<0?ie.negate():ie.clone();if(le.compareTo(he)<0){var Se=le;le=he,he=Se}var Ne=le.getLowestSetBit(),Le=he.getLowestSetBit();if(Le<0)return le;for(Ne<Le&&(Le=Ne),Le>0&&(le.rShiftTo(Le,le),he.rShiftTo(Le,he));le.signum()>0;)(Ne=le.getLowestSetBit())>0&&le.rShiftTo(Ne,le),(Ne=he.getLowestSetBit())>0&&he.rShiftTo(Ne,he),le.compareTo(he)>=0?(le.subTo(he,le),le.rShiftTo(1,le)):(he.subTo(le,he),he.rShiftTo(1,he));return Le>0&&he.lShiftTo(Le,he),he},m.prototype.isProbablePrime=function xd(ie){var le,he=this.abs();if(1==he.t&&he.data[0]<=xs[xs.length-1]){for(le=0;le<xs.length;++le)if(he.data[0]==xs[le])return!0;return!1}if(he.isEven())return!1;for(le=1;le<xs.length;){for(var Se=xs[le],Ne=le+1;Ne<xs.length&&Se<Ed;)Se*=xs[Ne++];for(Se=he.modInt(Se);le<Ne;)if(Se%xs[le++]==0)return!1}return he.millerRabin(ie)}},56101:(re,J,p)=>{var w=p(67779);re.exports=w.md=w.md||{},w.md.algorithms=w.md.algorithms||{}},64445:(re,J,p)=>{var w=p(67779);p(31207),re.exports=w.mgf=w.mgf||{},w.mgf.mgf1=w.mgf1},31207:(re,J,p)=>{var w=p(67779);p(35813),w.mgf=w.mgf||{},(re.exports=w.mgf.mgf1=w.mgf1=w.mgf1||{}).create=function(S){return{generate:function(m,l){for(var h=new w.util.ByteBuffer,y=Math.ceil(l/S.digestLength),_=0;_<y;_++){var A=new w.util.ByteBuffer;A.putInt32(_),S.start(),S.update(m+A.getBytes()),h.putBuffer(S.digest())}return h.truncate(h.length()-l),h.getBytes()}}}},40072:(re,J,p)=>{var w=p(67779);w.pki=w.pki||{};var d=re.exports=w.pki.oids=w.oids=w.oids||{};function S(m,l){d[m]=l,d[l]=m}function I(m,l){d[m]=l}S("1.2.840.113549.1.1.1","rsaEncryption"),S("1.2.840.113549.1.1.4","md5WithRSAEncryption"),S("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),S("1.2.840.113549.1.1.7","RSAES-OAEP"),S("1.2.840.113549.1.1.8","mgf1"),S("1.2.840.113549.1.1.9","pSpecified"),S("1.2.840.113549.1.1.10","RSASSA-PSS"),S("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),S("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),S("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),S("1.3.101.112","EdDSA25519"),S("1.2.840.10040.4.3","dsa-with-sha1"),S("1.3.14.3.2.7","desCBC"),S("1.3.14.3.2.26","sha1"),S("1.3.14.3.2.29","sha1WithRSASignature"),S("2.16.840.1.101.3.4.2.1","sha256"),S("2.16.840.1.101.3.4.2.2","sha384"),S("2.16.840.1.101.3.4.2.3","sha512"),S("2.16.840.1.101.3.4.2.4","sha224"),S("2.16.840.1.101.3.4.2.5","sha512-224"),S("2.16.840.1.101.3.4.2.6","sha512-256"),S("1.2.840.113549.2.2","md2"),S("1.2.840.113549.2.5","md5"),S("1.2.840.113549.1.7.1","data"),S("1.2.840.113549.1.7.2","signedData"),S("1.2.840.113549.1.7.3","envelopedData"),S("1.2.840.113549.1.7.4","signedAndEnvelopedData"),S("1.2.840.113549.1.7.5","digestedData"),S("1.2.840.113549.1.7.6","encryptedData"),S("1.2.840.113549.1.9.1","emailAddress"),S("1.2.840.113549.1.9.2","unstructuredName"),S("1.2.840.113549.1.9.3","contentType"),S("1.2.840.113549.1.9.4","messageDigest"),S("1.2.840.113549.1.9.5","signingTime"),S("1.2.840.113549.1.9.6","counterSignature"),S("1.2.840.113549.1.9.7","challengePassword"),S("1.2.840.113549.1.9.8","unstructuredAddress"),S("1.2.840.113549.1.9.14","extensionRequest"),S("1.2.840.113549.1.9.20","friendlyName"),S("1.2.840.113549.1.9.21","localKeyId"),S("1.2.840.113549.1.9.22.1","x509Certificate"),S("1.2.840.113549.1.12.10.1.1","keyBag"),S("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),S("1.2.840.113549.1.12.10.1.3","certBag"),S("1.2.840.113549.1.12.10.1.4","crlBag"),S("1.2.840.113549.1.12.10.1.5","secretBag"),S("1.2.840.113549.1.12.10.1.6","safeContentsBag"),S("1.2.840.113549.1.5.13","pkcs5PBES2"),S("1.2.840.113549.1.5.12","pkcs5PBKDF2"),S("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),S("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),S("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),S("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),S("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),S("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),S("1.2.840.113549.2.7","hmacWithSHA1"),S("1.2.840.113549.2.8","hmacWithSHA224"),S("1.2.840.113549.2.9","hmacWithSHA256"),S("1.2.840.113549.2.10","hmacWithSHA384"),S("1.2.840.113549.2.11","hmacWithSHA512"),S("1.2.840.113549.3.7","des-EDE3-CBC"),S("2.16.840.1.101.3.4.1.2","aes128-CBC"),S("2.16.840.1.101.3.4.1.22","aes192-CBC"),S("2.16.840.1.101.3.4.1.42","aes256-CBC"),S("2.5.4.3","commonName"),S("2.5.4.4","surname"),S("2.5.4.5","serialNumber"),S("2.5.4.6","countryName"),S("2.5.4.7","localityName"),S("2.5.4.8","stateOrProvinceName"),S("2.5.4.9","streetAddress"),S("2.5.4.10","organizationName"),S("2.5.4.11","organizationalUnitName"),S("2.5.4.12","title"),S("2.5.4.13","description"),S("2.5.4.15","businessCategory"),S("2.5.4.17","postalCode"),S("2.5.4.42","givenName"),S("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),S("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),S("2.16.840.1.113730.1.1","nsCertType"),S("2.16.840.1.113730.1.13","nsComment"),I("2.5.29.1","authorityKeyIdentifier"),I("2.5.29.2","keyAttributes"),I("2.5.29.3","certificatePolicies"),I("2.5.29.4","keyUsageRestriction"),I("2.5.29.5","policyMapping"),I("2.5.29.6","subtreesConstraint"),I("2.5.29.7","subjectAltName"),I("2.5.29.8","issuerAltName"),I("2.5.29.9","subjectDirectoryAttributes"),I("2.5.29.10","basicConstraints"),I("2.5.29.11","nameConstraints"),I("2.5.29.12","policyConstraints"),I("2.5.29.13","basicConstraints"),S("2.5.29.14","subjectKeyIdentifier"),S("2.5.29.15","keyUsage"),I("2.5.29.16","privateKeyUsagePeriod"),S("2.5.29.17","subjectAltName"),S("2.5.29.18","issuerAltName"),S("2.5.29.19","basicConstraints"),I("2.5.29.20","cRLNumber"),I("2.5.29.21","cRLReason"),I("2.5.29.22","expirationDate"),I("2.5.29.23","instructionCode"),I("2.5.29.24","invalidityDate"),I("2.5.29.25","cRLDistributionPoints"),I("2.5.29.26","issuingDistributionPoint"),I("2.5.29.27","deltaCRLIndicator"),I("2.5.29.28","issuingDistributionPoint"),I("2.5.29.29","certificateIssuer"),I("2.5.29.30","nameConstraints"),S("2.5.29.31","cRLDistributionPoints"),S("2.5.29.32","certificatePolicies"),I("2.5.29.33","policyMappings"),I("2.5.29.34","policyConstraints"),S("2.5.29.35","authorityKeyIdentifier"),I("2.5.29.36","policyConstraints"),S("2.5.29.37","extKeyUsage"),I("2.5.29.46","freshestCRL"),I("2.5.29.54","inhibitAnyPolicy"),S("1.3.6.1.4.1.11129.2.4.2","timestampList"),S("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),S("1.3.6.1.5.5.7.3.1","serverAuth"),S("1.3.6.1.5.5.7.3.2","clientAuth"),S("1.3.6.1.5.5.7.3.3","codeSigning"),S("1.3.6.1.5.5.7.3.4","emailProtection"),S("1.3.6.1.5.5.7.3.8","timeStamping")},87027:(re,J,p)=>{var w=p(67779);if(p(89690),p(97238),p(24590),p(56101),p(40072),p(91950),p(16082),p(96525),p(55149),p(11812),p(35813),typeof d>"u")var d=w.jsbn.BigInteger;var S=w.asn1,I=w.pki=w.pki||{};re.exports=I.pbe=w.pbe=w.pbe||{};var m=I.oids,l={name:"EncryptedPrivateKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},h={name:"PBES2Algorithms",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},y={name:"pkcs-12PbeParams",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"iterations"}]};function _(g,v){return g.start().update(v).digest().getBytes()}function A(g){var v;if(g){if(!(v=I.oids[S.derToOid(g)])){var R=new Error("Unsupported PRF OID.");throw R.oid=g,R.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],R}}else v="hmacWithSHA1";return O(v)}function O(g){var v=w.md;switch(g){case"hmacWithSHA224":v=w.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":g=g.substr(8).toLowerCase();break;default:var R=new Error("Unsupported PRF algorithm.");throw R.algorithm=g,R.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],R}if(!v||!(g in v))throw new Error("Unknown hash algorithm: "+g);return v[g].create()}I.encryptPrivateKeyInfo=function(g,v,R){(R=R||{}).saltSize=R.saltSize||8,R.count=R.count||2048,R.algorithm=R.algorithm||"aes128",R.prfAlgorithm=R.prfAlgorithm||"sha1";var j,Q,L,N=w.random.getBytesSync(R.saltSize),D=R.count,k=S.integerToDer(D);if(0===R.algorithm.indexOf("aes")||"des"===R.algorithm){var K,G,C;switch(R.algorithm){case"aes128":j=16,K=16,G=m["aes128-CBC"],C=w.aes.createEncryptionCipher;break;case"aes192":j=24,K=16,G=m["aes192-CBC"],C=w.aes.createEncryptionCipher;break;case"aes256":j=32,K=16,G=m["aes256-CBC"],C=w.aes.createEncryptionCipher;break;case"des":j=8,K=8,G=m.desCBC,C=w.des.createEncryptionCipher;break;default:throw(z=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=R.algorithm,z}var te="hmacWith"+R.prfAlgorithm.toUpperCase(),Z=O(te),se=w.pkcs5.pbkdf2(v,N,D,j,Z),ue=w.random.getBytesSync(K);(oe=C(se)).start(ue),oe.update(S.toDer(g)),oe.finish(),L=oe.output.getBytes();var me=function x(g,v,R,N){var D=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,g),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,v.getBytes())]);return"hmacWithSHA1"!==N&&D.value.push(S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,w.util.hexToBytes(R.toString(16))),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(I.oids[N]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])),D}(N,k,j,te);Q=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(m.pkcs5PBES2).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(m.pkcs5PBKDF2).getBytes()),me]),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(G).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,ue)])])])}else{var z;if("3des"!==R.algorithm)throw(z=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=R.algorithm,z;j=24;var oe,fe=new w.util.ByteBuffer(N);se=I.pbe.generatePkcs12Key(v,fe,1,D,j),ue=I.pbe.generatePkcs12Key(v,fe,2,D,j),(oe=w.des.createEncryptionCipher(se)).start(ue),oe.update(S.toDer(g)),oe.finish(),L=oe.output.getBytes(),Q=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(m["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,N),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,k.getBytes())])])}return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[Q,S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,L)])},I.decryptPrivateKeyInfo=function(g,v){var R=null,N={},D=[];if(!S.validate(g,l,N,D)){var k=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw k.errors=D,k}var j=S.derToOid(N.encryptionOid),Q=I.pbe.getCipher(j,N.encryptionParams,v),L=w.util.createBuffer(N.encryptedData);return Q.update(L),Q.finish()&&(R=S.fromDer(Q.output)),R},I.encryptedPrivateKeyToPem=function(g,v){var R={type:"ENCRYPTED PRIVATE KEY",body:S.toDer(g).getBytes()};return w.pem.encode(R,{maxline:v})},I.encryptedPrivateKeyFromPem=function(g){var v=w.pem.decode(g)[0];if("ENCRYPTED PRIVATE KEY"!==v.type){var R=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw R.headerType=v.type,R}if(v.procType&&"ENCRYPTED"===v.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return S.fromDer(v.body)},I.encryptRsaPrivateKey=function(g,v,R){if(!(R=R||{}).legacy){var N=I.wrapRsaPrivateKey(I.privateKeyToAsn1(g));return N=I.encryptPrivateKeyInfo(N,v,R),I.encryptedPrivateKeyToPem(N)}var D,k,j,Q;switch(R.algorithm){case"aes128":D="AES-128-CBC",j=16,k=w.random.getBytesSync(16),Q=w.aes.createEncryptionCipher;break;case"aes192":D="AES-192-CBC",j=24,k=w.random.getBytesSync(16),Q=w.aes.createEncryptionCipher;break;case"aes256":D="AES-256-CBC",j=32,k=w.random.getBytesSync(16),Q=w.aes.createEncryptionCipher;break;case"3des":D="DES-EDE3-CBC",j=24,k=w.random.getBytesSync(8),Q=w.des.createEncryptionCipher;break;case"des":D="DES-CBC",j=8,k=w.random.getBytesSync(8),Q=w.des.createEncryptionCipher;break;default:var L=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+R.algorithm+'".');throw L.algorithm=R.algorithm,L}var G=Q(w.pbe.opensslDeriveBytes(v,k.substr(0,8),j));G.start(k),G.update(S.toDer(I.privateKeyToAsn1(g))),G.finish();var C={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:D,parameters:w.util.bytesToHex(k).toUpperCase()},body:G.output.getBytes()};return w.pem.encode(C)},I.decryptRsaPrivateKey=function(g,v){var R=null,N=w.pem.decode(g)[0];if("ENCRYPTED PRIVATE KEY"!==N.type&&"PRIVATE KEY"!==N.type&&"RSA PRIVATE KEY"!==N.type)throw(D=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=D,D;if(N.procType&&"ENCRYPTED"===N.procType.type){var k,j;switch(N.dekInfo.algorithm){case"DES-CBC":k=8,j=w.des.createDecryptionCipher;break;case"DES-EDE3-CBC":k=24,j=w.des.createDecryptionCipher;break;case"AES-128-CBC":k=16,j=w.aes.createDecryptionCipher;break;case"AES-192-CBC":k=24,j=w.aes.createDecryptionCipher;break;case"AES-256-CBC":k=32,j=w.aes.createDecryptionCipher;break;case"RC2-40-CBC":k=5,j=function(C){return w.rc2.createDecryptionCipher(C,40)};break;case"RC2-64-CBC":k=8,j=function(C){return w.rc2.createDecryptionCipher(C,64)};break;case"RC2-128-CBC":k=16,j=function(C){return w.rc2.createDecryptionCipher(C,128)};break;default:var D;throw(D=new Error('Could not decrypt private key; unsupported encryption algorithm "'+N.dekInfo.algorithm+'".')).algorithm=N.dekInfo.algorithm,D}var Q=w.util.hexToBytes(N.dekInfo.parameters),K=j(w.pbe.opensslDeriveBytes(v,Q.substr(0,8),k));if(K.start(Q),K.update(w.util.createBuffer(N.body)),!K.finish())return R;R=K.output.getBytes()}else R=N.body;return null!==(R="ENCRYPTED PRIVATE KEY"===N.type?I.decryptPrivateKeyInfo(S.fromDer(R),v):S.fromDer(R))&&(R=I.privateKeyFromAsn1(R)),R},I.pbe.generatePkcs12Key=function(g,v,R,N,D,k){var j,Q;if(typeof k>"u"||null===k){if(!("sha1"in w.md))throw new Error('"sha1" hash algorithm unavailable.');k=w.md.sha1.create()}var L=k.digestLength,K=k.blockLength,G=new w.util.ByteBuffer,C=new w.util.ByteBuffer;if(null!=g){for(Q=0;Q<g.length;Q++)C.putInt16(g.charCodeAt(Q));C.putInt16(0)}var z=C.length(),te=v.length(),Z=new w.util.ByteBuffer;Z.fillWithByte(R,K);var se=K*Math.ceil(te/K),ue=new w.util.ByteBuffer;for(Q=0;Q<se;Q++)ue.putByte(v.at(Q%te));var oe=K*Math.ceil(z/K),me=new w.util.ByteBuffer;for(Q=0;Q<oe;Q++)me.putByte(C.at(Q%z));var fe=ue;fe.putBuffer(me);for(var ae=Math.ceil(D/L),pe=1;pe<=ae;pe++){var ce=new w.util.ByteBuffer;ce.putBytes(Z.bytes()),ce.putBytes(fe.bytes());for(var _e=0;_e<N;_e++)k.start(),k.update(ce.getBytes()),ce=k.digest();var de=new w.util.ByteBuffer;for(Q=0;Q<K;Q++)de.putByte(ce.at(Q%L));var ye=Math.ceil(te/K)+Math.ceil(z/K),we=new w.util.ByteBuffer;for(j=0;j<ye;j++){var xe=new w.util.ByteBuffer(fe.getBytes(K)),Ae=511;for(Q=de.length()-1;Q>=0;Q--)Ae>>=8,Ae+=de.at(Q)+xe.at(Q),xe.setAt(Q,255&Ae);we.putBuffer(xe)}fe=we,G.putBuffer(ce)}return G.truncate(G.length()-D),G},I.pbe.getCipher=function(g,v,R){switch(g){case I.oids.pkcs5PBES2:return I.pbe.getCipherForPBES2(g,v,R);case I.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case I.oids["pbewithSHAAnd40BitRC2-CBC"]:return I.pbe.getCipherForPKCS12PBE(g,v,R);default:var N=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw N.oid=g,N.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],N}},I.pbe.getCipherForPBES2=function(g,v,R){var k,N={},D=[];if(!S.validate(v,h,N,D))throw(k=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=D,k;if((g=S.derToOid(N.kdfOid))!==I.oids.pkcs5PBKDF2)throw(k=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=g,k.supportedOids=["pkcs5PBKDF2"],k;if((g=S.derToOid(N.encOid))!==I.oids["aes128-CBC"]&&g!==I.oids["aes192-CBC"]&&g!==I.oids["aes256-CBC"]&&g!==I.oids["des-EDE3-CBC"]&&g!==I.oids.desCBC)throw(k=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=g,k.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],k;var L,K,j=N.kdfSalt,Q=w.util.createBuffer(N.kdfIterationCount);switch(Q=Q.getInt(Q.length()<<3),I.oids[g]){case"aes128-CBC":L=16,K=w.aes.createDecryptionCipher;break;case"aes192-CBC":L=24,K=w.aes.createDecryptionCipher;break;case"aes256-CBC":L=32,K=w.aes.createDecryptionCipher;break;case"des-EDE3-CBC":L=24,K=w.des.createDecryptionCipher;break;case"desCBC":L=8,K=w.des.createDecryptionCipher}var G=A(N.prfOid),C=w.pkcs5.pbkdf2(R,j,Q,L,G),z=N.encIv,te=K(C);return te.start(z),te},I.pbe.getCipherForPKCS12PBE=function(g,v,R){var N={},D=[];if(!S.validate(v,y,N,D))throw(k=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=D,k;var L,K,G,j=w.util.createBuffer(N.salt),Q=w.util.createBuffer(N.iterations);switch(Q=Q.getInt(Q.length()<<3),g){case I.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:L=24,K=8,G=w.des.startDecrypting;break;case I.oids["pbewithSHAAnd40BitRC2-CBC"]:L=5,K=8,G=function(se,ue){var oe=w.rc2.createDecryptionCipher(se,40);return oe.start(ue,null),oe};break;default:var k;throw(k=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=g,k}var C=A(N.prfOid),z=I.pbe.generatePkcs12Key(R,j,1,Q,L,C);return C.start(),G(z,I.pbe.generatePkcs12Key(R,j,2,Q,K,C))},I.pbe.opensslDeriveBytes=function(g,v,R,N){if(typeof N>"u"||null===N){if(!("md5"in w.md))throw new Error('"md5" hash algorithm unavailable.');N=w.md.md5.create()}null===v&&(v="");for(var D=[_(N,g+v)],k=16,j=1;k<R;++j,k+=16)D.push(_(N,D[j-1]+g+v));return D.join("").substr(0,R)}},91950:(re,J,p)=>{var w=p(13195).Buffer,d=p(67779);p(16950),p(56101),p(35813);var I,S=d.pkcs5=d.pkcs5||{};d.util.isNodejs&&!d.options.usePureJavaScript&&(I=p(25819)),re.exports=d.pbkdf2=S.pbkdf2=function(m,l,h,y,_,A){if("function"==typeof _&&(A=_,_=null),d.util.isNodejs&&!d.options.usePureJavaScript&&I.pbkdf2&&(null===_||"object"!=typeof _)&&(I.pbkdf2Sync.length>4||!_||"sha1"===_))return"string"!=typeof _&&(_="sha1"),m=w.from(m,"binary"),l=w.from(l,"binary"),A?4===I.pbkdf2Sync.length?I.pbkdf2(m,l,h,y,function(C,z){if(C)return A(C);A(null,z.toString("binary"))}):I.pbkdf2(m,l,h,y,_,function(C,z){if(C)return A(C);A(null,z.toString("binary"))}):4===I.pbkdf2Sync.length?I.pbkdf2Sync(m,l,h,y).toString("binary"):I.pbkdf2Sync(m,l,h,y,_).toString("binary");if((typeof _>"u"||null===_)&&(_="sha1"),"string"==typeof _){if(!(_ in d.md.algorithms))throw new Error("Unknown hash algorithm: "+_);_=d.md[_].create()}var O=_.digestLength;if(y>4294967295*O){var x=new Error("Derived key is too long.");if(A)return A(x);throw x}var g=Math.ceil(y/O),v=y-(g-1)*O,R=d.hmac.create();R.start(_,m);var D,k,j,N="";if(!A){for(var Q=1;Q<=g;++Q){R.start(null,null),R.update(l),R.update(d.util.int32ToBytes(Q)),D=j=R.digest().getBytes();for(var L=2;L<=h;++L)R.start(null,null),R.update(j),k=R.digest().getBytes(),D=d.util.xorBytes(D,k,O),j=k;N+=Q<g?D:D.substr(0,v)}return N}function K(){if(Q>g)return A(null,N);R.start(null,null),R.update(l),R.update(d.util.int32ToBytes(Q)),D=j=R.digest().getBytes(),L=2,G()}function G(){if(L<=h)return R.start(null,null),R.update(j),k=R.digest().getBytes(),D=d.util.xorBytes(D,k,O),j=k,++L,d.util.setImmediate(G);N+=Q<g?D:D.substr(0,v),++Q,K()}Q=1,K()}},16082:(re,J,p)=>{var w=p(67779);p(35813);var d=re.exports=w.pem=w.pem||{};function S(m){for(var l=m.name+": ",h=[],y=function(g,v){return" "+v},_=0;_<m.values.length;++_)h.push(m.values[_].replace(/^(\S+\r\n)/,y));l+=h.join(",")+"\r\n";var A=0,O=-1;for(_=0;_<l.length;++_,++A)if(A>65&&-1!==O){var x=l[O];","===x?(++O,l=l.substr(0,O)+"\r\n "+l.substr(O)):l=l.substr(0,O)+"\r\n"+x+l.substr(O+1),A=_-O-1,O=-1,++_}else(" "===l[_]||"\t"===l[_]||","===l[_])&&(O=_);return l}function I(m){return m.replace(/^\s+/,"")}d.encode=function(m,l){l=l||{};var y,h="-----BEGIN "+m.type+"-----\r\n";if(m.procType&&(h+=S(y={name:"Proc-Type",values:[String(m.procType.version),m.procType.type]})),m.contentDomain&&(h+=S(y={name:"Content-Domain",values:[m.contentDomain]})),m.dekInfo&&(y={name:"DEK-Info",values:[m.dekInfo.algorithm]},m.dekInfo.parameters&&y.values.push(m.dekInfo.parameters),h+=S(y)),m.headers)for(var _=0;_<m.headers.length;++_)h+=S(m.headers[_]);return m.procType&&(h+="\r\n"),(h+=w.util.encode64(m.body,l.maxline||64)+"\r\n")+"-----END "+m.type+"-----\r\n"},d.decode=function(m){for(var A,l=[],h=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,y=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,_=/\r?\n/;A=h.exec(m);){var O=A[1];"NEW CERTIFICATE REQUEST"===O&&(O="CERTIFICATE REQUEST");var x={type:O,procType:null,contentDomain:null,dekInfo:null,headers:[],body:w.util.decode64(A[3])};if(l.push(x),A[2]){for(var g=A[2].split(_),v=0;A&&v<g.length;){for(var R=g[v].replace(/\s+$/,""),N=v+1;N<g.length;++N){var D=g[N];if(!/\s/.test(D[0]))break;R+=D,v=N}if(A=R.match(y)){for(var k={name:A[1],values:[]},j=A[2].split(","),Q=0;Q<j.length;++Q)k.values.push(I(j[Q]));if(x.procType)if(x.contentDomain||"Content-Domain"!==k.name)if(x.dekInfo||"DEK-Info"!==k.name)x.headers.push(k);else{if(0===k.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');x.dekInfo={algorithm:j[0],parameters:j[1]||null}}else x.contentDomain=j[0]||"";else{if("Proc-Type"!==k.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==k.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');x.procType={version:j[0],type:j[1]}}}++v}if("ENCRYPTED"===x.procType&&!x.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===l.length)throw new Error("Invalid PEM formatted message.");return l}},45878:(re,J,p)=>{var w=p(67779);p(35813),p(96525),p(92587);var d=re.exports=w.pkcs1=w.pkcs1||{};function S(I,m,l){l||(l=w.md.sha1.create());for(var h="",y=Math.ceil(m/l.digestLength),_=0;_<y;++_){var A=String.fromCharCode(_>>24&255,_>>16&255,_>>8&255,255&_);l.start(),l.update(I+A),h+=l.digest().getBytes()}return h.substring(0,m)}d.encode_rsa_oaep=function(I,m,l){var h,y,_,A;"string"==typeof l?(h=l,y=arguments[3]||void 0,_=arguments[4]||void 0):l&&(h=l.label||void 0,y=l.seed||void 0,_=l.md||void 0,l.mgf1&&l.mgf1.md&&(A=l.mgf1.md)),_?_.start():_=w.md.sha1.create(),A||(A=_);var O=Math.ceil(I.n.bitLength()/8),x=O-2*_.digestLength-2;if(m.length>x)throw(g=new Error("RSAES-OAEP input message length is too long.")).length=m.length,g.maxLength=x,g;h||(h=""),_.update(h,"raw");for(var v=_.digest(),R="",N=x-m.length,D=0;D<N;D++)R+="\0";var k=v.getBytes()+R+"\x01"+m;if(y){if(y.length!==_.digestLength){var g;throw(g=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=y.length,g.digestLength=_.digestLength,g}}else y=w.random.getBytes(_.digestLength);var j=S(y,O-_.digestLength-1,A),Q=w.util.xorBytes(k,j,k.length),L=S(Q,_.digestLength,A),K=w.util.xorBytes(y,L,y.length);return"\0"+K+Q},d.decode_rsa_oaep=function(I,m,l){var h,y,_;"string"==typeof l?(h=l,y=arguments[3]||void 0):l&&(h=l.label||void 0,y=l.md||void 0,l.mgf1&&l.mgf1.md&&(_=l.mgf1.md));var A=Math.ceil(I.n.bitLength()/8);if(m.length!==A)throw(Q=new Error("RSAES-OAEP encoded message length is invalid.")).length=m.length,Q.expectedLength=A,Q;if(void 0===y?y=w.md.sha1.create():y.start(),_||(_=y),A<2*y.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");h||(h=""),y.update(h,"raw");for(var O=y.digest().getBytes(),x=m.charAt(0),g=m.substring(1,y.digestLength+1),v=m.substring(1+y.digestLength),R=S(v,y.digestLength,_),N=w.util.xorBytes(g,R,g.length),D=S(N,A-y.digestLength-1,_),k=w.util.xorBytes(v,D,v.length),j=k.substring(0,y.digestLength),Q="\0"!==x,L=0;L<y.digestLength;++L)Q|=O.charAt(L)!==j.charAt(L);for(var K=1,G=y.digestLength,C=y.digestLength;C<k.length;C++){var z=k.charCodeAt(C),te=1&z^1,Z=K?65534:0;Q|=z&Z,G+=K&=te}if(Q||1!==k.charCodeAt(G))throw new Error("Invalid RSAES-OAEP padding.");return k.substring(G+1)}},12998:(re,J,p)=>{var w=p(67779);p(89690),p(97238),p(24590),p(40072),p(16082),p(13787),p(96525),p(35813),p(85466);var d=w.asn1,S=re.exports=w.pkcs7=w.pkcs7||{};function I(N){var D={},k=[];if(!d.validate(N,S.asn1.recipientInfoValidator,D,k)){var j=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw j.errors=k,j}return{version:D.version.charCodeAt(0),issuer:w.pki.RDNAttributesAsArray(D.issuer),serialNumber:w.util.createBuffer(D.serial).toHex(),encryptedContent:{algorithm:d.derToOid(D.encAlgorithm),parameter:D.encParameter?D.encParameter.value:void 0,content:D.encKey}}}function m(N){return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(N.version).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[w.pki.distinguishedNameToAsn1({attributes:N.issuer}),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,w.util.hexToBytes(N.serialNumber))]),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(N.encryptedContent.algorithm).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")]),d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,N.encryptedContent.content)])}function h(N){for(var D=[],k=0;k<N.length;++k)D.push(m(N[k]));return D}function _(N){var D=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(N.version).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[w.pki.distinguishedNameToAsn1({attributes:N.issuer}),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,w.util.hexToBytes(N.serialNumber))]),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(N.digestAlgorithm).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")])]);if(N.authenticatedAttributesAsn1&&D.value.push(N.authenticatedAttributesAsn1),D.value.push(d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(N.signatureAlgorithm).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")])),D.value.push(d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,N.signature)),N.unauthenticatedAttributes.length>0){for(var k=d.create(d.Class.CONTEXT_SPECIFIC,1,!0,[]),j=0;j<N.unauthenticatedAttributes.length;++j)k.values.push(x(N.unauthenticatedAttributes[j]));D.value.push(k)}return D}function x(N){var D;if(N.type===w.pki.oids.contentType)D=d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(N.value).getBytes());else if(N.type===w.pki.oids.messageDigest)D=d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,N.value.bytes());else if(N.type===w.pki.oids.signingTime){var k=new Date("1950-01-01T00:00:00Z"),j=new Date("2050-01-01T00:00:00Z"),Q=N.value;if("string"==typeof Q){var L=Date.parse(Q);Q=isNaN(L)?13===Q.length?d.utcTimeToDate(Q):d.generalizedTimeToDate(Q):new Date(L)}D=Q>=k&&Q<j?d.create(d.Class.UNIVERSAL,d.Type.UTCTIME,!1,d.dateToUtcTime(Q)):d.create(d.Class.UNIVERSAL,d.Type.GENERALIZEDTIME,!1,d.dateToGeneralizedTime(Q))}return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(N.type).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SET,!0,[D])])}function g(N){return[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(w.pki.oids.data).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(N.algorithm).getBytes()),N.parameter?d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,N.parameter.getBytes()):void 0]),d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,N.content.getBytes())])]}function v(N,D,k){var j={};if(!d.validate(D,k,j,[])){var L=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw L.errors=L,L}if(d.derToOid(j.contentType)!==w.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(j.encryptedContent){var G="";if(w.util.isArray(j.encryptedContent))for(var C=0;C<j.encryptedContent.length;++C){if(j.encryptedContent[C].type!==d.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");G+=j.encryptedContent[C].value}else G=j.encryptedContent;N.encryptedContent={algorithm:d.derToOid(j.encAlgorithm),parameter:w.util.createBuffer(j.encParameter.value),content:w.util.createBuffer(G)}}if(j.content){if(G="",w.util.isArray(j.content))for(C=0;C<j.content.length;++C){if(j.content[C].type!==d.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");G+=j.content[C].value}else G=j.content;N.content=w.util.createBuffer(G)}return N.version=j.version.charCodeAt(0),N.rawCapture=j,j}function R(N){if(void 0===N.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===N.content){var D;switch(N.encryptedContent.algorithm){case w.pki.oids["aes128-CBC"]:case w.pki.oids["aes192-CBC"]:case w.pki.oids["aes256-CBC"]:D=w.aes.createDecryptionCipher(N.encryptedContent.key);break;case w.pki.oids.desCBC:case w.pki.oids["des-EDE3-CBC"]:D=w.des.createDecryptionCipher(N.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+N.encryptedContent.algorithm)}if(D.start(N.encryptedContent.parameter),D.update(N.encryptedContent.content),!D.finish())throw new Error("Symmetric decryption failed.");N.content=D.output}}S.messageFromPem=function(N){var D=w.pem.decode(N)[0];if("PKCS7"!==D.type){var k=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw k.headerType=D.type,k}if(D.procType&&"ENCRYPTED"===D.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var j=d.fromDer(D.body);return S.messageFromAsn1(j)},S.messageToPem=function(N,D){var k={type:"PKCS7",body:d.toDer(N.toAsn1()).getBytes()};return w.pem.encode(k,{maxline:D})},S.messageFromAsn1=function(N){var D={},k=[];if(!d.validate(N,S.asn1.contentInfoValidator,D,k)){var j=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw j.errors=k,j}var L,Q=d.derToOid(D.contentType);switch(Q){case w.pki.oids.envelopedData:L=S.createEnvelopedData();break;case w.pki.oids.encryptedData:L=S.createEncryptedData();break;case w.pki.oids.signedData:L=S.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+Q+" is not (yet) supported.")}return L.fromAsn1(D.content.value[0]),L},S.createSignedData=function(){var N=null;return N={type:w.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(j){if(v(N,j,S.asn1.signedDataValidator),N.certificates=[],N.crls=[],N.digestAlgorithmIdentifiers=[],N.contentInfo=null,N.signerInfos=[],N.rawCapture.certificates)for(var Q=N.rawCapture.certificates.value,L=0;L<Q.length;++L)N.certificates.push(w.pki.certificateFromAsn1(Q[L]))},toAsn1:function(){N.contentInfo||N.sign();for(var j=[],Q=0;Q<N.certificates.length;++Q)j.push(w.pki.certificateToAsn1(N.certificates[Q]));var L=[],K=d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(N.version).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SET,!0,N.digestAlgorithmIdentifiers),N.contentInfo])]);return j.length>0&&K.value[0].value.push(d.create(d.Class.CONTEXT_SPECIFIC,0,!0,j)),L.length>0&&K.value[0].value.push(d.create(d.Class.CONTEXT_SPECIFIC,1,!0,L)),K.value[0].value.push(d.create(d.Class.UNIVERSAL,d.Type.SET,!0,N.signerInfos)),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(N.type).getBytes()),K])},addSigner:function(j){var Q=j.issuer,L=j.serialNumber;if(j.certificate){var K=j.certificate;"string"==typeof K&&(K=w.pki.certificateFromPem(K)),Q=K.issuer.attributes,L=K.serialNumber}var G=j.key;if(!G)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof G&&(G=w.pki.privateKeyFromPem(G));var C=j.digestAlgorithm||w.pki.oids.sha1;switch(C){case w.pki.oids.sha1:case w.pki.oids.sha256:case w.pki.oids.sha384:case w.pki.oids.sha512:case w.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+C)}var z=j.authenticatedAttributes||[];if(z.length>0){for(var te=!1,Z=!1,se=0;se<z.length;++se){var ue=z[se];if(te||ue.type!==w.pki.oids.contentType){if(Z||ue.type!==w.pki.oids.messageDigest);else if(Z=!0,te)break}else if(te=!0,Z)break}if(!te||!Z)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}N.signers.push({key:G,version:1,issuer:Q,serialNumber:L,digestAlgorithm:C,signatureAlgorithm:w.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:z,unauthenticatedAttributes:[]})},sign:function(j){var Q;if(j=j||{},"object"==typeof N.content&&null!==N.contentInfo||(N.contentInfo=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(w.pki.oids.data).getBytes())]),!("content"in N))||(N.content instanceof w.util.ByteBuffer?Q=N.content.bytes():"string"==typeof N.content&&(Q=w.util.encodeUtf8(N.content)),j.detached?N.detachedContent=d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,Q):N.contentInfo.value.push(d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,Q)]))),0!==N.signers.length){var L=function D(){for(var j={},Q=0;Q<N.signers.length;++Q){var L=N.signers[Q];(K=L.digestAlgorithm)in j||(j[K]=w.md[w.pki.oids[K]].create()),L.md=0===L.authenticatedAttributes.length?j[K]:w.md[w.pki.oids[K]].create()}for(var K in N.digestAlgorithmIdentifiers=[],j)N.digestAlgorithmIdentifiers.push(d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(K).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")]));return j}();!function k(j){var Q;if(!(Q=N.detachedContent?N.detachedContent:(Q=N.contentInfo.value[1]).value[0]))throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var L=d.derToOid(N.contentInfo.value[0].value),K=d.toDer(Q);for(var G in K.getByte(),d.getBerValueLength(K),K=K.getBytes(),j)j[G].start().update(K);for(var C=new Date,z=0;z<N.signers.length;++z){var te=N.signers[z];if(0===te.authenticatedAttributes.length){if(L!==w.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{te.authenticatedAttributesAsn1=d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var Z=d.create(d.Class.UNIVERSAL,d.Type.SET,!0,[]),se=0;se<te.authenticatedAttributes.length;++se){var ue=te.authenticatedAttributes[se];ue.type===w.pki.oids.messageDigest?ue.value=j[te.digestAlgorithm].digest():ue.type===w.pki.oids.signingTime&&(ue.value||(ue.value=C)),Z.value.push(x(ue)),te.authenticatedAttributesAsn1.value.push(x(ue))}K=d.toDer(Z).getBytes(),te.md.start().update(K)}te.signature=te.key.sign(te.md,"RSASSA-PKCS1-V1_5")}N.signerInfos=function O(N){for(var D=[],k=0;k<N.length;++k)D.push(_(N[k]));return D}(N.signers)}(L)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(j){"string"==typeof j&&(j=w.pki.certificateFromPem(j)),N.certificates.push(j)},addCertificateRevokationList:function(j){throw new Error("PKCS#7 CRL support not yet implemented.")}}},S.createEncryptedData=function(){var N=null;return N={type:w.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:w.pki.oids["aes256-CBC"]},fromAsn1:function(D){v(N,D,S.asn1.encryptedDataValidator)},decrypt:function(D){void 0!==D&&(N.encryptedContent.key=D),R(N)}}},S.createEnvelopedData=function(){var N=null;return N={type:w.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:w.pki.oids["aes256-CBC"]},fromAsn1:function(D){var k=v(N,D,S.asn1.envelopedDataValidator);N.recipients=function l(N){for(var D=[],k=0;k<N.length;++k)D.push(I(N[k]));return D}(k.recipientInfos.value)},toAsn1:function(){return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(N.type).getBytes()),d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(N.version).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SET,!0,h(N.recipients)),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,g(N.encryptedContent))])])])},findRecipient:function(D){for(var k=D.issuer.attributes,j=0;j<N.recipients.length;++j){var Q=N.recipients[j],L=Q.issuer;if(Q.serialNumber===D.serialNumber&&L.length===k.length){for(var K=!0,G=0;G<k.length;++G)if(L[G].type!==k[G].type||L[G].value!==k[G].value){K=!1;break}if(K)return Q}}return null},decrypt:function(D,k){if(void 0===N.encryptedContent.key&&void 0!==D&&void 0!==k)switch(D.encryptedContent.algorithm){case w.pki.oids.rsaEncryption:case w.pki.oids.desCBC:var j=k.decrypt(D.encryptedContent.content);N.encryptedContent.key=w.util.createBuffer(j);break;default:throw new Error("Unsupported asymmetric cipher, OID "+D.encryptedContent.algorithm)}R(N)},addRecipient:function(D){N.recipients.push({version:0,issuer:D.issuer.attributes,serialNumber:D.serialNumber,encryptedContent:{algorithm:w.pki.oids.rsaEncryption,key:D.publicKey}})},encrypt:function(D,k){if(void 0===N.encryptedContent.content){var j,Q,L;switch(D=D||N.encryptedContent.key,k=k||N.encryptedContent.algorithm){case w.pki.oids["aes128-CBC"]:j=16,Q=16,L=w.aes.createEncryptionCipher;break;case w.pki.oids["aes192-CBC"]:j=24,Q=16,L=w.aes.createEncryptionCipher;break;case w.pki.oids["aes256-CBC"]:j=32,Q=16,L=w.aes.createEncryptionCipher;break;case w.pki.oids["des-EDE3-CBC"]:j=24,Q=8,L=w.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+k)}if(void 0===D)D=w.util.createBuffer(w.random.getBytes(j));else if(D.length()!=j)throw new Error("Symmetric key has wrong length; got "+D.length()+" bytes, expected "+j+".");N.encryptedContent.algorithm=k,N.encryptedContent.key=D,N.encryptedContent.parameter=w.util.createBuffer(w.random.getBytes(Q));var K=L(D);if(K.start(N.encryptedContent.parameter.copy()),K.update(N.content),!K.finish())throw new Error("Symmetric encryption failed.");N.encryptedContent.content=K.output}for(var G=0;G<N.recipients.length;++G){var C=N.recipients[G];if(void 0===C.encryptedContent.content){if(C.encryptedContent.algorithm!==w.pki.oids.rsaEncryption)throw new Error("Unsupported asymmetric cipher, OID "+C.encryptedContent.algorithm);C.encryptedContent.content=C.encryptedContent.key.encrypt(N.encryptedContent.key.data)}}}}}},13787:(re,J,p)=>{var w=p(67779);p(97238),p(35813);var d=w.asn1,S=re.exports=w.pkcs7asn1=w.pkcs7asn1||{};w.pkcs7=w.pkcs7||{},w.pkcs7.asn1=S;var I={name:"ContentInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:d.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};S.contentInfoValidator=I;var m={name:"EncryptedContentInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:d.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:d.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};S.envelopedDataValidator={name:"EnvelopedData",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:d.Class.UNIVERSAL,type:d.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(m)},S.encryptedDataValidator={name:"EncryptedData",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"version"}].concat(m)},S.signedDataValidator={name:"SignedData",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:d.Class.UNIVERSAL,type:d.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},I,{name:"SignedData.Certificates",tagClass:d.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:d.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:d.Class.UNIVERSAL,type:d.Type.SET,capture:"signerInfos",optional:!0,value:[{name:"SignerInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:d.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:d.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:d.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]}]}]},S.recipientInfoValidator={name:"RecipientInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:d.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},75930:(re,J,p)=>{var w=p(67779);p(35813),p(53837),p(96525),function(){if(w.prime)re.exports=w.prime;else{var d=re.exports=w.prime=w.prime||{},S=w.jsbn.BigInteger,I=[6,4,2,4,2,4,6,2],m=new S(null);m.fromInt(30);var l=function(g,v){return g|v};d.generateProbablePrime=function(g,v,R){"function"==typeof v&&(R=v,v={});var N=(v=v||{}).algorithm||"PRIMEINC";"string"==typeof N&&(N={name:N}),N.options=N.options||{};var D=v.prng||w.random;if("PRIMEINC"===N.name)return function h(g,v,R,N){return"workers"in R?function A(g,v,R,N){if(typeof Worker>"u")return y(g,v,R,N);var D=O(g,v),k=R.workers,j=R.workLoad||100,Q=30*j/8,L=R.workerScript||"forge/prime.worker.js";if(-1===k)return w.util.estimateCores(function(G,C){G&&(C=2),k=C-1,K()});function K(){k=Math.max(1,k);for(var G=[],C=0;C<k;++C)G[C]=new Worker(L);for(C=0;C<k;++C)G[C].addEventListener("message",Z);var te=!1;function Z(se){if(!te){var ue=se.data;if(ue.found){for(var oe=0;oe<G.length;++oe)G[oe].terminate();return te=!0,N(null,new S(ue.prime,16))}D.bitLength()>g&&(D=O(g,v));var me=D.toString(16);se.target.postMessage({hex:me,workLoad:j}),D.dAddOffset(Q,0)}}}K()}(g,v,R,N):y(g,v,R,N)}(g,{nextBytes:function(j){for(var Q=D.getBytesSync(j.length),L=0;L<j.length;++L)j[L]=Q.charCodeAt(L)}},N.options,R);throw new Error("Invalid prime generation algorithm: "+N.name)}}function y(g,v,R,N){var D=O(g,v),j=function x(g){return g<=100?27:g<=150?18:g<=200?15:g<=250?12:g<=300?9:g<=350?8:g<=400?7:g<=500?6:g<=600?5:g<=800?4:g<=1250?3:2}(D.bitLength());"millerRabinTests"in R&&(j=R.millerRabinTests);var Q=10;"maxBlockTime"in R&&(Q=R.maxBlockTime),_(D,g,v,0,j,Q,N)}function _(g,v,R,N,D,k,j){var Q=+new Date;do{if(g.bitLength()>v&&(g=O(v,R)),g.isProbablePrime(D))return j(null,g);g.dAddOffset(I[N++%8],0)}while(k<0||+new Date-Q<k);w.util.setImmediate(function(){_(g,v,R,N,D,k,j)})}function O(g,v){var R=new S(g,v),N=g-1;return R.testBit(N)||R.bitwiseTo(S.ONE.shiftLeft(N),l,R),R.dAddOffset(31-R.mod(m).byteValue(),0),R}}()},87031:(re,J,p)=>{var w=p(53217),d=p(67779);p(35813);var S=null;d.util.isNodejs&&!d.options.usePureJavaScript&&!w.versions["node-webkit"]&&(S=p(25819)),(re.exports=d.prng=d.prng||{}).create=function(m){for(var l={plugin:m,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},h=m.md,y=new Array(32),_=0;_<32;++_)y[_]=h.create();function O(){if(l.pools[0].messageLength>=32)return x();l.collect(l.seedFileSync(32-l.pools[0].messageLength<<5)),x()}function x(){l.reseeds=4294967295===l.reseeds?0:l.reseeds+1;var v=l.plugin.md.create();v.update(l.keyBytes);for(var R=1,N=0;N<32;++N)l.reseeds%R==0&&(v.update(l.pools[N].digest().getBytes()),l.pools[N].start()),R<<=1;l.keyBytes=v.digest().getBytes(),v.start(),v.update(l.keyBytes);var D=v.digest().getBytes();l.key=l.plugin.formatKey(l.keyBytes),l.seed=l.plugin.formatSeed(D),l.generated=0}function g(v){var R=null,N=d.util.globalScope,D=N.crypto||N.msCrypto;D&&D.getRandomValues&&(R=function(te){return D.getRandomValues(te)});var k=d.util.createBuffer();if(R)for(;k.length()<v;){var j=Math.max(1,Math.min(v-k.length(),65536)/4),Q=new Uint32Array(Math.floor(j));try{R(Q);for(var L=0;L<Q.length;++L)k.putInt32(Q[L])}catch(te){if(!(typeof QuotaExceededError<"u"&&te instanceof QuotaExceededError))throw te}}if(k.length()<v)for(var K,G,C,z=Math.floor(65536*Math.random());k.length()<v;)for(G=16807*(65535&z),G+=(32767&(K=16807*(z>>16)))<<16,z=4294967295&(G=(2147483647&(G+=K>>15))+(G>>31)),L=0;L<3;++L)C=z>>>(L<<3),C^=Math.floor(256*Math.random()),k.putByte(255&C);return k.getBytes(v)}return l.pools=y,l.pool=0,l.generate=function(v,R){if(!R)return l.generateSync(v);var N=l.plugin.cipher,D=l.plugin.increment,k=l.plugin.formatKey,j=l.plugin.formatSeed,Q=d.util.createBuffer();l.key=null,function L(K){if(K)return R(K);if(Q.length()>=v)return R(null,Q.getBytes(v));if(l.generated>1048575&&(l.key=null),null===l.key)return d.util.nextTick(function(){!function A(v){if(l.pools[0].messageLength>=32)return x(),v();l.seedFile(32-l.pools[0].messageLength<<5,function(N,D){if(N)return v(N);l.collect(D),x(),v()})}(L)});var G=N(l.key,l.seed);l.generated+=G.length,Q.putBytes(G),l.key=k(N(l.key,D(l.seed))),l.seed=j(N(l.key,l.seed)),d.util.setImmediate(L)}()},l.generateSync=function(v){var R=l.plugin.cipher,N=l.plugin.increment,D=l.plugin.formatKey,k=l.plugin.formatSeed;l.key=null;for(var j=d.util.createBuffer();j.length()<v;){l.generated>1048575&&(l.key=null),null===l.key&&O();var Q=R(l.key,l.seed);l.generated+=Q.length,j.putBytes(Q),l.key=D(R(l.key,N(l.seed))),l.seed=k(R(l.key,l.seed))}return j.getBytes(v)},S?(l.seedFile=function(v,R){S.randomBytes(v,function(N,D){if(N)return R(N);R(null,D.toString())})},l.seedFileSync=function(v){return S.randomBytes(v).toString()}):(l.seedFile=function(v,R){try{R(null,g(v))}catch(N){R(N)}},l.seedFileSync=g),l.collect=function(v){for(var R=v.length,N=0;N<R;++N)l.pools[l.pool].update(v.substr(N,1)),l.pool=31===l.pool?0:l.pool+1},l.collectInt=function(v,R){for(var N="",D=0;D<R;D+=8)N+=String.fromCharCode(v>>D&255);l.collect(N)},l.registerWorker=function(v){v===self?l.seedFile=function(N,D){self.addEventListener("message",function k(j){var Q=j.data;Q.forge&&Q.forge.prng&&(self.removeEventListener("message",k),D(Q.forge.prng.err,Q.forge.prng.bytes))}),self.postMessage({forge:{prng:{needed:N}}})}:v.addEventListener("message",function(N){var D=N.data;D.forge&&D.forge.prng&&l.seedFile(D.forge.prng.needed,function(k,j){v.postMessage({forge:{prng:{err:k,bytes:j}}})})})},l}},36878:(re,J,p)=>{var w=p(67779);p(96525),p(35813),(re.exports=w.pss=w.pss||{}).create=function(S){3===arguments.length&&(S={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var y,I=S.md,m=S.mgf,l=I.digestLength,h=S.salt||null;if("string"==typeof h&&(h=w.util.createBuffer(h)),"saltLength"in S)y=S.saltLength;else{if(null===h)throw new Error("Salt length not specified or specific salt not given.");y=h.length()}if(null!==h&&h.length()!==y)throw new Error("Given salt length does not match length of given salt.");var _=S.prng||w.random,A={encode:function(O,x){var g,D,v=x-1,R=Math.ceil(v/8),N=O.digest().getBytes();if(R<l+y+2)throw new Error("Message is too long to encrypt.");D=null===h?_.getBytesSync(y):h.bytes();var k=new w.util.ByteBuffer;k.fillWithByte(0,8),k.putBytes(N),k.putBytes(D),I.start(),I.update(k.getBytes());var j=I.digest().getBytes(),Q=new w.util.ByteBuffer;Q.fillWithByte(0,R-y-l-2),Q.putByte(1),Q.putBytes(D);var L=Q.getBytes(),K=R-l-1,G=m.generate(j,K),C="";for(g=0;g<K;g++)C+=String.fromCharCode(L.charCodeAt(g)^G.charCodeAt(g));var z=65280>>8*R-v&255;return(C=String.fromCharCode(C.charCodeAt(0)&~z)+C.substr(1))+j+String.fromCharCode(188)},verify:function(O,x,g){var v,R=g-1,N=Math.ceil(R/8);if(x=x.substr(-N),N<l+y+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==x.charCodeAt(N-1))throw new Error("Encoded message does not end in 0xBC.");var D=N-l-1,k=x.substr(0,D),j=x.substr(D,l),Q=65280>>8*N-R&255;if(0!=(k.charCodeAt(0)&Q))throw new Error("Bits beyond keysize not zero as expected.");var L=m.generate(j,D),K="";for(v=0;v<D;v++)K+=String.fromCharCode(k.charCodeAt(v)^L.charCodeAt(v));K=String.fromCharCode(K.charCodeAt(0)&~Q)+K.substr(1);var G=N-l-y-2;for(v=0;v<G;v++)if(0!==K.charCodeAt(v))throw new Error("Leftmost octets not zero as expected");if(1!==K.charCodeAt(G))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var C=K.substr(-y),z=new w.util.ByteBuffer;return z.fillWithByte(0,8),z.putBytes(O),z.putBytes(C),I.start(),I.update(z.getBytes()),j===I.digest().getBytes()}};return A}},96525:(re,J,p)=>{var w=p(67779);p(89690),p(12465),p(87031),p(35813),w.random&&w.random.getBytes?re.exports=w.random:function(d){var S={},I=new Array(4),m=w.util.createBuffer();function l(){var g=w.prng.create(S);return g.getBytes=function(v,R){return g.generate(v,R)},g.getBytesSync=function(v){return g.generate(v)},g}S.formatKey=function(g){var v=w.util.createBuffer(g);return(g=new Array(4))[0]=v.getInt32(),g[1]=v.getInt32(),g[2]=v.getInt32(),g[3]=v.getInt32(),w.aes._expandKey(g,!1)},S.formatSeed=function(g){var v=w.util.createBuffer(g);return(g=new Array(4))[0]=v.getInt32(),g[1]=v.getInt32(),g[2]=v.getInt32(),g[3]=v.getInt32(),g},S.cipher=function(g,v){return w.aes._updateBlock(g,v,I,!1),m.putInt32(I[0]),m.putInt32(I[1]),m.putInt32(I[2]),m.putInt32(I[3]),m.getBytes()},S.increment=function(g){return++g[3],g},S.md=w.md.sha256;var h=l(),y=null,_=w.util.globalScope,A=_.crypto||_.msCrypto;if(A&&A.getRandomValues&&(y=function(g){return A.getRandomValues(g)}),w.options.usePureJavaScript||!w.util.isNodejs&&!y){if(typeof window>"u"||window,h.collectInt(+new Date,32),typeof navigator<"u"){var O="";for(var x in navigator)try{"string"==typeof navigator[x]&&(O+=navigator[x])}catch{}h.collect(O),O=null}d&&(d().mousemove(function(g){h.collectInt(g.clientX,16),h.collectInt(g.clientY,16)}),d().keypress(function(g){h.collectInt(g.charCode,8)}))}if(w.random)for(var x in h)w.random[x]=h[x];else w.random=h;w.random.createInstance=l,re.exports=w.random}(typeof jQuery<"u"?jQuery:null)},55149:(re,J,p)=>{var w=p(67779);p(35813);var d=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],S=[1,2,3,5],I=function(h,y){return h<<y&65535|(65535&h)>>16-y},m=function(h,y){return(65535&h)>>y|h<<16-y&65535};re.exports=w.rc2=w.rc2||{},w.rc2.expandKey=function(h,y){"string"==typeof h&&(h=w.util.createBuffer(h)),y=y||128;var v,_=h,A=h.length(),O=y,x=Math.ceil(O/8),g=255>>(7&O);for(v=A;v<128;v++)_.putByte(d[_.at(v-1)+_.at(v-A)&255]);for(_.setAt(128-x,d[_.at(128-x)&g]),v=127-x;v>=0;v--)_.setAt(v,d[_.at(v+1)^_.at(v+x)]);return _};var l=function(h,y,_){var v,R,N,D,A=!1,O=null,x=null,g=null,k=[];for(h=w.rc2.expandKey(h,y),N=0;N<64;N++)k.push(h.getInt16Le());_?(v=function(L){for(N=0;N<4;N++)L[N]+=k[D]+(L[(N+3)%4]&L[(N+2)%4])+(~L[(N+3)%4]&L[(N+1)%4]),L[N]=I(L[N],S[N]),D++},R=function(L){for(N=0;N<4;N++)L[N]+=k[63&L[(N+3)%4]]}):(v=function(L){for(N=3;N>=0;N--)L[N]=m(L[N],S[N]),L[N]-=k[D]+(L[(N+3)%4]&L[(N+2)%4])+(~L[(N+3)%4]&L[(N+1)%4]),D--},R=function(L){for(N=3;N>=0;N--)L[N]-=k[63&L[(N+3)%4]]});var j=function(L){var K=[];for(N=0;N<4;N++){var G=O.getInt16Le();null!==g&&(_?G^=g.getInt16Le():g.putInt16Le(G)),K.push(65535&G)}D=_?0:63;for(var C=0;C<L.length;C++)for(var z=0;z<L[C][0];z++)L[C][1](K);for(N=0;N<4;N++)null!==g&&(_?g.putInt16Le(K[N]):K[N]^=g.getInt16Le()),x.putInt16Le(K[N])},Q=null;return Q={start:function(L,K){L&&"string"==typeof L&&(L=w.util.createBuffer(L)),A=!1,O=w.util.createBuffer(),x=K||new w.util.createBuffer,g=L,Q.output=x},update:function(L){for(A||O.putBuffer(L);O.length()>=8;)j([[5,v],[1,R],[6,v],[1,R],[5,v]])},finish:function(L){var K=!0;if(_)if(L)K=L(8,O,!_);else{var G=8===O.length()?8:8-O.length();O.fillWithByte(G,G)}if(K&&(A=!0,Q.update()),!_&&(K=0===O.length()))if(L)K=L(8,x,!_);else{var C=x.length(),z=x.at(C-1);z>C?K=!1:x.truncate(z)}return K}}};w.rc2.startEncrypting=function(h,y,_){var A=w.rc2.createEncryptionCipher(h,128);return A.start(y,_),A},w.rc2.createEncryptionCipher=function(h,y){return l(h,y,!0)},w.rc2.startDecrypting=function(h,y,_){var A=w.rc2.createDecryptionCipher(h,128);return A.start(y,_),A},w.rc2.createDecryptionCipher=function(h,y){return l(h,y,!1)}},11812:(re,J,p)=>{var w=p(67779);if(p(97238),p(53837),p(40072),p(45878),p(75930),p(96525),p(35813),typeof d>"u")var d=w.jsbn.BigInteger;var S=w.util.isNodejs?p(25819):null,I=w.asn1,m=w.util;w.pki=w.pki||{},re.exports=w.pki.rsa=w.rsa=w.rsa||{};var l=w.pki,h=[6,4,2,4,2,4,6,2],y={name:"PrivateKeyInfo",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},_={name:"RSAPrivateKey",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},A={name:"RSAPublicKey",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},O=w.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:I.Class.UNIVERSAL,type:I.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},x={name:"DigestInfo",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:I.Class.UNIVERSAL,type:I.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},g=function(Z){if(!(Z.algorithm in l.oids)){var ue=new Error("Unknown message digest algorithm.");throw ue.algorithm=Z.algorithm,ue}var oe=I.oidToDer(l.oids[Z.algorithm]).getBytes(),me=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[]),fe=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[]);fe.value.push(I.create(I.Class.UNIVERSAL,I.Type.OID,!1,oe)),fe.value.push(I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,""));var ae=I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,Z.digest().getBytes());return me.value.push(fe),me.value.push(ae),I.toDer(me).getBytes()},v=function(Z,se,ue){if(ue)return Z.modPow(se.e,se.n);if(!se.p||!se.q)return Z.modPow(se.d,se.n);var oe;se.dP||(se.dP=se.d.mod(se.p.subtract(d.ONE))),se.dQ||(se.dQ=se.d.mod(se.q.subtract(d.ONE))),se.qInv||(se.qInv=se.q.modInverse(se.p));do{oe=new d(w.util.bytesToHex(w.random.getBytes(se.n.bitLength()/8)),16)}while(oe.compareTo(se.n)>=0||!oe.gcd(se.n).equals(d.ONE));for(var me=(Z=Z.multiply(oe.modPow(se.e,se.n)).mod(se.n)).mod(se.p).modPow(se.dP,se.p),fe=Z.mod(se.q).modPow(se.dQ,se.q);me.compareTo(fe)<0;)me=me.add(se.p);var ae=me.subtract(fe).multiply(se.qInv).mod(se.p).multiply(se.q).add(fe);return ae.multiply(oe.modInverse(se.n)).mod(se.n)};function R(Z,se,ue){var oe=w.util.createBuffer(),me=Math.ceil(se.n.bitLength()/8);if(Z.length>me-11){var fe=new Error("Message is too long for PKCS#1 v1.5 padding.");throw fe.length=Z.length,fe.max=me-11,fe}oe.putByte(0),oe.putByte(ue);var pe,ae=me-3-Z.length;if(0===ue||1===ue){pe=0===ue?0:255;for(var ce=0;ce<ae;++ce)oe.putByte(pe)}else for(;ae>0;){var _e=0,de=w.random.getBytes(ae);for(ce=0;ce<ae;++ce)0===(pe=de.charCodeAt(ce))?++_e:oe.putByte(pe);ae=_e}return oe.putByte(0),oe.putBytes(Z),oe}function N(Z,se,ue,oe){var me=Math.ceil(se.n.bitLength()/8),fe=w.util.createBuffer(Z),ae=fe.getByte(),pe=fe.getByte();if(0!==ae||ue&&0!==pe&&1!==pe||!ue&&2!=pe||ue&&0===pe&&typeof oe>"u")throw new Error("Encryption block is invalid.");var ce=0;if(0===pe){ce=me-3-oe;for(var _e=0;_e<ce;++_e)if(0!==fe.getByte())throw new Error("Encryption block is invalid.")}else if(1===pe)for(ce=0;fe.length()>1;){if(255!==fe.getByte()){--fe.read;break}++ce}else if(2===pe)for(ce=0;fe.length()>1;){if(0===fe.getByte()){--fe.read;break}++ce}if(0!==fe.getByte()||ce!==me-3-fe.length())throw new Error("Encryption block is invalid.");return fe.getBytes()}function D(Z,se,ue){"function"==typeof se&&(ue=se,se={});var oe={algorithm:{name:(se=se||{}).algorithm||"PRIMEINC",options:{workers:se.workers||2,workLoad:se.workLoad||100,workerScript:se.workerScript}}};function me(){fe(Z.pBits,function(pe,ce){return pe?ue(pe):(Z.p=ce,null!==Z.q?ae(pe,Z.q):void fe(Z.qBits,ae))})}function fe(pe,ce){w.prime.generateProbablePrime(pe,oe,ce)}function ae(pe,ce){if(pe)return ue(pe);if(Z.q=ce,Z.p.compareTo(Z.q)<0){var _e=Z.p;Z.p=Z.q,Z.q=_e}if(0!==Z.p.subtract(d.ONE).gcd(Z.e).compareTo(d.ONE))return Z.p=null,void me();if(0!==Z.q.subtract(d.ONE).gcd(Z.e).compareTo(d.ONE))return Z.q=null,void fe(Z.qBits,ae);if(Z.p1=Z.p.subtract(d.ONE),Z.q1=Z.q.subtract(d.ONE),Z.phi=Z.p1.multiply(Z.q1),0!==Z.phi.gcd(Z.e).compareTo(d.ONE))return Z.p=Z.q=null,void me();if(Z.n=Z.p.multiply(Z.q),Z.n.bitLength()!==Z.bits)return Z.q=null,void fe(Z.qBits,ae);var de=Z.e.modInverse(Z.phi);Z.keys={privateKey:l.rsa.setPrivateKey(Z.n,Z.e,de,Z.p,Z.q,de.mod(Z.p1),de.mod(Z.q1),Z.q.modInverse(Z.p)),publicKey:l.rsa.setPublicKey(Z.n,Z.e)},ue(null,Z.keys)}"prng"in se&&(oe.prng=se.prng),me()}function k(Z){var se=Z.toString(16);se[0]>="8"&&(se="00"+se);var ue=w.util.hexToBytes(se);return ue.length>1&&(0===ue.charCodeAt(0)&&0==(128&ue.charCodeAt(1))||255===ue.charCodeAt(0)&&128==(128&ue.charCodeAt(1)))?ue.substr(1):ue}function j(Z){return Z<=100?27:Z<=150?18:Z<=200?15:Z<=250?12:Z<=300?9:Z<=350?8:Z<=400?7:Z<=500?6:Z<=600?5:Z<=800?4:Z<=1250?3:2}function Q(Z){return w.util.isNodejs&&"function"==typeof S[Z]}function L(Z){return typeof m.globalScope<"u"&&"object"==typeof m.globalScope.crypto&&"object"==typeof m.globalScope.crypto.subtle&&"function"==typeof m.globalScope.crypto.subtle[Z]}function K(Z){return typeof m.globalScope<"u"&&"object"==typeof m.globalScope.msCrypto&&"object"==typeof m.globalScope.msCrypto.subtle&&"function"==typeof m.globalScope.msCrypto.subtle[Z]}function G(Z){for(var se=w.util.hexToBytes(Z.toString(16)),ue=new Uint8Array(se.length),oe=0;oe<se.length;++oe)ue[oe]=se.charCodeAt(oe);return ue}l.rsa.encrypt=function(Z,se,ue){var me,oe=ue,fe=Math.ceil(se.n.bitLength()/8);!1!==ue&&!0!==ue?(oe=2===ue,me=R(Z,se,ue)):(me=w.util.createBuffer()).putBytes(Z);for(var ae=new d(me.toHex(),16),ce=v(ae,se,oe).toString(16),_e=w.util.createBuffer(),de=fe-Math.ceil(ce.length/2);de>0;)_e.putByte(0),--de;return _e.putBytes(w.util.hexToBytes(ce)),_e.getBytes()},l.rsa.decrypt=function(Z,se,ue,oe){var me=Math.ceil(se.n.bitLength()/8);if(Z.length!==me){var fe=new Error("Encrypted message length is invalid.");throw fe.length=Z.length,fe.expected=me,fe}var ae=new d(w.util.createBuffer(Z).toHex(),16);if(ae.compareTo(se.n)>=0)throw new Error("Encrypted message is invalid.");for(var ce=v(ae,se,ue).toString(16),_e=w.util.createBuffer(),de=me-Math.ceil(ce.length/2);de>0;)_e.putByte(0),--de;return _e.putBytes(w.util.hexToBytes(ce)),!1!==oe?N(_e.getBytes(),se,ue):_e.getBytes()},l.rsa.createKeyPairGenerationState=function(Z,se,ue){"string"==typeof Z&&(Z=parseInt(Z,10)),Z=Z||2048;var ae,oe=(ue=ue||{}).prng||w.random,me={nextBytes:function(pe){for(var ce=oe.getBytesSync(pe.length),_e=0;_e<pe.length;++_e)pe[_e]=ce.charCodeAt(_e)}},fe=ue.algorithm||"PRIMEINC";if("PRIMEINC"!==fe)throw new Error("Invalid key generation algorithm: "+fe);return(ae={algorithm:fe,state:0,bits:Z,rng:me,eInt:se||65537,e:new d(null),p:null,q:null,qBits:Z>>1,pBits:Z-(Z>>1),pqState:0,num:null,keys:null}).e.fromInt(ae.eInt),ae},l.rsa.stepKeyPairGenerationState=function(Z,se){"algorithm"in Z||(Z.algorithm="PRIMEINC");var ue=new d(null);ue.fromInt(30);for(var ae,oe=0,me=function(ye,we){return ye|we},fe=+new Date,pe=0;null===Z.keys&&(se<=0||pe<se);){if(0===Z.state){var ce=null===Z.p?Z.pBits:Z.qBits,_e=ce-1;0===Z.pqState?(Z.num=new d(ce,Z.rng),Z.num.testBit(_e)||Z.num.bitwiseTo(d.ONE.shiftLeft(_e),me,Z.num),Z.num.dAddOffset(31-Z.num.mod(ue).byteValue(),0),oe=0,++Z.pqState):1===Z.pqState?Z.num.bitLength()>ce?Z.pqState=0:Z.num.isProbablePrime(j(Z.num.bitLength()))?++Z.pqState:Z.num.dAddOffset(h[oe++%8],0):2===Z.pqState?Z.pqState=0===Z.num.subtract(d.ONE).gcd(Z.e).compareTo(d.ONE)?3:0:3===Z.pqState&&(Z.pqState=0,null===Z.p?Z.p=Z.num:Z.q=Z.num,null!==Z.p&&null!==Z.q&&++Z.state,Z.num=null)}else if(1===Z.state)Z.p.compareTo(Z.q)<0&&(Z.num=Z.p,Z.p=Z.q,Z.q=Z.num),++Z.state;else if(2===Z.state)Z.p1=Z.p.subtract(d.ONE),Z.q1=Z.q.subtract(d.ONE),Z.phi=Z.p1.multiply(Z.q1),++Z.state;else if(3===Z.state)0===Z.phi.gcd(Z.e).compareTo(d.ONE)?++Z.state:(Z.p=null,Z.q=null,Z.state=0);else if(4===Z.state)Z.n=Z.p.multiply(Z.q),Z.n.bitLength()===Z.bits?++Z.state:(Z.q=null,Z.state=0);else if(5===Z.state){var de=Z.e.modInverse(Z.phi);Z.keys={privateKey:l.rsa.setPrivateKey(Z.n,Z.e,de,Z.p,Z.q,de.mod(Z.p1),de.mod(Z.q1),Z.q.modInverse(Z.p)),publicKey:l.rsa.setPublicKey(Z.n,Z.e)}}pe+=(ae=+new Date)-fe,fe=ae}return null!==Z.keys},l.rsa.generateKeyPair=function(Z,se,ue,oe){if(1===arguments.length?"object"==typeof Z?(ue=Z,Z=void 0):"function"==typeof Z&&(oe=Z,Z=void 0):2===arguments.length?"number"==typeof Z?"function"==typeof se?(oe=se,se=void 0):"number"!=typeof se&&(ue=se,se=void 0):(ue=Z,oe=se,Z=void 0,se=void 0):3===arguments.length&&("number"==typeof se?"function"==typeof ue&&(oe=ue,ue=void 0):(oe=ue,ue=se,se=void 0)),ue=ue||{},void 0===Z&&(Z=ue.bits||2048),void 0===se&&(se=ue.e||65537),!w.options.usePureJavaScript&&!ue.prng&&Z>=256&&Z<=16384&&(65537===se||3===se))if(oe){if(Q("generateKeyPair"))return S.generateKeyPair("rsa",{modulusLength:Z,publicExponent:se,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(pe,ce,_e){if(pe)return oe(pe);oe(null,{privateKey:l.privateKeyFromPem(_e),publicKey:l.publicKeyFromPem(ce)})});if(L("generateKey")&&L("exportKey"))return m.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:Z,publicExponent:G(se),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(pe){return m.globalScope.crypto.subtle.exportKey("pkcs8",pe.privateKey)}).then(void 0,function(pe){oe(pe)}).then(function(pe){if(pe){var ce=l.privateKeyFromAsn1(I.fromDer(w.util.createBuffer(pe)));oe(null,{privateKey:ce,publicKey:l.setRsaPublicKey(ce.n,ce.e)})}});if(K("generateKey")&&K("exportKey")){var me=m.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:Z,publicExponent:G(se),hash:{name:"SHA-256"}},!0,["sign","verify"]);return me.oncomplete=function(pe){var _e=m.globalScope.msCrypto.subtle.exportKey("pkcs8",pe.target.result.privateKey);_e.oncomplete=function(de){var we=l.privateKeyFromAsn1(I.fromDer(w.util.createBuffer(de.target.result)));oe(null,{privateKey:we,publicKey:l.setRsaPublicKey(we.n,we.e)})},_e.onerror=function(de){oe(de)}},void(me.onerror=function(pe){oe(pe)})}}else if(Q("generateKeyPairSync")){var fe=S.generateKeyPairSync("rsa",{modulusLength:Z,publicExponent:se,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:l.privateKeyFromPem(fe.privateKey),publicKey:l.publicKeyFromPem(fe.publicKey)}}var ae=l.rsa.createKeyPairGenerationState(Z,se,ue);if(!oe)return l.rsa.stepKeyPairGenerationState(ae,0),ae.keys;D(ae,ue,oe)},l.setRsaPublicKey=l.rsa.setPublicKey=function(Z,se){var ue={n:Z,e:se,encrypt:function(oe,me,fe){if("string"==typeof me?me=me.toUpperCase():void 0===me&&(me="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===me)me={encode:function(pe,ce,_e){return R(pe,ce,2).getBytes()}};else if("RSA-OAEP"===me||"RSAES-OAEP"===me)me={encode:function(pe,ce){return w.pkcs1.encode_rsa_oaep(ce,pe,fe)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(me))me={encode:function(pe){return pe}};else if("string"==typeof me)throw new Error('Unsupported encryption scheme: "'+me+'".');var ae=me.encode(oe,ue,!0);return l.rsa.encrypt(ae,ue,!0)},verify:function(oe,me,fe,ae){"string"==typeof fe?fe=fe.toUpperCase():void 0===fe&&(fe="RSASSA-PKCS1-V1_5"),void 0===ae&&(ae={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in ae||(ae._parseAllDigestBytes=!0),"RSASSA-PKCS1-V1_5"===fe?fe={verify:function(ce,_e){_e=N(_e,ue,!0);var de=I.fromDer(_e,{parseAllBytes:ae._parseAllDigestBytes}),ye={},we=[];if(!I.validate(de,x,ye,we))throw(xe=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.")).errors=we,xe;var xe,Ae=I.derToOid(ye.algorithmIdentifier);if(Ae!==w.oids.md2&&Ae!==w.oids.md5&&Ae!==w.oids.sha1&&Ae!==w.oids.sha224&&Ae!==w.oids.sha256&&Ae!==w.oids.sha384&&Ae!==w.oids.sha512&&Ae!==w.oids["sha512-224"]&&Ae!==w.oids["sha512-256"])throw(xe=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.")).oid=Ae,xe;if((Ae===w.oids.md2||Ae===w.oids.md5)&&!("parameters"in ye))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return ce===ye.digest}}:("NONE"===fe||"NULL"===fe||null===fe)&&(fe={verify:function(ce,_e){return ce===N(_e,ue,!0)}});var pe=l.rsa.decrypt(me,ue,!0,!1);return fe.verify(oe,pe,ue.n.bitLength())}};return ue},l.setRsaPrivateKey=l.rsa.setPrivateKey=function(Z,se,ue,oe,me,fe,ae,pe){var ce={n:Z,e:se,d:ue,p:oe,q:me,dP:fe,dQ:ae,qInv:pe,decrypt:function(_e,de,ye){"string"==typeof de?de=de.toUpperCase():void 0===de&&(de="RSAES-PKCS1-V1_5");var we=l.rsa.decrypt(_e,ce,!1,!1);if("RSAES-PKCS1-V1_5"===de)de={decode:N};else if("RSA-OAEP"===de||"RSAES-OAEP"===de)de={decode:function(xe,Ae){return w.pkcs1.decode_rsa_oaep(Ae,xe,ye)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(de))throw new Error('Unsupported encryption scheme: "'+de+'".');de={decode:function(xe){return xe}}}return de.decode(we,ce,!1)},sign:function(_e,de){var ye=!1;"string"==typeof de&&(de=de.toUpperCase()),void 0===de||"RSASSA-PKCS1-V1_5"===de?(de={encode:g},ye=1):("NONE"===de||"NULL"===de||null===de)&&(de={encode:function(){return _e}},ye=1);var we=de.encode(_e,ce.n.bitLength());return l.rsa.encrypt(we,ce,ye)}};return ce},l.wrapRsaPrivateKey=function(Z){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(0).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(l.oids.rsaEncryption).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")]),I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,I.toDer(Z).getBytes())])},l.privateKeyFromAsn1=function(Z){var me,fe,ae,pe,ce,_e,de,ye,se={},ue=[];if(I.validate(Z,y,se,ue)&&(Z=I.fromDer(w.util.createBuffer(se.privateKey))),!I.validate(Z,_,se={},ue=[])){var oe=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw oe.errors=ue,oe}return me=w.util.createBuffer(se.privateKeyModulus).toHex(),fe=w.util.createBuffer(se.privateKeyPublicExponent).toHex(),ae=w.util.createBuffer(se.privateKeyPrivateExponent).toHex(),pe=w.util.createBuffer(se.privateKeyPrime1).toHex(),ce=w.util.createBuffer(se.privateKeyPrime2).toHex(),_e=w.util.createBuffer(se.privateKeyExponent1).toHex(),de=w.util.createBuffer(se.privateKeyExponent2).toHex(),ye=w.util.createBuffer(se.privateKeyCoefficient).toHex(),l.setRsaPrivateKey(new d(me,16),new d(fe,16),new d(ae,16),new d(pe,16),new d(ce,16),new d(_e,16),new d(de,16),new d(ye,16))},l.privateKeyToAsn1=l.privateKeyToRSAPrivateKey=function(Z){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(0).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,k(Z.n)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,k(Z.e)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,k(Z.d)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,k(Z.p)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,k(Z.q)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,k(Z.dP)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,k(Z.dQ)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,k(Z.qInv))])},l.publicKeyFromAsn1=function(Z){var se={},ue=[];if(I.validate(Z,O,se,ue)){var me,oe=I.derToOid(se.publicKeyOid);if(oe!==l.oids.rsaEncryption)throw(me=new Error("Cannot read public key. Unknown OID.")).oid=oe,me;Z=se.rsaPublicKey}if(!I.validate(Z,A,se,ue=[]))throw(me=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=ue,me;var fe=w.util.createBuffer(se.publicKeyModulus).toHex(),ae=w.util.createBuffer(se.publicKeyExponent).toHex();return l.setRsaPublicKey(new d(fe,16),new d(ae,16))},l.publicKeyToAsn1=l.publicKeyToSubjectPublicKeyInfo=function(Z){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(l.oids.rsaEncryption).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")]),I.create(I.Class.UNIVERSAL,I.Type.BITSTRING,!1,[l.publicKeyToRSAPublicKey(Z)])])},l.publicKeyToRSAPublicKey=function(Z){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,k(Z.n)),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,k(Z.e))])}},92587:(re,J,p)=>{var w=p(67779);p(56101),p(35813);var d=re.exports=w.sha1=w.sha1||{};w.md.sha1=w.md.algorithms.sha1=d,d.create=function(){I||function m(){S=String.fromCharCode(128),S+=w.util.fillString(String.fromCharCode(0),64),I=!0}();var h=null,y=w.util.createBuffer(),_=new Array(80),A={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){A.messageLength=0,A.fullMessageLength=A.messageLength64=[];for(var O=A.messageLengthSize/4,x=0;x<O;++x)A.fullMessageLength.push(0);return y=w.util.createBuffer(),h={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},A}};return A.start(),A.update=function(O,x){"utf8"===x&&(O=w.util.encodeUtf8(O));var g=O.length;A.messageLength+=g,g=[g/4294967296>>>0,g>>>0];for(var v=A.fullMessageLength.length-1;v>=0;--v)A.fullMessageLength[v]+=g[1],g[1]=g[0]+(A.fullMessageLength[v]/4294967296>>>0),A.fullMessageLength[v]=A.fullMessageLength[v]>>>0,g[0]=g[1]/4294967296>>>0;return y.putBytes(O),l(h,_,y),(y.read>2048||0===y.length())&&y.compact(),A},A.digest=function(){var O=w.util.createBuffer();O.putBytes(y.bytes()),O.putBytes(S.substr(0,A.blockLength-(A.fullMessageLength[A.fullMessageLength.length-1]+A.messageLengthSize&A.blockLength-1)));for(var v,N=8*A.fullMessageLength[0],D=0;D<A.fullMessageLength.length-1;++D)O.putInt32((N+=(v=8*A.fullMessageLength[D+1])/4294967296>>>0)>>>0),N=v>>>0;O.putInt32(N);var k={h0:h.h0,h1:h.h1,h2:h.h2,h3:h.h3,h4:h.h4};l(k,_,O);var j=w.util.createBuffer();return j.putInt32(k.h0),j.putInt32(k.h1),j.putInt32(k.h2),j.putInt32(k.h3),j.putInt32(k.h4),j},A};var S=null,I=!1;function l(h,y,_){for(var A,O,x,g,v,R,D,k=_.length();k>=64;){for(O=h.h0,x=h.h1,g=h.h2,v=h.h3,R=h.h4,D=0;D<16;++D)A=_.getInt32(),y[D]=A,A=(O<<5|O>>>27)+(v^x&(g^v))+R+1518500249+A,R=v,v=g,g=(x<<30|x>>>2)>>>0,x=O,O=A;for(;D<20;++D)y[D]=A=(A=y[D-3]^y[D-8]^y[D-14]^y[D-16])<<1|A>>>31,A=(O<<5|O>>>27)+(v^x&(g^v))+R+1518500249+A,R=v,v=g,g=(x<<30|x>>>2)>>>0,x=O,O=A;for(;D<32;++D)y[D]=A=(A=y[D-3]^y[D-8]^y[D-14]^y[D-16])<<1|A>>>31,A=(O<<5|O>>>27)+(x^g^v)+R+1859775393+A,R=v,v=g,g=(x<<30|x>>>2)>>>0,x=O,O=A;for(;D<40;++D)y[D]=A=(A=y[D-6]^y[D-16]^y[D-28]^y[D-32])<<2|A>>>30,A=(O<<5|O>>>27)+(x^g^v)+R+1859775393+A,R=v,v=g,g=(x<<30|x>>>2)>>>0,x=O,O=A;for(;D<60;++D)y[D]=A=(A=y[D-6]^y[D-16]^y[D-28]^y[D-32])<<2|A>>>30,A=(O<<5|O>>>27)+(x&g|v&(x^g))+R+2400959708+A,R=v,v=g,g=(x<<30|x>>>2)>>>0,x=O,O=A;for(;D<80;++D)y[D]=A=(A=y[D-6]^y[D-16]^y[D-28]^y[D-32])<<2|A>>>30,A=(O<<5|O>>>27)+(x^g^v)+R+3395469782+A,R=v,v=g,g=(x<<30|x>>>2)>>>0,x=O,O=A;h.h0=h.h0+O|0,h.h1=h.h1+x|0,h.h2=h.h2+g|0,h.h3=h.h3+v|0,h.h4=h.h4+R|0,k-=64}}},12465:(re,J,p)=>{var w=p(67779);p(56101),p(35813);var d=re.exports=w.sha256=w.sha256||{};w.md.sha256=w.md.algorithms.sha256=d,d.create=function(){I||function l(){S=String.fromCharCode(128),S+=w.util.fillString(String.fromCharCode(0),64),m=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],I=!0}();var y=null,_=w.util.createBuffer(),A=new Array(64),O={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){O.messageLength=0,O.fullMessageLength=O.messageLength64=[];for(var x=O.messageLengthSize/4,g=0;g<x;++g)O.fullMessageLength.push(0);return _=w.util.createBuffer(),y={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},O}};return O.start(),O.update=function(x,g){"utf8"===g&&(x=w.util.encodeUtf8(x));var v=x.length;O.messageLength+=v,v=[v/4294967296>>>0,v>>>0];for(var R=O.fullMessageLength.length-1;R>=0;--R)O.fullMessageLength[R]+=v[1],v[1]=v[0]+(O.fullMessageLength[R]/4294967296>>>0),O.fullMessageLength[R]=O.fullMessageLength[R]>>>0,v[0]=v[1]/4294967296>>>0;return _.putBytes(x),h(y,A,_),(_.read>2048||0===_.length())&&_.compact(),O},O.digest=function(){var x=w.util.createBuffer();x.putBytes(_.bytes()),x.putBytes(S.substr(0,O.blockLength-(O.fullMessageLength[O.fullMessageLength.length-1]+O.messageLengthSize&O.blockLength-1)));for(var R,D=8*O.fullMessageLength[0],k=0;k<O.fullMessageLength.length-1;++k)x.putInt32((D+=(R=8*O.fullMessageLength[k+1])/4294967296>>>0)>>>0),D=R>>>0;x.putInt32(D);var j={h0:y.h0,h1:y.h1,h2:y.h2,h3:y.h3,h4:y.h4,h5:y.h5,h6:y.h6,h7:y.h7};h(j,A,x);var Q=w.util.createBuffer();return Q.putInt32(j.h0),Q.putInt32(j.h1),Q.putInt32(j.h2),Q.putInt32(j.h3),Q.putInt32(j.h4),Q.putInt32(j.h5),Q.putInt32(j.h6),Q.putInt32(j.h7),Q},O};var S=null,I=!1,m=null;function h(y,_,A){for(var O,x,N,D,k,j,Q,L,K,G,C,z,te=A.length();te>=64;){for(D=0;D<16;++D)_[D]=A.getInt32();for(;D<64;++D)_[D]=(O=((O=_[D-2])>>>17|O<<15)^(O>>>19|O<<13)^O>>>10)+_[D-7]+(x=((x=_[D-15])>>>7|x<<25)^(x>>>18|x<<14)^x>>>3)+_[D-16]|0;for(k=y.h0,j=y.h1,Q=y.h2,L=y.h3,K=y.h4,G=y.h5,C=y.h6,z=y.h7,D=0;D<64;++D)N=k&j|Q&(k^j),O=z+((K>>>6|K<<26)^(K>>>11|K<<21)^(K>>>25|K<<7))+(C^K&(G^C))+m[D]+_[D],z=C,C=G,G=K,K=L+O>>>0,L=Q,Q=j,j=k,k=O+(x=((k>>>2|k<<30)^(k>>>13|k<<19)^(k>>>22|k<<10))+N)>>>0;y.h0=y.h0+k|0,y.h1=y.h1+j|0,y.h2=y.h2+Q|0,y.h3=y.h3+L|0,y.h4=y.h4+K|0,y.h5=y.h5+G|0,y.h6=y.h6+C|0,y.h7=y.h7+z|0,te-=64}}},26243:(re,J,p)=>{var w=p(67779);p(56101),p(35813);var d=re.exports=w.sha512=w.sha512||{};w.md.sha512=w.md.algorithms.sha512=d;var S=w.sha384=w.sha512.sha384=w.sha512.sha384||{};S.create=function(){return d.create("SHA-384")},w.md.sha384=w.md.algorithms.sha384=S,w.sha512.sha256=w.sha512.sha256||{create:function(){return d.create("SHA-512/256")}},w.md["sha512/256"]=w.md.algorithms["sha512/256"]=w.sha512.sha256,w.sha512.sha224=w.sha512.sha224||{create:function(){return d.create("SHA-512/224")}},w.md["sha512/224"]=w.md.algorithms["sha512/224"]=w.sha512.sha224,d.create=function(A){if(m||function y(){I=String.fromCharCode(128),I+=w.util.fillString(String.fromCharCode(0),128),l=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(h={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],h["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],h["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],h["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],m=!0}(),typeof A>"u"&&(A="SHA-512"),!(A in h))throw new Error("Invalid SHA-512 algorithm: "+A);for(var O=h[A],x=null,g=w.util.createBuffer(),v=new Array(80),R=0;R<80;++R)v[R]=new Array(2);var N=64;switch(A){case"SHA-384":N=48;break;case"SHA-512/256":N=32;break;case"SHA-512/224":N=28}var D={algorithm:A.replace("-","").toLowerCase(),blockLength:128,digestLength:N,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){D.messageLength=0,D.fullMessageLength=D.messageLength128=[];for(var k=D.messageLengthSize/4,j=0;j<k;++j)D.fullMessageLength.push(0);for(g=w.util.createBuffer(),x=new Array(O.length),j=0;j<O.length;++j)x[j]=O[j].slice(0);return D}};return D.start(),D.update=function(k,j){"utf8"===j&&(k=w.util.encodeUtf8(k));var Q=k.length;D.messageLength+=Q,Q=[Q/4294967296>>>0,Q>>>0];for(var L=D.fullMessageLength.length-1;L>=0;--L)D.fullMessageLength[L]+=Q[1],Q[1]=Q[0]+(D.fullMessageLength[L]/4294967296>>>0),D.fullMessageLength[L]=D.fullMessageLength[L]>>>0,Q[0]=Q[1]/4294967296>>>0;return g.putBytes(k),_(x,v,g),(g.read>2048||0===g.length())&&g.compact(),D},D.digest=function(){var k=w.util.createBuffer();k.putBytes(g.bytes()),k.putBytes(I.substr(0,D.blockLength-(D.fullMessageLength[D.fullMessageLength.length-1]+D.messageLengthSize&D.blockLength-1)));for(var L,G=8*D.fullMessageLength[0],C=0;C<D.fullMessageLength.length-1;++C)k.putInt32((G+=(L=8*D.fullMessageLength[C+1])/4294967296>>>0)>>>0),G=L>>>0;k.putInt32(G);var z=new Array(x.length);for(C=0;C<x.length;++C)z[C]=x[C].slice(0);_(z,v,k);var Z,te=w.util.createBuffer();for(Z="SHA-512"===A?z.length:"SHA-384"===A?z.length-2:z.length-4,C=0;C<Z;++C)te.putInt32(z[C][0]),(C!==Z-1||"SHA-512/224"!==A)&&te.putInt32(z[C][1]);return te},D};var I=null,m=!1,l=null,h=null;function _(A,O,x){for(var g,v,R,N,z,te,Z,se,ue,oe,me,fe,ae,pe,ce,_e,de,ye,we,xe,Ae,Re,ve,Oe,Ve,Ue,je,Ke=x.length();Ke>=128;){for(Ae=0;Ae<16;++Ae)O[Ae][0]=x.getInt32()>>>0,O[Ae][1]=x.getInt32()>>>0;for(;Ae<80;++Ae)v=(((Re=(Oe=O[Ae-2])[0])<<13|(ve=Oe[1])>>>19)^(ve<<3|Re>>>29)^(Re<<26|ve>>>6))>>>0,O[Ae][0]=(g=((Re>>>19|ve<<13)^(ve>>>29|Re<<3)^Re>>>6)>>>0)+(Ve=O[Ae-7])[0]+(R=(((Re=(Ue=O[Ae-15])[0])>>>1|(ve=Ue[1])<<31)^(Re>>>8|ve<<24)^Re>>>7)>>>0)+(je=O[Ae-16])[0]+((ve=v+Ve[1]+(N=((Re<<31|ve>>>1)^(Re<<24|ve>>>8)^(Re<<25|ve>>>7))>>>0)+je[1])/4294967296>>>0)>>>0,O[Ae][1]=ve>>>0;for(z=A[0][0],te=A[0][1],Z=A[1][0],se=A[1][1],ue=A[2][0],oe=A[2][1],me=A[3][0],fe=A[3][1],ae=A[4][0],pe=A[4][1],ce=A[5][0],_e=A[5][1],de=A[6][0],ye=A[6][1],we=A[7][0],xe=A[7][1],Ae=0;Ae<80;++Ae)g=we+(((ae>>>14|pe<<18)^(ae>>>18|pe<<14)^(pe>>>9|ae<<23))>>>0)+((de^ae&(ce^de))>>>0)+l[Ae][0]+O[Ae][0]+((ve=xe+(((ae<<18|pe>>>14)^(ae<<14|pe>>>18)^(pe<<23|ae>>>9))>>>0)+((ye^pe&(_e^ye))>>>0)+l[Ae][1]+O[Ae][1])/4294967296>>>0)>>>0,v=ve>>>0,R=(((z>>>28|te<<4)^(te>>>2|z<<30)^(te>>>7|z<<25))>>>0)+((z&Z|ue&(z^Z))>>>0)+((ve=(((z<<4|te>>>28)^(te<<30|z>>>2)^(te<<25|z>>>7))>>>0)+((te&se|oe&(te^se))>>>0))/4294967296>>>0)>>>0,N=ve>>>0,we=de,xe=ye,de=ce,ye=_e,ce=ae,_e=pe,ae=me+g+((ve=fe+v)/4294967296>>>0)>>>0,pe=ve>>>0,me=ue,fe=oe,ue=Z,oe=se,Z=z,se=te,z=g+R+((ve=v+N)/4294967296>>>0)>>>0,te=ve>>>0;A[0][0]=A[0][0]+z+((ve=A[0][1]+te)/4294967296>>>0)>>>0,A[0][1]=ve>>>0,A[1][0]=A[1][0]+Z+((ve=A[1][1]+se)/4294967296>>>0)>>>0,A[1][1]=ve>>>0,A[2][0]=A[2][0]+ue+((ve=A[2][1]+oe)/4294967296>>>0)>>>0,A[2][1]=ve>>>0,A[3][0]=A[3][0]+me+((ve=A[3][1]+fe)/4294967296>>>0)>>>0,A[3][1]=ve>>>0,A[4][0]=A[4][0]+ae+((ve=A[4][1]+pe)/4294967296>>>0)>>>0,A[4][1]=ve>>>0,A[5][0]=A[5][0]+ce+((ve=A[5][1]+_e)/4294967296>>>0)>>>0,A[5][1]=ve>>>0,A[6][0]=A[6][0]+de+((ve=A[6][1]+ye)/4294967296>>>0)>>>0,A[6][1]=ve>>>0,A[7][0]=A[7][0]+we+((ve=A[7][1]+xe)/4294967296>>>0)>>>0,A[7][1]=ve>>>0,Ke-=128}}},35813:(re,J,p)=>{var w=p(53217),d=p(40146),S=p(13195).Buffer,I=p(67779),m=p(29119),l=re.exports=I.util=I.util||{};function h(L){if(8!==L&&16!==L&&24!==L&&32!==L)throw new Error("Only 8, 16, 24, or 32 bits supported: "+L)}function y(L){if(this.data="",this.read=0,"string"==typeof L)this.data=L;else if(l.isArrayBuffer(L)||l.isArrayBufferView(L))if(typeof S<"u"&&L instanceof S)this.data=L.toString("binary");else{var K=new Uint8Array(L);try{this.data=String.fromCharCode.apply(null,K)}catch{for(var G=0;G<K.length;++G)this.putByte(K[G])}}else(L instanceof y||"object"==typeof L&&"string"==typeof L.data&&"number"==typeof L.read)&&(this.data=L.data,this.read=L.read);this._constructedStringLength=0}(function(){if(typeof w<"u"&&w.nextTick&&!w.browser)return l.nextTick=w.nextTick,void(l.setImmediate="function"==typeof setImmediate?setImmediate:l.nextTick);if("function"==typeof setImmediate)return l.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(l.nextTick=function(se){return setImmediate(se)});if(l.setImmediate=function(se){setTimeout(se,0)},typeof window<"u"&&"function"==typeof window.postMessage){let se=function(ue){if(ue.source===window&&ue.data===L){ue.stopPropagation();var oe=K.slice();K.length=0,oe.forEach(function(me){me()})}};var L="forge.setImmediate",K=[];l.setImmediate=function(ue){K.push(ue),1===K.length&&window.postMessage(L,"*")},window.addEventListener("message",se,!0)}if(typeof MutationObserver<"u"){var G=Date.now(),C=!0,z=document.createElement("div");K=[],new MutationObserver(function(){var ue=K.slice();K.length=0,ue.forEach(function(oe){oe()})}).observe(z,{attributes:!0});var te=l.setImmediate;l.setImmediate=function(ue){Date.now()-G>15?(G=Date.now(),te(ue)):(K.push(ue),1===K.length&&z.setAttribute("a",C=!C))}}l.nextTick=l.setImmediate})(),l.isNodejs=typeof w<"u"&&w.versions&&w.versions.node,l.globalScope=l.isNodejs?d:typeof self>"u"?window:self,l.isArray=Array.isArray||function(L){return"[object Array]"===Object.prototype.toString.call(L)},l.isArrayBuffer=function(L){return typeof ArrayBuffer<"u"&&L instanceof ArrayBuffer},l.isArrayBufferView=function(L){return L&&l.isArrayBuffer(L.buffer)&&void 0!==L.byteLength},l.ByteBuffer=y,l.ByteStringBuffer=y,l.ByteStringBuffer.prototype._optimizeConstructedString=function(L){this._constructedStringLength+=L,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},l.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},l.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},l.ByteStringBuffer.prototype.putByte=function(L){return this.putBytes(String.fromCharCode(L))},l.ByteStringBuffer.prototype.fillWithByte=function(L,K){L=String.fromCharCode(L);for(var G=this.data;K>0;)1&K&&(G+=L),(K>>>=1)>0&&(L+=L);return this.data=G,this._optimizeConstructedString(K),this},l.ByteStringBuffer.prototype.putBytes=function(L){return this.data+=L,this._optimizeConstructedString(L.length),this},l.ByteStringBuffer.prototype.putString=function(L){return this.putBytes(l.encodeUtf8(L))},l.ByteStringBuffer.prototype.putInt16=function(L){return this.putBytes(String.fromCharCode(L>>8&255)+String.fromCharCode(255&L))},l.ByteStringBuffer.prototype.putInt24=function(L){return this.putBytes(String.fromCharCode(L>>16&255)+String.fromCharCode(L>>8&255)+String.fromCharCode(255&L))},l.ByteStringBuffer.prototype.putInt32=function(L){return this.putBytes(String.fromCharCode(L>>24&255)+String.fromCharCode(L>>16&255)+String.fromCharCode(L>>8&255)+String.fromCharCode(255&L))},l.ByteStringBuffer.prototype.putInt16Le=function(L){return this.putBytes(String.fromCharCode(255&L)+String.fromCharCode(L>>8&255))},l.ByteStringBuffer.prototype.putInt24Le=function(L){return this.putBytes(String.fromCharCode(255&L)+String.fromCharCode(L>>8&255)+String.fromCharCode(L>>16&255))},l.ByteStringBuffer.prototype.putInt32Le=function(L){return this.putBytes(String.fromCharCode(255&L)+String.fromCharCode(L>>8&255)+String.fromCharCode(L>>16&255)+String.fromCharCode(L>>24&255))},l.ByteStringBuffer.prototype.putInt=function(L,K){h(K);var G="";do{K-=8,G+=String.fromCharCode(L>>K&255)}while(K>0);return this.putBytes(G)},l.ByteStringBuffer.prototype.putSignedInt=function(L,K){return L<0&&(L+=2<<K-1),this.putInt(L,K)},l.ByteStringBuffer.prototype.putBuffer=function(L){return this.putBytes(L.getBytes())},l.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},l.ByteStringBuffer.prototype.getInt16=function(){var L=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,L},l.ByteStringBuffer.prototype.getInt24=function(){var L=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,L},l.ByteStringBuffer.prototype.getInt32=function(){var L=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,L},l.ByteStringBuffer.prototype.getInt16Le=function(){var L=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,L},l.ByteStringBuffer.prototype.getInt24Le=function(){var L=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,L},l.ByteStringBuffer.prototype.getInt32Le=function(){var L=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,L},l.ByteStringBuffer.prototype.getInt=function(L){h(L);var K=0;do{K=(K<<8)+this.data.charCodeAt(this.read++),L-=8}while(L>0);return K},l.ByteStringBuffer.prototype.getSignedInt=function(L){var K=this.getInt(L),G=2<<L-2;return K>=G&&(K-=G<<1),K},l.ByteStringBuffer.prototype.getBytes=function(L){var K;return L?(L=Math.min(this.length(),L),K=this.data.slice(this.read,this.read+L),this.read+=L):0===L?K="":(K=0===this.read?this.data:this.data.slice(this.read),this.clear()),K},l.ByteStringBuffer.prototype.bytes=function(L){return typeof L>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+L)},l.ByteStringBuffer.prototype.at=function(L){return this.data.charCodeAt(this.read+L)},l.ByteStringBuffer.prototype.setAt=function(L,K){return this.data=this.data.substr(0,this.read+L)+String.fromCharCode(K)+this.data.substr(this.read+L+1),this},l.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},l.ByteStringBuffer.prototype.copy=function(){var L=l.createBuffer(this.data);return L.read=this.read,L},l.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},l.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},l.ByteStringBuffer.prototype.truncate=function(L){var K=Math.max(0,this.length()-L);return this.data=this.data.substr(this.read,K),this.read=0,this},l.ByteStringBuffer.prototype.toHex=function(){for(var L="",K=this.read;K<this.data.length;++K){var G=this.data.charCodeAt(K);G<16&&(L+="0"),L+=G.toString(16)}return L},l.ByteStringBuffer.prototype.toString=function(){return l.decodeUtf8(this.bytes())},l.DataBuffer=function A(L,K){this.read=(K=K||{}).readOffset||0,this.growSize=K.growSize||1024;var G=l.isArrayBuffer(L),C=l.isArrayBufferView(L);if(G||C)return this.data=G?new DataView(L):new DataView(L.buffer,L.byteOffset,L.byteLength),void(this.write="writeOffset"in K?K.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=L&&this.putBytes(L),"writeOffset"in K&&(this.write=K.writeOffset)},l.DataBuffer.prototype.length=function(){return this.write-this.read},l.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},l.DataBuffer.prototype.accommodate=function(L,K){if(this.length()>=L)return this;K=Math.max(K||this.growSize,L);var G=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),C=new Uint8Array(this.length()+K);return C.set(G),this.data=new DataView(C.buffer),this},l.DataBuffer.prototype.putByte=function(L){return this.accommodate(1),this.data.setUint8(this.write++,L),this},l.DataBuffer.prototype.fillWithByte=function(L,K){this.accommodate(K);for(var G=0;G<K;++G)this.data.setUint8(L);return this},l.DataBuffer.prototype.putBytes=function(L,K){if(l.isArrayBufferView(L)){var C=(G=new Uint8Array(L.buffer,L.byteOffset,L.byteLength)).byteLength-G.byteOffset;return this.accommodate(C),new Uint8Array(this.data.buffer,this.write).set(G),this.write+=C,this}if(l.isArrayBuffer(L)){var G=new Uint8Array(L);return this.accommodate(G.byteLength),new Uint8Array(this.data.buffer).set(G,this.write),this.write+=G.byteLength,this}if(L instanceof l.DataBuffer||"object"==typeof L&&"number"==typeof L.read&&"number"==typeof L.write&&l.isArrayBufferView(L.data))return G=new Uint8Array(L.data.byteLength,L.read,L.length()),this.accommodate(G.byteLength),new Uint8Array(L.data.byteLength,this.write).set(G),this.write+=G.byteLength,this;if(L instanceof l.ByteStringBuffer&&(L=L.data,K="binary"),K=K||"binary","string"==typeof L){var te;if("hex"===K)return this.accommodate(Math.ceil(L.length/2)),te=new Uint8Array(this.data.buffer,this.write),this.write+=l.binary.hex.decode(L,te,this.write),this;if("base64"===K)return this.accommodate(3*Math.ceil(L.length/4)),te=new Uint8Array(this.data.buffer,this.write),this.write+=l.binary.base64.decode(L,te,this.write),this;if("utf8"===K&&(L=l.encodeUtf8(L),K="binary"),"binary"===K||"raw"===K)return this.accommodate(L.length),te=new Uint8Array(this.data.buffer,this.write),this.write+=l.binary.raw.decode(te),this;if("utf16"===K)return this.accommodate(2*L.length),te=new Uint16Array(this.data.buffer,this.write),this.write+=l.text.utf16.encode(te),this;throw new Error("Invalid encoding: "+K)}throw Error("Invalid parameter: "+L)},l.DataBuffer.prototype.putBuffer=function(L){return this.putBytes(L),L.clear(),this},l.DataBuffer.prototype.putString=function(L){return this.putBytes(L,"utf16")},l.DataBuffer.prototype.putInt16=function(L){return this.accommodate(2),this.data.setInt16(this.write,L),this.write+=2,this},l.DataBuffer.prototype.putInt24=function(L){return this.accommodate(3),this.data.setInt16(this.write,L>>8&65535),this.data.setInt8(this.write,L>>16&255),this.write+=3,this},l.DataBuffer.prototype.putInt32=function(L){return this.accommodate(4),this.data.setInt32(this.write,L),this.write+=4,this},l.DataBuffer.prototype.putInt16Le=function(L){return this.accommodate(2),this.data.setInt16(this.write,L,!0),this.write+=2,this},l.DataBuffer.prototype.putInt24Le=function(L){return this.accommodate(3),this.data.setInt8(this.write,L>>16&255),this.data.setInt16(this.write,L>>8&65535,!0),this.write+=3,this},l.DataBuffer.prototype.putInt32Le=function(L){return this.accommodate(4),this.data.setInt32(this.write,L,!0),this.write+=4,this},l.DataBuffer.prototype.putInt=function(L,K){h(K),this.accommodate(K/8);do{K-=8,this.data.setInt8(this.write++,L>>K&255)}while(K>0);return this},l.DataBuffer.prototype.putSignedInt=function(L,K){return h(K),this.accommodate(K/8),L<0&&(L+=2<<K-1),this.putInt(L,K)},l.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},l.DataBuffer.prototype.getInt16=function(){var L=this.data.getInt16(this.read);return this.read+=2,L},l.DataBuffer.prototype.getInt24=function(){var L=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,L},l.DataBuffer.prototype.getInt32=function(){var L=this.data.getInt32(this.read);return this.read+=4,L},l.DataBuffer.prototype.getInt16Le=function(){var L=this.data.getInt16(this.read,!0);return this.read+=2,L},l.DataBuffer.prototype.getInt24Le=function(){var L=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,L},l.DataBuffer.prototype.getInt32Le=function(){var L=this.data.getInt32(this.read,!0);return this.read+=4,L},l.DataBuffer.prototype.getInt=function(L){h(L);var K=0;do{K=(K<<8)+this.data.getInt8(this.read++),L-=8}while(L>0);return K},l.DataBuffer.prototype.getSignedInt=function(L){var K=this.getInt(L),G=2<<L-2;return K>=G&&(K-=G<<1),K},l.DataBuffer.prototype.getBytes=function(L){var K;return L?(L=Math.min(this.length(),L),K=this.data.slice(this.read,this.read+L),this.read+=L):0===L?K="":(K=0===this.read?this.data:this.data.slice(this.read),this.clear()),K},l.DataBuffer.prototype.bytes=function(L){return typeof L>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+L)},l.DataBuffer.prototype.at=function(L){return this.data.getUint8(this.read+L)},l.DataBuffer.prototype.setAt=function(L,K){return this.data.setUint8(L,K),this},l.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},l.DataBuffer.prototype.copy=function(){return new l.DataBuffer(this)},l.DataBuffer.prototype.compact=function(){if(this.read>0){var L=new Uint8Array(this.data.buffer,this.read),K=new Uint8Array(L.byteLength);K.set(L),this.data=new DataView(K),this.write-=this.read,this.read=0}return this},l.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},l.DataBuffer.prototype.truncate=function(L){return this.write=Math.max(0,this.length()-L),this.read=Math.min(this.read,this.write),this},l.DataBuffer.prototype.toHex=function(){for(var L="",K=this.read;K<this.data.byteLength;++K){var G=this.data.getUint8(K);G<16&&(L+="0"),L+=G.toString(16)}return L},l.DataBuffer.prototype.toString=function(L){var K=new Uint8Array(this.data,this.read,this.length());if("binary"===(L=L||"utf8")||"raw"===L)return l.binary.raw.encode(K);if("hex"===L)return l.binary.hex.encode(K);if("base64"===L)return l.binary.base64.encode(K);if("utf8"===L)return l.text.utf8.decode(K);if("utf16"===L)return l.text.utf16.decode(K);throw new Error("Invalid encoding: "+L)},l.createBuffer=function(L,K){return K=K||"raw",void 0!==L&&"utf8"===K&&(L=l.encodeUtf8(L)),new l.ByteBuffer(L)},l.fillString=function(L,K){for(var G="";K>0;)1&K&&(G+=L),(K>>>=1)>0&&(L+=L);return G},l.xorBytes=function(L,K,G){for(var C="",z="",te="",Z=0,se=0;G>0;--G,++Z)z=L.charCodeAt(Z)^K.charCodeAt(Z),se>=10&&(C+=te,te="",se=0),te+=String.fromCharCode(z),++se;return C+te},l.hexToBytes=function(L){var K="",G=0;for(!0&L.length&&(G=1,K+=String.fromCharCode(parseInt(L[0],16)));G<L.length;G+=2)K+=String.fromCharCode(parseInt(L.substr(G,2),16));return K},l.bytesToHex=function(L){return l.createBuffer(L).toHex()},l.int32ToBytes=function(L){return String.fromCharCode(L>>24&255)+String.fromCharCode(L>>16&255)+String.fromCharCode(L>>8&255)+String.fromCharCode(255&L)};var O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",x=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],g="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";l.encode64=function(L,K){for(var z,te,Z,G="",C="",se=0;se<L.length;)z=L.charCodeAt(se++),te=L.charCodeAt(se++),Z=L.charCodeAt(se++),G+=O.charAt(z>>2),G+=O.charAt((3&z)<<4|te>>4),isNaN(te)?G+="==":(G+=O.charAt((15&te)<<2|Z>>6),G+=isNaN(Z)?"=":O.charAt(63&Z)),K&&G.length>K&&(C+=G.substr(0,K)+"\r\n",G=G.substr(K));return C+G},l.decode64=function(L){L=L.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var G,C,z,te,K="",Z=0;Z<L.length;)G=x[L.charCodeAt(Z++)-43],C=x[L.charCodeAt(Z++)-43],z=x[L.charCodeAt(Z++)-43],te=x[L.charCodeAt(Z++)-43],K+=String.fromCharCode(G<<2|C>>4),64!==z&&(K+=String.fromCharCode((15&C)<<4|z>>2),64!==te&&(K+=String.fromCharCode((3&z)<<6|te)));return K},l.encodeUtf8=function(L){return unescape(encodeURIComponent(L))},l.decodeUtf8=function(L){return decodeURIComponent(escape(L))},l.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:m.encode,decode:m.decode}},l.binary.raw.encode=function(L){return String.fromCharCode.apply(null,L)},l.binary.raw.decode=function(L,K,G){var C=K;C||(C=new Uint8Array(L.length));for(var z=G=G||0,te=0;te<L.length;++te)C[z++]=L.charCodeAt(te);return K?z-G:C},l.binary.hex.encode=l.bytesToHex,l.binary.hex.decode=function(L,K,G){var C=K;C||(C=new Uint8Array(Math.ceil(L.length/2)));var z=0,te=G=G||0;for(1&L.length&&(z=1,C[te++]=parseInt(L[0],16));z<L.length;z+=2)C[te++]=parseInt(L.substr(z,2),16);return K?te-G:C},l.binary.base64.encode=function(L,K){for(var z,te,Z,G="",C="",se=0;se<L.byteLength;)z=L[se++],te=L[se++],Z=L[se++],G+=O.charAt(z>>2),G+=O.charAt((3&z)<<4|te>>4),isNaN(te)?G+="==":(G+=O.charAt((15&te)<<2|Z>>6),G+=isNaN(Z)?"=":O.charAt(63&Z)),K&&G.length>K&&(C+=G.substr(0,K)+"\r\n",G=G.substr(K));return C+G},l.binary.base64.decode=function(L,K,G){var C=K;C||(C=new Uint8Array(3*Math.ceil(L.length/4))),L=L.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var z,te,Z,se,ue=0,oe=G=G||0;ue<L.length;)z=x[L.charCodeAt(ue++)-43],te=x[L.charCodeAt(ue++)-43],Z=x[L.charCodeAt(ue++)-43],se=x[L.charCodeAt(ue++)-43],C[oe++]=z<<2|te>>4,64!==Z&&(C[oe++]=(15&te)<<4|Z>>2,64!==se&&(C[oe++]=(3&Z)<<6|se));return K?oe-G:C.subarray(0,oe)},l.binary.base58.encode=function(L,K){return l.binary.baseN.encode(L,g,K)},l.binary.base58.decode=function(L,K){return l.binary.baseN.decode(L,g,K)},l.text={utf8:{},utf16:{}},l.text.utf8.encode=function(L,K,G){L=l.encodeUtf8(L);var C=K;C||(C=new Uint8Array(L.length));for(var z=G=G||0,te=0;te<L.length;++te)C[z++]=L.charCodeAt(te);return K?z-G:C},l.text.utf8.decode=function(L){return l.decodeUtf8(String.fromCharCode.apply(null,L))},l.text.utf16.encode=function(L,K,G){var C=K;C||(C=new Uint8Array(2*L.length));for(var z=new Uint16Array(C.buffer),te=G=G||0,Z=G,se=0;se<L.length;++se)z[Z++]=L.charCodeAt(se),te+=2;return K?te-G:C},l.text.utf16.decode=function(L){return String.fromCharCode.apply(null,new Uint16Array(L.buffer))},l.deflate=function(L,K,G){if(K=l.decode64(L.deflate(l.encode64(K)).rval),G){var C=2;32&K.charCodeAt(1)&&(C=6),K=K.substring(C,K.length-4)}return K},l.inflate=function(L,K,G){var C=L.inflate(l.encode64(K)).rval;return null===C?null:l.decode64(C)};var v=function(L,K,G){if(!L)throw new Error("WebStorage not available.");var C;if(null===G?C=L.removeItem(K):(G=l.encode64(JSON.stringify(G)),C=L.setItem(K,G)),typeof C<"u"&&!0!==C.rval){var z=new Error(C.error.message);throw z.id=C.error.id,z.name=C.error.name,z}},R=function(L,K){if(!L)throw new Error("WebStorage not available.");var G=L.getItem(K);if(L.init)if(null===G.rval){if(G.error){var C=new Error(G.error.message);throw C.id=G.error.id,C.name=G.error.name,C}G=null}else G=G.rval;return null!==G&&(G=JSON.parse(l.decode64(G))),G},N=function(L,K,G,C){var z=R(L,K);null===z&&(z={}),z[G]=C,v(L,K,z)},D=function(L,K,G){var C=R(L,K);return null!==C&&(C=G in C?C[G]:null),C},k=function(L,K,G){var C=R(L,K);if(null!==C&&G in C){delete C[G];var z=!0;for(var te in C){z=!1;break}z&&(C=null),v(L,K,C)}},j=function(L,K){v(L,K,null)},Q=function(L,K,G){var C=null;typeof G>"u"&&(G=["web","flash"]);var z,te=!1,Z=null;for(var se in G){z=G[se];try{if("flash"===z||"both"===z){if(null===K[0])throw new Error("Flash local storage not available.");C=L.apply(this,K),te="flash"===z}("web"===z||"both"===z)&&(K[0]=localStorage,C=L.apply(this,K),te=!0)}catch(ue){Z=ue}if(te)break}if(!te)throw Z;return C};l.setItem=function(L,K,G,C,z){Q(N,arguments,z)},l.getItem=function(L,K,G,C){return Q(D,arguments,C)},l.removeItem=function(L,K,G,C){Q(k,arguments,C)},l.clearItems=function(L,K,G){Q(j,arguments,G)},l.isEmpty=function(L){for(var K in L)if(L.hasOwnProperty(K))return!1;return!0},l.format=function(L){for(var G,C,K=/%./g,z=0,te=[],Z=0;G=K.exec(L);){(C=L.substring(Z,K.lastIndex-2)).length>0&&te.push(C),Z=K.lastIndex;var se=G[0][1];switch(se){case"s":case"o":te.push(z<arguments.length?arguments[1+z++]:"<?>");break;case"%":te.push("%");break;default:te.push("<%"+se+"?>")}}return te.push(L.substring(Z)),te.join("")},l.formatNumber=function(L,K,G,C){var z=L,te=isNaN(K=Math.abs(K))?2:K,Z=void 0===G?",":G,se=void 0===C?".":C,ue=z<0?"-":"",oe=parseInt(z=Math.abs(+z||0).toFixed(te),10)+"",me=oe.length>3?oe.length%3:0;return ue+(me?oe.substr(0,me)+se:"")+oe.substr(me).replace(/(\d{3})(?=\d)/g,"$1"+se)+(te?Z+Math.abs(z-oe).toFixed(te).slice(2):"")},l.formatSize=function(L){return L>=1073741824?l.formatNumber(L/1073741824,2,".","")+" GiB":L>=1048576?l.formatNumber(L/1048576,2,".","")+" MiB":L>=1024?l.formatNumber(L/1024,0)+" KiB":l.formatNumber(L,0)+" bytes"},l.bytesFromIP=function(L){return-1!==L.indexOf(".")?l.bytesFromIPv4(L):-1!==L.indexOf(":")?l.bytesFromIPv6(L):null},l.bytesFromIPv4=function(L){if(4!==(L=L.split(".")).length)return null;for(var K=l.createBuffer(),G=0;G<L.length;++G){var C=parseInt(L[G],10);if(isNaN(C))return null;K.putByte(C)}return K.getBytes()},l.bytesFromIPv6=function(L){for(var K=0,G=2*(8-(L=L.split(":").filter(function(Z){return 0===Z.length&&++K,!0})).length+K),C=l.createBuffer(),z=0;z<8;++z)if(L[z]&&0!==L[z].length){var te=l.hexToBytes(L[z]);te.length<2&&C.putByte(0),C.putBytes(te)}else C.fillWithByte(0,G),G=0;return C.getBytes()},l.bytesToIP=function(L){return 4===L.length?l.bytesToIPv4(L):16===L.length?l.bytesToIPv6(L):null},l.bytesToIPv4=function(L){if(4!==L.length)return null;for(var K=[],G=0;G<L.length;++G)K.push(L.charCodeAt(G));return K.join(".")},l.bytesToIPv6=function(L){if(16!==L.length)return null;for(var K=[],G=[],C=0,z=0;z<L.length;z+=2){for(var te=l.bytesToHex(L[z]+L[z+1]);"0"===te[0]&&"0"!==te;)te=te.substr(1);if("0"===te){var Z=G[G.length-1],se=K.length;Z&&se===Z.end+1?(Z.end=se,Z.end-Z.start>G[C].end-G[C].start&&(C=G.length-1)):G.push({start:se,end:se})}K.push(te)}if(G.length>0){var ue=G[C];ue.end-ue.start>0&&(K.splice(ue.start,ue.end-ue.start+1,""),0===ue.start&&K.unshift(""),7===ue.end&&K.push(""))}return K.join(":")},l.estimateCores=function(L,K){if("function"==typeof L&&(K=L,L={}),L=L||{},"cores"in l&&!L.update)return K(null,l.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return l.cores=navigator.hardwareConcurrency,K(null,l.cores);if(typeof Worker>"u")return l.cores=1,K(null,l.cores);if(typeof Blob>"u")return l.cores=2,K(null,l.cores);var G=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(Z){for(var se=Date.now(),ue=se+4;Date.now()<ue;);self.postMessage({st:se,et:ue})})}.toString(),")()"],{type:"application/javascript"}));!function C(Z,se,ue){if(0===se){var oe=Math.floor(Z.reduce(function(me,fe){return me+fe},0)/Z.length);return l.cores=Math.max(1,oe),URL.revokeObjectURL(G),K(null,l.cores)}!function z(Z,se){for(var ue=[],oe=[],me=0;me<Z;++me){var fe=new Worker(G);fe.addEventListener("message",function(ae){if(oe.push(ae.data),oe.length===Z){for(var pe=0;pe<Z;++pe)ue[pe].terminate();se(null,oe)}}),ue.push(fe)}for(me=0;me<Z;++me)ue[me].postMessage(me)}(ue,function(me,fe){Z.push(function te(Z,se){for(var ue=[],oe=0;oe<Z;++oe)for(var me=se[oe],fe=ue[oe]=[],ae=0;ae<Z;++ae)if(oe!==ae){var pe=se[ae];(me.st>pe.st&&me.st<pe.et||pe.st>me.st&&pe.st<me.et)&&fe.push(ae)}return ue.reduce(function(ce,_e){return Math.max(ce,_e.length)},0)}(ue,fe)),C(Z,se-1,ue)})}([],5,16)}},85466:(re,J,p)=>{var w=p(67779);p(89690),p(97238),p(24590),p(56101),p(64445),p(40072),p(16082),p(36878),p(11812),p(35813);var d=w.asn1,S=re.exports=w.pki=w.pki||{},I=S.oids,m={};m.CN=I.commonName,m.commonName="CN",m.C=I.countryName,m.countryName="C",m.L=I.localityName,m.localityName="L",m.ST=I.stateOrProvinceName,m.stateOrProvinceName="ST",m.O=I.organizationName,m.organizationName="O",m.OU=I.organizationalUnitName,m.organizationalUnitName="OU",m.E=I.emailAddress,m.emailAddress="E";var l=w.pki.rsa.publicKeyValidator,h={name:"Certificate",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:d.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:d.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:d.Class.UNIVERSAL,type:d.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:d.Class.UNIVERSAL,type:d.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:d.Class.UNIVERSAL,type:d.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:d.Class.UNIVERSAL,type:d.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},l,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:d.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:d.Class.UNIVERSAL,type:d.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:d.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:d.Class.UNIVERSAL,type:d.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:d.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:d.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:d.Class.UNIVERSAL,type:d.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},y={name:"rsapss",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:d.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:d.Class.UNIVERSAL,type:d.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:d.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:d.Class.UNIVERSAL,type:d.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:d.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:d.Class.UNIVERSAL,type:d.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:d.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:d.Class.UNIVERSAL,type:d.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},A={name:"CertificationRequest",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[{name:"CertificationRequestInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},l,{name:"CertificationRequestInfo.attributes",tagClass:d.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:d.Class.UNIVERSAL,type:d.Type.SET,constructed:!0}]}]}]},{name:"CertificationRequest.signatureAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:d.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:d.Class.UNIVERSAL,type:d.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function O(C,z){"string"==typeof z&&(z={shortName:z});for(var Z,te=null,se=0;null===te&&se<C.attributes.length;++se)Z=C.attributes[se],(z.type&&z.type===Z.type||z.name&&z.name===Z.name||z.shortName&&z.shortName===Z.shortName)&&(te=Z);return te}S.RDNAttributesAsArray=function(C,z){for(var Z,se,ue,te=[],oe=0;oe<C.value.length;++oe){Z=C.value[oe];for(var me=0;me<Z.value.length;++me)(ue={}).type=d.derToOid((se=Z.value[me]).value[0].value),ue.value=se.value[1].value,ue.valueTagClass=se.value[1].type,ue.type in I&&(ue.name=I[ue.type],ue.name in m&&(ue.shortName=m[ue.name])),z&&(z.update(ue.type),z.update(ue.value)),te.push(ue)}return te},S.CRIAttributesAsArray=function(C){for(var z=[],te=0;te<C.length;++te)for(var Z=C[te],se=d.derToOid(Z.value[0].value),ue=Z.value[1].value,oe=0;oe<ue.length;++oe){var me={};if(me.type=se,me.value=ue[oe].value,me.valueTagClass=ue[oe].type,me.type in I&&(me.name=I[me.type],me.name in m&&(me.shortName=m[me.name])),me.type===I.extensionRequest){me.extensions=[];for(var fe=0;fe<me.value.length;++fe)me.extensions.push(S.certificateExtensionFromAsn1(me.value[fe]))}z.push(me)}return z};var x=function(C,z,te){var Z={};if(C!==I["RSASSA-PSS"])return Z;te&&(Z={hash:{algorithmOid:I.sha1},mgf:{algorithmOid:I.mgf1,hash:{algorithmOid:I.sha1}},saltLength:20});var se={},ue=[];if(!d.validate(z,y,se,ue)){var oe=new Error("Cannot read RSASSA-PSS parameter block.");throw oe.errors=ue,oe}return void 0!==se.hashOid&&(Z.hash=Z.hash||{},Z.hash.algorithmOid=d.derToOid(se.hashOid)),void 0!==se.maskGenOid&&(Z.mgf=Z.mgf||{},Z.mgf.algorithmOid=d.derToOid(se.maskGenOid),Z.mgf.hash=Z.mgf.hash||{},Z.mgf.hash.algorithmOid=d.derToOid(se.maskGenHashOid)),void 0!==se.saltLength&&(Z.saltLength=se.saltLength.charCodeAt(0)),Z},g=function(C){switch(I[C.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return w.md.sha1.create();case"md5WithRSAEncryption":return w.md.md5.create();case"sha256WithRSAEncryption":case"RSASSA-PSS":return w.md.sha256.create();case"sha384WithRSAEncryption":return w.md.sha384.create();case"sha512WithRSAEncryption":return w.md.sha512.create();default:var z=new Error("Could not compute "+C.type+" digest. Unknown signature OID.");throw z.signatureOid=C.signatureOid,z}},v=function(C){var te,z=C.certificate;switch(z.signatureOid){case I.sha1WithRSAEncryption:case I.sha1WithRSASignature:break;case I["RSASSA-PSS"]:var Z,se,ue;if(void 0===(Z=I[z.signatureParameters.mgf.hash.algorithmOid])||void 0===w.md[Z])throw(ue=new Error("Unsupported MGF hash function.")).oid=z.signatureParameters.mgf.hash.algorithmOid,ue.name=Z,ue;if(void 0===(se=I[z.signatureParameters.mgf.algorithmOid])||void 0===w.mgf[se])throw(ue=new Error("Unsupported MGF function.")).oid=z.signatureParameters.mgf.algorithmOid,ue.name=se,ue;if(se=w.mgf[se].create(w.md[Z].create()),void 0===(Z=I[z.signatureParameters.hash.algorithmOid])||void 0===w.md[Z])throw(ue=new Error("Unsupported RSASSA-PSS hash function.")).oid=z.signatureParameters.hash.algorithmOid,ue.name=Z,ue;te=w.pss.create(w.md[Z].create(),se,z.signatureParameters.saltLength)}return z.publicKey.verify(C.md.digest().getBytes(),C.signature,te)};function R(C){for(var te,Z,z=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]),se=C.attributes,ue=0;ue<se.length;++ue){var oe=(te=se[ue]).value,me=d.Type.PRINTABLESTRING;"valueTagClass"in te&&(me=te.valueTagClass)===d.Type.UTF8&&(oe=w.util.encodeUtf8(oe)),Z=d.create(d.Class.UNIVERSAL,d.Type.SET,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(te.type).getBytes()),d.create(d.Class.UNIVERSAL,me,!1,oe)])]),z.value.push(Z)}return z}function D(C){for(var z,te=0;te<C.length;++te){if(typeof(z=C[te]).name>"u"&&(z.type&&z.type in S.oids?z.name=S.oids[z.type]:z.shortName&&z.shortName in m&&(z.name=S.oids[m[z.shortName]])),typeof z.type>"u"){if(!z.name||!(z.name in S.oids))throw(Z=new Error("Attribute type not specified.")).attribute=z,Z;z.type=S.oids[z.name]}if(typeof z.shortName>"u"&&z.name&&z.name in m&&(z.shortName=m[z.name]),z.type===I.extensionRequest&&(z.valueConstructed=!0,z.valueTagClass=d.Type.SEQUENCE,!z.value&&z.extensions)){z.value=[];for(var se=0;se<z.extensions.length;++se)z.value.push(S.certificateExtensionToAsn1(k(z.extensions[se])))}var Z;if(typeof z.value>"u")throw(Z=new Error("Attribute value not specified.")).attribute=z,Z}}function k(C,z){if(z=z||{},typeof C.name>"u"&&C.id&&C.id in S.oids&&(C.name=S.oids[C.id]),typeof C.id>"u"){if(!C.name||!(C.name in S.oids))throw(te=new Error("Extension ID not specified.")).extension=C,te;C.id=S.oids[C.name]}if(typeof C.value<"u")return C;if("keyUsage"===C.name){var Z=0,se=0,ue=0;C.digitalSignature&&(se|=128,Z=7),C.nonRepudiation&&(se|=64,Z=6),C.keyEncipherment&&(se|=32,Z=5),C.dataEncipherment&&(se|=16,Z=4),C.keyAgreement&&(se|=8,Z=3),C.keyCertSign&&(se|=4,Z=2),C.cRLSign&&(se|=2,Z=1),C.encipherOnly&&(se|=1,Z=0),C.decipherOnly&&(ue|=128,Z=7);var oe=String.fromCharCode(Z);0!==ue?oe+=String.fromCharCode(se)+String.fromCharCode(ue):0!==se&&(oe+=String.fromCharCode(se)),C.value=d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,oe)}else if("basicConstraints"===C.name)C.value=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]),C.cA&&C.value.value.push(d.create(d.Class.UNIVERSAL,d.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in C&&C.value.value.push(d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(C.pathLenConstraint).getBytes()));else if("extKeyUsage"===C.name){C.value=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]);var me=C.value.value;for(var fe in C)!0===C[fe]&&(fe in I?me.push(d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(I[fe]).getBytes())):-1!==fe.indexOf(".")&&me.push(d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(fe).getBytes())))}else if("nsCertType"===C.name)Z=0,se=0,C.client&&(se|=128,Z=7),C.server&&(se|=64,Z=6),C.email&&(se|=32,Z=5),C.objsign&&(se|=16,Z=4),C.reserved&&(se|=8,Z=3),C.sslCA&&(se|=4,Z=2),C.emailCA&&(se|=2,Z=1),C.objCA&&(se|=1,Z=0),oe=String.fromCharCode(Z),0!==se&&(oe+=String.fromCharCode(se)),C.value=d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,oe);else if("subjectAltName"===C.name||"issuerAltName"===C.name){C.value=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]);for(var pe=0;pe<C.altNames.length;++pe){if(oe=(ae=C.altNames[pe]).value,7===ae.type&&ae.ip){if(null===(oe=w.util.bytesFromIP(ae.ip)))throw(te=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=C,te}else 8===ae.type&&(oe=d.oidToDer(ae.oid?d.oidToDer(ae.oid):oe));C.value.value.push(d.create(d.Class.CONTEXT_SPECIFIC,ae.type,!1,oe))}}else if("nsComment"===C.name&&z.cert){if(!/^[\x00-\x7F]*$/.test(C.comment)||C.comment.length<1||C.comment.length>128)throw new Error('Invalid "nsComment" content.');C.value=d.create(d.Class.UNIVERSAL,d.Type.IA5STRING,!1,C.comment)}else if("subjectKeyIdentifier"===C.name&&z.cert){var ce=z.cert.generateSubjectKeyIdentifier();C.subjectKeyIdentifier=ce.toHex(),C.value=d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,ce.getBytes())}else if("authorityKeyIdentifier"===C.name&&z.cert){if(C.value=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]),me=C.value.value,C.keyIdentifier){var _e=!0===C.keyIdentifier?z.cert.generateSubjectKeyIdentifier().getBytes():C.keyIdentifier;me.push(d.create(d.Class.CONTEXT_SPECIFIC,0,!1,_e))}if(C.authorityCertIssuer){var de=[d.create(d.Class.CONTEXT_SPECIFIC,4,!0,[R(!0===C.authorityCertIssuer?z.cert.issuer:C.authorityCertIssuer)])];me.push(d.create(d.Class.CONTEXT_SPECIFIC,1,!0,de))}if(C.serialNumber){var ye=w.util.hexToBytes(!0===C.serialNumber?z.cert.serialNumber:C.serialNumber);me.push(d.create(d.Class.CONTEXT_SPECIFIC,2,!1,ye))}}else if("cRLDistributionPoints"===C.name){C.value=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]),me=C.value.value;var ae,we=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]),xe=d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[]);for(pe=0;pe<C.altNames.length;++pe){if(oe=(ae=C.altNames[pe]).value,7===ae.type&&ae.ip){if(null===(oe=w.util.bytesFromIP(ae.ip)))throw(te=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=C,te}else 8===ae.type&&(oe=d.oidToDer(ae.oid?d.oidToDer(ae.oid):oe));xe.value.push(d.create(d.Class.CONTEXT_SPECIFIC,ae.type,!1,oe))}we.value.push(d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[xe])),me.push(we)}var te;if(typeof C.value>"u")throw(te=new Error("Extension value not specified.")).extension=C,te;return C}function j(C,z){if(C===I["RSASSA-PSS"]){var te=[];return void 0!==z.hash.algorithmOid&&te.push(d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(z.hash.algorithmOid).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")])])),void 0!==z.mgf.algorithmOid&&te.push(d.create(d.Class.CONTEXT_SPECIFIC,1,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(z.mgf.algorithmOid).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(z.mgf.hash.algorithmOid).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")])])])),void 0!==z.saltLength&&te.push(d.create(d.Class.CONTEXT_SPECIFIC,2,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(z.saltLength).getBytes())])),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,te)}return d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")}function Q(C){var z=d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===C.attributes.length)return z;for(var te=C.attributes,Z=0;Z<te.length;++Z){var se=te[Z],ue=se.value,oe=d.Type.UTF8;"valueTagClass"in se&&(oe=se.valueTagClass),oe===d.Type.UTF8&&(ue=w.util.encodeUtf8(ue));var me=!1;"valueConstructed"in se&&(me=se.valueConstructed);var fe=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(se.type).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SET,!0,[d.create(d.Class.UNIVERSAL,oe,me,ue)])]);z.value.push(fe)}return z}S.certificateFromPem=function(C,z,te){var Z=w.pem.decode(C)[0];if("CERTIFICATE"!==Z.type&&"X509 CERTIFICATE"!==Z.type&&"TRUSTED CERTIFICATE"!==Z.type){var se=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw se.headerType=Z.type,se}if(Z.procType&&"ENCRYPTED"===Z.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var ue=d.fromDer(Z.body,te);return S.certificateFromAsn1(ue,z)},S.certificateToPem=function(C,z){var te={type:"CERTIFICATE",body:d.toDer(S.certificateToAsn1(C)).getBytes()};return w.pem.encode(te,{maxline:z})},S.publicKeyFromPem=function(C){var z=w.pem.decode(C)[0];if("PUBLIC KEY"!==z.type&&"RSA PUBLIC KEY"!==z.type){var te=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw te.headerType=z.type,te}if(z.procType&&"ENCRYPTED"===z.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var Z=d.fromDer(z.body);return S.publicKeyFromAsn1(Z)},S.publicKeyToPem=function(C,z){var te={type:"PUBLIC KEY",body:d.toDer(S.publicKeyToAsn1(C)).getBytes()};return w.pem.encode(te,{maxline:z})},S.publicKeyToRSAPublicKeyPem=function(C,z){var te={type:"RSA PUBLIC KEY",body:d.toDer(S.publicKeyToRSAPublicKey(C)).getBytes()};return w.pem.encode(te,{maxline:z})},S.getPublicKeyFingerprint=function(C,z){var se,te=(z=z||{}).md||w.md.sha1.create();switch(z.type||"RSAPublicKey"){case"RSAPublicKey":se=d.toDer(S.publicKeyToRSAPublicKey(C)).getBytes();break;case"SubjectPublicKeyInfo":se=d.toDer(S.publicKeyToAsn1(C)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+z.type+'".')}te.start(),te.update(se);var ue=te.digest();if("hex"===z.encoding){var oe=ue.toHex();return z.delimiter?oe.match(/.{2}/g).join(z.delimiter):oe}if("binary"===z.encoding)return ue.getBytes();if(z.encoding)throw new Error('Unknown encoding "'+z.encoding+'".');return ue},S.certificationRequestFromPem=function(C,z,te){var Z=w.pem.decode(C)[0];if("CERTIFICATE REQUEST"!==Z.type){var se=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw se.headerType=Z.type,se}if(Z.procType&&"ENCRYPTED"===Z.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var ue=d.fromDer(Z.body,te);return S.certificationRequestFromAsn1(ue,z)},S.certificationRequestToPem=function(C,z){var te={type:"CERTIFICATE REQUEST",body:d.toDer(S.certificationRequestToAsn1(C)).getBytes()};return w.pem.encode(te,{maxline:z})},S.createCertificate=function(){var C={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return C.siginfo.algorithmOid=null,C.validity={},C.validity.notBefore=new Date,C.validity.notAfter=new Date,C.issuer={},C.issuer.getField=function(z){return O(C.issuer,z)},C.issuer.addField=function(z){D([z]),C.issuer.attributes.push(z)},C.issuer.attributes=[],C.issuer.hash=null,C.subject={},C.subject.getField=function(z){return O(C.subject,z)},C.subject.addField=function(z){D([z]),C.subject.attributes.push(z)},C.subject.attributes=[],C.subject.hash=null,C.extensions=[],C.publicKey=null,C.md=null,C.setSubject=function(z,te){D(z),C.subject.attributes=z,delete C.subject.uniqueId,te&&(C.subject.uniqueId=te),C.subject.hash=null},C.setIssuer=function(z,te){D(z),C.issuer.attributes=z,delete C.issuer.uniqueId,te&&(C.issuer.uniqueId=te),C.issuer.hash=null},C.setExtensions=function(z){for(var te=0;te<z.length;++te)k(z[te],{cert:C});C.extensions=z},C.getExtension=function(z){"string"==typeof z&&(z={name:z});for(var Z,te=null,se=0;null===te&&se<C.extensions.length;++se)Z=C.extensions[se],(z.id&&Z.id===z.id||z.name&&Z.name===z.name)&&(te=Z);return te},C.sign=function(z,te){C.md=te||w.md.sha1.create();var Z=I[C.md.algorithm+"WithRSAEncryption"];if(!Z){var se=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw se.algorithm=C.md.algorithm,se}C.signatureOid=C.siginfo.algorithmOid=Z,C.tbsCertificate=S.getTBSCertificate(C);var ue=d.toDer(C.tbsCertificate);C.md.update(ue.getBytes()),C.signature=z.sign(C.md)},C.verify=function(z){var te=!1;if(!C.issued(z)){var Z=z.issuer,se=C.subject,ue=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw ue.expectedIssuer=se.attributes,ue.actualIssuer=Z.attributes,ue}var oe=z.md;if(null===oe){oe=g({signatureOid:z.signatureOid,type:"certificate"});var me=z.tbsCertificate||S.getTBSCertificate(z),fe=d.toDer(me);oe.update(fe.getBytes())}return null!==oe&&(te=v({certificate:C,md:oe,signature:z.signature})),te},C.isIssuer=function(z){var te=!1,Z=C.issuer,se=z.subject;if(Z.hash&&se.hash)te=Z.hash===se.hash;else if(Z.attributes.length===se.attributes.length){te=!0;for(var ue,oe,me=0;te&&me<Z.attributes.length;++me)((ue=Z.attributes[me]).type!==(oe=se.attributes[me]).type||ue.value!==oe.value)&&(te=!1)}return te},C.issued=function(z){return z.isIssuer(C)},C.generateSubjectKeyIdentifier=function(){return S.getPublicKeyFingerprint(C.publicKey,{type:"RSAPublicKey"})},C.verifySubjectKeyIdentifier=function(){for(var z=I.subjectKeyIdentifier,te=0;te<C.extensions.length;++te){var Z=C.extensions[te];if(Z.id===z){var se=C.generateSubjectKeyIdentifier().getBytes();return w.util.hexToBytes(Z.subjectKeyIdentifier)===se}}return!1},C},S.certificateFromAsn1=function(C,z){var te={},Z=[];if(!d.validate(C,h,te,Z)){var se=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw se.errors=Z,se}if(d.derToOid(te.publicKeyOid)!==S.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var oe=S.createCertificate();oe.version=te.certVersion?te.certVersion.charCodeAt(0):0;var me=w.util.createBuffer(te.certSerialNumber);oe.serialNumber=me.toHex(),oe.signatureOid=w.asn1.derToOid(te.certSignatureOid),oe.signatureParameters=x(oe.signatureOid,te.certSignatureParams,!0),oe.siginfo.algorithmOid=w.asn1.derToOid(te.certinfoSignatureOid),oe.siginfo.parameters=x(oe.siginfo.algorithmOid,te.certinfoSignatureParams,!1),oe.signature=te.certSignature;var fe=[];if(void 0!==te.certValidity1UTCTime&&fe.push(d.utcTimeToDate(te.certValidity1UTCTime)),void 0!==te.certValidity2GeneralizedTime&&fe.push(d.generalizedTimeToDate(te.certValidity2GeneralizedTime)),void 0!==te.certValidity3UTCTime&&fe.push(d.utcTimeToDate(te.certValidity3UTCTime)),void 0!==te.certValidity4GeneralizedTime&&fe.push(d.generalizedTimeToDate(te.certValidity4GeneralizedTime)),fe.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(fe.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(oe.validity.notBefore=fe[0],oe.validity.notAfter=fe[1],oe.tbsCertificate=te.tbsCertificate,z){oe.md=g({signatureOid:oe.signatureOid,type:"certificate"});var ae=d.toDer(oe.tbsCertificate);oe.md.update(ae.getBytes())}var pe=w.md.sha1.create(),ce=d.toDer(te.certIssuer);pe.update(ce.getBytes()),oe.issuer.getField=function(ye){return O(oe.issuer,ye)},oe.issuer.addField=function(ye){D([ye]),oe.issuer.attributes.push(ye)},oe.issuer.attributes=S.RDNAttributesAsArray(te.certIssuer),te.certIssuerUniqueId&&(oe.issuer.uniqueId=te.certIssuerUniqueId),oe.issuer.hash=pe.digest().toHex();var _e=w.md.sha1.create(),de=d.toDer(te.certSubject);return _e.update(de.getBytes()),oe.subject.getField=function(ye){return O(oe.subject,ye)},oe.subject.addField=function(ye){D([ye]),oe.subject.attributes.push(ye)},oe.subject.attributes=S.RDNAttributesAsArray(te.certSubject),te.certSubjectUniqueId&&(oe.subject.uniqueId=te.certSubjectUniqueId),oe.subject.hash=_e.digest().toHex(),oe.extensions=te.certExtensions?S.certificateExtensionsFromAsn1(te.certExtensions):[],oe.publicKey=S.publicKeyFromAsn1(te.subjectPublicKeyInfo),oe},S.certificateExtensionsFromAsn1=function(C){for(var z=[],te=0;te<C.value.length;++te)for(var Z=C.value[te],se=0;se<Z.value.length;++se)z.push(S.certificateExtensionFromAsn1(Z.value[se]));return z},S.certificateExtensionFromAsn1=function(C){var z={};if(z.id=d.derToOid(C.value[0].value),z.critical=!1,C.value[1].type===d.Type.BOOLEAN?(z.critical=0!==C.value[1].value.charCodeAt(0),z.value=C.value[2].value):z.value=C.value[1].value,z.id in I)if(z.name=I[z.id],"keyUsage"===z.name){var Z=0,se=0;(te=d.fromDer(z.value)).value.length>1&&(Z=te.value.charCodeAt(1),se=te.value.length>2?te.value.charCodeAt(2):0),z.digitalSignature=128==(128&Z),z.nonRepudiation=64==(64&Z),z.keyEncipherment=32==(32&Z),z.dataEncipherment=16==(16&Z),z.keyAgreement=8==(8&Z),z.keyCertSign=4==(4&Z),z.cRLSign=2==(2&Z),z.encipherOnly=1==(1&Z),z.decipherOnly=128==(128&se)}else if("basicConstraints"===z.name){var te=d.fromDer(z.value);z.cA=te.value.length>0&&te.value[0].type===d.Type.BOOLEAN&&0!==te.value[0].value.charCodeAt(0);var ue=null;te.value.length>0&&te.value[0].type===d.Type.INTEGER?ue=te.value[0].value:te.value.length>1&&(ue=te.value[1].value),null!==ue&&(z.pathLenConstraint=d.derToInteger(ue))}else if("extKeyUsage"===z.name){te=d.fromDer(z.value);for(var oe=0;oe<te.value.length;++oe){var me=d.derToOid(te.value[oe].value);me in I?z[I[me]]=!0:z[me]=!0}}else if("nsCertType"===z.name)Z=0,(te=d.fromDer(z.value)).value.length>1&&(Z=te.value.charCodeAt(1)),z.client=128==(128&Z),z.server=64==(64&Z),z.email=32==(32&Z),z.objsign=16==(16&Z),z.reserved=8==(8&Z),z.sslCA=4==(4&Z),z.emailCA=2==(2&Z),z.objCA=1==(1&Z);else if("subjectAltName"===z.name||"issuerAltName"===z.name){z.altNames=[],te=d.fromDer(z.value);for(var fe,ae=0;ae<te.value.length;++ae){var pe={type:(fe=te.value[ae]).type,value:fe.value};switch(z.altNames.push(pe),fe.type){case 1:case 2:case 6:break;case 7:pe.ip=w.util.bytesToIP(fe.value);break;case 8:pe.oid=d.derToOid(fe.value)}}}else"subjectKeyIdentifier"===z.name&&(te=d.fromDer(z.value),z.subjectKeyIdentifier=w.util.bytesToHex(te.value));return z},S.certificationRequestFromAsn1=function(C,z){var te={},Z=[];if(!d.validate(C,A,te,Z)){var se=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw se.errors=Z,se}if(d.derToOid(te.publicKeyOid)!==S.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var oe=S.createCertificationRequest();if(oe.version=te.csrVersion?te.csrVersion.charCodeAt(0):0,oe.signatureOid=w.asn1.derToOid(te.csrSignatureOid),oe.signatureParameters=x(oe.signatureOid,te.csrSignatureParams,!0),oe.siginfo.algorithmOid=w.asn1.derToOid(te.csrSignatureOid),oe.siginfo.parameters=x(oe.siginfo.algorithmOid,te.csrSignatureParams,!1),oe.signature=te.csrSignature,oe.certificationRequestInfo=te.certificationRequestInfo,z){oe.md=g({signatureOid:oe.signatureOid,type:"certification request"});var me=d.toDer(oe.certificationRequestInfo);oe.md.update(me.getBytes())}var fe=w.md.sha1.create();return oe.subject.getField=function(ae){return O(oe.subject,ae)},oe.subject.addField=function(ae){D([ae]),oe.subject.attributes.push(ae)},oe.subject.attributes=S.RDNAttributesAsArray(te.certificationRequestInfoSubject,fe),oe.subject.hash=fe.digest().toHex(),oe.publicKey=S.publicKeyFromAsn1(te.subjectPublicKeyInfo),oe.getAttribute=function(ae){return O(oe,ae)},oe.addAttribute=function(ae){D([ae]),oe.attributes.push(ae)},oe.attributes=S.CRIAttributesAsArray(te.certificationRequestInfoAttributes||[]),oe},S.createCertificationRequest=function(){var C={version:0,signatureOid:null,signature:null,siginfo:{}};return C.siginfo.algorithmOid=null,C.subject={},C.subject.getField=function(z){return O(C.subject,z)},C.subject.addField=function(z){D([z]),C.subject.attributes.push(z)},C.subject.attributes=[],C.subject.hash=null,C.publicKey=null,C.attributes=[],C.getAttribute=function(z){return O(C,z)},C.addAttribute=function(z){D([z]),C.attributes.push(z)},C.md=null,C.setSubject=function(z){D(z),C.subject.attributes=z,C.subject.hash=null},C.setAttributes=function(z){D(z),C.attributes=z},C.sign=function(z,te){C.md=te||w.md.sha1.create();var Z=I[C.md.algorithm+"WithRSAEncryption"];if(!Z){var se=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw se.algorithm=C.md.algorithm,se}C.signatureOid=C.siginfo.algorithmOid=Z,C.certificationRequestInfo=S.getCertificationRequestInfo(C);var ue=d.toDer(C.certificationRequestInfo);C.md.update(ue.getBytes()),C.signature=z.sign(C.md)},C.verify=function(){var z=!1,te=C.md;if(null===te){te=g({signatureOid:C.signatureOid,type:"certification request"});var Z=C.certificationRequestInfo||S.getCertificationRequestInfo(C),se=d.toDer(Z);te.update(se.getBytes())}return null!==te&&(z=v({certificate:C,md:te,signature:C.signature})),z},C};var L=new Date("1950-01-01T00:00:00Z"),K=new Date("2050-01-01T00:00:00Z");function G(C){return C>=L&&C<K?d.create(d.Class.UNIVERSAL,d.Type.UTCTIME,!1,d.dateToUtcTime(C)):d.create(d.Class.UNIVERSAL,d.Type.GENERALIZEDTIME,!1,d.dateToGeneralizedTime(C))}S.getTBSCertificate=function(C){var z=G(C.validity.notBefore),te=G(C.validity.notAfter),Z=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(C.version).getBytes())]),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,w.util.hexToBytes(C.serialNumber)),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(C.siginfo.algorithmOid).getBytes()),j(C.siginfo.algorithmOid,C.siginfo.parameters)]),R(C.issuer),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[z,te]),R(C.subject),S.publicKeyToAsn1(C.publicKey)]);return C.issuer.uniqueId&&Z.value.push(d.create(d.Class.CONTEXT_SPECIFIC,1,!0,[d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,String.fromCharCode(0)+C.issuer.uniqueId)])),C.subject.uniqueId&&Z.value.push(d.create(d.Class.CONTEXT_SPECIFIC,2,!0,[d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,String.fromCharCode(0)+C.subject.uniqueId)])),C.extensions.length>0&&Z.value.push(S.certificateExtensionsToAsn1(C.extensions)),Z},S.getCertificationRequestInfo=function(C){return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(C.version).getBytes()),R(C.subject),S.publicKeyToAsn1(C.publicKey),Q(C)])},S.distinguishedNameToAsn1=function(C){return R(C)},S.certificateToAsn1=function(C){var z=C.tbsCertificate||S.getTBSCertificate(C);return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[z,d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(C.signatureOid).getBytes()),j(C.signatureOid,C.signatureParameters)]),d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,String.fromCharCode(0)+C.signature)])},S.certificateExtensionsToAsn1=function(C){var z=d.create(d.Class.CONTEXT_SPECIFIC,3,!0,[]),te=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]);z.value.push(te);for(var Z=0;Z<C.length;++Z)te.value.push(S.certificateExtensionToAsn1(C[Z]));return z},S.certificateExtensionToAsn1=function(C){var z=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]);z.value.push(d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(C.id).getBytes())),C.critical&&z.value.push(d.create(d.Class.UNIVERSAL,d.Type.BOOLEAN,!1,String.fromCharCode(255)));var te=C.value;return"string"!=typeof C.value&&(te=d.toDer(te).getBytes()),z.value.push(d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,te)),z},S.certificationRequestToAsn1=function(C){var z=C.certificationRequestInfo||S.getCertificationRequestInfo(C);return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[z,d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(C.signatureOid).getBytes()),j(C.signatureOid,C.signatureParameters)]),d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,String.fromCharCode(0)+C.signature)])},S.createCaStore=function(C){var z={certs:{}};function te(oe){return Z(oe),z.certs[oe.hash]||null}function Z(oe){if(!oe.hash){var me=w.md.sha1.create();oe.attributes=S.RDNAttributesAsArray(R(oe),me),oe.hash=me.digest().toHex()}}if(z.getIssuer=function(oe){return te(oe.issuer)},z.addCertificate=function(oe){if("string"==typeof oe&&(oe=w.pki.certificateFromPem(oe)),Z(oe.subject),!z.hasCertificate(oe))if(oe.subject.hash in z.certs){var me=z.certs[oe.subject.hash];w.util.isArray(me)||(me=[me]),me.push(oe),z.certs[oe.subject.hash]=me}else z.certs[oe.subject.hash]=oe},z.hasCertificate=function(oe){"string"==typeof oe&&(oe=w.pki.certificateFromPem(oe));var me=te(oe.subject);if(!me)return!1;w.util.isArray(me)||(me=[me]);for(var fe=d.toDer(S.certificateToAsn1(oe)).getBytes(),ae=0;ae<me.length;++ae)if(fe===d.toDer(S.certificateToAsn1(me[ae])).getBytes())return!0;return!1},z.listAllCertificates=function(){var oe=[];for(var me in z.certs)if(z.certs.hasOwnProperty(me)){var fe=z.certs[me];if(w.util.isArray(fe))for(var ae=0;ae<fe.length;++ae)oe.push(fe[ae]);else oe.push(fe)}return oe},z.removeCertificate=function(oe){var me;if("string"==typeof oe&&(oe=w.pki.certificateFromPem(oe)),Z(oe.subject),!z.hasCertificate(oe))return null;var fe=te(oe.subject);if(!w.util.isArray(fe))return me=z.certs[oe.subject.hash],delete z.certs[oe.subject.hash],me;for(var ae=d.toDer(S.certificateToAsn1(oe)).getBytes(),pe=0;pe<fe.length;++pe)ae===d.toDer(S.certificateToAsn1(fe[pe])).getBytes()&&(me=fe[pe],fe.splice(pe,1));return 0===fe.length&&delete z.certs[oe.subject.hash],me},C)for(var se=0;se<C.length;++se)z.addCertificate(C[se]);return z},S.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},S.verifyCertificateChain=function(C,z,te){"function"==typeof te&&(te={verify:te}),te=te||{};var Z=(z=z.slice(0)).slice(0),se=te.validityCheckDate;typeof se>"u"&&(se=new Date);var ue=!0,oe=null,me=0;do{var fe=z.shift(),ae=null,pe=!1;if(se&&(se<fe.validity.notBefore||se>fe.validity.notAfter)&&(oe={message:"Certificate is not valid yet or has expired.",error:S.certificateError.certificate_expired,notBefore:fe.validity.notBefore,notAfter:fe.validity.notAfter,now:se}),null===oe){if(null===(ae=z[0]||C.getIssuer(fe))&&fe.isIssuer(fe)&&(pe=!0,ae=fe),ae){var ce=ae;w.util.isArray(ce)||(ce=[ce]);for(var _e=!1;!_e&&ce.length>0;){ae=ce.shift();try{_e=ae.verify(fe)}catch{}}_e||(oe={message:"Certificate signature is invalid.",error:S.certificateError.bad_certificate})}null===oe&&(!ae||pe)&&!C.hasCertificate(fe)&&(oe={message:"Certificate is not trusted.",error:S.certificateError.unknown_ca})}if(null===oe&&ae&&!fe.isIssuer(ae)&&(oe={message:"Certificate issuer is invalid.",error:S.certificateError.bad_certificate}),null===oe)for(var de={keyUsage:!0,basicConstraints:!0},ye=0;null===oe&&ye<fe.extensions.length;++ye){var we=fe.extensions[ye];we.critical&&!(we.name in de)&&(oe={message:"Certificate has an unsupported critical extension.",error:S.certificateError.unsupported_certificate})}if(null===oe&&(!ue||0===z.length&&(!ae||pe))){var xe=fe.getExtension("basicConstraints"),Ae=fe.getExtension("keyUsage");null!==Ae&&(!Ae.keyCertSign||null===xe)&&(oe={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:S.certificateError.bad_certificate}),null===oe&&null!==xe&&!xe.cA&&(oe={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:S.certificateError.bad_certificate}),null===oe&&null!==Ae&&"pathLenConstraint"in xe&&me-1>xe.pathLenConstraint&&(oe={message:"Certificate basicConstraints pathLenConstraint violated.",error:S.certificateError.bad_certificate})}var ve=null===oe||oe.error,Oe=te.verify?te.verify(ve,me,Z):ve;if(!0!==Oe)throw!0===ve&&(oe={message:"The application rejected the certificate.",error:S.certificateError.bad_certificate}),(Oe||0===Oe)&&("object"!=typeof Oe||w.util.isArray(Oe)?"string"==typeof Oe&&(oe.error=Oe):(Oe.message&&(oe.message=Oe.message),Oe.error&&(oe.error=Oe.error))),oe;oe=null,ue=!1,++me}while(z.length>0);return!0}},93037:(re,J,p)=>{const w=p(30766),d=p(16947);re.exports=class{constructor(){this._buffer=new w,this._waitingConsumers=new w}push(I){const{promise:m,resolve:l}=d();return this._buffer.push({chunk:I,resolve:l}),this._consume(),m}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){const I=this._waitingConsumers.shift(),m=this._buffer.shift();I.resolve(m.chunk),m.resolve()}}shift(){const{promise:I,resolve:m}=d();return this._waitingConsumers.push({resolve:m}),this._consume(),I}isEmpty(){return this._buffer.isEmpty()}}},16947:re=>{"use strict";re.exports=()=>{const p={};return p.promise=new Promise((w,d)=>{p.resolve=w,p.reject=d}),p}},7617:(re,J,p)=>{"use strict";re.exports=p(94998).default},94998:function(re,J,p){"use strict";var w=this&&this.__importDefault||function(A){return A&&A.__esModule?A:{default:A}};Object.defineProperty(J,"__esModule",{value:!0});const d=p(63174),S=w(p(82421)),I=w(p(32581)),m=p(8950),h=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"].map(A=>new d.Netmask(A));function _(A){return/^::$/.test(A)||/^::1$/.test(A)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(A)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(A)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(A)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(A)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(A)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(A)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(A)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(A)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(A)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(A)||/^ff([0-9a-fA-F]{2,2}):/i.test(A)}J.default=A=>{if((0,m.isValid)(A)){const O=(0,m.parse)(A);if("ipv4"===O.kind())return function y(A){for(let O of h)if(O.contains(A))return!0;return!1}(O.toNormalizedString());if("ipv6"===O.kind())return _(A)}else if((0,I.default)(A)&&S.default.v6().test(A))return _(A)}},82421:re=>{"use strict";const J="[a-fA-F\\d:]",p=y=>y&&y.includeBoundaries?`(?:(?<=\\s|^)(?=${J})|(?<=${J})(?=\\s|$))`:"",w="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",d="[a-fA-F\\d]{1,4}",S=`\n(?:\n(?:${d}:){7}(?:${d}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${d}:){6}(?:${w}|:${d}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${d}:){5}(?::${w}|(?::${d}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${d}:){4}(?:(?::${d}){0,1}:${w}|(?::${d}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${d}:){3}(?:(?::${d}){0,2}:${w}|(?::${d}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${d}:){2}(?:(?::${d}){0,3}:${w}|(?::${d}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${d}:){1}(?:(?::${d}){0,4}:${w}|(?::${d}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${d}){0,5}:${w}|(?::${d}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),I=new RegExp(`(?:^${w}$)|(?:^${S}$)`),m=new RegExp(`^${w}$`),l=new RegExp(`^${S}$`),h=y=>y&&y.exact?I:new RegExp(`(?:${p(y)}${w}${p(y)})|(?:${p(y)}${S}${p(y)})`,"g");h.v4=y=>y&&y.exact?m:new RegExp(`${p(y)}${w}${p(y)}`,"g"),h.v6=y=>y&&y.exact?l:new RegExp(`${p(y)}${S}${p(y)}`,"g"),re.exports=h},32581:(re,J,p)=>{"use strict";const w=p(82421),d=S=>w({exact:!0}).test(S);d.v4=S=>w.v4({exact:!0}).test(S),d.v6=S=>w.v6({exact:!0}).test(S),d.version=S=>d(S)?d.v4(S)?4:6:void 0,re.exports=d},29693:(re,J,p)=>{"use strict";re.exports=p(25318)},25318:(re,J,p)=>{"use strict";var w=J;function d(){w.util._configure(),w.Writer._configure(w.BufferWriter),w.Reader._configure(w.BufferReader)}w.build="minimal",w.Writer=p(70267),w.BufferWriter=p(59417),w.Reader=p(88157),w.BufferReader=p(13385),w.util=p(7414),w.rpc=p(90161),w.roots=p(17702),w.configure=d,d()},88157:(re,J,p)=>{"use strict";re.exports=l;var d,w=p(7414),S=w.LongBits,I=w.utf8;function m(x,g){return RangeError("index out of range: "+x.pos+" + "+(g||1)+" > "+x.len)}function l(x){this.buf=x,this.pos=0,this.len=x.length}var g,h=typeof Uint8Array<"u"?function(g){if(g instanceof Uint8Array||Array.isArray(g))return new l(g);throw Error("illegal buffer")}:function(g){if(Array.isArray(g))return new l(g);throw Error("illegal buffer")},y=function(){return w.Buffer?function(v){return(l.create=function(N){return w.Buffer.isBuffer(N)?new d(N):h(N)})(v)}:h};function _(){var x=new S(0,0),g=0;if(!(this.len-this.pos>4)){for(;g<3;++g){if(this.pos>=this.len)throw m(this);if(x.lo=(x.lo|(127&this.buf[this.pos])<<7*g)>>>0,this.buf[this.pos++]<128)return x}return x.lo=(x.lo|(127&this.buf[this.pos++])<<7*g)>>>0,x}for(;g<4;++g)if(x.lo=(x.lo|(127&this.buf[this.pos])<<7*g)>>>0,this.buf[this.pos++]<128)return x;if(x.lo=(x.lo|(127&this.buf[this.pos])<<28)>>>0,x.hi=(x.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return x;if(g=0,this.len-this.pos>4){for(;g<5;++g)if(x.hi=(x.hi|(127&this.buf[this.pos])<<7*g+3)>>>0,this.buf[this.pos++]<128)return x}else for(;g<5;++g){if(this.pos>=this.len)throw m(this);if(x.hi=(x.hi|(127&this.buf[this.pos])<<7*g+3)>>>0,this.buf[this.pos++]<128)return x}throw Error("invalid varint encoding")}function A(x,g){return(x[g-4]|x[g-3]<<8|x[g-2]<<16|x[g-1]<<24)>>>0}function O(){if(this.pos+8>this.len)throw m(this,8);return new S(A(this.buf,this.pos+=4),A(this.buf,this.pos+=4))}l.create=y(),l.prototype._slice=w.Array.prototype.subarray||w.Array.prototype.slice,l.prototype.uint32=(g=4294967295,function(){if(g=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(g=(g|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(g=(g|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(g=(g|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(g=(g|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return g;if((this.pos+=5)>this.len)throw this.pos=this.len,m(this,10);return g}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var g=this.uint32();return g>>>1^-(1&g)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw m(this,4);return A(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw m(this,4);return 0|A(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw m(this,4);var g=w.float.readFloatLE(this.buf,this.pos);return this.pos+=4,g},l.prototype.double=function(){if(this.pos+8>this.len)throw m(this,4);var g=w.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,g},l.prototype.bytes=function(){var g=this.uint32(),v=this.pos,R=this.pos+g;if(R>this.len)throw m(this,g);return this.pos+=g,Array.isArray(this.buf)?this.buf.slice(v,R):v===R?new this.buf.constructor(0):this._slice.call(this.buf,v,R)},l.prototype.string=function(){var g=this.bytes();return I.read(g,0,g.length)},l.prototype.skip=function(g){if("number"==typeof g){if(this.pos+g>this.len)throw m(this,g);this.pos+=g}else do{if(this.pos>=this.len)throw m(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(x){switch(x){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(x=7&this.uint32());)this.skipType(x);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+x+" at offset "+this.pos)}return this},l._configure=function(x){d=x,l.create=y(),d._configure();var g=w.Long?"toLong":"toNumber";w.merge(l.prototype,{int64:function(){return _.call(this)[g](!1)},uint64:function(){return _.call(this)[g](!0)},sint64:function(){return _.call(this).zzDecode()[g](!1)},fixed64:function(){return O.call(this)[g](!0)},sfixed64:function(){return O.call(this)[g](!1)}})}},13385:(re,J,p)=>{"use strict";re.exports=S;var w=p(88157);(S.prototype=Object.create(w.prototype)).constructor=S;var d=p(7414);function S(I){w.call(this,I)}S._configure=function(){d.Buffer&&(S.prototype._slice=d.Buffer.prototype.slice)},S.prototype.string=function(){var m=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+m,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+m,this.len))},S._configure()},17702:re=>{"use strict";re.exports={}},90161:(re,J,p)=>{"use strict";J.Service=p(16993)},16993:(re,J,p)=>{"use strict";re.exports=d;var w=p(7414);function d(S,I,m){if("function"!=typeof S)throw TypeError("rpcImpl must be a function");w.EventEmitter.call(this),this.rpcImpl=S,this.requestDelimited=Boolean(I),this.responseDelimited=Boolean(m)}(d.prototype=Object.create(w.EventEmitter.prototype)).constructor=d,d.prototype.rpcCall=function S(I,m,l,h,y){if(!h)throw TypeError("request must be specified");var _=this;if(!y)return w.asPromise(S,_,I,m,l,h);if(_.rpcImpl)try{return _.rpcImpl(I,m[_.requestDelimited?"encodeDelimited":"encode"](h).finish(),function(O,x){if(O)return _.emit("error",O,I),y(O);if(null!==x){if(!(x instanceof l))try{x=l[_.responseDelimited?"decodeDelimited":"decode"](x)}catch(g){return _.emit("error",g,I),y(g)}return _.emit("data",x,I),y(null,x)}_.end(!0)})}catch(A){return _.emit("error",A,I),void setTimeout(function(){y(A)},0)}else setTimeout(function(){y(Error("already ended"))},0)},d.prototype.end=function(I){return this.rpcImpl&&(I||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},89429:(re,J,p)=>{"use strict";re.exports=d;var w=p(7414);function d(l,h){this.lo=l>>>0,this.hi=h>>>0}var S=d.zero=new d(0,0);S.toNumber=function(){return 0},S.zzEncode=S.zzDecode=function(){return this},S.length=function(){return 1};var I=d.zeroHash="\0\0\0\0\0\0\0\0";d.fromNumber=function(h){if(0===h)return S;var y=h<0;y&&(h=-h);var _=h>>>0,A=(h-_)/4294967296>>>0;return y&&(A=~A>>>0,_=~_>>>0,++_>4294967295&&(_=0,++A>4294967295&&(A=0))),new d(_,A)},d.from=function(h){if("number"==typeof h)return d.fromNumber(h);if(w.isString(h)){if(!w.Long)return d.fromNumber(parseInt(h,10));h=w.Long.fromString(h)}return h.low||h.high?new d(h.low>>>0,h.high>>>0):S},d.prototype.toNumber=function(h){if(!h&&this.hi>>>31){var y=1+~this.lo>>>0,_=~this.hi>>>0;return y||(_=_+1>>>0),-(y+4294967296*_)}return this.lo+4294967296*this.hi},d.prototype.toLong=function(h){return w.Long?new w.Long(0|this.lo,0|this.hi,Boolean(h)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(h)}};var m=String.prototype.charCodeAt;d.fromHash=function(h){return h===I?S:new d((m.call(h,0)|m.call(h,1)<<8|m.call(h,2)<<16|m.call(h,3)<<24)>>>0,(m.call(h,4)|m.call(h,5)<<8|m.call(h,6)<<16|m.call(h,7)<<24)>>>0)},d.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},d.prototype.zzEncode=function(){var h=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^h)>>>0,this.lo=(this.lo<<1^h)>>>0,this},d.prototype.zzDecode=function(){var h=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^h)>>>0,this.hi=(this.hi>>>1^h)>>>0,this},d.prototype.length=function(){var h=this.lo,y=(this.lo>>>28|this.hi<<4)>>>0,_=this.hi>>>24;return 0===_?0===y?h<16384?h<128?1:2:h<2097152?3:4:y<16384?y<128?5:6:y<2097152?7:8:_<128?9:10}},7414:function(re,J,p){"use strict";var w=p(40146),d=J;function S(m,l,h){for(var y=Object.keys(l),_=0;_<y.length;++_)(void 0===m[y[_]]||!h)&&(m[y[_]]=l[y[_]]);return m}function I(m){function l(h,y){if(!(this instanceof l))return new l(h,y);Object.defineProperty(this,"message",{get:function(){return h}}),Error.captureStackTrace?Error.captureStackTrace(this,l):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),y&&S(this,y)}return(l.prototype=Object.create(Error.prototype)).constructor=l,Object.defineProperty(l.prototype,"name",{get:function(){return m}}),l.prototype.toString=function(){return this.name+": "+this.message},l}d.asPromise=p(18791),d.base64=p(5985),d.EventEmitter=p(68074),d.float=p(48170),d.inquire=p(91248),d.utf8=p(88178),d.pool=p(15759),d.LongBits=p(89429),d.isNode=Boolean(typeof w<"u"&&w&&w.process&&w.process.versions&&w.process.versions.node),d.global=d.isNode&&w||typeof window<"u"&&window||typeof self<"u"&&self||this,d.emptyArray=Object.freeze?Object.freeze([]):[],d.emptyObject=Object.freeze?Object.freeze({}):{},d.isInteger=Number.isInteger||function(l){return"number"==typeof l&&isFinite(l)&&Math.floor(l)===l},d.isString=function(l){return"string"==typeof l||l instanceof String},d.isObject=function(l){return l&&"object"==typeof l},d.isset=d.isSet=function(l,h){var y=l[h];return!(null==y||!l.hasOwnProperty(h))&&("object"!=typeof y||(Array.isArray(y)?y.length:Object.keys(y).length)>0)},d.Buffer=function(){try{var m=d.inquire("buffer").Buffer;return m.prototype.utf8Write?m:null}catch{return null}}(),d._Buffer_from=null,d._Buffer_allocUnsafe=null,d.newBuffer=function(l){return"number"==typeof l?d.Buffer?d._Buffer_allocUnsafe(l):new d.Array(l):d.Buffer?d._Buffer_from(l):typeof Uint8Array>"u"?l:new Uint8Array(l)},d.Array=typeof Uint8Array<"u"?Uint8Array:Array,d.Long=d.global.dcodeIO&&d.global.dcodeIO.Long||d.global.Long||d.inquire("long"),d.key2Re=/^true|false|0|1$/,d.key32Re=/^-?(?:0|[1-9][0-9]*)$/,d.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,d.longToHash=function(l){return l?d.LongBits.from(l).toHash():d.LongBits.zeroHash},d.longFromHash=function(l,h){var y=d.LongBits.fromHash(l);return d.Long?d.Long.fromBits(y.lo,y.hi,h):y.toNumber(Boolean(h))},d.merge=S,d.lcFirst=function(l){return l.charAt(0).toLowerCase()+l.substring(1)},d.newError=I,d.ProtocolError=I("ProtocolError"),d.oneOfGetter=function(l){for(var h={},y=0;y<l.length;++y)h[l[y]]=1;return function(){for(var _=Object.keys(this),A=_.length-1;A>-1;--A)if(1===h[_[A]]&&null!=this[_[A]])return _[A]}},d.oneOfSetter=function(l){return function(h){for(var y=0;y<l.length;++y)l[y]!==h&&delete this[l[y]]}},d.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},d._configure=function(){var m=d.Buffer;m?(d._Buffer_from=m.from!==Uint8Array.from&&m.from||function(h,y){return new m(h,y)},d._Buffer_allocUnsafe=m.allocUnsafe||function(h){return new m(h)}):d._Buffer_from=d._Buffer_allocUnsafe=null}},70267:(re,J,p)=>{"use strict";re.exports=_;var d,w=p(7414),S=w.LongBits,I=w.base64,m=w.utf8;function l(D,k,j){this.fn=D,this.len=k,this.next=void 0,this.val=j}function h(){}function y(D){this.head=D.head,this.tail=D.tail,this.len=D.len,this.next=D.states}function _(){this.len=0,this.head=new l(h,0,0),this.tail=this.head,this.states=null}var A=function(){return w.Buffer?function(){return(_.create=function(){return new d})()}:function(){return new _}};function O(D,k,j){k[j]=255&D}function g(D,k){this.len=D,this.next=void 0,this.val=k}function v(D,k,j){for(;D.hi;)k[j++]=127&D.lo|128,D.lo=(D.lo>>>7|D.hi<<25)>>>0,D.hi>>>=7;for(;D.lo>127;)k[j++]=127&D.lo|128,D.lo=D.lo>>>7;k[j++]=D.lo}function R(D,k,j){k[j]=255&D,k[j+1]=D>>>8&255,k[j+2]=D>>>16&255,k[j+3]=D>>>24}_.create=A(),_.alloc=function(k){return new w.Array(k)},w.Array!==Array&&(_.alloc=w.pool(_.alloc,w.Array.prototype.subarray)),_.prototype._push=function(k,j,Q){return this.tail=this.tail.next=new l(k,j,Q),this.len+=j,this},(g.prototype=Object.create(l.prototype)).fn=function x(D,k,j){for(;D>127;)k[j++]=127&D|128,D>>>=7;k[j]=D},_.prototype.uint32=function(k){return this.len+=(this.tail=this.tail.next=new g((k>>>=0)<128?1:k<16384?2:k<2097152?3:k<268435456?4:5,k)).len,this},_.prototype.int32=function(k){return k<0?this._push(v,10,S.fromNumber(k)):this.uint32(k)},_.prototype.sint32=function(k){return this.uint32((k<<1^k>>31)>>>0)},_.prototype.int64=_.prototype.uint64=function(k){var j=S.from(k);return this._push(v,j.length(),j)},_.prototype.sint64=function(k){var j=S.from(k).zzEncode();return this._push(v,j.length(),j)},_.prototype.bool=function(k){return this._push(O,1,k?1:0)},_.prototype.sfixed32=_.prototype.fixed32=function(k){return this._push(R,4,k>>>0)},_.prototype.sfixed64=_.prototype.fixed64=function(k){var j=S.from(k);return this._push(R,4,j.lo)._push(R,4,j.hi)},_.prototype.float=function(k){return this._push(w.float.writeFloatLE,4,k)},_.prototype.double=function(k){return this._push(w.float.writeDoubleLE,8,k)};var N=w.Array.prototype.set?function(k,j,Q){j.set(k,Q)}:function(k,j,Q){for(var L=0;L<k.length;++L)j[Q+L]=k[L]};_.prototype.bytes=function(k){var j=k.length>>>0;if(!j)return this._push(O,1,0);if(w.isString(k)){var Q=_.alloc(j=I.length(k));I.decode(k,Q,0),k=Q}return this.uint32(j)._push(N,j,k)},_.prototype.string=function(k){var j=m.length(k);return j?this.uint32(j)._push(m.write,j,k):this._push(O,1,0)},_.prototype.fork=function(){return this.states=new y(this),this.head=this.tail=new l(h,0,0),this.len=0,this},_.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(h,0,0),this.len=0),this},_.prototype.ldelim=function(){var k=this.head,j=this.tail,Q=this.len;return this.reset().uint32(Q),Q&&(this.tail.next=k.next,this.tail=j,this.len+=Q),this},_.prototype.finish=function(){for(var k=this.head.next,j=this.constructor.alloc(this.len),Q=0;k;)k.fn(k.val,j,Q),Q+=k.len,k=k.next;return j},_._configure=function(D){d=D,_.create=A(),d._configure()}},59417:(re,J,p)=>{"use strict";re.exports=S;var w=p(70267);(S.prototype=Object.create(w.prototype)).constructor=S;var d=p(7414);function S(){w.call(this)}function I(m,l,h){m.length<40?d.utf8.write(m,l,h):l.utf8Write?l.utf8Write(m,h):l.write(m,h)}S._configure=function(){S.alloc=d._Buffer_allocUnsafe,S.writeBytesBuffer=d.Buffer&&d.Buffer.prototype instanceof Uint8Array&&"set"===d.Buffer.prototype.set.name?function(l,h,y){h.set(l,y)}:function(l,h,y){if(l.copy)l.copy(h,y,0,l.length);else for(var _=0;_<l.length;)h[y++]=l[_++]}},S.prototype.bytes=function(l){d.isString(l)&&(l=d._Buffer_from(l,"base64"));var h=l.length>>>0;return this.uint32(h),h&&this._push(S.writeBytesBuffer,h,l),this},S.prototype.string=function(l){var h=d.Buffer.byteLength(l);return this.uint32(h),h&&this._push(I,h,l),this},S._configure()},58158:(re,J,p)=>{"use strict";re.exports=l;var d,w=p(90683),S=w.LongBits,I=w.utf8;function m(x,g){return RangeError("index out of range: "+x.pos+" + "+(g||1)+" > "+x.len)}function l(x){this.buf=x,this.pos=0,this.len=x.length}var g,h=typeof Uint8Array<"u"?function(g){if(g instanceof Uint8Array||Array.isArray(g))return new l(g);throw Error("illegal buffer")}:function(g){if(Array.isArray(g))return new l(g);throw Error("illegal buffer")},y=function(){return w.Buffer?function(v){return(l.create=function(N){return w.Buffer.isBuffer(N)?new d(N):h(N)})(v)}:h};function _(){var x=new S(0,0),g=0;if(!(this.len-this.pos>4)){for(;g<3;++g){if(this.pos>=this.len)throw m(this);if(x.lo=(x.lo|(127&this.buf[this.pos])<<7*g)>>>0,this.buf[this.pos++]<128)return x}return x.lo=(x.lo|(127&this.buf[this.pos++])<<7*g)>>>0,x}for(;g<4;++g)if(x.lo=(x.lo|(127&this.buf[this.pos])<<7*g)>>>0,this.buf[this.pos++]<128)return x;if(x.lo=(x.lo|(127&this.buf[this.pos])<<28)>>>0,x.hi=(x.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return x;if(g=0,this.len-this.pos>4){for(;g<5;++g)if(x.hi=(x.hi|(127&this.buf[this.pos])<<7*g+3)>>>0,this.buf[this.pos++]<128)return x}else for(;g<5;++g){if(this.pos>=this.len)throw m(this);if(x.hi=(x.hi|(127&this.buf[this.pos])<<7*g+3)>>>0,this.buf[this.pos++]<128)return x}throw Error("invalid varint encoding")}function A(x,g){return(x[g-4]|x[g-3]<<8|x[g-2]<<16|x[g-1]<<24)>>>0}function O(){if(this.pos+8>this.len)throw m(this,8);return new S(A(this.buf,this.pos+=4),A(this.buf,this.pos+=4))}l.create=y(),l.prototype._slice=w.Array.prototype.subarray||w.Array.prototype.slice,l.prototype.uint32=(g=4294967295,function(){if(g=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(g=(g|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(g=(g|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(g=(g|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(g=(g|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return g;if((this.pos+=5)>this.len)throw this.pos=this.len,m(this,10);return g}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var g=this.uint32();return g>>>1^-(1&g)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw m(this,4);return A(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw m(this,4);return 0|A(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw m(this,4);var g=w.float.readFloatLE(this.buf,this.pos);return this.pos+=4,g},l.prototype.double=function(){if(this.pos+8>this.len)throw m(this,4);var g=w.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,g},l.prototype.bytes=function(){var g=this.uint32(),v=this.pos,R=this.pos+g;if(R>this.len)throw m(this,g);return this.pos+=g,Array.isArray(this.buf)?this.buf.slice(v,R):v===R?new this.buf.constructor(0):this._slice.call(this.buf,v,R)},l.prototype.string=function(){var g=this.bytes();return I.read(g,0,g.length)},l.prototype.skip=function(g){if("number"==typeof g){if(this.pos+g>this.len)throw m(this,g);this.pos+=g}else do{if(this.pos>=this.len)throw m(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(x){switch(x){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(x=7&this.uint32());)this.skipType(x);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+x+" at offset "+this.pos)}return this},l._configure=function(x){d=x,l.create=y(),d._configure();var g=w.Long?"toLong":"toNumber";w.merge(l.prototype,{int64:function(){return _.call(this)[g](!1)},uint64:function(){return _.call(this)[g](!0)},sint64:function(){return _.call(this).zzDecode()[g](!1)},fixed64:function(){return O.call(this)[g](!0)},sfixed64:function(){return O.call(this)[g](!1)}})}},60469:(re,J,p)=>{"use strict";re.exports=S;var w=p(58158);(S.prototype=Object.create(w.prototype)).constructor=S;var d=p(90683);function S(I){w.call(this,I)}S._configure=function(){d.Buffer&&(S.prototype._slice=d.Buffer.prototype.slice)},S.prototype.string=function(){var m=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+m,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+m,this.len))},S._configure()},3911:(re,J,p)=>{"use strict";re.exports=d;var w=p(90683);function d(l,h){this.lo=l>>>0,this.hi=h>>>0}var S=d.zero=new d(0,0);S.toNumber=function(){return 0},S.zzEncode=S.zzDecode=function(){return this},S.length=function(){return 1};var I=d.zeroHash="\0\0\0\0\0\0\0\0";d.fromNumber=function(h){if(0===h)return S;var y=h<0;y&&(h=-h);var _=h>>>0,A=(h-_)/4294967296>>>0;return y&&(A=~A>>>0,_=~_>>>0,++_>4294967295&&(_=0,++A>4294967295&&(A=0))),new d(_,A)},d.from=function(h){if("number"==typeof h)return d.fromNumber(h);if(w.isString(h)){if(!w.Long)return d.fromNumber(parseInt(h,10));h=w.Long.fromString(h)}return h.low||h.high?new d(h.low>>>0,h.high>>>0):S},d.prototype.toNumber=function(h){if(!h&&this.hi>>>31){var y=1+~this.lo>>>0,_=~this.hi>>>0;return y||(_=_+1>>>0),-(y+4294967296*_)}return this.lo+4294967296*this.hi},d.prototype.toLong=function(h){return w.Long?new w.Long(0|this.lo,0|this.hi,Boolean(h)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(h)}};var m=String.prototype.charCodeAt;d.fromHash=function(h){return h===I?S:new d((m.call(h,0)|m.call(h,1)<<8|m.call(h,2)<<16|m.call(h,3)<<24)>>>0,(m.call(h,4)|m.call(h,5)<<8|m.call(h,6)<<16|m.call(h,7)<<24)>>>0)},d.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},d.prototype.zzEncode=function(){var h=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^h)>>>0,this.lo=(this.lo<<1^h)>>>0,this},d.prototype.zzDecode=function(){var h=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^h)>>>0,this.hi=(this.hi>>>1^h)>>>0,this},d.prototype.length=function(){var h=this.lo,y=(this.lo>>>28|this.hi<<4)>>>0,_=this.hi>>>24;return 0===_?0===y?h<16384?h<128?1:2:h<2097152?3:4:y<16384?y<128?5:6:y<2097152?7:8:_<128?9:10}},90683:function(re,J,p){"use strict";var w=p(40146),d=J;function S(m,l,h){for(var y=Object.keys(l),_=0;_<y.length;++_)(void 0===m[y[_]]||!h)&&(m[y[_]]=l[y[_]]);return m}function I(m){function l(h,y){if(!(this instanceof l))return new l(h,y);Object.defineProperty(this,"message",{get:function(){return h}}),Error.captureStackTrace?Error.captureStackTrace(this,l):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),y&&S(this,y)}return l.prototype=Object.create(Error.prototype,{constructor:{value:l,writable:!0,enumerable:!1,configurable:!0},name:{get:()=>m,set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),l}d.asPromise=p(18791),d.base64=p(5985),d.EventEmitter=p(68074),d.float=p(48170),d.inquire=p(91248),d.utf8=p(88178),d.pool=p(15759),d.LongBits=p(3911),d.isNode=Boolean(typeof w<"u"&&w&&w.process&&w.process.versions&&w.process.versions.node),d.global=d.isNode&&w||typeof window<"u"&&window||typeof self<"u"&&self||this,d.emptyArray=Object.freeze?Object.freeze([]):[],d.emptyObject=Object.freeze?Object.freeze({}):{},d.isInteger=Number.isInteger||function(l){return"number"==typeof l&&isFinite(l)&&Math.floor(l)===l},d.isString=function(l){return"string"==typeof l||l instanceof String},d.isObject=function(l){return l&&"object"==typeof l},d.isset=d.isSet=function(l,h){var y=l[h];return!(null==y||!l.hasOwnProperty(h))&&("object"!=typeof y||(Array.isArray(y)?y.length:Object.keys(y).length)>0)},d.Buffer=function(){try{var m=d.inquire("buffer").Buffer;return m.prototype.utf8Write?m:null}catch{return null}}(),d._Buffer_from=null,d._Buffer_allocUnsafe=null,d.newBuffer=function(l){return"number"==typeof l?d.Buffer?d._Buffer_allocUnsafe(l):new d.Array(l):d.Buffer?d._Buffer_from(l):typeof Uint8Array>"u"?l:new Uint8Array(l)},d.Array=typeof Uint8Array<"u"?Uint8Array:Array,d.Long=d.global.dcodeIO&&d.global.dcodeIO.Long||d.global.Long||d.inquire("long"),d.key2Re=/^true|false|0|1$/,d.key32Re=/^-?(?:0|[1-9][0-9]*)$/,d.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,d.longToHash=function(l){return l?d.LongBits.from(l).toHash():d.LongBits.zeroHash},d.longFromHash=function(l,h){var y=d.LongBits.fromHash(l);return d.Long?d.Long.fromBits(y.lo,y.hi,h):y.toNumber(Boolean(h))},d.merge=S,d.lcFirst=function(l){return l.charAt(0).toLowerCase()+l.substring(1)},d.newError=I,d.ProtocolError=I("ProtocolError"),d.oneOfGetter=function(l){for(var h={},y=0;y<l.length;++y)h[l[y]]=1;return function(){for(var _=Object.keys(this),A=_.length-1;A>-1;--A)if(1===h[_[A]]&&null!=this[_[A]])return _[A]}},d.oneOfSetter=function(l){return function(h){for(var y=0;y<l.length;++y)l[y]!==h&&delete this[l[y]]}},d.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},d._configure=function(){var m=d.Buffer;m?(d._Buffer_from=m.from!==Uint8Array.from&&m.from||function(h,y){return new m(h,y)},d._Buffer_allocUnsafe=m.allocUnsafe||function(h){return new m(h)}):d._Buffer_from=d._Buffer_allocUnsafe=null}},98526:(re,J,p)=>{"use strict";re.exports=_;var d,w=p(90683),S=w.LongBits,I=w.base64,m=w.utf8;function l(D,k,j){this.fn=D,this.len=k,this.next=void 0,this.val=j}function h(){}function y(D){this.head=D.head,this.tail=D.tail,this.len=D.len,this.next=D.states}function _(){this.len=0,this.head=new l(h,0,0),this.tail=this.head,this.states=null}var A=function(){return w.Buffer?function(){return(_.create=function(){return new d})()}:function(){return new _}};function O(D,k,j){k[j]=255&D}function g(D,k){this.len=D,this.next=void 0,this.val=k}function v(D,k,j){for(;D.hi;)k[j++]=127&D.lo|128,D.lo=(D.lo>>>7|D.hi<<25)>>>0,D.hi>>>=7;for(;D.lo>127;)k[j++]=127&D.lo|128,D.lo=D.lo>>>7;k[j++]=D.lo}function R(D,k,j){k[j]=255&D,k[j+1]=D>>>8&255,k[j+2]=D>>>16&255,k[j+3]=D>>>24}_.create=A(),_.alloc=function(k){return new w.Array(k)},w.Array!==Array&&(_.alloc=w.pool(_.alloc,w.Array.prototype.subarray)),_.prototype._push=function(k,j,Q){return this.tail=this.tail.next=new l(k,j,Q),this.len+=j,this},(g.prototype=Object.create(l.prototype)).fn=function x(D,k,j){for(;D>127;)k[j++]=127&D|128,D>>>=7;k[j]=D},_.prototype.uint32=function(k){return this.len+=(this.tail=this.tail.next=new g((k>>>=0)<128?1:k<16384?2:k<2097152?3:k<268435456?4:5,k)).len,this},_.prototype.int32=function(k){return k<0?this._push(v,10,S.fromNumber(k)):this.uint32(k)},_.prototype.sint32=function(k){return this.uint32((k<<1^k>>31)>>>0)},_.prototype.int64=_.prototype.uint64=function(k){var j=S.from(k);return this._push(v,j.length(),j)},_.prototype.sint64=function(k){var j=S.from(k).zzEncode();return this._push(v,j.length(),j)},_.prototype.bool=function(k){return this._push(O,1,k?1:0)},_.prototype.sfixed32=_.prototype.fixed32=function(k){return this._push(R,4,k>>>0)},_.prototype.sfixed64=_.prototype.fixed64=function(k){var j=S.from(k);return this._push(R,4,j.lo)._push(R,4,j.hi)},_.prototype.float=function(k){return this._push(w.float.writeFloatLE,4,k)},_.prototype.double=function(k){return this._push(w.float.writeDoubleLE,8,k)};var N=w.Array.prototype.set?function(k,j,Q){j.set(k,Q)}:function(k,j,Q){for(var L=0;L<k.length;++L)j[Q+L]=k[L]};_.prototype.bytes=function(k){var j=k.length>>>0;if(!j)return this._push(O,1,0);if(w.isString(k)){var Q=_.alloc(j=I.length(k));I.decode(k,Q,0),k=Q}return this.uint32(j)._push(N,j,k)},_.prototype.string=function(k){var j=m.length(k);return j?this.uint32(j)._push(m.write,j,k):this._push(O,1,0)},_.prototype.fork=function(){return this.states=new y(this),this.head=this.tail=new l(h,0,0),this.len=0,this},_.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(h,0,0),this.len=0),this},_.prototype.ldelim=function(){var k=this.head,j=this.tail,Q=this.len;return this.reset().uint32(Q),Q&&(this.tail.next=k.next,this.tail=j,this.len+=Q),this},_.prototype.finish=function(){for(var k=this.head.next,j=this.constructor.alloc(this.len),Q=0;k;)k.fn(k.val,j,Q),Q+=k.len,k=k.next;return j},_._configure=function(D){d=D,_.create=A(),d._configure()}},8071:(re,J,p)=>{"use strict";re.exports=S;var w=p(98526);(S.prototype=Object.create(w.prototype)).constructor=S;var d=p(90683);function S(){w.call(this)}function I(m,l,h){m.length<40?d.utf8.write(m,l,h):l.utf8Write?l.utf8Write(m,h):l.write(m,h)}S._configure=function(){S.alloc=d._Buffer_allocUnsafe,S.writeBytesBuffer=d.Buffer&&d.Buffer.prototype instanceof Uint8Array&&"set"===d.Buffer.prototype.set.name?function(l,h,y){h.set(l,y)}:function(l,h,y){if(l.copy)l.copy(h,y,0,l.length);else for(var _=0;_<l.length;)h[y++]=l[_++]}},S.prototype.bytes=function(l){d.isString(l)&&(l=d._Buffer_from(l,"base64"));var h=l.length>>>0;return this.uint32(h),h&&this._push(S.writeBytesBuffer,h,l),this},S.prototype.string=function(l){var h=d.Buffer.byteLength(l);return this.uint32(h),h&&this._push(I,h,l),this},S._configure()},12097:(re,J,p)=>{var w=p(40146);let d;re.exports="function"==typeof queueMicrotask?queueMicrotask.bind(typeof window<"u"?window:w):S=>(d||(d=Promise.resolve())).then(S).catch(I=>setTimeout(()=>{throw I},0))},28633:(re,J,p)=>{const{instantiate:w}=p(66917);function d(S={}){if(!d.supported)return null;var I=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return w(new Response(new Blob([I],{type:"application/wasm"})),S)}d.supported=typeof WebAssembly<"u",re.exports=d},66917:(re,J,p)=>{"use strict";var w=p(28069),d=p(21778).default;const oe=typeof BigUint64Array<"u",me=Symbol();function ae(ve,Oe){const Ve=new Uint32Array(ve),Ue=new Uint16Array(ve);var je=Ve[Oe+-4>>>2]>>>1,Ke=Oe>>>1;if(je<=1024)return String.fromCharCode.apply(String,Ue.subarray(Ke,Ke+je));const nt=[];do{const dt=Ue[Ke+1024-1],pt=dt>=55296&&dt<56320?1023:1024;nt.push(String.fromCharCode.apply(String,Ue.subarray(Ke,Ke+=pt))),je-=pt}while(je>1024);return nt.join("")+String.fromCharCode.apply(String,Ue.subarray(Ke,Ke+je))}function pe(ve){const Oe={};function Ve(je,Ke){return je?ae(je.buffer,Ke):"<yet unknown>"}const Ue=ve.env=ve.env||{};return Ue.abort=Ue.abort||function(Ke,nt,dt,pt){const Xt=Oe.memory||Ue.memory;throw Error("abort: "+Ve(Xt,Ke)+" at "+Ve(Xt,nt)+":"+dt+":"+pt)},Ue.trace=Ue.trace||function(Ke,nt){const dt=Oe.memory||Ue.memory;w.log("trace: "+Ve(dt,Ke)+(nt?" ":"")+Array.prototype.slice.call(arguments,2,2+nt).join(", "))},ve.Math=ve.Math||Math,ve.Date=ve.Date||Date,Oe}function ce(ve,Oe){const Ve=Oe.exports,Ue=Ve.memory,je=Ve.table,Ke=Ve.__alloc,nt=Ve.__retain,dt=Ve.__rtti_base||-1;function pt(Ye){const tt=new Uint32Array(Ue.buffer);if((Ye>>>=0)>=tt[dt>>>2])throw Error("invalid id: "+Ye);return tt[(dt+4>>>2)+2*Ye]}function Xt(Ye){const tt=new Uint32Array(Ue.buffer);if((Ye>>>=0)>=tt[dt>>>2])throw Error("invalid id: "+Ye);return tt[(dt+4>>>2)+2*Ye+1]}function Ft(Ye){return 31-Math.clz32(Ye>>>5&31)}function Zt(Ye,tt,st){const ot=Ue.buffer;if(st)switch(Ye){case 2:return new Float32Array(ot);case 3:return new Float64Array(ot)}else switch(Ye){case 0:return new(tt?Int8Array:Uint8Array)(ot);case 1:return new(tt?Int16Array:Uint16Array)(ot);case 2:return new(tt?Int32Array:Uint32Array)(ot);case 3:return new(tt?BigInt64Array:BigUint64Array)(ot)}throw Error("unsupported align: "+Ye)}function lr(Ye){const tt=new Uint32Array(Ue.buffer),st=tt[Ye+-8>>>2],ot=pt(st);if(!(1&ot))throw Error("not an array: "+st);const ht=Ft(ot);var St=tt[Ye+4>>>2];const zt=2&ot?tt[Ye+12>>>2]:tt[St+-4>>>2]>>>ht;return Zt(ht,1024&ot,2048&ot).subarray(St>>>=ht,St+zt)}function Dt(Ye,tt,st){return new Ye(Tt(Ye,tt,st))}function Tt(Ye,tt,st){const ot=Ue.buffer,ht=new Uint32Array(ot),St=ht[st+4>>>2];return new Ye(ot,St,ht[St+-4>>>2]>>>tt)}return ve.__allocString=function Kt(Ye){const tt=Ye.length,st=Ke(tt<<1,1),ot=new Uint16Array(Ue.buffer);for(var ht=0,St=st>>>1;ht<tt;++ht)ot[St+ht]=Ye.charCodeAt(ht);return st},ve.__getString=function xr(Ye){const tt=Ue.buffer;if(1!==new Uint32Array(tt)[Ye+-8>>>2])throw Error("not a string: "+Ye);return ae(tt,Ye)},ve.__allocArray=function qt(Ye,tt){const st=pt(Ye);if(!(3&st))throw Error("not an array: "+Ye+" @ "+st);const ot=Ft(st),ht=tt.length,St=Ke(ht<<ot,0),zt=Ke(2&st?16:12,Ye),er=new Uint32Array(Ue.buffer);er[zt+0>>>2]=nt(St),er[zt+4>>>2]=St,er[zt+8>>>2]=ht<<ot,2&st&&(er[zt+12>>>2]=ht);const bo=Zt(ot,1024&st,2048&st);if(8192&st)for(let ji=0;ji<ht;++ji)bo[(St>>>ot)+ji]=nt(tt[ji]);else bo.set(tt,St>>>ot);return zt},ve.__getArrayView=lr,ve.__getArray=function hr(Ye){const tt=lr(Ye),st=tt.length,ot=new Array(st);for(let ht=0;ht<st;ht++)ot[ht]=tt[ht];return ot},ve.__getArrayBuffer=function pr(Ye){const tt=Ue.buffer,st=new Uint32Array(tt)[Ye+-4>>>2];return tt.slice(Ye,Ye+st)},ve.__getInt8Array=Dt.bind(null,Int8Array,0),ve.__getInt8ArrayView=Tt.bind(null,Int8Array,0),ve.__getUint8Array=Dt.bind(null,Uint8Array,0),ve.__getUint8ArrayView=Tt.bind(null,Uint8Array,0),ve.__getUint8ClampedArray=Dt.bind(null,Uint8ClampedArray,0),ve.__getUint8ClampedArrayView=Tt.bind(null,Uint8ClampedArray,0),ve.__getInt16Array=Dt.bind(null,Int16Array,1),ve.__getInt16ArrayView=Tt.bind(null,Int16Array,1),ve.__getUint16Array=Dt.bind(null,Uint16Array,1),ve.__getUint16ArrayView=Tt.bind(null,Uint16Array,1),ve.__getInt32Array=Dt.bind(null,Int32Array,2),ve.__getInt32ArrayView=Tt.bind(null,Int32Array,2),ve.__getUint32Array=Dt.bind(null,Uint32Array,2),ve.__getUint32ArrayView=Tt.bind(null,Uint32Array,2),oe&&(ve.__getInt64Array=Dt.bind(null,BigInt64Array,3),ve.__getInt64ArrayView=Tt.bind(null,BigInt64Array,3),ve.__getUint64Array=Dt.bind(null,BigUint64Array,3),ve.__getUint64ArrayView=Tt.bind(null,BigUint64Array,3)),ve.__getFloat32Array=Dt.bind(null,Float32Array,2),ve.__getFloat32ArrayView=Tt.bind(null,Float32Array,2),ve.__getFloat64Array=Dt.bind(null,Float64Array,3),ve.__getFloat64ArrayView=Tt.bind(null,Float64Array,3),ve.__instanceof=function yr(Ye,tt){const st=new Uint32Array(Ue.buffer);var ot=st[Ye+-8>>>2];if(ot<=st[dt>>>2])do{if(ot==tt)return!0}while(ot=Xt(ot));return!1},ve.memory=ve.memory||Ue,ve.table=ve.table||je,Re(Ve,ve)}function _e(ve){return typeof Response<"u"&&ve instanceof Response}function de(ve,Oe){return ye.apply(this,arguments)}function ye(){return(ye=d(function*(ve,Oe){return _e(ve=yield ve)?xe(ve,Oe):ce(pe(Oe||(Oe={})),yield WebAssembly.instantiate(ve instanceof WebAssembly.Module?ve:yield WebAssembly.compile(ve),Oe))})).apply(this,arguments)}function xe(ve,Oe){return Ae.apply(this,arguments)}function Ae(){return(Ae=d(function*(ve,Oe){return WebAssembly.instantiateStreaming?ce(pe(Oe||(Oe={})),(yield WebAssembly.instantiateStreaming(ve,Oe)).instance):de(_e(ve=yield ve)?ve.arrayBuffer():ve,Oe)})).apply(this,arguments)}function Re(ve,Oe){var Ve=Oe?Object.create(Oe):{},Ue=ve.__argumentsLength?function(je){ve.__argumentsLength.value=je}:ve.__setArgumentsLength||ve.__setargc||function(){};for(let je in ve){if(!Object.prototype.hasOwnProperty.call(ve,je))continue;const Ke=ve[je];let nt=je.split("."),dt=Ve;for(;nt.length>1;){let Ft=nt.shift();Object.prototype.hasOwnProperty.call(dt,Ft)||(dt[Ft]={}),dt=dt[Ft]}let pt=nt[0],Xt=pt.indexOf("#");if(Xt>=0){let Ft=pt.substring(0,Xt),Ht=dt[Ft];if(typeof Ht>"u"||!Ht.prototype){let Kt=function(...xr){return Kt.wrap(Kt.prototype.constructor(0,...xr))};Kt.prototype={valueOf:function(){return this[me]}},Kt.wrap=function(xr){return Object.create(Kt.prototype,{[me]:{value:xr,writable:!1}})},Ht&&Object.getOwnPropertyNames(Ht).forEach(xr=>Object.defineProperty(Kt,xr,Object.getOwnPropertyDescriptor(Ht,xr))),dt[Ft]=Kt}if(pt=pt.substring(Xt+1),dt=dt[Ft].prototype,/^(get|set):/.test(pt)){if(!Object.prototype.hasOwnProperty.call(dt,pt=pt.substring(4))){let Kt=ve[je.replace("set:","get:")],xr=ve[je.replace("get:","set:")];Object.defineProperty(dt,pt,{get:function(){return Kt(this[me])},set:function(Zt){xr(this[me],Zt)},enumerable:!0})}}else"constructor"===pt?(dt[pt]=(...Kt)=>(Ue(Kt.length),Ke(...Kt))).original=Ke:(dt[pt]=function(...Kt){return Ue(Kt.length),Ke(this[me],...Kt)}).original=Ke}else/^(get|set):/.test(pt)?Object.prototype.hasOwnProperty.call(dt,pt=pt.substring(4))||Object.defineProperty(dt,pt,{get:ve[je.replace("set:","get:")],set:ve[je.replace("get:","set:")],enumerable:!0}):"function"==typeof Ke&&Ke!==Ue?(dt[pt]=(...Ft)=>(Ue(Ft.length),Ke(...Ft))).original=Ke:dt[pt]=Ke}return Ve}J.instantiate=de,J.instantiateSync=function we(ve,Oe){return ce(pe(Oe||(Oe={})),new WebAssembly.Instance(ve instanceof WebAssembly.Module?ve:new WebAssembly.Module(ve),Oe))},J.instantiateStreaming=xe,J.demangle=Re},4148:(re,J,p)=>{var w=p(21778).default;const d=p(24175),S=p(28633),I=function(){var m=w(function*(l,h,y,_,A){const O=yield S();return new d(O,l,h,y,_,A)});return function(h,y,_,A,O){return m.apply(this,arguments)}}();re.exports={Rabin:d,create:I}},24175:re=>{re.exports=class J{constructor(w,d=12,S=8192,I=32768,m=64,l){this.bits=d,this.min=S,this.max=I,this.asModule=w,this.rabin=new w.Rabin(d,S,I,m,l),this.polynomial=l}fingerprint(w){const{__retain:d,__release:S,__allocArray:I,__getInt32Array:m,Int32Array_ID:l,Uint8Array_ID:h}=this.asModule,_=d(I(l,new Int32Array(Math.ceil(w.length/this.min)))),A=d(I(h,w)),x=m(this.rabin.fingerprint(A,_));S(A),S(_);const g=x.indexOf(0);return g>=0?x.subarray(0,g):x}}},51186:(re,J,p)=>{"use strict";var w=p(40146),d=p(53217),S=65536,l=p(69708).Buffer,h=w.crypto||w.msCrypto;re.exports=h&&h.getRandomValues?function y(_,A){if(_>4294967295)throw new RangeError("requested too many random bytes");var O=l.allocUnsafe(_);if(_>0)if(_>S)for(var x=0;x<_;x+=S)h.getRandomValues(O.slice(x,x+S));else h.getRandomValues(O);return"function"==typeof A?d.nextTick(function(){A(null,O)}):O}:function m(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}},2518:(re,J,p)=>{const w=p(53644),d=p(59938),S=p(10211),I=p(96648),{RateLimiterClusterMaster:m,RateLimiterClusterMasterPM2:l,RateLimiterCluster:h}=p(57640),y=p(78354),_=p(33434),A=p(8590),O=p(16111),x=p(21983),g=p(98511),v=p(50932);re.exports={RateLimiterRedis:w,RateLimiterMongo:d,RateLimiterMySQL:S,RateLimiterPostgres:I,RateLimiterMemory:y,RateLimiterMemcache:_,RateLimiterClusterMaster:m,RateLimiterClusterMasterPM2:l,RateLimiterCluster:h,RLWrapperBlackAndWhite:A,RateLimiterUnion:O,RateLimiterQueue:x,BurstyRateLimiter:g,RateLimiterRes:v}},98511:(re,J,p)=>{const w=p(50932);re.exports=class{constructor(S,I){this._rateLimiter=S,this._burstLimiter=I}_combineRes(S,I){return new w(S.remainingPoints,Math.min(S.msBeforeNext,I.msBeforeNext),S.consumedPoints,S.isFirstInDuration)}consume(S,I=1,m={}){return this._rateLimiter.consume(S,I,m).catch(l=>l instanceof w?this._burstLimiter.consume(S,I,m).then(h=>Promise.resolve(this._combineRes(l,h))).catch(h=>Promise.reject(h instanceof w?this._combineRes(l,h):h)):Promise.reject(l))}get(S){return Promise.all([this._rateLimiter.get(S),this._burstLimiter.get(S)]).then(([I,m])=>this._combineRes(I,m))}get points(){return this._rateLimiter.points}}},8590:(re,J,p)=>{const w=p(50932);re.exports=class{constructor(S={}){this.limiter=S.limiter,this.blackList=S.blackList,this.whiteList=S.whiteList,this.isBlackListed=S.isBlackListed,this.isWhiteListed=S.isWhiteListed,this.runActionAnyway=S.runActionAnyway}get limiter(){return this._limiter}set limiter(S){if(typeof S>"u")throw new Error("limiter is not set");this._limiter=S}get runActionAnyway(){return this._runActionAnyway}set runActionAnyway(S){this._runActionAnyway=!(typeof S>"u")&&S}get blackList(){return this._blackList}set blackList(S){this._blackList=Array.isArray(S)?S:[]}get isBlackListed(){return this._isBlackListed}set isBlackListed(S){if(typeof S>"u"&&(S=()=>!1),"function"!=typeof S)throw new Error("isBlackListed must be function");this._isBlackListed=S}get whiteList(){return this._whiteList}set whiteList(S){this._whiteList=Array.isArray(S)?S:[]}get isWhiteListed(){return this._isWhiteListed}set isWhiteListed(S){if(typeof S>"u"&&(S=()=>!1),"function"!=typeof S)throw new Error("isWhiteListed must be function");this._isWhiteListed=S}isBlackListedSomewhere(S){return this.blackList.indexOf(S)>=0||this.isBlackListed(S)}isWhiteListedSomewhere(S){return this.whiteList.indexOf(S)>=0||this.isWhiteListed(S)}getBlackRes(){return new w(0,Number.MAX_SAFE_INTEGER,0,!1)}getWhiteRes(){return new w(Number.MAX_SAFE_INTEGER,0,0,!1)}rejectBlack(){return Promise.reject(this.getBlackRes())}resolveBlack(){return Promise.resolve(this.getBlackRes())}resolveWhite(){return Promise.resolve(this.getWhiteRes())}consume(S,I=1){let m;return this.isWhiteListedSomewhere(S)?m=this.resolveWhite():this.isBlackListedSomewhere(S)&&(m=this.rejectBlack()),typeof m>"u"?this.limiter.consume(S,I):(this.runActionAnyway&&this.limiter.consume(S,I).catch(()=>{}),m)}block(S,I){let m;return this.isWhiteListedSomewhere(S)?m=this.resolveWhite():this.isBlackListedSomewhere(S)&&(m=this.resolveBlack()),typeof m>"u"?this.limiter.block(S,I):(this.runActionAnyway&&this.limiter.block(S,I).catch(()=>{}),m)}penalty(S,I){let m;return this.isWhiteListedSomewhere(S)?m=this.resolveWhite():this.isBlackListedSomewhere(S)&&(m=this.resolveBlack()),typeof m>"u"?this.limiter.penalty(S,I):(this.runActionAnyway&&this.limiter.penalty(S,I).catch(()=>{}),m)}reward(S,I){let m;return this.isWhiteListedSomewhere(S)?m=this.resolveWhite():this.isBlackListedSomewhere(S)&&(m=this.resolveBlack()),typeof m>"u"?this.limiter.reward(S,I):(this.runActionAnyway&&this.limiter.reward(S,I).catch(()=>{}),m)}get(S){let I;return this.isWhiteListedSomewhere(S)?I=this.resolveWhite():this.isBlackListedSomewhere(S)&&(I=this.resolveBlack()),typeof I>"u"||this.runActionAnyway?this.limiter.get(S):I}delete(S){return this.limiter.delete(S)}}},55781:re=>{re.exports=class{constructor(p={}){this.points=p.points,this.duration=p.duration,this.blockDuration=p.blockDuration,this.execEvenly=p.execEvenly,this.execEvenlyMinDelayMs=p.execEvenlyMinDelayMs,this.keyPrefix=p.keyPrefix}get points(){return this._points}set points(p){this._points=p>=0?p:4}get duration(){return this._duration}set duration(p){this._duration=typeof p>"u"?1:p}get msDuration(){return 1e3*this.duration}get blockDuration(){return this._blockDuration}set blockDuration(p){this._blockDuration=typeof p>"u"?0:p}get msBlockDuration(){return 1e3*this.blockDuration}get execEvenly(){return this._execEvenly}set execEvenly(p){this._execEvenly=!(typeof p>"u")&&Boolean(p)}get execEvenlyMinDelayMs(){return this._execEvenlyMinDelayMs}set execEvenlyMinDelayMs(p){this._execEvenlyMinDelayMs=typeof p>"u"?Math.ceil(this.msDuration/this.points):p}get keyPrefix(){return this._keyPrefix}set keyPrefix(p){if(typeof p>"u"&&(p="rlflx"),"string"!=typeof p)throw new Error("keyPrefix must be string");this._keyPrefix=p}_getKeySecDuration(p={}){return p&&p.customDuration>=0?p.customDuration:this.duration}getKey(p){return this.keyPrefix.length>0?`${this.keyPrefix}:${p}`:p}parseKey(p){return p.substring(this.keyPrefix.length)}consume(){throw new Error("You have to implement the method 'consume'!")}penalty(){throw new Error("You have to implement the method 'penalty'!")}reward(){throw new Error("You have to implement the method 'reward'!")}get(){throw new Error("You have to implement the method 'get'!")}set(){throw new Error("You have to implement the method 'set'!")}block(){throw new Error("You have to implement the method 'block'!")}delete(){throw new Error("You have to implement the method 'delete'!")}}},57640:(re,J,p)=>{var w=p(53217),d=p(28069);const S=p(81265),I=p(35539),m=p(55781),l=p(78354),h=p(50932),y="rate_limiter_flexible";let _=null;const A=function(Q,L,K,G){let C;C=null===G||!0===G||!1===G?G:{remainingPoints:G.remainingPoints,msBeforeNext:G.msBeforeNext,consumedPoints:G.consumedPoints,isFirstInDuration:G.isFirstInDuration},Q.send({channel:y,keyPrefix:L.keyPrefix,promiseId:L.promiseId,type:K,data:C})},O=function(Q){setTimeout(()=>{this._initiated?w.send(Q):typeof this._promises[Q.promiseId]<"u"&&O.call(this,Q)},30)},x=function(Q,L,K,G,C){const z={channel:y,keyPrefix:this.keyPrefix,func:Q,promiseId:L,data:{key:K,arg:G,opts:C}};this._initiated?w.send(z):O.call(this,z)},g=function(Q,L){if(!L||L.channel!==y||typeof this._rateLimiters[L.keyPrefix]>"u")return!1;let K;switch(L.func){case"consume":K=this._rateLimiters[L.keyPrefix].consume(L.data.key,L.data.arg,L.data.opts);break;case"penalty":K=this._rateLimiters[L.keyPrefix].penalty(L.data.key,L.data.arg,L.data.opts);break;case"reward":K=this._rateLimiters[L.keyPrefix].reward(L.data.key,L.data.arg,L.data.opts);break;case"block":K=this._rateLimiters[L.keyPrefix].block(L.data.key,L.data.arg,L.data.opts);break;case"get":K=this._rateLimiters[L.keyPrefix].get(L.data.key,L.data.opts);break;case"delete":K=this._rateLimiters[L.keyPrefix].delete(L.data.key,L.data.opts);break;default:return!1}K&&K.then(G=>{A(Q,L,"resolve",G)}).catch(G=>{A(Q,L,"reject",G)})},v=function(Q){if(!Q||Q.channel!==y||Q.keyPrefix!==this.keyPrefix)return!1;if(this._promises[Q.promiseId]){let L;switch(clearTimeout(this._promises[Q.promiseId].timeoutId),L=null===Q.data||!0===Q.data||!1===Q.data?Q.data:new h(Q.data.remainingPoints,Q.data.msBeforeNext,Q.data.consumedPoints,Q.data.isFirstInDuration),Q.type){case"resolve":this._promises[Q.promiseId].resolve(L);break;case"reject":this._promises[Q.promiseId].reject(L);break;default:throw new Error(`RateLimiterCluster: no such message type '${Q.type}'`)}delete this._promises[Q.promiseId]}},R=function(){return{points:this.points,duration:this.duration,blockDuration:this.blockDuration,execEvenly:this.execEvenly,execEvenlyMinDelayMs:this.execEvenlyMinDelayMs,keyPrefix:this.keyPrefix}},N=function(Q,L){const K=w.hrtime();let G=K[0].toString()+K[1].toString();return typeof this._promises[G]<"u"&&(G+=I.randomBytes(12).toString("base64")),this._promises[G]={resolve:Q,reject:L,timeoutId:setTimeout(()=>{delete this._promises[G],L(new Error("RateLimiterCluster timeout: no answer from master in time"))},this.timeoutMs)},G};re.exports={RateLimiterClusterMaster:class D{constructor(){if(_)return _;this._rateLimiters={},S.setMaxListeners(0),S.on("message",(L,K)=>{K&&K.channel===y&&"init"===K.type?(typeof this._rateLimiters[K.opts.keyPrefix]>"u"&&(this._rateLimiters[K.opts.keyPrefix]=new l(K.opts)),L.send({channel:y,type:"init",keyPrefix:K.opts.keyPrefix})):g.call(this,L,K)}),_=this}},RateLimiterClusterMasterPM2:class k{constructor(L){if(_)return _;this._rateLimiters={},L.launchBus((K,G)=>{G.on("process:msg",C=>{const z=C.raw;z&&z.channel===y&&"init"===z.type?(typeof this._rateLimiters[z.opts.keyPrefix]>"u"&&(this._rateLimiters[z.opts.keyPrefix]=new l(z.opts)),L.sendDataToProcessId(C.process.pm_id,{data:{},topic:y,channel:y,type:"init",keyPrefix:z.opts.keyPrefix},(te,Z)=>{te&&d.log(te,Z)})):g.call(this,{send:Z=>{const se=Z;se.topic=y,typeof se.data>"u"&&(se.data={}),L.sendDataToProcessId(C.process.pm_id,se,(ue,oe)=>{ue&&d.log(ue,oe)})}},z)})}),_=this}},RateLimiterCluster:class j extends m{get timeoutMs(){return this._timeoutMs}set timeoutMs(L){this._timeoutMs=typeof L>"u"?5e3:Math.abs(parseInt(L))}constructor(L={}){super(L),w.setMaxListeners(0),this.timeoutMs=L.timeoutMs,this._initiated=!1,w.on("message",K=>{K&&K.channel===y&&"init"===K.type&&K.keyPrefix===this.keyPrefix?this._initiated=!0:v.call(this,K)}),w.send({channel:y,type:"init",opts:R.call(this)}),this._promises={}}consume(L,K=1,G={}){return new Promise((C,z)=>{const te=N.call(this,C,z);x.call(this,"consume",te,L,K,G)})}penalty(L,K=1,G={}){return new Promise((C,z)=>{const te=N.call(this,C,z);x.call(this,"penalty",te,L,K,G)})}reward(L,K=1,G={}){return new Promise((C,z)=>{const te=N.call(this,C,z);x.call(this,"reward",te,L,K,G)})}block(L,K,G={}){return new Promise((C,z)=>{const te=N.call(this,C,z);x.call(this,"block",te,L,K,G)})}get(L,K={}){return new Promise((G,C)=>{const z=N.call(this,G,C);x.call(this,"get",z,L,K)})}delete(L,K={}){return new Promise((G,C)=>{const z=N.call(this,G,C);x.call(this,"delete",z,L,K)})}}}},33434:(re,J,p)=>{const w=p(9306),d=p(50932);re.exports=class S extends w{constructor(m){super(m),this.client=m.storeClient}_getRateLimiterRes(m,l,h){const y=new d;return y.consumedPoints=parseInt(h.consumedPoints),y.isFirstInDuration=h.consumedPoints===l,y.remainingPoints=Math.max(this.points-y.consumedPoints,0),y.msBeforeNext=h.msBeforeNext,y}_upsert(m,l,h,y=!1,_={}){return new Promise((A,O)=>{const x=Date.now(),g=Math.floor(h/1e3);y?this.client.set(m,l,g,v=>{v?O(v):this.client.set(`${m}_expire`,g>0?x+1e3*g:-1,g,()=>{A({consumedPoints:l,msBeforeNext:g>0?1e3*g:-1})})}):this.client.incr(m,l,(v,R)=>{v||!1===R?this.client.add(m,l,g,(N,D)=>{if(N||!D)if(typeof _.attemptNumber>"u"||_.attemptNumber<3){const k=Object.assign({},_);k.attemptNumber=k.attemptNumber?k.attemptNumber+1:1,this._upsert(m,l,h,y,k).then(j=>A(j)).catch(j=>O(j))}else O(new Error("Can not add key"));else this.client.add(`${m}_expire`,g>0?x+1e3*g:-1,g,()=>{A({consumedPoints:l,msBeforeNext:g>0?1e3*g:-1})})}):this.client.get(`${m}_expire`,(N,D)=>{if(N)O(N);else{const k=!1===D?0:D,j={consumedPoints:R,msBeforeNext:k>=0?Math.max(k-x,0):-1};A(j)}})})})}_get(m){return new Promise((l,h)=>{const y=Date.now();this.client.get(m,(_,A)=>{A?this.client.get(`${m}_expire`,(O,x)=>{if(O)h(O);else{const g=!1===x?0:x,v={consumedPoints:A,msBeforeNext:g>=0?Math.max(g-y,0):-1};l(v)}}):l(null)})})}_delete(m){return new Promise((l,h)=>{this.client.del(m,(y,_)=>{y?h(y):!1===_?l(_):this.client.del(`${m}_expire`,A=>{A?h(A):l(_)})})})}}},78354:(re,J,p)=>{const w=p(55781),d=p(5290),S=p(50932);re.exports=class I extends w{constructor(l={}){super(l),this._memoryStorage=new d}consume(l,h=1,y={}){return new Promise((_,A)=>{const O=this.getKey(l),x=this._getKeySecDuration(y);let g=this._memoryStorage.incrby(O,h,x);if(g.remainingPoints=Math.max(this.points-g.consumedPoints,0),g.consumedPoints>this.points)this.blockDuration>0&&g.consumedPoints<=this.points+h&&(g=this._memoryStorage.set(O,g.consumedPoints,this.blockDuration)),A(g);else if(this.execEvenly&&g.msBeforeNext>0&&!g.isFirstInDuration){let v=Math.ceil(g.msBeforeNext/(g.remainingPoints+2));v<this.execEvenlyMinDelayMs&&(v=g.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(_,v,g)}else _(g)})}penalty(l,h=1,y={}){const _=this.getKey(l);return new Promise(A=>{const O=this._getKeySecDuration(y),x=this._memoryStorage.incrby(_,h,O);x.remainingPoints=Math.max(this.points-x.consumedPoints,0),A(x)})}reward(l,h=1,y={}){const _=this.getKey(l);return new Promise(A=>{const O=this._getKeySecDuration(y),x=this._memoryStorage.incrby(_,-h,O);x.remainingPoints=Math.max(this.points-x.consumedPoints,0),A(x)})}block(l,h){const y=1e3*h,_=this.points+1;return this._memoryStorage.set(this.getKey(l),_,h),Promise.resolve(new S(0,0===y?-1:y,_))}set(l,h,y){const _=1e3*(y>=0?y:this.duration);return this._memoryStorage.set(this.getKey(l),h,y),Promise.resolve(new S(0,0===_?-1:_,h))}get(l){const h=this._memoryStorage.get(this.getKey(l));return null!==h&&(h.remainingPoints=Math.max(this.points-h.consumedPoints,0)),Promise.resolve(h)}delete(l){return Promise.resolve(this._memoryStorage.delete(this.getKey(l)))}}},59938:(re,J,p)=>{const w=p(9306),d=p(50932);function S(m){try{const l=m.client?m.client:m,{version:h}=l.topology.s.options.metadata.driver,y=h.split(".").map(_=>parseInt(_));return{major:y[0],feature:y[1],patch:y[2]}}catch{return{major:0,feature:0,patch:0}}}class I extends w{constructor(l){super(l),this.dbName=l.dbName,this.tableName=l.tableName,this.indexKeyPrefix=l.indexKeyPrefix,this.client=l.mongo?l.mongo:l.storeClient,"function"==typeof this.client.then?this.client.then(h=>{this.client=h,this._initCollection(),this._driverVersion=S(this.client)}):(this._initCollection(),this._driverVersion=S(this.client))}get dbName(){return this._dbName}set dbName(l){this._dbName=typeof l>"u"?I.getDbName():l}static getDbName(){return"node-rate-limiter-flexible"}get tableName(){return this._tableName}set tableName(l){this._tableName=typeof l>"u"?this.keyPrefix:l}get client(){return this._client}set client(l){if(typeof l>"u")throw new Error("mongo is not set");this._client=l}get indexKeyPrefix(){return this._indexKeyPrefix}set indexKeyPrefix(l){this._indexKeyPrefix=l||{}}_initCollection(){const h=("function"==typeof this.client.db?this.client.db(this.dbName):this.client).collection(this.tableName);h.createIndex({expire:-1},{expireAfterSeconds:0}),h.createIndex(Object.assign({},this.indexKeyPrefix,{key:1}),{unique:!0}),this._collection=h}_getRateLimiterRes(l,h,y){const _=new d;let A;return A=typeof y.value>"u"?y:y.value,_.isFirstInDuration=A.points===h,_.consumedPoints=A.points,_.remainingPoints=Math.max(this.points-_.consumedPoints,0),_.msBeforeNext=null!==A.expire?Math.max(new Date(A.expire).getTime()-Date.now(),0):-1,_}_upsert(l,h,y,_=!1,A={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const O=A.attrs||{};let x,g;_?(x={key:l},x=Object.assign(x,O),g={$set:{key:l,points:h,expire:y>0?new Date(Date.now()+y):null}},g.$set=Object.assign(g.$set,O)):(x={$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}],key:l},x=Object.assign(x,O),g={$setOnInsert:{key:l,expire:y>0?new Date(Date.now()+y):null},$inc:{points:h}},g.$setOnInsert=Object.assign(g.$setOnInsert,O));const v={upsert:!0};return this._driverVersion.major>=4||3===this._driverVersion.major&&this._driverVersion.feature>=7||this._driverVersion.feature>=6&&this._driverVersion.patch>=7?v.returnDocument="after":v.returnOriginal=!1,new Promise((R,N)=>{this._collection.findOneAndUpdate(x,g,v).then(D=>{R(D)}).catch(D=>{if(D&&11e3===D.code){const k=Object.assign({$or:[{expire:{$lte:new Date}},{expire:{$eq:null}}],key:l},O),j={$set:Object.assign({key:l,points:h,expire:y>0?new Date(Date.now()+y):null},O)};this._collection.findOneAndUpdate(k,j,v).then(Q=>{R(Q)}).catch(Q=>{Q&&11e3===Q.code?this._upsert(l,h,y,_).then(L=>R(L)).catch(L=>N(L)):N(Q)})}else N(D)})})}_get(l,h={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const y=h.attrs||{},_=Object.assign({key:l,$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}]},y);return this._collection.findOne(_)}_delete(l,h={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const _=Object.assign({key:l},h.attrs||{});return this._collection.deleteOne(_).then(A=>A.deletedCount>0)}}re.exports=I},10211:(re,J,p)=>{const w=p(9306),d=p(50932);re.exports=class S extends w{constructor(m,l=null){super(m),this.client=m.storeClient,this.clientType=m.storeType,this.dbName=m.dbName,this.tableName=m.tableName,this.clearExpiredByTimeout=m.clearExpiredByTimeout,this.tableCreated=m.tableCreated,this.tableCreated?(this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof l&&l()):this._createDbAndTable().then(()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof l&&l()}).catch(h=>{if("function"!=typeof l)throw h;l(h)})}clearExpired(m){return new Promise(l=>{this._getConnection().then(h=>{h.query("DELETE FROM ??.?? WHERE expire < ?",[this.dbName,this.tableName,m],()=>{this._releaseConnection(h),l()})}).catch(()=>{l()})})}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout(()=>{this.clearExpired(Date.now()-36e5).then(()=>{this._clearExpiredHourAgo()})},3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return new Promise((m,l)=>{this.client.getConnection((h,y)=>{if(h)return l(h);m(y)})});case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();default:return Promise.resolve(this.client)}}_releaseConnection(m){switch(this.clientType){case"pool":return m.release();case"sequelize":return this.client.connectionManager.releaseConnection(m);case"knex":return this.client.client.releaseConnection(m);default:return!0}}_createDbAndTable(){return new Promise((m,l)=>{this._getConnection().then(h=>{h.query(`CREATE DATABASE IF NOT EXISTS \`${this.dbName}\`;`,y=>{if(y)return this._releaseConnection(h),l(y);h.query(this._getCreateTableStmt(),_=>{if(_)return this._releaseConnection(h),l(_);this._releaseConnection(h),m()})})}).catch(h=>{l(h)})})}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS \`${this.dbName}\`.\`${this.tableName}\` (\`key\` VARCHAR(255) CHARACTER SET utf8 NOT NULL,\`points\` INT(9) NOT NULL default 0,\`expire\` BIGINT UNSIGNED,PRIMARY KEY (\`key\`)) ENGINE = INNODB;`}get clientType(){return this._clientType}set clientType(m){if(typeof m>"u")if("Connection"===this.client.constructor.name)m="connection";else if("Pool"===this.client.constructor.name)m="pool";else{if("Sequelize"!==this.client.constructor.name)throw new Error("storeType is not defined");m="sequelize"}this._clientType=m.toLowerCase()}get dbName(){return this._dbName}set dbName(m){this._dbName=typeof m>"u"?"rtlmtrflx":m}get tableName(){return this._tableName}set tableName(m){this._tableName=typeof m>"u"?this.keyPrefix:m}get tableCreated(){return this._tableCreated}set tableCreated(m){this._tableCreated=!(typeof m>"u"||!m)}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(m){this._clearExpiredByTimeout=typeof m>"u"||Boolean(m)}_getRateLimiterRes(m,l,h){const y=new d,[_]=h;return y.isFirstInDuration=l===_.points,y.consumedPoints=y.isFirstInDuration?l:_.points,y.remainingPoints=Math.max(this.points-y.consumedPoints,0),y.msBeforeNext=_.expire?Math.max(_.expire-Date.now(),0):-1,y}_upsertTransaction(m,l,h,y,_){return new Promise((A,O)=>{m.query("BEGIN",x=>{if(x)return m.rollback(),O(x);const g=Date.now(),v=y>0?g+y:null;let R,N;_?(R="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = ?, \n            expire = ?;",N=[this.dbName,this.tableName,l,h,v,h,v]):(R="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = IF(expire <= ?, ?, points + (?)), \n            expire = IF(expire <= ?, ?, expire);",N=[this.dbName,this.tableName,l,h,v,g,h,h,g,v]),m.query(R,N,D=>{if(D)return m.rollback(),O(D);m.query("SELECT points, expire FROM ??.?? WHERE `key` = ?;",[this.dbName,this.tableName,l],(k,j)=>{if(k)return m.rollback(),O(k);m.query("COMMIT",Q=>{if(Q)return m.rollback(),O(Q);A(j)})})})})})}_upsert(m,l,h,y=!1){return this.tableCreated?new Promise((_,A)=>{this._getConnection().then(O=>{this._upsertTransaction(O,m,l,h,y).then(x=>{_(x),this._releaseConnection(O)}).catch(x=>{A(x),this._releaseConnection(O)})}).catch(O=>{A(O)})}):Promise.reject(Error("Table is not created yet"))}_get(m){return this.tableCreated?new Promise((l,h)=>{this._getConnection().then(y=>{y.query("SELECT points, expire FROM ??.?? WHERE `key` = ? AND (`expire` > ? OR `expire` IS NULL)",[this.dbName,this.tableName,m,Date.now()],(_,A)=>{_?h(_):l(0===A.length?null:A),this._releaseConnection(y)})}).catch(y=>{h(y)})}):Promise.reject(Error("Table is not created yet"))}_delete(m){return this.tableCreated?new Promise((l,h)=>{this._getConnection().then(y=>{y.query("DELETE FROM ??.?? WHERE `key` = ?",[this.dbName,this.tableName,m],(_,A)=>{_?h(_):l(A.affectedRows>0),this._releaseConnection(y)})}).catch(y=>{h(y)})}):Promise.reject(Error("Table is not created yet"))}}},96648:(re,J,p)=>{const w=p(9306),d=p(50932);re.exports=class S extends w{constructor(m,l=null){super(m),this.client=m.storeClient,this.clientType=m.storeType,this.tableName=m.tableName,this.clearExpiredByTimeout=m.clearExpiredByTimeout,this.tableCreated=m.tableCreated,this.tableCreated?"function"==typeof l&&l():this._createTable().then(()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof l&&l()}).catch(h=>{if("function"!=typeof l)throw h;l(h)})}clearExpired(m){return new Promise(l=>{this._query({name:"rlflx-clear-expired",text:`DELETE FROM ${this.tableName} WHERE expire < $1`,values:[m]}).then(()=>{l()}).catch(()=>{l()})})}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout(()=>{this.clearExpired(Date.now()-36e5).then(()=>{this._clearExpiredHourAgo()})},3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":default:return Promise.resolve(this.client);case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();case"typeorm":return Promise.resolve(this.client.driver.master)}}_releaseConnection(m){switch(this.clientType){case"pool":case"typeorm":default:return!0;case"sequelize":return this.client.connectionManager.releaseConnection(m);case"knex":return this.client.client.releaseConnection(m)}}_createTable(){return new Promise((m,l)=>{this._query({text:this._getCreateTableStmt()}).then(()=>{m()}).catch(h=>{"23505"===h.code?m():l(h)})})}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS ${this.tableName} ( \n      key varchar(255) PRIMARY KEY,\n      points integer NOT NULL DEFAULT 0,\n      expire bigint\n    );`}get clientType(){return this._clientType}set clientType(m){const l=this.client.constructor.name;if(typeof m>"u")if("Client"===l)m="client";else if("Pool"===l||"BoundPool"===l)m="pool";else{if("Sequelize"!==l)throw new Error("storeType is not defined");m="sequelize"}this._clientType=m.toLowerCase()}get tableName(){return this._tableName}set tableName(m){this._tableName=typeof m>"u"?this.keyPrefix:m}get tableCreated(){return this._tableCreated}set tableCreated(m){this._tableCreated=!(typeof m>"u"||!m)}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(m){this._clearExpiredByTimeout=typeof m>"u"||Boolean(m)}_getRateLimiterRes(m,l,h){const y=new d,_=h.rows[0];return y.isFirstInDuration=l===_.points,y.consumedPoints=y.isFirstInDuration?l:_.points,y.remainingPoints=Math.max(this.points-y.consumedPoints,0),y.msBeforeNext=_.expire?Math.max(_.expire-Date.now(),0):-1,y}_query(m){const h={name:`${this.tableName.toLowerCase()}:${m.name}`,text:m.text,values:m.values};return new Promise((y,_)=>{this._getConnection().then(A=>{A.query(h).then(O=>{y(O),this._releaseConnection(A)}).catch(O=>{_(O),this._releaseConnection(A)})}).catch(A=>{_(A)})})}_upsert(m,l,h,y=!1){if(!this.tableCreated)return Promise.reject(Error("Table is not created yet"));const _=h>0?Date.now()+h:null;return this._query({name:y?"rlflx-upsert-force":"rlflx-upsert",text:`\n            INSERT INTO ${this.tableName} VALUES ($1, $2, $3)\n              ON CONFLICT(key) DO UPDATE SET\n                points = CASE\n                          WHEN (${this.tableName}.expire <= $4 OR 1=${y?1:0}) THEN $2\n                          ELSE ${this.tableName}.points + ($2)\n                         END,\n                expire = ${y?" $3 ":` CASE\n             WHEN ${this.tableName}.expire <= $4 THEN $3\n             ELSE ${this.tableName}.expire\n            END `}\n            RETURNING points, expire;`,values:[m,l,_,Date.now()]})}_get(m){return this.tableCreated?new Promise((l,h)=>{this._query({name:"rlflx-get",text:`\n            SELECT points, expire FROM ${this.tableName} WHERE key = $1 AND (expire > $2 OR expire IS NULL);`,values:[m,Date.now()]}).then(y=>{0===y.rowCount&&(y=null),l(y)}).catch(y=>{h(y)})}):Promise.reject(Error("Table is not created yet"))}_delete(m){return this.tableCreated?this._query({name:"rlflx-delete",text:`DELETE FROM ${this.tableName} WHERE key = $1`,values:[m]}).then(l=>l.rowCount>0):Promise.reject(Error("Table is not created yet"))}}},21983:(re,J,p)=>{const w=p(22396),d=4294967295,S="limiter";re.exports=class{constructor(l,h={maxQueueSize:d}){this._queueLimiters={KEY_DEFAULT:new I(l,h)},this._limiterFlexible=l,this._maxQueueSize=h.maxQueueSize}getTokensRemaining(l=S){return this._queueLimiters[l]?this._queueLimiters[l].getTokensRemaining():Promise.resolve(this._limiterFlexible.points)}removeTokens(l,h=S){return this._queueLimiters[h]||(this._queueLimiters[h]=new I(this._limiterFlexible,{key:h,maxQueueSize:this._maxQueueSize})),this._queueLimiters[h].removeTokens(l)}};class I{constructor(l,h={maxQueueSize:d,key:S}){this._key=h.key,this._waitTimeout=null,this._queue=[],this._limiterFlexible=l,this._maxQueueSize=h.maxQueueSize}getTokensRemaining(){return this._limiterFlexible.get(this._key).then(l=>null!==l?l.remainingPoints:this._limiterFlexible.points)}removeTokens(l){const h=this;return new Promise((y,_)=>{l>h._limiterFlexible.points?_(new w(`Requested tokens ${l} exceeds maximum ${h._limiterFlexible.points} tokens per interval`)):h._queue.length>0?h._queueRequest.call(h,y,_,l):h._limiterFlexible.consume(h._key,l).then(A=>{y(A.remainingPoints)}).catch(A=>{A instanceof Error?_(A):(h._queueRequest.call(h,y,_,l),null===h._waitTimeout&&(h._waitTimeout=setTimeout(h._processFIFO.bind(h),A.msBeforeNext)))})})}_queueRequest(l,h,y){const _=this;_._queue.length<_._maxQueueSize?_._queue.push({resolve:l,reject:h,tokens:y}):h(new w(`Number of requests reached it's maximum ${_._maxQueueSize}`))}_processFIFO(){const l=this;if(null!==l._waitTimeout&&(clearTimeout(l._waitTimeout),l._waitTimeout=null),0===l._queue.length)return;const h=l._queue.shift();l._limiterFlexible.consume(l._key,h.tokens).then(y=>{h.resolve(y.remainingPoints),l._processFIFO.call(l)}).catch(y=>{y instanceof Error?(h.reject(y),l._processFIFO.call(l)):(l._queue.unshift(h),null===l._waitTimeout&&(l._waitTimeout=setTimeout(l._processFIFO.bind(l),y.msBeforeNext)))})}}},53644:(re,J,p)=>{const w=p(9306),d=p(50932),S="redis.call('set', KEYS[1], 0, 'EX', ARGV[2], 'NX') local consumed = redis.call('incrby', KEYS[1], ARGV[1]) local ttl = redis.call('pttl', KEYS[1]) if ttl == -1 then   redis.call('expire', KEYS[1], ARGV[2])   ttl = 1000 * ARGV[2] end return {consumed, ttl} ";re.exports=class I extends w{constructor(l){super(l),this.client=l.redis?l.redis:l.storeClient,this._rejectIfRedisNotReady=!!l.rejectIfRedisNotReady,"function"==typeof this.client.defineCommand&&this.client.defineCommand("rlflxIncr",{numberOfKeys:1,lua:S})}_isRedisReady(){return!this._rejectIfRedisNotReady||!(this.client.status&&"ready"!==this.client.status||"function"==typeof this.client.isReady&&!this.client.isReady())}_getRateLimiterRes(l,h,y){let[_,A]=y;Array.isArray(_)&&([,_]=_,[,A]=A);const O=new d;return O.consumedPoints=parseInt(_),O.isFirstInDuration=O.consumedPoints===h,O.remainingPoints=Math.max(this.points-O.consumedPoints,0),O.msBeforeNext=A,O}_upsert(l,h,y,_=!1){return new Promise((A,O)=>{if(!this._isRedisReady())return O(new Error("Redis connection is not ready"));const x=Math.floor(y/1e3),g=this.client.multi();if(_)x>0?g.set(l,h,"EX",x):g.set(l,h),g.pttl(l).exec((v,R)=>v?O(v):A(R));else if(x>0){const v=function(R,N){return R?O(R):A(N)};"function"==typeof this.client.rlflxIncr?this.client.rlflxIncr(l,h,x,v):this.client.eval(S,1,l,h,x,v)}else g.incrby(l,h).pttl(l).exec((v,R)=>v?O(v):A(R))})}_get(l){return new Promise((h,y)=>{if(!this._isRedisReady())return y(new Error("Redis connection is not ready"));this.client.multi().get(l).pttl(l).exec((_,A)=>{if(_)y(_);else{const[O]=A;if(null===O)return h(null);h(A)}})})}_delete(l){return new Promise((h,y)=>{this.client.del(l,(_,A)=>{_?y(_):h(A>0)})})}}},50932:re=>{re.exports=class{constructor(p,w,d,S){this.remainingPoints=typeof p>"u"?0:p,this.msBeforeNext=typeof w>"u"?0:w,this.consumedPoints=typeof d>"u"?0:d,this.isFirstInDuration=!(typeof S>"u")&&S}get msBeforeNext(){return this._msBeforeNext}set msBeforeNext(p){return this._msBeforeNext=p,this}get remainingPoints(){return this._remainingPoints}set remainingPoints(p){return this._remainingPoints=p,this}get consumedPoints(){return this._consumedPoints}set consumedPoints(p){return this._consumedPoints=p,this}get isFirstInDuration(){return this._isFirstInDuration}set isFirstInDuration(p){this._isFirstInDuration=Boolean(p)}_getDecoratedProperties(){return{remainingPoints:this.remainingPoints,msBeforeNext:this.msBeforeNext,consumedPoints:this.consumedPoints,isFirstInDuration:this.isFirstInDuration}}[Symbol.for("nodejs.util.inspect.custom")](){return this._getDecoratedProperties()}toString(){return JSON.stringify(this._getDecoratedProperties())}toJSON(){return this._getDecoratedProperties()}}},9306:(re,J,p)=>{const w=p(55781),d=p(80498),S=p(50932);re.exports=class extends w{constructor(m={}){super(m),this.inMemoryBlockOnConsumed=m.inMemoryBlockOnConsumed||m.inmemoryBlockOnConsumed,this.inMemoryBlockDuration=m.inMemoryBlockDuration||m.inmemoryBlockDuration,this.insuranceLimiter=m.insuranceLimiter,this._inMemoryBlockedKeys=new d}get client(){return this._client}set client(m){if(typeof m>"u")throw new Error("storeClient is not set");this._client=m}_afterConsume(m,l,h,y,_,A={}){const O=this._getRateLimiterRes(h,y,_);if(this.inMemoryBlockOnConsumed>0&&!(this.inMemoryBlockDuration>0)&&O.consumedPoints>=this.inMemoryBlockOnConsumed)return this._inMemoryBlockedKeys.addMs(h,O.msBeforeNext),O.consumedPoints>this.points?l(O):m(O);if(O.consumedPoints>this.points){let x=Promise.resolve();this.blockDuration>0&&O.consumedPoints<=this.points+y&&(O.msBeforeNext=this.msBlockDuration,x=this._block(h,O.consumedPoints,this.msBlockDuration,A)),this.inMemoryBlockOnConsumed>0&&O.consumedPoints>=this.inMemoryBlockOnConsumed&&(this._inMemoryBlockedKeys.add(h,this.inMemoryBlockDuration),O.msBeforeNext=this.msInMemoryBlockDuration),x.then(()=>{l(O)}).catch(g=>{l(g)})}else if(this.execEvenly&&O.msBeforeNext>0&&!O.isFirstInDuration){let x=Math.ceil(O.msBeforeNext/(O.remainingPoints+2));x<this.execEvenlyMinDelayMs&&(x=O.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(m,x,O)}else m(O)}_handleError(m,l,h,y,_,A=!1,O={}){this.insuranceLimiter instanceof w?this.insuranceLimiter[l](_,A,O).then(x=>{h(x)}).catch(x=>{y(x)}):y(m)}get _inmemoryBlockedKeys(){return this._inMemoryBlockedKeys}getInmemoryBlockMsBeforeExpire(m){return this.getInMemoryBlockMsBeforeExpire(m)}get inmemoryBlockOnConsumed(){return this.inMemoryBlockOnConsumed}set inmemoryBlockOnConsumed(m){this.inMemoryBlockOnConsumed=m}get inmemoryBlockDuration(){return this.inMemoryBlockDuration}set inmemoryBlockDuration(m){this.inMemoryBlockDuration=m}get msInmemoryBlockDuration(){return 1e3*this.inMemoryBlockDuration}getInMemoryBlockMsBeforeExpire(m){return this.inMemoryBlockOnConsumed>0?this._inMemoryBlockedKeys.msBeforeExpire(m):0}get inMemoryBlockOnConsumed(){return this._inMemoryBlockOnConsumed}set inMemoryBlockOnConsumed(m){if(this._inMemoryBlockOnConsumed=m?parseInt(m):0,this.inMemoryBlockOnConsumed>0&&this.points>this.inMemoryBlockOnConsumed)throw new Error('inMemoryBlockOnConsumed option must be greater or equal "points" option')}get inMemoryBlockDuration(){return this._inMemoryBlockDuration}set inMemoryBlockDuration(m){if(this._inMemoryBlockDuration=m?parseInt(m):0,this.inMemoryBlockDuration>0&&0===this.inMemoryBlockOnConsumed)throw new Error("inMemoryBlockOnConsumed option must be set up")}get msInMemoryBlockDuration(){return 1e3*this._inMemoryBlockDuration}get insuranceLimiter(){return this._insuranceLimiter}set insuranceLimiter(m){if(typeof m<"u"&&!(m instanceof w))throw new Error("insuranceLimiter must be instance of RateLimiterAbstract");this._insuranceLimiter=m,this._insuranceLimiter&&(this._insuranceLimiter.blockDuration=this.blockDuration,this._insuranceLimiter.execEvenly=this.execEvenly)}block(m,l,h={}){const y=1e3*l;return this._block(this.getKey(m),this.points+1,y,h)}set(m,l,h,y={}){const _=1e3*(h>=0?h:this.duration);return this._block(this.getKey(m),l,_,y)}consume(m,l=1,h={}){return new Promise((y,_)=>{const A=this.getKey(m),O=this.getInMemoryBlockMsBeforeExpire(A);if(O>0)return _(new S(0,O));this._upsert(A,l,1e3*this._getKeySecDuration(h),!1,h).then(x=>{this._afterConsume(y,_,A,l,x)}).catch(x=>{this._handleError(x,"consume",y,_,m,l,h)})})}penalty(m,l=1,h={}){const y=this.getKey(m);return new Promise((_,A)=>{this._upsert(y,l,1e3*this._getKeySecDuration(h),!1,h).then(O=>{_(this._getRateLimiterRes(y,l,O))}).catch(O=>{this._handleError(O,"penalty",_,A,m,l,h)})})}reward(m,l=1,h={}){const y=this.getKey(m);return new Promise((_,A)=>{this._upsert(y,-l,1e3*this._getKeySecDuration(h),!1,h).then(O=>{_(this._getRateLimiterRes(y,-l,O))}).catch(O=>{this._handleError(O,"reward",_,A,m,l,h)})})}get(m,l={}){const h=this.getKey(m);return new Promise((y,_)=>{this._get(h,l).then(A=>{y(null===A||typeof A>"u"?null:this._getRateLimiterRes(h,0,A))}).catch(A=>{this._handleError(A,"get",y,_,m,l)})})}delete(m,l={}){const h=this.getKey(m);return new Promise((y,_)=>{this._delete(h,l).then(A=>{this._inMemoryBlockedKeys.delete(h),y(A)}).catch(A=>{this._handleError(A,"delete",y,_,m,l)})})}deleteInMemoryBlockedAll(){this._inMemoryBlockedKeys.delete()}_getRateLimiterRes(m,l,h){throw new Error("You have to implement the method '_getRateLimiterRes'!")}_block(m,l,h,y={}){return new Promise((_,A)=>{this._upsert(m,l,h,!0,y).then(()=>{_(new S(0,h>0?h:-1,l))}).catch(O=>{this._handleError(O,"block",_,A,this.parseKey(m),h/1e3,y)})})}_get(m,l={}){throw new Error("You have to implement the method '_get'!")}_delete(m,l={}){throw new Error("You have to implement the method '_delete'!")}_upsert(m,l,h,y=!1,_={}){throw new Error("You have to implement the method '_upsert'!")}}},16111:(re,J,p)=>{const w=p(55781);re.exports=class{constructor(...S){if(S.length<1)throw new Error("RateLimiterUnion: at least one limiter have to be passed");S.forEach(I=>{if(!(I instanceof w))throw new Error("RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract")}),this._limiters=S}consume(S,I=1){return new Promise((m,l)=>{const h=[];this._limiters.forEach(y=>{h.push(y.consume(S,I).catch(_=>({rejected:!0,rej:_})))}),Promise.all(h).then(y=>{const _={};let A=!1;y.forEach(O=>{!0===O.rejected&&(A=!0)});for(let O=0;O<y.length;O++)A&&!0===y[O].rejected?_[this._limiters[O].keyPrefix]=y[O].rej:A||(_[this._limiters[O].keyPrefix]=y[O]);A?l(_):m(_)})})}}},35146:re=>{re.exports=class{constructor(){this._keys={},this._addedKeysAmount=0}collectExpired(){const p=Date.now();Object.keys(this._keys).forEach(w=>{this._keys[w]<=p&&delete this._keys[w]}),this._addedKeysAmount=Object.keys(this._keys).length}add(p,w){this.addMs(p,1e3*w)}addMs(p,w){this._keys[p]=Date.now()+w,this._addedKeysAmount++,this._addedKeysAmount>999&&this.collectExpired()}msBeforeExpire(p){const w=this._keys[p];if(w&&w>=Date.now()){this.collectExpired();const d=Date.now();return w>=d?w-d:0}return 0}delete(p){p?delete this._keys[p]:Object.keys(this._keys).forEach(w=>{delete this._keys[w]})}}},80498:(re,J,p)=>{const w=p(35146);re.exports=w},5290:(re,J,p)=>{const w=p(70817),d=p(50932);re.exports=class{constructor(){this._storage={}}incrby(I,m,l){if(this._storage[I]){const h=this._storage[I].expiresAt?this._storage[I].expiresAt.getTime()-(new Date).getTime():-1;return 0!==h?(this._storage[I].value=this._storage[I].value+m,new d(0,h,this._storage[I].value,!1)):this.set(I,m,l)}return this.set(I,m,l)}set(I,m,l){const h=1e3*l;return this._storage[I]&&this._storage[I].timeoutId&&clearTimeout(this._storage[I].timeoutId),this._storage[I]=new w(m,h>0?new Date(Date.now()+h):null),h>0&&(this._storage[I].timeoutId=setTimeout(()=>{delete this._storage[I]},h),this._storage[I].timeoutId.unref&&this._storage[I].timeoutId.unref()),new d(0,0===h?-1:h,this._storage[I].value,!0)}get(I){if(this._storage[I]){const m=this._storage[I].expiresAt?this._storage[I].expiresAt.getTime()-(new Date).getTime():-1;return new d(0,m,this._storage[I].value,!1)}return null}delete(I){return!!this._storage[I]&&(this._storage[I].timeoutId&&clearTimeout(this._storage[I].timeoutId),delete this._storage[I],!0)}}},70817:re=>{re.exports=class{constructor(p,w,d=null){this.value=p,this.expiresAt=w,this.timeoutId=d}get value(){return this._value}set value(p){this._value=parseInt(p)}get expiresAt(){return this._expiresAt}set expiresAt(p){!(p instanceof Date)&&Number.isInteger(p)&&(p=new Date(p)),this._expiresAt=p}get timeoutId(){return this._timeoutId}set timeoutId(p){this._timeoutId=p}}},22396:re=>{re.exports=class extends Error{constructor(p,w){super(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="CustomError",this.message=p,w&&(this.extra=w)}}},63389:(re,J,p)=>{"use strict";re.exports=m;var w=p(75592),d=m.prototype,S=new Date%1e9;function m(l){this.id=(l=l||{}).id||function I(){return(1e9*Math.random()>>>0)+S++}(),this.max=l.max||1/0,this.items=l.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(l.lastModified||new Date);for(var h,y,_=this.items.length;_--;)h=this.items[_],y=new Date(h.expires)-new Date,this._lookup[h.key]=h,y>0?this.expire(h.key,y):y<=0&&this.delete(h.key)}d.has=function(l){return l in this._lookup},d.get=function(l){if(!this.has(l))return null;var h=this._lookup[l];return h.refresh&&this.expire(l,h.refresh),this.items.splice(this.items.indexOf(h),1),this.items.push(h),h.value},d.meta=function(l){if(!this.has(l))return null;var h=this._lookup[l];return"meta"in h?h.meta:null},d.set=function(l,h,y){var _=this._lookup[l],A=this._lookup[l]={key:l,value:h};return this.lastModified=new Date,_?(clearTimeout(_.timeout),this.items.splice(this.items.indexOf(_),1,A)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(A),this.size++),y&&("ttl"in y&&this.expire(l,y.ttl),"meta"in y&&(A.meta=y.meta),y.refresh&&(A.refresh=y.ttl)),this},d.delete=function(l){var h=this._lookup[l];return!!h&&(this.lastModified=new Date,this.items.splice(this.items.indexOf(h),1),clearTimeout(h.timeout),delete this._lookup[l],this.size--,this)},d.expire=function(l,h){var y=h||0,_=this._lookup[l];if(!_)return this;if("string"==typeof y&&(y=w(h)),"number"!=typeof y)throw new TypeError("Expiration time must be a string or number.");return clearTimeout(_.timeout),_.timeout=setTimeout(this.delete.bind(this,_.key),y),_.expires=Number(new Date)+y,this},d.clear=function(){for(var l=this.items.length;l--;)this.delete(this.items[l].key);return this},d.toJSON=function(){for(var h,l=new Array(this.items.length),y=l.length;y--;)l[y]={key:(h=this.items[y]).key,meta:h.meta,value:h.value,expires:h.expires,refresh:h.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:l}}},17765:(re,J,p)=>{"use strict";const w=p(27075);class d{constructor(m,l,h){const y=this;this._started=w(),this._rescheduled=0,this._scheduled=l,this._args=h,this._triggered=!1,this._timerWrapper=()=>{y._rescheduled>0?(y._scheduled=y._rescheduled-(w()-y._started),y._schedule(y._scheduled)):(y._triggered=!0,m.apply(null,y._args))},this._timer=setTimeout(this._timerWrapper,l)}reschedule(m){m||(m=this._scheduled);const l=w();l+m-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(m)):this._triggered?this._schedule(m):(this._started=l,this._rescheduled=m)}_schedule(m){this._triggered=!1,this._started=w(),this._rescheduled=0,this._scheduled=m,this._timer=setTimeout(this._timerWrapper,m)}clear(){clearTimeout(this._timer)}}re.exports=function S(){if("function"!=typeof arguments[0])throw new Error("callback needed");if("number"!=typeof arguments[1])throw new Error("timeout needed");let I;if(arguments.length>0){I=new Array(arguments.length-2);for(var m=0;m<I.length;m++)I[m]=arguments[m+2]}return new d(arguments[0],arguments[1],I)}},27075:re=>{"use strict";re.exports=function(){return Date.now()}},97729:(re,J,p)=>{re.exports=function d(S,I,m){if("number"!=typeof I)throw new Error("second argument must be a Number");let l,h,y,_,A,x,O=!0;function g(R){function N(){m&&m(R,l),m=null}O?w(N):N()}function v(R,N,D){if(l[R]=D,N&&(A=!0),0==--y||N)g(N);else if(!A&&x<h){let k;_?(k=_[x],x+=1,S[k](function(j,Q){v(k,j,Q)})):(k=x,x+=1,S[k](function(j,Q){v(k,j,Q)}))}}Array.isArray(S)?(l=[],y=h=S.length):(_=Object.keys(S),l={},y=h=_.length),x=I,y?_?_.some(function(R,N){return S[R](function(D,k){v(R,D,k)}),N===I-1}):S.some(function(R,N){return R(function(D,k){v(N,D,k)}),N===I-1}):g(null),O=!1};const w=p(12097)},50522:(re,J,p)=>{"use strict";var w=p(25215),d=/[\/\?<>\\:\*\|"]/g,S=/[\x00-\x1f\x80-\x9f]/g,I=/^\.+$/,m=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,l=/[\. ]+$/;function h(y,_){if("string"!=typeof y)throw new Error("Input must be string");var A=y.replace(d,_).replace(S,_).replace(I,_).replace(m,_).replace(l,_);return w(A,255)}re.exports=function(y,_){var A=_&&_.replacement||"",O=h(y,A);return""===A?O:h(O,"")}},20488:(re,J,p)=>{"use strict";var w=p(21778).default;const d=new Map;function m(){return(m=w(function*(y,_,A){for(;d.get(A);){try{yield y()}catch(O){setTimeout(()=>{throw O},1);break}if(!d.get(A))break;yield new Promise(O=>{const x=setTimeout(O,_);d.set(A,x)})}})).apply(this,arguments)}re.exports={setDelayedInterval:function l(y,_,A){A=A||_;const O=`${Date.now()}:${Math.floor(1e6*Math.random())}`,x=setTimeout(()=>{!function I(y,_,A){m.apply(this,arguments)}(y,_,O)},A);return d.set(O,x),O},clearDelayedInterval:function h(y){const _=d.get(y);_&&(clearTimeout(_),d.delete(y))}}},20007:re=>{"use strict";function p(I,m){return I+w(m)}function w(I){let m=I;return m-=m>>1&1431655765,m=(858993459&m)+(m>>2&858993459),16843009*(m+(m>>4)&252645135)>>24}function d(I,m){return I[0]-m[0]}function S(I){return I[1]}re.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(m,l){let h=this._internalPositionFor(m,!1);if(void 0===l)-1!==h&&(this._unsetInternalPos(h),this._unsetBit(m),this._changedLength=!0,this._changedData=!0);else{let y=!1;-1===h?(h=this._data.length,this._setBit(m),this._changedData=!0):y=!0,this._setInternalPos(h,m,l,y),this._changedLength=!0}}unset(m){this.set(m,void 0)}get(m){this._sortData();const l=this._internalPositionFor(m,!0);if(-1!==l)return this._data[l][1]}push(m){return this.set(this.length,m),this.length}get length(){if(this._sortData(),this._changedLength){const m=this._data[this._data.length-1];this._length=m?m[0]+1:0,this._changedLength=!1}return this._length}forEach(m){let l=0;for(;l<this.length;)m(this.get(l),l,this),l++}map(m){let l=0,h=new Array(this.length);for(;l<this.length;)h[l]=m(this.get(l),l,this),l++;return h}reduce(m,l){let h=0,y=l;for(;h<this.length;)y=m(y,this.get(h),h),h++;return y}find(m){let h,y,l=0;for(;l<this.length&&!h;)y=this.get(l),h=m(y),l++;return h?y:void 0}_internalPositionFor(m,l){const h=this._bytePosFor(m,l);if(h>=this._bitArrays.length)return-1;const y=this._bitArrays[h],_=m-7*h;return(y&1<<_)>0?this._bitArrays.slice(0,h).reduce(p,0)+w(y&~(4294967295<<_+1))-1:-1}_bytePosFor(m,l){const h=Math.floor(m/7),y=h+1;for(;!l&&this._bitArrays.length<y;)this._bitArrays.push(0);return h}_setBit(m){const l=this._bytePosFor(m,!1);this._bitArrays[l]|=1<<m-7*l}_unsetBit(m){const l=this._bytePosFor(m,!1);this._bitArrays[l]&=~(1<<m-7*l)}_setInternalPos(m,l,h,y){const _=this._data,A=[l,h];if(y)this._sortData(),_[m]=A;else{if(_.length)if(_[_.length-1][0]>=l)_.push(A);else if(_[0][0]<=l)_.unshift(A);else{const O=Math.round(_.length/2);this._data=_.slice(0,O).concat(A).concat(_.slice(O))}else this._data.push(A);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(m){this._data.splice(m,1)}_sortData(){this._changedData&&this._data.sort(d),this._changedData=!1}bitField(){const m=[];let _,l=8,h=0,y=0;const A=this._bitArrays.slice();for(;A.length||h;){0===h&&(_=A.shift(),h=7);const x=Math.min(h,l);y|=(_&~(255<<x))<<8-l,_>>>=x,h-=x,l-=x,(!l||!h&&!A.length)&&(m.push(y),y=0,l=8)}for(var O=m.length-1;O>0&&0===m[O];O--)m.pop();return m}compactArray(){return this._sortData(),this._data.map(S)}}},61038:(re,J,p)=>{var w=p(14997).default,d=p(73671).default;re.exports=S=>{if(S[Symbol.asyncIterator])return S;if(S.getReader)return d(function*(){const I=S.getReader();try{for(;;){const{done:m,value:l}=yield w(I.read());if(m)return;yield l}}finally{I.releaseLock()}})();throw new Error("unknown stream")}},62148:(re,J,p)=>{"use strict";const{AbortController:w}=globalThis,d=p(17765);class S extends w{constructor(m){super(),this._ms=m,this._timer=d(()=>this.abort(),m),Object.setPrototypeOf(this,S.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=d(()=>this.abort(),this._ms)}}re.exports={TimeoutController:S}},68202:re=>{!function(){re.exports=D;var p=86400,w=3200,d=1168776,S=p*d,I=1e3*S,m=1e11*p,h=4294967296,y=1e6,_=1e9,A="000000000",O=Math.trunc||function pe(ye){var we=ye-ye%1;return 0===we&&(ye<0||0===ye&&1/ye!=1/0)?-0:we},x=D.prototype;D.fromDate=function z(ye){return new D(+ye)},D.fromInt64BE=fe(0,1,2,3,0,4),D.fromInt64LE=fe(3,2,1,0,4,0),D.fromString=function C(ye){var we,xe=new D,Ae=(ye+="").replace(/^\s*[+\-]?\d+/,function(Re){var ve=+Re,Oe=1970+(ve-1970)%400;return xe.year=ve-Oe,Oe}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(Re,ve,Oe){return ve<0&&(Oe*=-1),we=6e4*(60*+ve+ +Oe),""}).replace(/\.\d+$/,function(Re){return xe.nano=+(Re+A).substr(1,9),""}).split(/\D+/);if(Ae.length>1?Ae[1]--:Ae[1]=0,xe.time=we=Date.UTC.apply(Date,Ae)-(we||0),isNaN(we))throw new TypeError("Invalid Date");return j(xe)},D.fromTimeT=function te(ye){return Z(ye,0)},x.year=0,x.time=0,x.nano=0,x.addNano=function K(ye){return this.nano+=+ye||0,this},x.getNano=function G(){var ye=j(this);return(ye.time%1e3*y+ +ye.nano+_)%_},x.getTimeT=function se(){var ye=j(this),we=Math.floor(ye.time/1e3),xe=ye.year;return xe&&(we+=xe*d*p/w),we},x.getYear=function k(){return this.toDate().getUTCFullYear()+this.year},x.toDate=function Q(){return L(j(this).time)},x.toJSON=function ue(){return this.toString().replace(/0{1,6}Z$/,"Z")},x.toString=function oe(ye){var we=this,xe=we.toDate(),Ae={H:function je(){return _e(xe.getUTCHours())},L:function dt(){return de(xe.getUTCMilliseconds(),3)},M:function Ke(){return _e(xe.getUTCMinutes())},N:function pt(){return de(we.getNano(),9)},S:function nt(){return _e(xe.getUTCSeconds())},Y:function ve(){var Ht=we.getYear();return Ht>999999?"+"+Ht:Ht>9999?"+"+de(Ht,6):Ht>=0?de(Ht,4):Ht>=-999999?"-"+de(-Ht,6):Ht},a:function Xt(){return R[xe.getUTCDay()]},b:function Ft(){return v[xe.getUTCMonth()]},d:function Ve(){return _e(xe.getUTCDate())},e:function Ue(){return function ce(ye){return(ye>9?"":" ")+(0|ye)}(xe.getUTCDate())},m:function Oe(){return _e(xe.getUTCMonth()+1)}};return function Re(Ht){return Ht.replace(/%./g,function(Kt){var xr=Kt[1],Zt=N[xr],qt=Ae[xr];return Zt?Re(Zt):qt?qt():Kt})}(ye||"%Y-%m-%dT%H:%M:%S.%NZ")},x.writeInt64BE=me(0,1,2,3,0,4),x.writeInt64LE=me(3,2,1,0,4,0);var v=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],R=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],N={"%":"%",F:"%Y-%m-%d",n:"\n",R:"%H:%M",T:"%H:%M:%S",t:"\t",X:"%T",Z:"GMT",z:"+0000"};return D;function D(ye,we,xe){var Ae=this;if(!(Ae instanceof D))return new D(ye,we,xe);Ae.time=+ye||0,Ae.nano=+we||0,Ae.year=+xe||0,j(Ae)}function j(ye){var Re,ve,we=ye.year,xe=ye.time,Ae=ye.nano;if(Ae<0||y<=Ae){var Oe=Math.floor(Ae/y);Ae-=Oe*y,xe+=Oe,Re=1}var Ve=we%w;if(xe<-m||m<xe||Ve){(ve=O(xe/I))&&(we+=ve*w,xe-=ve*I);var Ue=L(xe);Ue.setUTCFullYear(Ve+Ue.getUTCFullYear());var je=(xe=+Ue)+(ve=O((we-=Ve)/w))*I;ve&&-m<=je&&je<=m&&(we-=ve*w,xe=je),Re=1}return Re&&(ye.year=we,ye.time=xe,ye.nano=Ae),ye}function L(ye){var we=new Date(0);return we.setTime(ye),we}function Z(ye,we){we|=0,ye=+ye||0;var xe=O((we*=h)/S)+O(ye/S),Ae=we%S+ye%S,Re=O(Ae/S);return Re&&(xe+=Re,Ae-=Re*S),new D(1e3*Ae,0,xe*w)}function me(ye,we,xe,Ae,Re,ve){return function Oe(Ue,je){var Ke=j(this);Ue||(Ue=new Array(8)),ae(Ue,je|=0);var nt=Math.floor(Ke.time/1e3),dt=Ke.year*(d*p/w),pt=O(dt/h)+O(nt/h),Xt=dt%h+nt%h,Ft=Math.floor(Xt/h);return Ft&&(pt+=Ft,Xt-=Ft*h),Ve(Ue,je+Re,pt),Ve(Ue,je+ve,Xt),Ue};function Ve(Ue,je,Ke){Ue[je+ye]=Ke>>24&255,Ue[je+we]=Ke>>16&255,Ue[je+xe]=Ke>>8&255,Ue[je+Ae]=255&Ke}}function fe(ye,we,xe,Ae,Re,ve){return function Oe(Ue,je){ae(Ue,je|=0);var Ke=Ve(Ue,je+Re);return Z(Ve(Ue,je+ve),Ke)};function Ve(Ue,je){return 16777216*Ue[je+ye]+(Ue[je+we]<<16|Ue[je+xe]<<8|Ue[je+Ae])}}function ae(ye,we){var xe=ye&&ye.length;if(null==xe)throw new TypeError("Invalid Buffer");if(xe<we+8)throw new RangeError("Out of range")}function _e(ye){return(ye>9?"":"0")+(0|ye)}function de(ye,we){return(A+(0|ye)).substr(-we)}}()},25215:(re,J,p)=>{"use strict";var w=p(70257),d=p(33440);re.exports=w.bind(null,d)},70257:re=>{"use strict";function p(w){return w>=56320&&w<=57343}re.exports=function(d,S,I){if("string"!=typeof S)throw new Error("Input must be string");for(var h,y,m=S.length,l=0,_=0;_<m;_+=1){if(h=S.charCodeAt(_),y=S[_],(w=h)>=55296&&w<=56319&&p(S.charCodeAt(_+1))&&(y+=S[_+=1]),(l+=d(y))===I)return S.slice(0,_+1);if(l>I)return S.slice(0,_-y.length+1)}var w;return S}},33440:re=>{"use strict";function J(w){return w>=55296&&w<=56319}re.exports=function(d){if("string"!=typeof d)throw new Error("Input must be string");for(var S=d.length,I=0,m=null,l=null,h=0;h<S;h++)(w=m=d.charCodeAt(h))>=56320&&w<=57343?null!=l&&J(l)?I+=1:I+=3:m<=127?I+=1:m>=128&&m<=2047?I+=2:m>=2048&&m<=65535&&(I+=3),l=m;var w;return I}},64074:re=>{re.exports=function w(d,m){var y,I=0,l=0,h=m=m||0,_=d.length;do{if(h>=_)throw w.bytes=0,new RangeError("Could not decode varint");y=d[h++],I+=l<28?(127&y)<<l:(127&y)*Math.pow(2,l),l+=7}while(y>=128);return w.bytes=h-m,I}},85128:re=>{re.exports=function S(I,m,l){m=m||[];for(var h=l=l||0;I>=d;)m[l++]=255&I|128,I/=128;for(;-128&I;)m[l++]=255&I|128,I>>>=7;return m[l]=0|I,S.bytes=l-h+1,m};var d=Math.pow(2,31)},380:(re,J,p)=>{re.exports={encode:p(85128),decode:p(64074),encodingLength:p(7738)}},7738:re=>{var J=Math.pow(2,7),p=Math.pow(2,14),w=Math.pow(2,21),d=Math.pow(2,28),S=Math.pow(2,35),I=Math.pow(2,42),m=Math.pow(2,49),l=Math.pow(2,56),h=Math.pow(2,63);re.exports=function(y){return y<J?1:y<p?2:y<w?3:y<d?4:y<S?5:y<I?6:y<m?7:y<l?8:y<h?9:10}},99802:(re,J,p)=>{"use strict";const w=p(380);re.exports=d=>{if(!(d instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");const S=[];for(;d.length>0;){const I=w.decode(d);S.push(I),d=d.slice(w.decode.bytes)}return S}},38561:re=>{re.exports=function w(d,m){var y,I=0,l=0,h=m=m||0,_=d.length;do{if(h>=_||l>49)throw w.bytes=0,new RangeError("Could not decode varint");y=d[h++],I+=l<28?(127&y)<<l:(127&y)*Math.pow(2,l),l+=7}while(y>=128);return w.bytes=h-m,I}},81838:re=>{re.exports=function S(I,m,l){if(Number.MAX_SAFE_INTEGER&&I>Number.MAX_SAFE_INTEGER)throw S.bytes=0,new RangeError("Could not encode varint");m=m||[];for(var h=l=l||0;I>=d;)m[l++]=255&I|128,I/=128;for(;-128&I;)m[l++]=255&I|128,I>>>=7;return m[l]=0|I,S.bytes=l-h+1,m};var d=Math.pow(2,31)},67213:(re,J,p)=>{re.exports={encode:p(81838),decode:p(38561),encodingLength:p(13758)}},13758:re=>{var J=Math.pow(2,7),p=Math.pow(2,14),w=Math.pow(2,21),d=Math.pow(2,28),S=Math.pow(2,35),I=Math.pow(2,42),m=Math.pow(2,49),l=Math.pow(2,56),h=Math.pow(2,63);re.exports=function(y){return y<J?1:y<p?2:y<w?3:y<d?4:y<S?5:y<I?6:y<m?7:y<l?8:y<h?9:10}},7420:()=>{},95856:()=>{},35883:()=>{},52596:()=>{},63897:()=>{},25819:()=>{},81265:()=>{},35539:()=>{},6321:function(re,J,p){"use strict";var d,S;d=[p(29693)],void 0!==(S=function(I){var m=I.Reader,l=I.Writer,h=I.util,y=I.roots.default||(I.roots.default={});return y.RPC=function(){function _(O){if(this.subscriptions=[],this.messages=[],O)for(var x=Object.keys(O),g=0;g<x.length;++g)null!=O[x[g]]&&(this[x[g]]=O[x[g]])}var A;return _.prototype.subscriptions=h.emptyArray,_.prototype.messages=h.emptyArray,_.prototype.control=null,Object.defineProperty(_.prototype,"_control",{get:h.oneOfGetter(A=["control"]),set:h.oneOfSetter(A)}),_.encode=function(x,g){if(g||(g=l.create()),null!=x.subscriptions&&x.subscriptions.length)for(var v=0;v<x.subscriptions.length;++v)y.RPC.SubOpts.encode(x.subscriptions[v],g.uint32(10).fork()).ldelim();if(null!=x.messages&&x.messages.length)for(v=0;v<x.messages.length;++v)y.RPC.Message.encode(x.messages[v],g.uint32(18).fork()).ldelim();return null!=x.control&&Object.hasOwnProperty.call(x,"control")&&y.RPC.ControlMessage.encode(x.control,g.uint32(26).fork()).ldelim(),g},_.decode=function(x,g){x instanceof m||(x=m.create(x));for(var v=void 0===g?x.len:x.pos+g,R=new y.RPC;x.pos<v;){var N=x.uint32();switch(N>>>3){case 1:R.subscriptions&&R.subscriptions.length||(R.subscriptions=[]),R.subscriptions.push(y.RPC.SubOpts.decode(x,x.uint32()));break;case 2:R.messages&&R.messages.length||(R.messages=[]),R.messages.push(y.RPC.Message.decode(x,x.uint32()));break;case 3:R.control=y.RPC.ControlMessage.decode(x,x.uint32());break;default:x.skipType(7&N)}}return R},_.fromObject=function(x){if(x instanceof y.RPC)return x;var g=new y.RPC;if(x.subscriptions){if(!Array.isArray(x.subscriptions))throw TypeError(".RPC.subscriptions: array expected");g.subscriptions=[];for(var v=0;v<x.subscriptions.length;++v){if("object"!=typeof x.subscriptions[v])throw TypeError(".RPC.subscriptions: object expected");g.subscriptions[v]=y.RPC.SubOpts.fromObject(x.subscriptions[v])}}if(x.messages){if(!Array.isArray(x.messages))throw TypeError(".RPC.messages: array expected");for(g.messages=[],v=0;v<x.messages.length;++v){if("object"!=typeof x.messages[v])throw TypeError(".RPC.messages: object expected");g.messages[v]=y.RPC.Message.fromObject(x.messages[v])}}if(null!=x.control){if("object"!=typeof x.control)throw TypeError(".RPC.control: object expected");g.control=y.RPC.ControlMessage.fromObject(x.control)}return g},_.toObject=function(x,g){g||(g={});var v={};if((g.arrays||g.defaults)&&(v.subscriptions=[],v.messages=[]),x.subscriptions&&x.subscriptions.length){v.subscriptions=[];for(var R=0;R<x.subscriptions.length;++R)v.subscriptions[R]=y.RPC.SubOpts.toObject(x.subscriptions[R],g)}if(x.messages&&x.messages.length)for(v.messages=[],R=0;R<x.messages.length;++R)v.messages[R]=y.RPC.Message.toObject(x.messages[R],g);return null!=x.control&&x.hasOwnProperty("control")&&(v.control=y.RPC.ControlMessage.toObject(x.control,g),g.oneofs&&(v._control="control")),v},_.prototype.toJSON=function(){return this.constructor.toObject(this,I.util.toJSONOptions)},_.SubOpts=function(){function O(g){if(g)for(var v=Object.keys(g),R=0;R<v.length;++R)null!=g[v[R]]&&(this[v[R]]=g[v[R]])}var x;return O.prototype.subscribe=null,O.prototype.topic=null,Object.defineProperty(O.prototype,"_subscribe",{get:h.oneOfGetter(x=["subscribe"]),set:h.oneOfSetter(x)}),Object.defineProperty(O.prototype,"_topic",{get:h.oneOfGetter(x=["topic"]),set:h.oneOfSetter(x)}),O.encode=function(v,R){return R||(R=l.create()),null!=v.subscribe&&Object.hasOwnProperty.call(v,"subscribe")&&R.uint32(8).bool(v.subscribe),null!=v.topic&&Object.hasOwnProperty.call(v,"topic")&&R.uint32(18).string(v.topic),R},O.decode=function(v,R){v instanceof m||(v=m.create(v));for(var N=void 0===R?v.len:v.pos+R,D=new y.RPC.SubOpts;v.pos<N;){var k=v.uint32();switch(k>>>3){case 1:D.subscribe=v.bool();break;case 2:D.topic=v.string();break;default:v.skipType(7&k)}}return D},O.fromObject=function(v){if(v instanceof y.RPC.SubOpts)return v;var R=new y.RPC.SubOpts;return null!=v.subscribe&&(R.subscribe=Boolean(v.subscribe)),null!=v.topic&&(R.topic=String(v.topic)),R},O.toObject=function(v,R){R||(R={});var N={};return null!=v.subscribe&&v.hasOwnProperty("subscribe")&&(N.subscribe=v.subscribe,R.oneofs&&(N._subscribe="subscribe")),null!=v.topic&&v.hasOwnProperty("topic")&&(N.topic=v.topic,R.oneofs&&(N._topic="topic")),N},O.prototype.toJSON=function(){return this.constructor.toObject(this,I.util.toJSONOptions)},O}(),_.Message=function(){function O(g){if(g)for(var v=Object.keys(g),R=0;R<v.length;++R)null!=g[v[R]]&&(this[v[R]]=g[v[R]])}var x;return O.prototype.from=null,O.prototype.data=null,O.prototype.seqno=null,O.prototype.topic="",O.prototype.signature=null,O.prototype.key=null,Object.defineProperty(O.prototype,"_from",{get:h.oneOfGetter(x=["from"]),set:h.oneOfSetter(x)}),Object.defineProperty(O.prototype,"_data",{get:h.oneOfGetter(x=["data"]),set:h.oneOfSetter(x)}),Object.defineProperty(O.prototype,"_seqno",{get:h.oneOfGetter(x=["seqno"]),set:h.oneOfSetter(x)}),Object.defineProperty(O.prototype,"_signature",{get:h.oneOfGetter(x=["signature"]),set:h.oneOfSetter(x)}),Object.defineProperty(O.prototype,"_key",{get:h.oneOfGetter(x=["key"]),set:h.oneOfSetter(x)}),O.encode=function(v,R){return R||(R=l.create()),null!=v.from&&Object.hasOwnProperty.call(v,"from")&&R.uint32(10).bytes(v.from),null!=v.data&&Object.hasOwnProperty.call(v,"data")&&R.uint32(18).bytes(v.data),null!=v.seqno&&Object.hasOwnProperty.call(v,"seqno")&&R.uint32(26).bytes(v.seqno),R.uint32(34).string(v.topic),null!=v.signature&&Object.hasOwnProperty.call(v,"signature")&&R.uint32(42).bytes(v.signature),null!=v.key&&Object.hasOwnProperty.call(v,"key")&&R.uint32(50).bytes(v.key),R},O.decode=function(v,R){v instanceof m||(v=m.create(v));for(var N=void 0===R?v.len:v.pos+R,D=new y.RPC.Message;v.pos<N;){var k=v.uint32();switch(k>>>3){case 1:D.from=v.bytes();break;case 2:D.data=v.bytes();break;case 3:D.seqno=v.bytes();break;case 4:D.topic=v.string();break;case 5:D.signature=v.bytes();break;case 6:D.key=v.bytes();break;default:v.skipType(7&k)}}if(!D.hasOwnProperty("topic"))throw h.ProtocolError("missing required 'topic'",{instance:D});return D},O.fromObject=function(v){if(v instanceof y.RPC.Message)return v;var R=new y.RPC.Message;return null!=v.from&&("string"==typeof v.from?h.base64.decode(v.from,R.from=h.newBuffer(h.base64.length(v.from)),0):v.from.length&&(R.from=v.from)),null!=v.data&&("string"==typeof v.data?h.base64.decode(v.data,R.data=h.newBuffer(h.base64.length(v.data)),0):v.data.length&&(R.data=v.data)),null!=v.seqno&&("string"==typeof v.seqno?h.base64.decode(v.seqno,R.seqno=h.newBuffer(h.base64.length(v.seqno)),0):v.seqno.length&&(R.seqno=v.seqno)),null!=v.topic&&(R.topic=String(v.topic)),null!=v.signature&&("string"==typeof v.signature?h.base64.decode(v.signature,R.signature=h.newBuffer(h.base64.length(v.signature)),0):v.signature.length&&(R.signature=v.signature)),null!=v.key&&("string"==typeof v.key?h.base64.decode(v.key,R.key=h.newBuffer(h.base64.length(v.key)),0):v.key.length&&(R.key=v.key)),R},O.toObject=function(v,R){R||(R={});var N={};return R.defaults&&(N.topic=""),null!=v.from&&v.hasOwnProperty("from")&&(N.from=R.bytes===String?h.base64.encode(v.from,0,v.from.length):R.bytes===Array?Array.prototype.slice.call(v.from):v.from,R.oneofs&&(N._from="from")),null!=v.data&&v.hasOwnProperty("data")&&(N.data=R.bytes===String?h.base64.encode(v.data,0,v.data.length):R.bytes===Array?Array.prototype.slice.call(v.data):v.data,R.oneofs&&(N._data="data")),null!=v.seqno&&v.hasOwnProperty("seqno")&&(N.seqno=R.bytes===String?h.base64.encode(v.seqno,0,v.seqno.length):R.bytes===Array?Array.prototype.slice.call(v.seqno):v.seqno,R.oneofs&&(N._seqno="seqno")),null!=v.topic&&v.hasOwnProperty("topic")&&(N.topic=v.topic),null!=v.signature&&v.hasOwnProperty("signature")&&(N.signature=R.bytes===String?h.base64.encode(v.signature,0,v.signature.length):R.bytes===Array?Array.prototype.slice.call(v.signature):v.signature,R.oneofs&&(N._signature="signature")),null!=v.key&&v.hasOwnProperty("key")&&(N.key=R.bytes===String?h.base64.encode(v.key,0,v.key.length):R.bytes===Array?Array.prototype.slice.call(v.key):v.key,R.oneofs&&(N._key="key")),N},O.prototype.toJSON=function(){return this.constructor.toObject(this,I.util.toJSONOptions)},O}(),_.ControlMessage=function(){function O(x){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],x)for(var g=Object.keys(x),v=0;v<g.length;++v)null!=x[g[v]]&&(this[g[v]]=x[g[v]])}return O.prototype.ihave=h.emptyArray,O.prototype.iwant=h.emptyArray,O.prototype.graft=h.emptyArray,O.prototype.prune=h.emptyArray,O.encode=function(g,v){if(v||(v=l.create()),null!=g.ihave&&g.ihave.length)for(var R=0;R<g.ihave.length;++R)y.RPC.ControlIHave.encode(g.ihave[R],v.uint32(10).fork()).ldelim();if(null!=g.iwant&&g.iwant.length)for(R=0;R<g.iwant.length;++R)y.RPC.ControlIWant.encode(g.iwant[R],v.uint32(18).fork()).ldelim();if(null!=g.graft&&g.graft.length)for(R=0;R<g.graft.length;++R)y.RPC.ControlGraft.encode(g.graft[R],v.uint32(26).fork()).ldelim();if(null!=g.prune&&g.prune.length)for(R=0;R<g.prune.length;++R)y.RPC.ControlPrune.encode(g.prune[R],v.uint32(34).fork()).ldelim();return v},O.decode=function(g,v){g instanceof m||(g=m.create(g));for(var R=void 0===v?g.len:g.pos+v,N=new y.RPC.ControlMessage;g.pos<R;){var D=g.uint32();switch(D>>>3){case 1:N.ihave&&N.ihave.length||(N.ihave=[]),N.ihave.push(y.RPC.ControlIHave.decode(g,g.uint32()));break;case 2:N.iwant&&N.iwant.length||(N.iwant=[]),N.iwant.push(y.RPC.ControlIWant.decode(g,g.uint32()));break;case 3:N.graft&&N.graft.length||(N.graft=[]),N.graft.push(y.RPC.ControlGraft.decode(g,g.uint32()));break;case 4:N.prune&&N.prune.length||(N.prune=[]),N.prune.push(y.RPC.ControlPrune.decode(g,g.uint32()));break;default:g.skipType(7&D)}}return N},O.fromObject=function(g){if(g instanceof y.RPC.ControlMessage)return g;var v=new y.RPC.ControlMessage;if(g.ihave){if(!Array.isArray(g.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");v.ihave=[];for(var R=0;R<g.ihave.length;++R){if("object"!=typeof g.ihave[R])throw TypeError(".RPC.ControlMessage.ihave: object expected");v.ihave[R]=y.RPC.ControlIHave.fromObject(g.ihave[R])}}if(g.iwant){if(!Array.isArray(g.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");for(v.iwant=[],R=0;R<g.iwant.length;++R){if("object"!=typeof g.iwant[R])throw TypeError(".RPC.ControlMessage.iwant: object expected");v.iwant[R]=y.RPC.ControlIWant.fromObject(g.iwant[R])}}if(g.graft){if(!Array.isArray(g.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");for(v.graft=[],R=0;R<g.graft.length;++R){if("object"!=typeof g.graft[R])throw TypeError(".RPC.ControlMessage.graft: object expected");v.graft[R]=y.RPC.ControlGraft.fromObject(g.graft[R])}}if(g.prune){if(!Array.isArray(g.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");for(v.prune=[],R=0;R<g.prune.length;++R){if("object"!=typeof g.prune[R])throw TypeError(".RPC.ControlMessage.prune: object expected");v.prune[R]=y.RPC.ControlPrune.fromObject(g.prune[R])}}return v},O.toObject=function(g,v){v||(v={});var R={};if((v.arrays||v.defaults)&&(R.ihave=[],R.iwant=[],R.graft=[],R.prune=[]),g.ihave&&g.ihave.length){R.ihave=[];for(var N=0;N<g.ihave.length;++N)R.ihave[N]=y.RPC.ControlIHave.toObject(g.ihave[N],v)}if(g.iwant&&g.iwant.length)for(R.iwant=[],N=0;N<g.iwant.length;++N)R.iwant[N]=y.RPC.ControlIWant.toObject(g.iwant[N],v);if(g.graft&&g.graft.length)for(R.graft=[],N=0;N<g.graft.length;++N)R.graft[N]=y.RPC.ControlGraft.toObject(g.graft[N],v);if(g.prune&&g.prune.length)for(R.prune=[],N=0;N<g.prune.length;++N)R.prune[N]=y.RPC.ControlPrune.toObject(g.prune[N],v);return R},O.prototype.toJSON=function(){return this.constructor.toObject(this,I.util.toJSONOptions)},O}(),_.ControlIHave=function(){function O(g){if(this.messageIDs=[],g)for(var v=Object.keys(g),R=0;R<v.length;++R)null!=g[v[R]]&&(this[v[R]]=g[v[R]])}var x;return O.prototype.topicID=null,O.prototype.messageIDs=h.emptyArray,Object.defineProperty(O.prototype,"_topicID",{get:h.oneOfGetter(x=["topicID"]),set:h.oneOfSetter(x)}),O.encode=function(v,R){if(R||(R=l.create()),null!=v.topicID&&Object.hasOwnProperty.call(v,"topicID")&&R.uint32(10).string(v.topicID),null!=v.messageIDs&&v.messageIDs.length)for(var N=0;N<v.messageIDs.length;++N)R.uint32(18).bytes(v.messageIDs[N]);return R},O.decode=function(v,R){v instanceof m||(v=m.create(v));for(var N=void 0===R?v.len:v.pos+R,D=new y.RPC.ControlIHave;v.pos<N;){var k=v.uint32();switch(k>>>3){case 1:D.topicID=v.string();break;case 2:D.messageIDs&&D.messageIDs.length||(D.messageIDs=[]),D.messageIDs.push(v.bytes());break;default:v.skipType(7&k)}}return D},O.fromObject=function(v){if(v instanceof y.RPC.ControlIHave)return v;var R=new y.RPC.ControlIHave;if(null!=v.topicID&&(R.topicID=String(v.topicID)),v.messageIDs){if(!Array.isArray(v.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");R.messageIDs=[];for(var N=0;N<v.messageIDs.length;++N)"string"==typeof v.messageIDs[N]?h.base64.decode(v.messageIDs[N],R.messageIDs[N]=h.newBuffer(h.base64.length(v.messageIDs[N])),0):v.messageIDs[N].length&&(R.messageIDs[N]=v.messageIDs[N])}return R},O.toObject=function(v,R){R||(R={});var N={};if((R.arrays||R.defaults)&&(N.messageIDs=[]),null!=v.topicID&&v.hasOwnProperty("topicID")&&(N.topicID=v.topicID,R.oneofs&&(N._topicID="topicID")),v.messageIDs&&v.messageIDs.length){N.messageIDs=[];for(var D=0;D<v.messageIDs.length;++D)N.messageIDs[D]=R.bytes===String?h.base64.encode(v.messageIDs[D],0,v.messageIDs[D].length):R.bytes===Array?Array.prototype.slice.call(v.messageIDs[D]):v.messageIDs[D]}return N},O.prototype.toJSON=function(){return this.constructor.toObject(this,I.util.toJSONOptions)},O}(),_.ControlIWant=function(){function O(x){if(this.messageIDs=[],x)for(var g=Object.keys(x),v=0;v<g.length;++v)null!=x[g[v]]&&(this[g[v]]=x[g[v]])}return O.prototype.messageIDs=h.emptyArray,O.encode=function(g,v){if(v||(v=l.create()),null!=g.messageIDs&&g.messageIDs.length)for(var R=0;R<g.messageIDs.length;++R)v.uint32(10).bytes(g.messageIDs[R]);return v},O.decode=function(g,v){g instanceof m||(g=m.create(g));for(var R=void 0===v?g.len:g.pos+v,N=new y.RPC.ControlIWant;g.pos<R;){var D=g.uint32();D>>>3==1?(N.messageIDs&&N.messageIDs.length||(N.messageIDs=[]),N.messageIDs.push(g.bytes())):g.skipType(7&D)}return N},O.fromObject=function(g){if(g instanceof y.RPC.ControlIWant)return g;var v=new y.RPC.ControlIWant;if(g.messageIDs){if(!Array.isArray(g.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");v.messageIDs=[];for(var R=0;R<g.messageIDs.length;++R)"string"==typeof g.messageIDs[R]?h.base64.decode(g.messageIDs[R],v.messageIDs[R]=h.newBuffer(h.base64.length(g.messageIDs[R])),0):g.messageIDs[R].length&&(v.messageIDs[R]=g.messageIDs[R])}return v},O.toObject=function(g,v){v||(v={});var R={};if((v.arrays||v.defaults)&&(R.messageIDs=[]),g.messageIDs&&g.messageIDs.length){R.messageIDs=[];for(var N=0;N<g.messageIDs.length;++N)R.messageIDs[N]=v.bytes===String?h.base64.encode(g.messageIDs[N],0,g.messageIDs[N].length):v.bytes===Array?Array.prototype.slice.call(g.messageIDs[N]):g.messageIDs[N]}return R},O.prototype.toJSON=function(){return this.constructor.toObject(this,I.util.toJSONOptions)},O}(),_.ControlGraft=function(){function O(g){if(g)for(var v=Object.keys(g),R=0;R<v.length;++R)null!=g[v[R]]&&(this[v[R]]=g[v[R]])}var x;return O.prototype.topicID=null,Object.defineProperty(O.prototype,"_topicID",{get:h.oneOfGetter(x=["topicID"]),set:h.oneOfSetter(x)}),O.encode=function(v,R){return R||(R=l.create()),null!=v.topicID&&Object.hasOwnProperty.call(v,"topicID")&&R.uint32(10).string(v.topicID),R},O.decode=function(v,R){v instanceof m||(v=m.create(v));for(var N=void 0===R?v.len:v.pos+R,D=new y.RPC.ControlGraft;v.pos<N;){var k=v.uint32();k>>>3==1?D.topicID=v.string():v.skipType(7&k)}return D},O.fromObject=function(v){if(v instanceof y.RPC.ControlGraft)return v;var R=new y.RPC.ControlGraft;return null!=v.topicID&&(R.topicID=String(v.topicID)),R},O.toObject=function(v,R){R||(R={});var N={};return null!=v.topicID&&v.hasOwnProperty("topicID")&&(N.topicID=v.topicID,R.oneofs&&(N._topicID="topicID")),N},O.prototype.toJSON=function(){return this.constructor.toObject(this,I.util.toJSONOptions)},O}(),_.ControlPrune=function(){function O(g){if(this.peers=[],g)for(var v=Object.keys(g),R=0;R<v.length;++R)null!=g[v[R]]&&(this[v[R]]=g[v[R]])}var x;return O.prototype.topicID=null,O.prototype.peers=h.emptyArray,O.prototype.backoff=null,Object.defineProperty(O.prototype,"_topicID",{get:h.oneOfGetter(x=["topicID"]),set:h.oneOfSetter(x)}),Object.defineProperty(O.prototype,"_backoff",{get:h.oneOfGetter(x=["backoff"]),set:h.oneOfSetter(x)}),O.encode=function(v,R){if(R||(R=l.create()),null!=v.topicID&&Object.hasOwnProperty.call(v,"topicID")&&R.uint32(10).string(v.topicID),null!=v.peers&&v.peers.length)for(var N=0;N<v.peers.length;++N)y.RPC.PeerInfo.encode(v.peers[N],R.uint32(18).fork()).ldelim();return null!=v.backoff&&Object.hasOwnProperty.call(v,"backoff")&&R.uint32(24).uint64(v.backoff),R},O.decode=function(v,R){v instanceof m||(v=m.create(v));for(var N=void 0===R?v.len:v.pos+R,D=new y.RPC.ControlPrune;v.pos<N;){var k=v.uint32();switch(k>>>3){case 1:D.topicID=v.string();break;case 2:D.peers&&D.peers.length||(D.peers=[]),D.peers.push(y.RPC.PeerInfo.decode(v,v.uint32()));break;case 3:D.backoff=v.uint64();break;default:v.skipType(7&k)}}return D},O.fromObject=function(v){if(v instanceof y.RPC.ControlPrune)return v;var R=new y.RPC.ControlPrune;if(null!=v.topicID&&(R.topicID=String(v.topicID)),v.peers){if(!Array.isArray(v.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");R.peers=[];for(var N=0;N<v.peers.length;++N){if("object"!=typeof v.peers[N])throw TypeError(".RPC.ControlPrune.peers: object expected");R.peers[N]=y.RPC.PeerInfo.fromObject(v.peers[N])}}return null!=v.backoff&&(h.Long?(R.backoff=h.Long.fromValue(v.backoff)).unsigned=!0:"string"==typeof v.backoff?R.backoff=parseInt(v.backoff,10):"number"==typeof v.backoff?R.backoff=v.backoff:"object"==typeof v.backoff&&(R.backoff=new h.LongBits(v.backoff.low>>>0,v.backoff.high>>>0).toNumber(!0))),R},O.toObject=function(v,R){R||(R={});var N={};if((R.arrays||R.defaults)&&(N.peers=[]),null!=v.topicID&&v.hasOwnProperty("topicID")&&(N.topicID=v.topicID,R.oneofs&&(N._topicID="topicID")),v.peers&&v.peers.length){N.peers=[];for(var D=0;D<v.peers.length;++D)N.peers[D]=y.RPC.PeerInfo.toObject(v.peers[D],R)}return null!=v.backoff&&v.hasOwnProperty("backoff")&&(N.backoff="number"==typeof v.backoff?R.longs===String?String(v.backoff):v.backoff:R.longs===String?h.Long.prototype.toString.call(v.backoff):R.longs===Number?new h.LongBits(v.backoff.low>>>0,v.backoff.high>>>0).toNumber(!0):v.backoff,R.oneofs&&(N._backoff="backoff")),N},O.prototype.toJSON=function(){return this.constructor.toObject(this,I.util.toJSONOptions)},O}(),_.PeerInfo=function(){function O(g){if(g)for(var v=Object.keys(g),R=0;R<v.length;++R)null!=g[v[R]]&&(this[v[R]]=g[v[R]])}var x;return O.prototype.peerID=null,O.prototype.signedPeerRecord=null,Object.defineProperty(O.prototype,"_peerID",{get:h.oneOfGetter(x=["peerID"]),set:h.oneOfSetter(x)}),Object.defineProperty(O.prototype,"_signedPeerRecord",{get:h.oneOfGetter(x=["signedPeerRecord"]),set:h.oneOfSetter(x)}),O.encode=function(v,R){return R||(R=l.create()),null!=v.peerID&&Object.hasOwnProperty.call(v,"peerID")&&R.uint32(10).bytes(v.peerID),null!=v.signedPeerRecord&&Object.hasOwnProperty.call(v,"signedPeerRecord")&&R.uint32(18).bytes(v.signedPeerRecord),R},O.decode=function(v,R){v instanceof m||(v=m.create(v));for(var N=void 0===R?v.len:v.pos+R,D=new y.RPC.PeerInfo;v.pos<N;){var k=v.uint32();switch(k>>>3){case 1:D.peerID=v.bytes();break;case 2:D.signedPeerRecord=v.bytes();break;default:v.skipType(7&k)}}return D},O.fromObject=function(v){if(v instanceof y.RPC.PeerInfo)return v;var R=new y.RPC.PeerInfo;return null!=v.peerID&&("string"==typeof v.peerID?h.base64.decode(v.peerID,R.peerID=h.newBuffer(h.base64.length(v.peerID)),0):v.peerID.length&&(R.peerID=v.peerID)),null!=v.signedPeerRecord&&("string"==typeof v.signedPeerRecord?h.base64.decode(v.signedPeerRecord,R.signedPeerRecord=h.newBuffer(h.base64.length(v.signedPeerRecord)),0):v.signedPeerRecord.length&&(R.signedPeerRecord=v.signedPeerRecord)),R},O.toObject=function(v,R){R||(R={});var N={};return null!=v.peerID&&v.hasOwnProperty("peerID")&&(N.peerID=R.bytes===String?h.base64.encode(v.peerID,0,v.peerID.length):R.bytes===Array?Array.prototype.slice.call(v.peerID):v.peerID,R.oneofs&&(N._peerID="peerID")),null!=v.signedPeerRecord&&v.hasOwnProperty("signedPeerRecord")&&(N.signedPeerRecord=R.bytes===String?h.base64.encode(v.signedPeerRecord,0,v.signedPeerRecord.length):R.bytes===Array?Array.prototype.slice.call(v.signedPeerRecord):v.signedPeerRecord,R.oneofs&&(N._signedPeerRecord="signedPeerRecord")),N},O.prototype.toJSON=function(){return this.constructor.toObject(this,I.util.toJSONOptions)},O}(),_}(),y}.apply(J,d))&&(re.exports=S)},9207:(re,J,p)=>{var w=p(62364);function d(S){var I,m;function h(_,A){try{var O=S[_](A),x=O.value,g=x instanceof w;Promise.resolve(g?x.wrapped:x).then(function(v){g?h("return"===_?"return":"next",v):y(O.done?"return":"normal",v)},function(v){h("throw",v)})}catch(v){y("throw",v)}}function y(_,A){switch(_){case"return":I.resolve({value:A,done:!0});break;case"throw":I.reject(A);break;default:I.resolve({value:A,done:!1})}(I=I.next)?h(I.key,I.arg):m=null}this._invoke=function l(_,A){return new Promise(function(O,x){var g={key:_,arg:A,resolve:O,reject:x,next:null};m?m=m.next=g:(I=m=g,h(_,A))})},"function"!=typeof S.return&&(this.return=void 0)}d.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},d.prototype.next=function(S){return this._invoke("next",S)},d.prototype.throw=function(S){return this._invoke("throw",S)},d.prototype.return=function(S){return this._invoke("return",S)},re.exports=d,re.exports.__esModule=!0,re.exports.default=re.exports},62364:re=>{re.exports=function J(p){this.wrapped=p},re.exports.__esModule=!0,re.exports.default=re.exports},63983:re=>{re.exports=function J(p,w){var d={},S=!1;function I(m,l){return S=!0,l=new Promise(function(h){h(p[m](l))}),{done:!1,value:w(l)}}return d[typeof Symbol<"u"&&Symbol.iterator||"@@iterator"]=function(){return this},d.next=function(m){return S?(S=!1,m):I("next",m)},"function"==typeof p.throw&&(d.throw=function(m){if(S)throw S=!1,m;return I("throw",m)}),"function"==typeof p.return&&(d.return=function(m){return S?(S=!1,m):I("return",m)}),d},re.exports.__esModule=!0,re.exports.default=re.exports},40226:re=>{function p(w){function d(S){if(Object(S)!==S)return Promise.reject(new TypeError(S+" is not an object."));var I=S.done;return Promise.resolve(S.value).then(function(m){return{value:m,done:I}})}return(p=function(I){this.s=I,this.n=I.next}).prototype={s:null,n:null,next:function(){return d(this.n.apply(this.s,arguments))},return:function(I){var m=this.s.return;return void 0===m?Promise.resolve({value:I,done:!0}):d(m.apply(this.s,arguments))},throw:function(I){var m=this.s.return;return void 0===m?Promise.reject(I):d(m.apply(this.s,arguments))}},new p(w)}re.exports=function J(w){var d,S,I,m=2;for(typeof Symbol<"u"&&(S=Symbol.asyncIterator,I=Symbol.iterator);m--;){if(S&&null!=(d=w[S]))return d.call(w);if(I&&null!=(d=w[I]))return new p(d.call(w));S="@@asyncIterator",I="@@iterator"}throw new TypeError("Object is not async iterable")},re.exports.__esModule=!0,re.exports.default=re.exports},14997:(re,J,p)=>{var w=p(62364);re.exports=function d(S){return new w(S)},re.exports.__esModule=!0,re.exports.default=re.exports},73671:(re,J,p)=>{var w=p(9207);re.exports=function d(S){return function(){return new w(S.apply(this,arguments))}},re.exports.__esModule=!0,re.exports.default=re.exports},66762:(re,J,p)=>{"use strict";function d(S=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(S):new Uint8Array(S)}p.d(J,{E:()=>d})},49330:(re,J,p)=>{"use strict";p.r(J),p.d(J,{concat:()=>d});var w=p(66762);function d(S,I){I||(I=S.reduce((h,y)=>h+y.length,0));const m=(0,w.E)(I);let l=0;for(const h of S)m.set(h,l),l+=h.length;return m}}}]);
//# sourceMappingURL=apps_retroweb_src_app_core_ipfs_ipfs-core_ts.ba4b500545adcea9.js.map